2025-05-29 01:02:57,697 - __main__ - INFO - Using device: cpu
2025-05-29 01:02:57,698 - __main__ - INFO - Starting enhanced MoE training pipeline...
2025-05-29 01:02:57,698 - __main__ - INFO - Loading and preprocessing data...
2025-05-29 01:02:57,708 - __main__ - INFO - Loaded dataset: 5500 samples, 50 features
2025-05-29 01:02:57,708 - __main__ - INFO - Target range: [13.20, 86.37]
2025-05-29 01:02:57,710 - __main__ - INFO - Removed 38 outliers
2025-05-29 01:02:57,740 - __main__ - INFO - Data split - Train: 3549, Val: 820, Test: 1093
2025-05-29 01:02:57,741 - __main__ - INFO - Determining optimal binning strategy...
2025-05-29 01:02:57,748 - __main__ - INFO - Optimal bins: 6, Score: 0.9194
2025-05-29 01:02:57,750 - __main__ - INFO - Selecting optimal experts for each bin...
2025-05-29 01:03:12,182 - __main__ - INFO - Bin 0: Selected xgb_conservative (592 samples)
2025-05-29 01:03:26,974 - __main__ - INFO - Bin 1: Selected xgb_aggressive (591 samples)
2025-05-29 01:03:41,777 - __main__ - INFO - Bin 2: Selected xgb_standard (591 samples)
2025-05-29 01:03:57,894 - __main__ - INFO - Bin 3: Selected xgb_standard (592 samples)
2025-05-29 01:04:12,781 - __main__ - INFO - Bin 4: Selected xgb_aggressive (591 samples)
2025-05-29 01:04:28,699 - __main__ - INFO - Bin 5: Selected lgb_deep (592 samples)
2025-05-29 01:04:28,700 - __main__ - INFO - Optimizing expert hyperparameters...
2025-05-29 01:05:18,089 - __main__ - INFO - Bin 0 optimized: 15.0446
2025-05-29 01:07:40,953 - __main__ - INFO - Bin 1 optimized: 2.2986
2025-05-29 01:08:51,171 - __main__ - INFO - Bin 2 optimized: 1.4934
2025-05-29 01:10:16,711 - __main__ - INFO - Bin 3 optimized: 1.5797
2025-05-29 01:11:38,273 - __main__ - INFO - Bin 4 optimized: 2.4241
2025-05-29 01:11:46,678 - __main__ - INFO - Bin 5 optimized: 14.9510
2025-05-29 01:11:46,678 - __main__ - INFO - Training expert models...
2025-05-29 01:11:46,816 - __main__ - INFO - Trained expert for bin 0: 592 samples
2025-05-29 01:11:50,985 - __main__ - INFO - Trained expert for bin 1: 591 samples
2025-05-29 01:11:52,018 - __main__ - INFO - Trained expert for bin 2: 591 samples
2025-05-29 01:11:52,882 - __main__ - INFO - Trained expert for bin 3: 592 samples
2025-05-29 01:11:53,194 - __main__ - INFO - Trained expert for bin 4: 591 samples
2025-05-29 01:11:53,276 - __main__ - INFO - Trained expert for bin 5: 592 samples
2025-05-29 01:11:53,366 - __main__ - INFO - Training enhanced gating network...
2025-05-29 01:11:56,590 - __main__ - INFO - Epoch 0: Train Loss=96.424980, Val Loss=105.908127
2025-05-29 01:11:56,835 - __main__ - INFO - Epoch 20: Train Loss=95.021416, Val Loss=105.787216
2025-05-29 01:11:56,985 - __main__ - INFO - Early stopping at epoch 33
2025-05-29 01:11:56,996 - __main__ - INFO - Analyzing feature importance...
2025-05-29 01:11:57,003 - __main__ - INFO - Top 10 most important features:
2025-05-29 01:11:57,003 - __main__ - INFO -   1. Feature 5: 10.8470
2025-05-29 01:11:57,004 - __main__ - INFO -   2. Feature 13: 8.3494
2025-05-29 01:11:57,004 - __main__ - INFO -   3. Feature 9: 8.3483
2025-05-29 01:11:57,004 - __main__ - INFO -   4. Feature 27: 6.8553
2025-05-29 01:11:57,005 - __main__ - INFO -   5. Feature 49: 6.8524
2025-05-29 01:11:57,005 - __main__ - INFO -   6. Feature 39: 6.5174
2025-05-29 01:11:57,005 - __main__ - INFO -   7. Feature 22: 6.3507
2025-05-29 01:11:57,005 - __main__ - INFO -   8. Feature 37: 5.3527
2025-05-29 01:11:57,005 - __main__ - INFO -   9. Feature 31: 5.3507
2025-05-29 01:11:57,006 - __main__ - INFO -   10. Feature 46: 5.1865

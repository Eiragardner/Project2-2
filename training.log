2025-05-29 16:37:00,694 - MoETrainer - INFO - Using device: cpu
2025-05-29 16:37:00,695 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 16:37:00,696 - MoETrainer - INFO - Loading data...
2025-05-29 16:37:01,594 - MoETrainer - INFO - Loaded dataset: 5555 samples, 744 features
2025-05-29 16:37:01,594 - MoETrainer - INFO - Target range: [0.00, 1.00]
2025-05-29 16:37:01,595 - MoETrainer - INFO - Preprocessing data...
2025-05-29 17:01:43,378 - MoETrainer - INFO - Using device: cpu
2025-05-29 17:01:43,380 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 17:01:43,380 - MoETrainer - INFO - Loading data...
2025-05-29 17:01:44,397 - MoETrainer - INFO - Detected many house type features. Consolidating...
2025-05-29 17:01:50,880 - MoETrainer - INFO - Consolidated 736 binary features into 4 house type categories
2025-05-29 17:01:50,899 - MoETrainer - INFO - Loaded dataset: 5555 samples, 12 features
2025-05-29 17:01:50,901 - MoETrainer - INFO - Target (Price) range: [$149,000, $4,700,000]
2025-05-29 17:01:50,901 - MoETrainer - WARNING - Small dataset (5555 samples) detected. Consider reducing MoE complexity or using simpler models.
2025-05-29 17:01:50,902 - MoETrainer - INFO - Preprocessing data for small dataset...
2025-05-29 17:01:50,903 - MoETrainer - INFO - Removed 96 outliers (1.7%)
2025-05-29 17:01:50,918 - MoETrainer - INFO - Applied robust scaling
2025-05-29 17:01:50,919 - MoETrainer - INFO - Final preprocessed shape: (5459, 12)
2025-05-29 17:01:50,919 - MoETrainer - INFO - Splitting data...
2025-05-29 17:01:50,928 - MoETrainer - INFO - Data split - Train: 3821, Val: 819, Test: 819
2025-05-29 17:01:50,928 - MoETrainer - INFO - Optimizing binning strategy...
2025-05-29 17:01:50,934 - MoETrainer - INFO - Optimal bins: 5, Score: 0.8714
2025-05-29 17:01:50,935 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 17:01:57,620 - MoETrainer - INFO - Bin 0: Selected lgb_wide (764 samples)
2025-05-29 17:02:02,640 - MoETrainer - INFO - Bin 1: Selected xgb_conservative (757 samples)
2025-05-29 17:02:07,626 - MoETrainer - INFO - Bin 2: Selected xgb_conservative (771 samples)
2025-05-29 17:02:13,378 - MoETrainer - INFO - Bin 3: Selected xgb_conservative (758 samples)
2025-05-29 17:02:19,165 - MoETrainer - INFO - Bin 4: Selected xgb_conservative (771 samples)
2025-05-29 17:02:19,166 - MoETrainer - INFO - Training expert models...
2025-05-29 17:02:19,240 - MoETrainer - INFO - Trained expert for bin 0: 764 samples
2025-05-29 17:02:19,404 - MoETrainer - INFO - Trained expert for bin 1: 757 samples
2025-05-29 17:02:19,551 - MoETrainer - INFO - Trained expert for bin 2: 771 samples
2025-05-29 17:02:19,715 - MoETrainer - INFO - Trained expert for bin 3: 758 samples
2025-05-29 17:02:19,959 - MoETrainer - INFO - Trained expert for bin 4: 771 samples
2025-05-29 17:02:20,076 - MoETrainer - INFO - Training enhanced gating network...
2025-05-29 17:02:25,506 - MoETrainer - INFO - Epoch 0: Train Loss=61763837952.000000, Val Loss=68553175040.000000
2025-05-29 17:02:25,817 - MoETrainer - INFO - Epoch 20: Train Loss=42804252672.000000, Val Loss=46943510528.000000
2025-05-29 17:02:26,331 - MoETrainer - INFO - Epoch 40: Train Loss=28139956224.000000, Val Loss=32164538368.000000
2025-05-29 17:02:26,648 - MoETrainer - INFO - Epoch 60: Train Loss=24196155392.000000, Val Loss=29370804224.000000
2025-05-29 17:02:26,973 - MoETrainer - INFO - Epoch 80: Train Loss=23114924032.000000, Val Loss=28167925760.000000
2025-05-29 17:02:27,317 - MoETrainer - INFO - Epoch 100: Train Loss=21964466176.000000, Val Loss=27339495424.000000
2025-05-29 17:02:27,639 - MoETrainer - INFO - Epoch 120: Train Loss=21364011008.000000, Val Loss=27033524224.000000
2025-05-29 17:02:28,058 - MoETrainer - INFO - Epoch 140: Train Loss=21083379712.000000, Val Loss=26862643200.000000
2025-05-29 17:02:28,259 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 17:02:28,259 - MoETrainer - INFO - Overall Performance:
2025-05-29 17:02:28,260 - MoETrainer - INFO -   RMSE: 157771.3430
2025-05-29 17:02:28,261 - MoETrainer - INFO -   MAE: 111012.4190
2025-05-29 17:02:28,261 - MoETrainer - INFO -   R²: 0.6009
2025-05-29 17:02:28,262 - MoETrainer - INFO -   MAPE: 22.35%
2025-05-29 17:02:28,262 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 17:02:28,262 - MoETrainer - INFO -   Bin 0: RMSE=110995.0439, R²=-6.1904, Samples=180
2025-05-29 17:02:28,263 - MoETrainer - INFO -   Bin 1: RMSE=102989.5401, R²=-23.4776, Samples=167
2025-05-29 17:02:28,263 - MoETrainer - INFO -   Bin 2: RMSE=121495.7022, R²=-19.0561, Samples=161
2025-05-29 17:02:28,263 - MoETrainer - INFO -   Bin 3: RMSE=150514.9098, R²=-8.0221, Samples=151
2025-05-29 17:02:28,263 - MoETrainer - INFO -   Bin 4: RMSE=257391.2002, R²=-0.3461, Samples=160
2025-05-29 17:02:28,264 - MoETrainer - WARNING - Stacking ensemble failed: Found input variables with inconsistent numbers of samples: [819, 3821]. Using voting instead.
2025-05-29 17:02:28,265 - MoETrainer - INFO - 
=== VOTING Ensemble Results ===
2025-05-29 17:02:28,279 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 17:02:28,279 - MoETrainer - INFO - Overall Performance:
2025-05-29 17:02:28,279 - MoETrainer - INFO -   RMSE: 193800.5831
2025-05-29 17:02:28,280 - MoETrainer - INFO -   MAE: 160487.2652
2025-05-29 17:02:28,280 - MoETrainer - INFO -   R²: 0.3979
2025-05-29 17:02:28,280 - MoETrainer - INFO -   MAPE: 39.37%
2025-05-29 17:02:28,280 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 17:02:28,281 - MoETrainer - INFO -   Bin 0: RMSE=239365.1437, R²=-32.4399, Samples=180
2025-05-29 17:02:28,282 - MoETrainer - INFO -   Bin 1: RMSE=178292.6736, R²=-72.3585, Samples=167
2025-05-29 17:02:28,282 - MoETrainer - INFO -   Bin 2: RMSE=142901.2259, R²=-26.7457, Samples=161
2025-05-29 17:02:28,282 - MoETrainer - INFO -   Bin 3: RMSE=121774.7272, R²=-4.9056, Samples=151
2025-05-29 17:02:28,283 - MoETrainer - INFO -   Bin 4: RMSE=245098.8324, R²=-0.2206, Samples=160
2025-05-29 17:02:28,283 - MoETrainer - INFO - 
=== STACKING Ensemble Results ===
2025-05-29 17:02:28,299 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 17:02:28,300 - MoETrainer - INFO - Overall Performance:
2025-05-29 17:02:28,300 - MoETrainer - INFO -   RMSE: 193800.5831
2025-05-29 17:02:28,300 - MoETrainer - INFO -   MAE: 160487.2652
2025-05-29 17:02:28,301 - MoETrainer - INFO -   R²: 0.3979
2025-05-29 17:02:28,301 - MoETrainer - INFO -   MAPE: 39.37%
2025-05-29 17:02:28,301 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 17:02:28,302 - MoETrainer - INFO -   Bin 0: RMSE=239365.1437, R²=-32.4399, Samples=180
2025-05-29 17:02:28,303 - MoETrainer - INFO -   Bin 1: RMSE=178292.6736, R²=-72.3585, Samples=167
2025-05-29 17:02:28,305 - MoETrainer - INFO -   Bin 2: RMSE=142901.2259, R²=-26.7457, Samples=161
2025-05-29 17:02:28,306 - MoETrainer - INFO -   Bin 3: RMSE=121774.7272, R²=-4.9056, Samples=151
2025-05-29 17:02:28,306 - MoETrainer - INFO -   Bin 4: RMSE=245098.8324, R²=-0.2206, Samples=160
2025-05-29 17:02:28,349 - MoETrainer - INFO - Model saved to models_enhanced
2025-05-29 17:02:28,349 - MoETrainer - INFO - Training completed successfully!
2025-05-29 17:16:41,803 - MoETrainer - INFO - Using device: cpu
2025-05-29 17:16:41,803 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 17:16:41,804 - MoETrainer - INFO - Loading data...
2025-05-29 17:16:42,850 - MoETrainer - INFO - Detected many house type features. Consolidating...
2025-05-29 17:16:46,226 - MoETrainer - INFO - Detected 736 binary columns
2025-05-29 17:16:51,951 - MoETrainer - INFO - Consolidated 736 binary features into 4 house type categories
2025-05-29 17:16:51,951 - MoETrainer - INFO - Final shape: (5555, 13)
2025-05-29 17:16:51,984 - MoETrainer - INFO - Loaded dataset: 5555 samples, 12 features
2025-05-29 17:16:51,985 - MoETrainer - INFO - Target (Price) range: [$149,000, $4,700,000]
2025-05-29 17:16:51,986 - MoETrainer - WARNING - Small dataset (5555 samples) detected. Consider reducing MoE complexity or using simpler models.
2025-05-29 17:18:57,131 - MoETrainer - INFO - Using device: cpu
2025-05-29 17:18:57,131 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 17:18:57,132 - MoETrainer - INFO - Loading data...
2025-05-29 17:19:03,061 - MoETrainer - INFO - Consolidating 736 binary features
2025-05-29 17:19:09,028 - MoETrainer - INFO - Reduced features from 744 to 12
2025-05-29 17:19:09,042 - MoETrainer - INFO - Loaded dataset: 5555 samples, 12 features
2025-05-29 17:19:09,048 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 17:19:09,053 - MoETrainer - INFO - Preprocessing data...
2025-05-29 17:19:09,059 - MoETrainer - INFO - Removed 336 outliers (6.0%)
2025-05-29 17:19:09,080 - MoETrainer - INFO - Applied robust scaling
2025-05-29 17:19:09,081 - MoETrainer - INFO - Splitting data...
2025-05-29 17:19:09,084 - MoETrainer - INFO - Data split - Train: 3392, Val: 783, Test: 1044
2025-05-29 17:19:09,085 - MoETrainer - INFO - Optimizing binning strategy...
2025-05-29 17:19:09,093 - MoETrainer - INFO - Optimal bins: 4, Score: 0.8563
2025-05-29 17:19:09,096 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 17:20:12,417 - MoETrainer - INFO - Using device: cpu
2025-05-29 17:20:12,418 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 17:20:12,418 - MoETrainer - INFO - Loading data...
2025-05-29 17:20:18,385 - MoETrainer - INFO - Consolidating 736 binary features
2025-05-29 17:20:26,568 - MoETrainer - INFO - Reduced features from 744 to 12
2025-05-29 17:20:26,574 - MoETrainer - INFO - Loaded dataset: 5555 samples, 12 features
2025-05-29 17:20:26,574 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 17:20:26,575 - MoETrainer - INFO - Preprocessing data...
2025-05-29 17:20:26,576 - MoETrainer - INFO - Removed 336 outliers (6.0%)
2025-05-29 17:20:26,593 - MoETrainer - INFO - Applied robust scaling
2025-05-29 17:20:26,596 - MoETrainer - INFO - Splitting data...
2025-05-29 17:20:26,600 - MoETrainer - INFO - Data split - Train: 3392, Val: 783, Test: 1044
2025-05-29 17:20:26,601 - MoETrainer - INFO - Optimizing binning strategy...
2025-05-29 17:20:26,612 - MoETrainer - INFO - Optimal bins: 4, Score: 0.8563
2025-05-29 17:20:26,612 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 17:20:27,970 - MoETrainer - INFO - Bin 0: Selected xgb_standard (758 samples)
2025-05-29 17:20:28,998 - MoETrainer - INFO - Bin 1: Selected lgb_wide (899 samples)
2025-05-29 17:20:29,910 - MoETrainer - INFO - Bin 2: Selected lgb_fast (854 samples)
2025-05-29 17:20:30,693 - MoETrainer - INFO - Bin 3: Selected xgb_standard (881 samples)
2025-05-29 17:20:30,694 - MoETrainer - INFO - Training expert models...
2025-05-29 17:20:30,819 - MoETrainer - INFO - Trained expert for bin 0: 758 samples
2025-05-29 17:20:30,886 - MoETrainer - INFO - Trained expert for bin 1: 899 samples
2025-05-29 17:20:30,928 - MoETrainer - INFO - Trained expert for bin 2: 854 samples
2025-05-29 17:20:31,027 - MoETrainer - INFO - Trained expert for bin 3: 881 samples
2025-05-29 17:20:31,093 - MoETrainer - INFO - Training enhanced gating network...
2025-05-29 17:20:35,593 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,598 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,607 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,610 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,612 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,616 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,620 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,623 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,627 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,629 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,631 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,633 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,637 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,639 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,640 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,644 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,646 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,648 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,650 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,654 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,657 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,660 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,662 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,665 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,667 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,674 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,679 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,682 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,684 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,687 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,690 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,693 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,695 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,698 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,701 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,704 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,706 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,707 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,710 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,713 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,715 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,717 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,721 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,723 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,726 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,729 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,731 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,734 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,738 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,740 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,745 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,747 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,750 - MoETrainer - WARNING - Batch failed in epoch 0: The size of tensor a (4) must match the size of tensor b (64) at non-singleton dimension 1
2025-05-29 17:20:35,750 - MoETrainer - WARNING - No valid batches in epoch 0
2025-05-29 17:20:35,751 - MoETrainer - WARNING - No improvement during training, using final state
2025-05-29 17:44:35,691 - MoETrainer - INFO - Using device: cpu
2025-05-29 17:44:35,692 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 17:44:35,692 - MoETrainer - INFO - Loading data...
2025-05-29 17:44:39,277 - MoETrainer - INFO - Consolidating 736 binary features
2025-05-29 17:44:42,231 - MoETrainer - INFO - Reduced features from 744 to 12
2025-05-29 17:44:42,241 - MoETrainer - INFO - Loaded dataset: 5555 samples, 12 features
2025-05-29 17:44:42,242 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 17:44:42,243 - MoETrainer - INFO - Preprocessing data...
2025-05-29 17:44:42,244 - MoETrainer - INFO - Removed 336 outliers (6.0%)
2025-05-29 17:44:42,250 - MoETrainer - INFO - Applied robust scaling
2025-05-29 17:44:42,251 - MoETrainer - INFO - Splitting data...
2025-05-29 17:44:42,257 - MoETrainer - INFO - Data split - Train: 3392, Val: 783, Test: 1044
2025-05-29 17:44:42,259 - MoETrainer - INFO - Optimizing binning strategy...
2025-05-29 17:44:42,268 - MoETrainer - INFO - Optimal bins: 4, Score: 0.8563
2025-05-29 17:44:42,270 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 17:44:42,868 - MoETrainer - INFO - Bin 0: Selected lgb_fast (758 samples)
2025-05-29 17:44:43,190 - MoETrainer - INFO - Bin 1: Selected lgb_conservative (899 samples)
2025-05-29 17:44:43,523 - MoETrainer - INFO - Bin 2: Selected lgb_fast (854 samples)
2025-05-29 17:44:43,851 - MoETrainer - INFO - Bin 3: Selected lgb_conservative (881 samples)
2025-05-29 17:44:43,852 - MoETrainer - INFO - Training expert models...
2025-05-29 17:44:43,885 - MoETrainer - INFO - Trained expert for bin 0: 758 samples
2025-05-29 17:44:43,919 - MoETrainer - INFO - Trained expert for bin 1: 899 samples
2025-05-29 17:44:43,952 - MoETrainer - INFO - Trained expert for bin 2: 854 samples
2025-05-29 17:44:43,989 - MoETrainer - INFO - Trained expert for bin 3: 881 samples
2025-05-29 17:44:44,048 - MoETrainer - INFO - Training enhanced gating network...
2025-05-29 17:44:49,911 - MoETrainer - INFO - Epoch 0: Train=40719802368.000000, Val=39173672960.000000
2025-05-29 17:44:50,035 - MoETrainer - INFO - Epoch 10: Train=39278403584.000000, Val=37865328640.000000
2025-05-29 17:44:50,116 - MoETrainer - INFO - Epoch 20: Train=37882269696.000000, Val=36596514816.000000
2025-05-29 17:44:50,247 - MoETrainer - INFO - Epoch 30: Train=36428468224.000000, Val=35379175424.000000
2025-05-29 17:44:50,403 - MoETrainer - INFO - Epoch 40: Train=35260211200.000000, Val=34216163328.000000
2025-05-29 17:44:50,533 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 17:44:50,534 - MoETrainer - INFO - Overall Performance:
2025-05-29 17:44:50,535 - MoETrainer - INFO -   RMSE: 186130.5080
2025-05-29 17:44:50,535 - MoETrainer - INFO -   MAE: 161826.7031
2025-05-29 17:44:50,536 - MoETrainer - INFO -   R²: -0.0639
2025-05-29 17:44:50,536 - MoETrainer - INFO -   MAPE: 43.34%
2025-05-29 17:44:50,536 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 17:44:50,536 - MoETrainer - INFO -   Bin 0: RMSE=274107.4499, R²=-39.0931, Samples=240
2025-05-29 17:44:50,536 - MoETrainer - INFO -   Bin 1: RMSE=181587.3490, R²=-41.4017, Samples=271
2025-05-29 17:44:50,536 - MoETrainer - INFO -   Bin 2: RMSE=102883.2447, R²=-5.2446, Samples=277
2025-05-29 17:44:50,537 - MoETrainer - INFO -   Bin 3: RMSE=156481.9763, R²=-0.7000, Samples=256
2025-05-29 17:44:50,537 - MoETrainer - INFO - 
=== VOTING Ensemble Results ===
2025-05-29 17:44:50,548 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 17:44:50,548 - MoETrainer - INFO - Overall Performance:
2025-05-29 17:44:50,549 - MoETrainer - INFO -   RMSE: 191069.7728
2025-05-29 17:44:50,549 - MoETrainer - INFO -   MAE: 166222.9326
2025-05-29 17:44:50,549 - MoETrainer - INFO -   R²: -0.1211
2025-05-29 17:44:50,550 - MoETrainer - INFO -   MAPE: 44.71%
2025-05-29 17:44:50,551 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 17:44:50,552 - MoETrainer - INFO -   Bin 0: RMSE=284331.8535, R²=-42.1399, Samples=240
2025-05-29 17:44:50,552 - MoETrainer - INFO -   Bin 1: RMSE=187643.6351, R²=-44.2772, Samples=271
2025-05-29 17:44:50,553 - MoETrainer - INFO -   Bin 2: RMSE=102633.7796, R²=-5.2143, Samples=277
2025-05-29 17:44:50,553 - MoETrainer - INFO -   Bin 3: RMSE=156268.8887, R²=-0.6954, Samples=256
2025-05-29 17:44:50,553 - MoETrainer - INFO - 
=== STACKING Ensemble Results ===
2025-05-29 17:44:50,569 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 17:44:50,571 - MoETrainer - INFO - Overall Performance:
2025-05-29 17:44:50,571 - MoETrainer - INFO -   RMSE: 191069.7728
2025-05-29 17:44:50,573 - MoETrainer - INFO -   MAE: 166222.9326
2025-05-29 17:44:50,575 - MoETrainer - INFO -   R²: -0.1211
2025-05-29 17:44:50,582 - MoETrainer - INFO -   MAPE: 44.71%
2025-05-29 17:44:50,586 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 17:44:50,587 - MoETrainer - INFO -   Bin 0: RMSE=284331.8535, R²=-42.1399, Samples=240
2025-05-29 17:44:50,587 - MoETrainer - INFO -   Bin 1: RMSE=187643.6351, R²=-44.2772, Samples=271
2025-05-29 17:44:50,588 - MoETrainer - INFO -   Bin 2: RMSE=102633.7796, R²=-5.2143, Samples=277
2025-05-29 17:44:50,588 - MoETrainer - INFO -   Bin 3: RMSE=156268.8887, R²=-0.6954, Samples=256
2025-05-29 17:44:50,609 - MoETrainer - INFO - Model saved to models_enhanced
2025-05-29 17:44:50,611 - MoETrainer - INFO - Training completed successfully!
2025-05-29 17:51:13,227 - MoETrainer - INFO - Using device: cpu
2025-05-29 17:51:13,227 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 17:51:13,228 - MoETrainer - INFO - Loading data...
2025-05-29 17:51:14,131 - MoETrainer - INFO - Consolidating 744 features...
2025-05-29 17:51:17,063 - MoETrainer - INFO - Consolidated to 14 features
2025-05-29 17:51:17,082 - MoETrainer - INFO - Loaded dataset: 5555 samples, 14 features
2025-05-29 17:51:17,082 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 17:51:17,083 - MoETrainer - INFO - Preprocessing data...
2025-05-29 17:51:17,087 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 17:51:17,097 - MoETrainer - INFO - Applied robust scaling
2025-05-29 17:51:17,144 - MoETrainer - INFO - Splitting data...
2025-05-29 17:51:17,229 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 17:51:17,297 - MoETrainer - INFO - Optimizing binning strategy...
2025-05-29 17:51:17,353 - MoETrainer - INFO - Optimal bins: 6, Score: 0.8626
2025-05-29 17:51:17,365 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 18:17:14,403 - MoETrainer - INFO - Using device: cpu
2025-05-29 18:17:14,404 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 18:17:14,405 - MoETrainer - INFO - Loading data...
2025-05-29 18:17:15,358 - MoETrainer - INFO - Consolidating 744 features...
2025-05-29 18:17:18,384 - MoETrainer - INFO - Consolidated to 14 features
2025-05-29 18:17:18,401 - MoETrainer - INFO - Loaded dataset: 5555 samples, 14 features
2025-05-29 18:17:18,408 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 18:17:18,408 - MoETrainer - INFO - Preprocessing data...
2025-05-29 18:17:18,410 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 18:17:18,421 - MoETrainer - INFO - Applied robust scaling
2025-05-29 18:17:18,421 - MoETrainer - INFO - Splitting data...
2025-05-29 18:17:18,425 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 18:17:18,426 - MoETrainer - INFO - Optimizing binning strategy...
2025-05-29 18:17:18,438 - MoETrainer - INFO - Optimal bins: 6, Score: 0.8626
2025-05-29 18:17:18,438 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 18:17:18,902 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 18:17:19,121 - MoETrainer - INFO - Bin 1: Selected lgb_simple (638 samples)
2025-05-29 18:17:19,300 - MoETrainer - INFO - Bin 2: Selected lgb_simple (615 samples)
2025-05-29 18:17:19,489 - MoETrainer - INFO - Bin 3: Selected ridge_light (599 samples)
2025-05-29 18:17:19,673 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 18:17:19,859 - MoETrainer - INFO - Bin 5: Selected ridge_heavy (597 samples)
2025-05-29 18:17:19,859 - MoETrainer - INFO - Training expert models...
2025-05-29 18:17:19,861 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 18:17:19,876 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 18:17:19,896 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 18:17:19,899 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 18:17:19,907 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 18:17:19,909 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 18:17:19,927 - MoETrainer - INFO - Training enhanced gating network...
2025-05-29 18:17:23,717 - MoETrainer - INFO - Epoch 0: Train=60219691008, Val=61325520896
2025-05-29 18:17:23,791 - MoETrainer - INFO - Epoch 10: Train=59970404352, Val=61131255808
2025-05-29 18:17:23,848 - MoETrainer - INFO - Epoch 20: Train=60103450624, Val=60933595136
2025-05-29 18:17:23,925 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 18:17:23,925 - MoETrainer - INFO - Overall Performance:
2025-05-29 18:17:23,926 - MoETrainer - INFO -   RMSE: 253006.7084
2025-05-29 18:17:23,926 - MoETrainer - INFO -   MAE: 194243.9844
2025-05-29 18:17:23,926 - MoETrainer - INFO -   R²: 0.1622
2025-05-29 18:17:23,927 - MoETrainer - INFO -   MAPE: 44.06%
2025-05-29 18:17:23,927 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 18:17:23,927 - MoETrainer - INFO -   Bin 0: RMSE=294474.1055, R²=-58.4565, Samples=178
2025-05-29 18:17:23,927 - MoETrainer - INFO -   Bin 1: RMSE=207767.9543, R²=-93.1900, Samples=195
2025-05-29 18:17:23,928 - MoETrainer - INFO -   Bin 2: RMSE=148519.1397, R²=-49.2594, Samples=180
2025-05-29 18:17:23,928 - MoETrainer - INFO -   Bin 3: RMSE=81669.1566, R²=-7.3156, Samples=179
2025-05-29 18:17:23,928 - MoETrainer - INFO -   Bin 4: RMSE=58387.2709, R²=-0.6353, Samples=172
2025-05-29 18:17:23,929 - MoETrainer - INFO -   Bin 5: RMSE=455502.2395, R²=-1.7123, Samples=197
2025-05-29 18:17:23,929 - MoETrainer - INFO - 
=== VOTING Ensemble Results ===
2025-05-29 18:17:23,945 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 18:17:23,946 - MoETrainer - INFO - Overall Performance:
2025-05-29 18:17:23,946 - MoETrainer - INFO -   RMSE: 258190.5294
2025-05-29 18:17:23,947 - MoETrainer - INFO -   MAE: 197674.3845
2025-05-29 18:17:23,947 - MoETrainer - INFO -   R²: 0.1275
2025-05-29 18:17:23,948 - MoETrainer - INFO -   MAPE: 44.66%
2025-05-29 18:17:23,948 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 18:17:23,950 - MoETrainer - INFO -   Bin 0: RMSE=298610.7548, R²=-60.1387, Samples=178
2025-05-29 18:17:23,951 - MoETrainer - INFO -   Bin 1: RMSE=209440.8462, R²=-94.7129, Samples=195
2025-05-29 18:17:23,952 - MoETrainer - INFO -   Bin 2: RMSE=148643.8062, R²=-49.3438, Samples=180
2025-05-29 18:17:23,953 - MoETrainer - INFO -   Bin 3: RMSE=80302.3986, R²=-7.0396, Samples=179
2025-05-29 18:17:23,954 - MoETrainer - INFO -   Bin 4: RMSE=58539.3574, R²=-0.6438, Samples=172
2025-05-29 18:17:23,956 - MoETrainer - INFO -   Bin 5: RMSE=468547.3577, R²=-1.8699, Samples=197
2025-05-29 18:17:23,957 - MoETrainer - INFO - 
=== STACKING Ensemble Results ===
2025-05-29 18:17:23,979 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 18:17:23,980 - MoETrainer - INFO - Overall Performance:
2025-05-29 18:17:23,980 - MoETrainer - INFO -   RMSE: 258190.5294
2025-05-29 18:17:23,980 - MoETrainer - INFO -   MAE: 197674.3845
2025-05-29 18:17:23,981 - MoETrainer - INFO -   R²: 0.1275
2025-05-29 18:17:23,981 - MoETrainer - INFO -   MAPE: 44.66%
2025-05-29 18:17:23,981 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 18:17:23,982 - MoETrainer - INFO -   Bin 0: RMSE=298610.7548, R²=-60.1387, Samples=178
2025-05-29 18:17:23,982 - MoETrainer - INFO -   Bin 1: RMSE=209440.8462, R²=-94.7129, Samples=195
2025-05-29 18:17:23,982 - MoETrainer - INFO -   Bin 2: RMSE=148643.8062, R²=-49.3438, Samples=180
2025-05-29 18:17:23,982 - MoETrainer - INFO -   Bin 3: RMSE=80302.3986, R²=-7.0396, Samples=179
2025-05-29 18:17:23,983 - MoETrainer - INFO -   Bin 4: RMSE=58539.3574, R²=-0.6438, Samples=172
2025-05-29 18:17:23,983 - MoETrainer - INFO -   Bin 5: RMSE=468547.3577, R²=-1.8699, Samples=197
2025-05-29 18:17:23,996 - MoETrainer - INFO - Model saved to models_enhanced
2025-05-29 18:17:23,997 - MoETrainer - INFO - Training completed successfully!
2025-05-29 18:25:25,704 - MoETrainer - INFO - Starting IMPROVED MoE Training Pipeline
2025-05-29 18:25:25,704 - MoETrainer - INFO - Loading data...
2025-05-29 18:25:26,617 - MoETrainer - INFO - Consolidating 744 features...
2025-05-29 18:25:29,944 - MoETrainer - INFO - Consolidated to 14 features
2025-05-29 18:25:29,962 - MoETrainer - INFO - Loaded dataset: 5555 samples, 14 features
2025-05-29 18:25:29,963 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 18:25:29,968 - MoETrainer - INFO - Preprocessing data...
2025-05-29 18:25:29,972 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 18:25:29,985 - MoETrainer - INFO - Applied robust scaling
2025-05-29 18:25:29,986 - MoETrainer - INFO - Splitting data...
2025-05-29 18:25:29,991 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 18:25:29,992 - MoETrainer - INFO - === Training Baseline Models ===
2025-05-29 18:25:30,753 - MoETrainer - INFO - RIDGE: RMSE=193206, R²=0.5114
2025-05-29 18:25:30,753 - MoETrainer - INFO - RANDOM_FOREST: RMSE=178453, R²=0.5832
2025-05-29 18:25:30,754 - MoETrainer - INFO - ENSEMBLE: RMSE=179655, R²=0.5776
2025-05-29 18:25:30,754 - MoETrainer - INFO - === Training Improved MoE ===
2025-05-29 18:25:31,702 - MoETrainer - INFO - MoE 2 bins: RMSE=159608, R²=0.6666
2025-05-29 18:25:32,856 - MoETrainer - INFO - MoE 3 bins: RMSE=141470, R²=0.7381
2025-05-29 18:25:34,163 - MoETrainer - INFO - MoE 4 bins: RMSE=128755, R²=0.7830
2025-05-29 18:25:35,745 - MoETrainer - INFO - MoE 5 bins: RMSE=118052, R²=0.8176
2025-05-29 18:25:35,746 - MoETrainer - INFO - === Model Selection Results ===
2025-05-29 18:25:35,747 - MoETrainer - INFO - === FINAL COMPARISON ===
2025-05-29 18:25:35,747 - MoETrainer - INFO - moe_5_bins          : RMSE=  118052, R²= 0.8176 *** BEST ***
2025-05-29 18:25:35,748 - MoETrainer - INFO - random_forest       : RMSE=  178453, R²= 0.5832
2025-05-29 18:25:35,748 - MoETrainer - INFO - ensemble            : RMSE=  179655, R²= 0.5776
2025-05-29 18:25:35,748 - MoETrainer - INFO - ridge               : RMSE=  193206, R²= 0.5114
2025-05-29 18:25:35,756 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 18:25:35,756 - MoETrainer - INFO - Overall Performance:
2025-05-29 18:25:35,756 - MoETrainer - INFO -   RMSE: 118052.4312
2025-05-29 18:25:35,757 - MoETrainer - INFO -   MAE: 59677.6118
2025-05-29 18:25:35,757 - MoETrainer - INFO -   R²: 0.8176
2025-05-29 18:25:35,758 - MoETrainer - INFO -   MAPE: 9.51%
2025-05-29 18:39:01,633 - MoETrainer - INFO - Starting DETAILED IMPROVED MoE Training Pipeline
2025-05-29 18:39:01,634 - MoETrainer - INFO - Loading data with improved processing...
2025-05-29 18:39:02,556 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 18:39:02,769 - MoETrainer - INFO - Feature types: 8 numeric, 736 binary, 0 categorical
2025-05-29 18:39:06,176 - MoETrainer - INFO - Processed features: 23 (from 744 original)
2025-05-29 18:39:06,177 - MoETrainer - INFO - Loaded dataset: 5555 samples, 23 features
2025-05-29 18:39:06,178 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 18:39:06,179 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 18:39:06,179 - MoETrainer - INFO - Preprocessing data with feature selection...
2025-05-29 18:39:06,181 - MoETrainer - INFO - Removed 7 outliers (0.1%)
2025-05-29 18:39:06,191 - MoETrainer - INFO - Selected 20 features from 23
2025-05-29 18:39:06,199 - MoETrainer - INFO - Applied robust scaling
2025-05-29 18:39:06,201 - MoETrainer - INFO - Splitting data...
2025-05-29 18:39:06,212 - MoETrainer - INFO - Data split - Train: 3605, Val: 833, Test: 1110
2025-05-29 18:39:06,212 - MoETrainer - INFO - Train target: mean=$550,360, std=$320,917
2025-05-29 18:39:06,213 - MoETrainer - INFO - Test target: mean=$560,582, std=$331,767
2025-05-29 18:39:06,214 - MoETrainer - INFO - === Training Baseline Models ===
2025-05-29 18:39:07,877 - MoETrainer - INFO -   RIDGE          : RMSE=  234367, MAE=  136233, R²= 0.5010
2025-05-29 18:39:07,878 - MoETrainer - INFO -   RANDOM_FOREST  : RMSE=  237346, MAE=  136969, R²= 0.4882
2025-05-29 18:39:07,878 - MoETrainer - INFO -   ENSEMBLE       : RMSE=  232989, MAE=  134808, R²= 0.5068
2025-05-29 18:39:07,880 - MoETrainer - INFO - === Training DETAILED MoE ===
2025-05-29 18:39:07,916 - MoETrainer - INFO -   Bin 0: Train=1796, Test=523, Range=$150,000 - $459,000, Mean=$353,968
2025-05-29 18:39:07,916 - MoETrainer - INFO -   Bin 1: Train=1809, Test=587, Range=$460,000 - $3,475,000, Mean=$745,341
2025-05-29 18:39:08,749 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R²=0.223)
2025-05-29 18:39:09,532 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R²=0.476)
2025-05-29 18:39:09,577 - MoETrainer - INFO -   Bin 0: RMSE=   59810, MAE=   49053, R²= 0.2201 (523 samples)
2025-05-29 18:39:09,581 - MoETrainer - INFO -   Bin 1: RMSE=  306230, MAE=  174634, R²= 0.2927 (587 samples)
2025-05-29 18:39:09,630 - MoETrainer - INFO -   Bin 0: Train=1202, Test=330, Range=$150,000 - $390,000, Mean=$319,322
2025-05-29 18:39:09,631 - MoETrainer - INFO -   Bin 1: Train=1195, Test=404, Range=$393,000 - $560,000, Mean=$465,767
2025-05-29 18:39:09,632 - MoETrainer - INFO -   Bin 2: Train=1208, Test=376, Range=$565,000 - $3,475,000, Mean=$863,935
2025-05-29 18:39:10,247 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R²=0.112)
2025-05-29 18:39:11,849 - MoETrainer - INFO -   Bin 2: Selected RandomForest (val_R²=0.297)
2025-05-29 18:39:12,065 - MoETrainer - INFO -   Bin 0: RMSE=   47135, MAE=   37812, R²= 0.1287 (330 samples)
2025-05-29 18:39:12,066 - MoETrainer - INFO -   Bin 1: RMSE=   47044, MAE=   39924, R²= 0.0886 (404 samples)
2025-05-29 18:39:12,068 - MoETrainer - INFO -   Bin 2: RMSE=  346305, MAE=  204231, R²= 0.2407 (376 samples)
2025-05-29 18:39:12,122 - MoETrainer - INFO -   Bin 0: Train= 900, Test=263, Range=$150,000 - $364,000, Mean=$299,697
2025-05-29 18:39:12,127 - MoETrainer - INFO -   Bin 1: Train= 896, Test=260, Range=$365,000 - $459,000, Mean=$408,482
2025-05-29 18:39:12,128 - MoETrainer - INFO -   Bin 2: Train= 907, Test=292, Range=$460,000 - $629,000, Mean=$535,681
2025-05-29 18:39:12,130 - MoETrainer - INFO -   Bin 3: Train= 902, Test=295, Range=$630,000 - $3,475,000, Mean=$956,164
2025-05-29 18:39:13,699 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R²=0.033)
2025-05-29 18:39:14,723 - MoETrainer - INFO -   Bin 0: RMSE=   41171, MAE=   33166, R²= 0.1177 (263 samples)
2025-05-29 18:39:14,727 - MoETrainer - INFO -   Bin 1: RMSE=   27660, MAE=   23506, R²=-0.0233 (260 samples)
2025-05-29 18:39:14,728 - MoETrainer - INFO -   Bin 2: RMSE=   45519, MAE=   38758, R²= 0.0827 (292 samples)
2025-05-29 18:39:14,728 - MoETrainer - INFO -   Bin 3: RMSE=  363984, MAE=  212254, R²= 0.2376 (295 samples)
2025-05-29 18:39:14,771 - MoETrainer - INFO -   Bin 0: Train= 702, Test=215, Range=$150,000 - $342,000, Mean=$285,272
2025-05-29 18:39:14,772 - MoETrainer - INFO -   Bin 1: Train= 735, Test=191, Range=$345,000 - $419,500, Mean=$378,130
2025-05-29 18:39:14,773 - MoETrainer - INFO -   Bin 2: Train= 725, Test=244, Range=$420,000 - $519,000, Mean=$463,044
2025-05-29 18:39:14,774 - MoETrainer - INFO -   Bin 3: Train= 722, Test=213, Range=$520,000 - $690,000, Mean=$591,883
2025-05-29 18:39:14,775 - MoETrainer - INFO -   Bin 4: Train= 721, Test=247, Range=$695,000 - $3,475,000, Mean=$1,030,259
2025-05-29 18:39:15,646 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R²=0.021)
2025-05-29 18:39:16,641 - MoETrainer - INFO -   Bin 3: Selected RandomForest (val_R²=0.011)
2025-05-29 18:39:17,083 - MoETrainer - INFO -   Bin 4: Selected RandomForest (val_R²=0.226)
2025-05-29 18:39:17,091 - MoETrainer - INFO -   Bin 0: RMSE=   38623, MAE=   31264, R²= 0.0540 (215 samples)
2025-05-29 18:39:17,091 - MoETrainer - INFO -   Bin 1: RMSE=   22166, MAE=   19044, R²=-0.0608 (191 samples)
2025-05-29 18:39:17,092 - MoETrainer - INFO -   Bin 2: RMSE=   27225, MAE=   24010, R²= 0.0203 (244 samples)
2025-05-29 18:39:17,092 - MoETrainer - INFO -   Bin 3: RMSE=   47705, MAE=   40378, R²= 0.0676 (213 samples)
2025-05-29 18:39:17,093 - MoETrainer - INFO -   Bin 4: RMSE=  404803, MAE=  245764, R²= 0.1287 (247 samples)
2025-05-29 18:39:17,136 - MoETrainer - INFO -   Bin 0: Train= 529, Test=161, Range=$150,000 - $324,500, Mean=$270,793
2025-05-29 18:39:17,136 - MoETrainer - INFO -   Bin 1: Train= 673, Test=169, Range=$325,000 - $390,000, Mean=$357,467
2025-05-29 18:39:17,137 - MoETrainer - INFO -   Bin 2: Train= 594, Test=193, Range=$393,000 - $459,000, Mean=$424,077
2025-05-29 18:39:17,138 - MoETrainer - INFO -   Bin 3: Train= 601, Test=211, Range=$460,000 - $560,000, Mean=$506,971
2025-05-29 18:39:17,139 - MoETrainer - INFO -   Bin 4: Train= 607, Test=173, Range=$565,000 - $727,000, Mean=$634,661
2025-05-29 18:39:17,140 - MoETrainer - INFO -   Bin 5: Train= 601, Test=203, Range=$729,000 - $3,475,000, Mean=$1,095,498
2025-05-29 18:39:20,436 - MoETrainer - INFO -   Bin 0: RMSE=   34655, MAE=   27937, R²= 0.0672 (161 samples)
2025-05-29 18:39:20,436 - MoETrainer - INFO -   Bin 1: RMSE=   21465, MAE=   18804, R²=-0.0201 (169 samples)
2025-05-29 18:39:20,437 - MoETrainer - INFO -   Bin 2: RMSE=   20417, MAE=   17421, R²=-0.0065 (193 samples)
2025-05-29 18:39:20,438 - MoETrainer - INFO -   Bin 3: RMSE=   29133, MAE=   25216, R²= 0.0066 (211 samples)
2025-05-29 18:39:20,438 - MoETrainer - INFO -   Bin 4: RMSE=   50592, MAE=   44054, R²=-0.0503 (173 samples)
2025-05-29 18:39:20,439 - MoETrainer - INFO -   Bin 5: RMSE=  413778, MAE=  254760, R²= 0.1628 (203 samples)
2025-05-29 18:39:20,455 - MoETrainer - INFO -   2 bins: RMSE=  226445, MAE=  115464, R²= 0.5341
2025-05-29 18:39:20,457 - MoETrainer - INFO -   3 bins: RMSE=  205158, MAE=   94953, R²= 0.6176
2025-05-29 18:39:20,458 - MoETrainer - INFO -   4 bins: RMSE=  190619, MAE=   79970, R²= 0.6699
2025-05-29 18:39:20,459 - MoETrainer - INFO -   5 bins: RMSE=  193486, MAE=   77047, R²= 0.6599
2025-05-29 18:39:20,477 - MoETrainer - INFO - === FINAL MODEL SELECTION ===
2025-05-29 18:39:20,611 - MoETrainer - INFO -   Number of bins: 6
2025-05-29 18:39:20,701 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 18:39:20,702 - MoETrainer - INFO - Overall Performance:
2025-05-29 18:39:20,703 - MoETrainer - INFO -   RMSE: 179412.5730
2025-05-29 18:39:20,703 - MoETrainer - INFO -   MAE: 68195.0954
2025-05-29 18:39:20,703 - MoETrainer - INFO -   R²: 0.7076
2025-05-29 18:39:20,704 - MoETrainer - INFO -   MAPE: 9.14%
2025-05-29 18:44:39,978 - MoETrainer - INFO - Starting DETAILED IMPROVED MoE Training Pipeline
2025-05-29 18:44:39,978 - MoETrainer - INFO - Loading data with improved processing...
2025-05-29 18:44:40,833 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 18:44:41,019 - MoETrainer - INFO - Feature types: 8 numeric, 736 binary, 0 categorical
2025-05-29 18:44:44,292 - MoETrainer - INFO - Processed features: 23 (from 744 original)
2025-05-29 18:44:44,293 - MoETrainer - INFO - Loaded dataset: 5555 samples, 23 features
2025-05-29 18:44:44,294 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 18:44:44,294 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 18:44:44,295 - MoETrainer - INFO - Preprocessing data with feature selection...
2025-05-29 18:44:44,296 - MoETrainer - INFO - Removed 7 outliers (0.1%)
2025-05-29 18:44:44,302 - MoETrainer - INFO - Selected 20 features from 23
2025-05-29 18:44:44,315 - MoETrainer - INFO - Applied robust scaling
2025-05-29 18:44:44,315 - MoETrainer - INFO - Splitting data...
2025-05-29 18:44:44,321 - MoETrainer - INFO - Data split - Train: 3605, Val: 833, Test: 1110
2025-05-29 18:44:44,322 - MoETrainer - INFO - Train target: mean=$550,360, std=$320,917
2025-05-29 18:44:44,323 - MoETrainer - INFO - Test target: mean=$560,582, std=$331,767
2025-05-29 18:44:44,323 - MoETrainer - INFO - === Training Baseline Models ===
2025-05-29 18:44:45,850 - MoETrainer - INFO - BASELINE RESULTS:
2025-05-29 18:44:45,851 - MoETrainer - INFO -   RIDGE          : RMSE=  234367, MAE=  136233, R^2= 0.5010
2025-05-29 18:44:45,851 - MoETrainer - INFO -   RANDOM_FOREST  : RMSE=  237346, MAE=  136969, R^2= 0.4882
2025-05-29 18:44:45,851 - MoETrainer - INFO -   ENSEMBLE       : RMSE=  232989, MAE=  134808, R^2= 0.5068
2025-05-29 18:44:45,851 - MoETrainer - INFO - === Training DETAILED MoE ===
2025-05-29 18:44:45,851 - MoETrainer - INFO - ANALYZING MoE WITH 2 BINS:
2025-05-29 18:44:45,852 - MoETrainer - INFO - Bin boundaries: $460,000
2025-05-29 18:44:45,852 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:44:45,853 - MoETrainer - INFO -   Bin 0: Train=1796, Test=523, Range=$150,000 - $459,000, Mean=$353,968
2025-05-29 18:44:45,853 - MoETrainer - INFO -   Bin 1: Train=1809, Test=587, Range=$460,000 - $3,475,000, Mean=$745,341
2025-05-29 18:44:45,853 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:44:48,494 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R^2=0.223)
2025-05-29 18:44:49,794 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=0.476)
2025-05-29 18:44:49,798 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:44:49,802 - MoETrainer - INFO -   Bin 0: RMSE=   59810, MAE=   49053, R^2= 0.2201 (523 samples)
2025-05-29 18:44:49,802 - MoETrainer - INFO -   Bin 1: RMSE=  306230, MAE=  174634, R^2= 0.2927 (587 samples)
2025-05-29 18:44:49,802 - MoETrainer - INFO - ANALYZING MoE WITH 3 BINS:
2025-05-29 18:44:49,804 - MoETrainer - INFO - Bin boundaries: $391,000, $565,000
2025-05-29 18:44:49,805 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:44:49,805 - MoETrainer - INFO -   Bin 0: Train=1202, Test=330, Range=$150,000 - $390,000, Mean=$319,322
2025-05-29 18:44:49,805 - MoETrainer - INFO -   Bin 1: Train=1195, Test=404, Range=$393,000 - $560,000, Mean=$465,767
2025-05-29 18:44:49,806 - MoETrainer - INFO -   Bin 2: Train=1208, Test=376, Range=$565,000 - $3,475,000, Mean=$863,935
2025-05-29 18:44:49,818 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:44:50,657 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R^2=0.112)
2025-05-29 18:44:51,406 - MoETrainer - INFO -   Bin 1: Selected Ridge(a=100) (val_R^2=0.118)
2025-05-29 18:44:52,117 - MoETrainer - INFO -   Bin 2: Selected RandomForest (val_R^2=0.297)
2025-05-29 18:44:52,119 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:44:52,119 - MoETrainer - INFO -   Bin 0: RMSE=   47135, MAE=   37812, R^2= 0.1287 (330 samples)
2025-05-29 18:44:52,120 - MoETrainer - INFO -   Bin 1: RMSE=   47044, MAE=   39924, R^2= 0.0886 (404 samples)
2025-05-29 18:44:52,121 - MoETrainer - INFO -   Bin 2: RMSE=  346305, MAE=  204231, R^2= 0.2407 (376 samples)
2025-05-29 18:44:52,121 - MoETrainer - INFO - ANALYZING MoE WITH 4 BINS:
2025-05-29 18:44:52,122 - MoETrainer - INFO - Bin boundaries: $365,000, $460,000, $630,000
2025-05-29 18:44:52,123 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:44:52,124 - MoETrainer - INFO -   Bin 0: Train= 900, Test=263, Range=$150,000 - $364,000, Mean=$299,697
2025-05-29 18:44:52,125 - MoETrainer - INFO -   Bin 1: Train= 896, Test=260, Range=$365,000 - $459,000, Mean=$408,482
2025-05-29 18:44:52,125 - MoETrainer - INFO -   Bin 2: Train= 907, Test=292, Range=$460,000 - $629,000, Mean=$535,681
2025-05-29 18:44:52,126 - MoETrainer - INFO -   Bin 3: Train= 902, Test=295, Range=$630,000 - $3,475,000, Mean=$956,164
2025-05-29 18:44:52,131 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:44:52,586 - MoETrainer - INFO -   Bin 0: Selected Ridge(a=10) (val_R^2=0.100)
2025-05-29 18:44:53,164 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=0.033)
2025-05-29 18:44:53,659 - MoETrainer - INFO -   Bin 2: Selected Ridge(a=10) (val_R^2=0.033)
2025-05-29 18:44:54,384 - MoETrainer - INFO -   Bin 3: Selected Ridge(a=10) (val_R^2=0.312)
2025-05-29 18:44:54,386 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:44:54,387 - MoETrainer - INFO -   Bin 0: RMSE=   41171, MAE=   33166, R^2= 0.1177 (263 samples)
2025-05-29 18:44:54,387 - MoETrainer - INFO -   Bin 1: RMSE=   27660, MAE=   23506, R^2=-0.0233 (260 samples)
2025-05-29 18:44:54,388 - MoETrainer - INFO -   Bin 2: RMSE=   45519, MAE=   38758, R^2= 0.0827 (292 samples)
2025-05-29 18:44:54,388 - MoETrainer - INFO -   Bin 3: RMSE=  363984, MAE=  212254, R^2= 0.2376 (295 samples)
2025-05-29 18:44:54,388 - MoETrainer - INFO - ANALYZING MoE WITH 5 BINS:
2025-05-29 18:44:54,389 - MoETrainer - INFO - Bin boundaries: $345,000, $420,000, $520,000, $691,000
2025-05-29 18:44:54,389 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:44:54,390 - MoETrainer - INFO -   Bin 0: Train= 702, Test=215, Range=$150,000 - $342,000, Mean=$285,272
2025-05-29 18:44:54,391 - MoETrainer - INFO -   Bin 1: Train= 735, Test=191, Range=$345,000 - $419,500, Mean=$378,130
2025-05-29 18:44:54,391 - MoETrainer - INFO -   Bin 2: Train= 725, Test=244, Range=$420,000 - $519,000, Mean=$463,044
2025-05-29 18:44:54,392 - MoETrainer - INFO -   Bin 3: Train= 722, Test=213, Range=$520,000 - $690,000, Mean=$591,883
2025-05-29 18:44:54,392 - MoETrainer - INFO -   Bin 4: Train= 721, Test=247, Range=$695,000 - $3,475,000, Mean=$1,030,259
2025-05-29 18:44:54,393 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:44:54,905 - MoETrainer - INFO -   Bin 0: Selected Ridge(a=10) (val_R^2=0.111)
2025-05-29 18:44:55,447 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=0.021)
2025-05-29 18:44:55,848 - MoETrainer - INFO -   Bin 2: Selected Ridge(a=100) (val_R^2=0.024)
2025-05-29 18:44:56,438 - MoETrainer - INFO -   Bin 3: Selected RandomForest (val_R^2=0.011)
2025-05-29 18:44:56,832 - MoETrainer - INFO -   Bin 4: Selected RandomForest (val_R^2=0.226)
2025-05-29 18:44:56,835 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:44:56,836 - MoETrainer - INFO -   Bin 0: RMSE=   38623, MAE=   31264, R^2= 0.0540 (215 samples)
2025-05-29 18:44:56,836 - MoETrainer - INFO -   Bin 1: RMSE=   22166, MAE=   19044, R^2=-0.0608 (191 samples)
2025-05-29 18:44:56,836 - MoETrainer - INFO -   Bin 2: RMSE=   27225, MAE=   24010, R^2= 0.0203 (244 samples)
2025-05-29 18:44:56,837 - MoETrainer - INFO -   Bin 3: RMSE=   47705, MAE=   40378, R^2= 0.0676 (213 samples)
2025-05-29 18:44:56,837 - MoETrainer - INFO -   Bin 4: RMSE=  404803, MAE=  245764, R^2= 0.1287 (247 samples)
2025-05-29 18:44:56,838 - MoETrainer - INFO - ANALYZING MoE WITH 6 BINS:
2025-05-29 18:44:56,839 - MoETrainer - INFO - Bin boundaries: $325,000, $391,000, $460,000, $565,000, $727,667
2025-05-29 18:44:56,841 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:44:56,842 - MoETrainer - INFO -   Bin 0: Train= 529, Test=161, Range=$150,000 - $324,500, Mean=$270,793
2025-05-29 18:44:56,845 - MoETrainer - INFO -   Bin 1: Train= 673, Test=169, Range=$325,000 - $390,000, Mean=$357,467
2025-05-29 18:44:56,848 - MoETrainer - INFO -   Bin 2: Train= 594, Test=193, Range=$393,000 - $459,000, Mean=$424,077
2025-05-29 18:44:56,848 - MoETrainer - INFO -   Bin 3: Train= 601, Test=211, Range=$460,000 - $560,000, Mean=$506,971
2025-05-29 18:44:56,852 - MoETrainer - INFO -   Bin 4: Train= 607, Test=173, Range=$565,000 - $727,000, Mean=$634,661
2025-05-29 18:44:56,852 - MoETrainer - INFO -   Bin 5: Train= 601, Test=203, Range=$729,000 - $3,475,000, Mean=$1,095,498
2025-05-29 18:44:56,853 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:44:57,161 - MoETrainer - INFO -   Bin 0: Selected Ridge(a=10) (val_R^2=0.078)
2025-05-29 18:44:57,585 - MoETrainer - INFO -   Bin 1: Selected Ridge(a=100) (val_R^2=-0.004)
2025-05-29 18:44:57,924 - MoETrainer - INFO -   Bin 2: Selected Ridge(a=100) (val_R^2=0.002)
2025-05-29 18:44:58,289 - MoETrainer - INFO -   Bin 3: Selected Ridge(a=100) (val_R^2=0.031)
2025-05-29 18:44:58,630 - MoETrainer - INFO -   Bin 4: Selected Ridge(a=10) (val_R^2=-0.014)
2025-05-29 18:44:58,963 - MoETrainer - INFO -   Bin 5: Selected Ridge(a=100) (val_R^2=0.158)
2025-05-29 18:44:58,965 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:44:58,967 - MoETrainer - INFO -   Bin 0: RMSE=   34655, MAE=   27937, R^2= 0.0672 (161 samples)
2025-05-29 18:44:58,967 - MoETrainer - INFO -   Bin 1: RMSE=   21465, MAE=   18804, R^2=-0.0201 (169 samples)
2025-05-29 18:44:58,967 - MoETrainer - INFO -   Bin 2: RMSE=   20417, MAE=   17421, R^2=-0.0065 (193 samples)
2025-05-29 18:44:58,968 - MoETrainer - INFO -   Bin 3: RMSE=   29133, MAE=   25216, R^2= 0.0066 (211 samples)
2025-05-29 18:44:58,968 - MoETrainer - INFO -   Bin 4: RMSE=   50592, MAE=   44054, R^2=-0.0503 (173 samples)
2025-05-29 18:44:58,968 - MoETrainer - INFO -   Bin 5: RMSE=  413778, MAE=  254760, R^2= 0.1628 (203 samples)
2025-05-29 18:44:58,969 - MoETrainer - INFO - MoE COMPARISON:
2025-05-29 18:44:58,970 - MoETrainer - INFO -   2 bins: RMSE=  226445, MAE=  115464, R^2= 0.5341
2025-05-29 18:44:58,970 - MoETrainer - INFO -   3 bins: RMSE=  205158, MAE=   94953, R^2= 0.6176
2025-05-29 18:44:58,971 - MoETrainer - INFO -   4 bins: RMSE=  190619, MAE=   79970, R^2= 0.6699
2025-05-29 18:44:58,971 - MoETrainer - INFO -   5 bins: RMSE=  193486, MAE=   77047, R^2= 0.6599
2025-05-29 18:44:58,973 - MoETrainer - INFO -   6 bins: RMSE=  179413, MAE=   68195, R^2= 0.7076 [BEST]
2025-05-29 18:44:58,974 - MoETrainer - INFO - === FINAL MODEL SELECTION ===
2025-05-29 18:44:58,976 - MoETrainer - INFO - FINAL COMPARISON (ranked by R^2):
2025-05-29 18:44:58,978 - MoETrainer - INFO -   [MoE] moe_6_bins          : RMSE=  179413, MAE=   68195, R^2= 0.7076 [WINNER]
2025-05-29 18:44:58,979 - MoETrainer - INFO -   [BASE] ensemble            : RMSE=  232989, MAE=  134808, R^2= 0.5068
2025-05-29 18:44:58,979 - MoETrainer - INFO -   [BASE] ridge               : RMSE=  234367, MAE=  136233, R^2= 0.5010
2025-05-29 18:44:58,979 - MoETrainer - INFO -   [BASE] random_forest       : RMSE=  237346, MAE=  136969, R^2= 0.4882
2025-05-29 18:44:58,980 - MoETrainer - INFO - WINNING MoE DETAILS:
2025-05-29 18:44:58,980 - MoETrainer - INFO -   Number of bins: 6
2025-05-29 18:44:58,980 - MoETrainer - INFO -   Bin 0: Ridge(a=10)
2025-05-29 18:44:58,981 - MoETrainer - INFO -   Bin 1: Ridge(a=100)
2025-05-29 18:44:58,981 - MoETrainer - INFO -   Bin 2: Ridge(a=100)
2025-05-29 18:44:58,981 - MoETrainer - INFO -   Bin 3: Ridge(a=100)
2025-05-29 18:44:58,982 - MoETrainer - INFO -   Bin 4: Ridge(a=10)
2025-05-29 18:44:58,984 - MoETrainer - INFO -   Bin 5: Ridge(a=100)
2025-05-29 18:44:58,988 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 18:44:58,991 - MoETrainer - INFO - Overall Performance:
2025-05-29 18:44:58,992 - MoETrainer - INFO -   RMSE: 179412.5730
2025-05-29 18:44:58,992 - MoETrainer - INFO -   MAE: 68195.0954
2025-05-29 18:44:58,993 - MoETrainer - INFO -   RÂ²: 0.7076
2025-05-29 18:44:58,994 - MoETrainer - INFO -   MAPE: 9.14%
2025-05-29 18:50:10,946 - MoETrainer - INFO - Starting DETAILED IMPROVED MoE Training Pipeline
2025-05-29 18:50:10,947 - MoETrainer - INFO - Loading data with improved processing...
2025-05-29 18:50:11,840 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 18:50:12,025 - MoETrainer - INFO - Feature types: 8 numeric, 736 binary, 0 categorical
2025-05-29 18:50:15,196 - MoETrainer - INFO - Processed features: 23 (from 744 original)
2025-05-29 18:50:15,197 - MoETrainer - INFO - Loaded dataset: 5555 samples, 23 features
2025-05-29 18:50:15,198 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 18:50:15,198 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 18:50:15,200 - MoETrainer - INFO - Preprocessing data with feature selection...
2025-05-29 18:50:15,203 - MoETrainer - INFO - Removed 7 outliers (0.1%)
2025-05-29 18:50:15,227 - MoETrainer - INFO - Selected 20 features from 23
2025-05-29 18:50:15,247 - MoETrainer - INFO - Applied robust scaling
2025-05-29 18:50:15,247 - MoETrainer - INFO - Splitting data...
2025-05-29 18:50:15,253 - MoETrainer - INFO - Data split - Train: 3605, Val: 833, Test: 1110
2025-05-29 18:50:15,277 - MoETrainer - INFO - Train target: mean=$550,360, std=$320,917
2025-05-29 18:50:15,278 - MoETrainer - INFO - Test target: mean=$560,582, std=$331,767
2025-05-29 18:50:15,294 - MoETrainer - INFO - === Training Baseline Models ===
2025-05-29 18:50:16,846 - MoETrainer - INFO - BASELINE RESULTS:
2025-05-29 18:50:16,846 - MoETrainer - INFO -   RIDGE          : RMSE=  234367, MAE=  136233, R^2= 0.5010
2025-05-29 18:50:16,846 - MoETrainer - INFO -   RANDOM_FOREST  : RMSE=  237346, MAE=  136969, R^2= 0.4882
2025-05-29 18:50:16,847 - MoETrainer - INFO -   ENSEMBLE       : RMSE=  232989, MAE=  134808, R^2= 0.5068
2025-05-29 18:50:16,847 - MoETrainer - INFO - === Training DETAILED MoE ===
2025-05-29 18:50:16,847 - MoETrainer - INFO - ANALYZING MoE WITH 2 BINS:
2025-05-29 18:50:16,848 - MoETrainer - INFO - Bin boundaries: $460,000
2025-05-29 18:50:16,848 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:50:16,848 - MoETrainer - INFO -   Bin 0: Train=1796, Test=523, Range=$150,000 - $459,000, Mean=$353,968
2025-05-29 18:50:16,849 - MoETrainer - INFO -   Bin 1: Train=1809, Test=587, Range=$460,000 - $3,475,000, Mean=$745,341
2025-05-29 18:50:16,849 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:50:17,583 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R^2=0.223)
2025-05-29 18:50:18,346 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=0.476)
2025-05-29 18:50:18,349 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:50:18,351 - MoETrainer - INFO -   Bin 0: RMSE=   59810, MAE=   49053, R^2= 0.2201 (523 samples)
2025-05-29 18:50:18,351 - MoETrainer - INFO -   Bin 1: RMSE=  306230, MAE=  174634, R^2= 0.2927 (587 samples)
2025-05-29 18:50:18,352 - MoETrainer - INFO - ANALYZING MoE WITH 3 BINS:
2025-05-29 18:50:18,353 - MoETrainer - INFO - Bin boundaries: $391,000, $565,000
2025-05-29 18:50:18,355 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:50:18,355 - MoETrainer - INFO -   Bin 0: Train=1202, Test=330, Range=$150,000 - $390,000, Mean=$319,322
2025-05-29 18:50:18,357 - MoETrainer - INFO -   Bin 1: Train=1195, Test=404, Range=$393,000 - $560,000, Mean=$465,767
2025-05-29 18:50:18,358 - MoETrainer - INFO -   Bin 2: Train=1208, Test=376, Range=$565,000 - $3,475,000, Mean=$863,935
2025-05-29 18:50:18,359 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:50:18,876 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R^2=0.112)
2025-05-29 18:50:19,412 - MoETrainer - INFO -   Bin 1: Selected Ridge(a=100) (val_R^2=0.118)
2025-05-29 18:50:19,944 - MoETrainer - INFO -   Bin 2: Selected RandomForest (val_R^2=0.297)
2025-05-29 18:50:19,945 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:50:19,945 - MoETrainer - INFO -   Bin 0: RMSE=   47135, MAE=   37812, R^2= 0.1287 (330 samples)
2025-05-29 18:50:19,946 - MoETrainer - INFO -   Bin 1: RMSE=   47044, MAE=   39924, R^2= 0.0886 (404 samples)
2025-05-29 18:50:19,946 - MoETrainer - INFO -   Bin 2: RMSE=  346305, MAE=  204231, R^2= 0.2407 (376 samples)
2025-05-29 18:50:19,947 - MoETrainer - INFO - ANALYZING MoE WITH 4 BINS:
2025-05-29 18:50:19,948 - MoETrainer - INFO - Bin boundaries: $365,000, $460,000, $630,000
2025-05-29 18:50:19,948 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:50:19,950 - MoETrainer - INFO -   Bin 0: Train= 900, Test=263, Range=$150,000 - $364,000, Mean=$299,697
2025-05-29 18:50:19,951 - MoETrainer - INFO -   Bin 1: Train= 896, Test=260, Range=$365,000 - $459,000, Mean=$408,482
2025-05-29 18:50:19,951 - MoETrainer - INFO -   Bin 2: Train= 907, Test=292, Range=$460,000 - $629,000, Mean=$535,681
2025-05-29 18:50:19,952 - MoETrainer - INFO -   Bin 3: Train= 902, Test=295, Range=$630,000 - $3,475,000, Mean=$956,164
2025-05-29 18:50:19,955 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:50:20,401 - MoETrainer - INFO -   Bin 0: Selected Ridge(a=10) (val_R^2=0.100)
2025-05-29 18:50:20,816 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=0.033)
2025-05-29 18:50:21,244 - MoETrainer - INFO -   Bin 2: Selected Ridge(a=10) (val_R^2=0.033)
2025-05-29 18:50:21,689 - MoETrainer - INFO -   Bin 3: Selected Ridge(a=10) (val_R^2=0.312)
2025-05-29 18:50:21,692 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:50:21,692 - MoETrainer - INFO -   Bin 0: RMSE=   41171, MAE=   33166, R^2= 0.1177 (263 samples)
2025-05-29 18:50:21,692 - MoETrainer - INFO -   Bin 1: RMSE=   27660, MAE=   23506, R^2=-0.0233 (260 samples)
2025-05-29 18:50:21,693 - MoETrainer - INFO -   Bin 2: RMSE=   45519, MAE=   38758, R^2= 0.0827 (292 samples)
2025-05-29 18:50:21,693 - MoETrainer - INFO -   Bin 3: RMSE=  363984, MAE=  212254, R^2= 0.2376 (295 samples)
2025-05-29 18:50:21,693 - MoETrainer - INFO - ANALYZING MoE WITH 5 BINS:
2025-05-29 18:50:21,694 - MoETrainer - INFO - Bin boundaries: $345,000, $420,000, $520,000, $691,000
2025-05-29 18:50:21,695 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:50:21,696 - MoETrainer - INFO -   Bin 0: Train= 702, Test=215, Range=$150,000 - $342,000, Mean=$285,272
2025-05-29 18:50:21,696 - MoETrainer - INFO -   Bin 1: Train= 735, Test=191, Range=$345,000 - $419,500, Mean=$378,130
2025-05-29 18:50:21,697 - MoETrainer - INFO -   Bin 2: Train= 725, Test=244, Range=$420,000 - $519,000, Mean=$463,044
2025-05-29 18:50:21,698 - MoETrainer - INFO -   Bin 3: Train= 722, Test=213, Range=$520,000 - $690,000, Mean=$591,883
2025-05-29 18:50:21,698 - MoETrainer - INFO -   Bin 4: Train= 721, Test=247, Range=$695,000 - $3,475,000, Mean=$1,030,259
2025-05-29 18:50:21,698 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:50:22,032 - MoETrainer - INFO -   Bin 0: Selected Ridge(a=10) (val_R^2=0.111)
2025-05-29 18:50:22,404 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=0.021)
2025-05-29 18:50:22,769 - MoETrainer - INFO -   Bin 2: Selected Ridge(a=100) (val_R^2=0.024)
2025-05-29 18:50:23,127 - MoETrainer - INFO -   Bin 3: Selected RandomForest (val_R^2=0.011)
2025-05-29 18:50:23,601 - MoETrainer - INFO -   Bin 4: Selected RandomForest (val_R^2=0.226)
2025-05-29 18:50:23,603 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:50:23,603 - MoETrainer - INFO -   Bin 0: RMSE=   38623, MAE=   31264, R^2= 0.0540 (215 samples)
2025-05-29 18:50:23,604 - MoETrainer - INFO -   Bin 1: RMSE=   22166, MAE=   19044, R^2=-0.0608 (191 samples)
2025-05-29 18:50:23,604 - MoETrainer - INFO -   Bin 2: RMSE=   27225, MAE=   24010, R^2= 0.0203 (244 samples)
2025-05-29 18:50:23,605 - MoETrainer - INFO -   Bin 3: RMSE=   47705, MAE=   40378, R^2= 0.0676 (213 samples)
2025-05-29 18:50:23,605 - MoETrainer - INFO -   Bin 4: RMSE=  404803, MAE=  245764, R^2= 0.1287 (247 samples)
2025-05-29 18:50:23,606 - MoETrainer - INFO - ANALYZING MoE WITH 6 BINS:
2025-05-29 18:50:23,607 - MoETrainer - INFO - Bin boundaries: $325,000, $391,000, $460,000, $565,000, $727,667
2025-05-29 18:50:23,608 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:50:23,609 - MoETrainer - INFO -   Bin 0: Train= 529, Test=161, Range=$150,000 - $324,500, Mean=$270,793
2025-05-29 18:50:23,609 - MoETrainer - INFO -   Bin 1: Train= 673, Test=169, Range=$325,000 - $390,000, Mean=$357,467
2025-05-29 18:50:23,610 - MoETrainer - INFO -   Bin 2: Train= 594, Test=193, Range=$393,000 - $459,000, Mean=$424,077
2025-05-29 18:50:23,611 - MoETrainer - INFO -   Bin 3: Train= 601, Test=211, Range=$460,000 - $560,000, Mean=$506,971
2025-05-29 18:50:23,611 - MoETrainer - INFO -   Bin 4: Train= 607, Test=173, Range=$565,000 - $727,000, Mean=$634,661
2025-05-29 18:50:23,614 - MoETrainer - INFO -   Bin 5: Train= 601, Test=203, Range=$729,000 - $3,475,000, Mean=$1,095,498
2025-05-29 18:50:23,614 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:50:23,894 - MoETrainer - INFO -   Bin 0: Selected Ridge(a=10) (val_R^2=0.078)
2025-05-29 18:50:24,259 - MoETrainer - INFO -   Bin 1: Selected Ridge(a=100) (val_R^2=-0.004)
2025-05-29 18:50:24,567 - MoETrainer - INFO -   Bin 2: Selected Ridge(a=100) (val_R^2=0.002)
2025-05-29 18:50:24,862 - MoETrainer - INFO -   Bin 3: Selected Ridge(a=100) (val_R^2=0.031)
2025-05-29 18:50:25,166 - MoETrainer - INFO -   Bin 4: Selected Ridge(a=10) (val_R^2=-0.014)
2025-05-29 18:50:25,490 - MoETrainer - INFO -   Bin 5: Selected Ridge(a=100) (val_R^2=0.158)
2025-05-29 18:50:25,493 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:50:25,493 - MoETrainer - INFO -   Bin 0: RMSE=   34655, MAE=   27937, R^2= 0.0672 (161 samples)
2025-05-29 18:50:25,493 - MoETrainer - INFO -   Bin 1: RMSE=   21465, MAE=   18804, R^2=-0.0201 (169 samples)
2025-05-29 18:50:25,494 - MoETrainer - INFO -   Bin 2: RMSE=   20417, MAE=   17421, R^2=-0.0065 (193 samples)
2025-05-29 18:50:25,494 - MoETrainer - INFO -   Bin 3: RMSE=   29133, MAE=   25216, R^2= 0.0066 (211 samples)
2025-05-29 18:50:25,494 - MoETrainer - INFO -   Bin 4: RMSE=   50592, MAE=   44054, R^2=-0.0503 (173 samples)
2025-05-29 18:50:25,494 - MoETrainer - INFO -   Bin 5: RMSE=  413778, MAE=  254760, R^2= 0.1628 (203 samples)
2025-05-29 18:50:25,495 - MoETrainer - INFO - MoE COMPARISON:
2025-05-29 18:50:25,495 - MoETrainer - INFO -   2 bins: RMSE=  226445, MAE=  115464, R^2= 0.5341
2025-05-29 18:50:25,495 - MoETrainer - INFO -   3 bins: RMSE=  205158, MAE=   94953, R^2= 0.6176
2025-05-29 18:50:25,496 - MoETrainer - INFO -   4 bins: RMSE=  190619, MAE=   79970, R^2= 0.6699
2025-05-29 18:50:25,496 - MoETrainer - INFO -   5 bins: RMSE=  193486, MAE=   77047, R^2= 0.6599
2025-05-29 18:50:25,497 - MoETrainer - INFO -   6 bins: RMSE=  179413, MAE=   68195, R^2= 0.7076 [BEST]
2025-05-29 18:50:25,499 - MoETrainer - INFO - === FINAL MODEL SELECTION ===
2025-05-29 18:50:25,500 - MoETrainer - INFO - FINAL COMPARISON (ranked by R^2):
2025-05-29 18:50:25,503 - MoETrainer - INFO -   [MoE] moe_6_bins          : RMSE=  179413, MAE=   68195, R^2= 0.7076 [WINNER]
2025-05-29 18:50:25,503 - MoETrainer - INFO -   [BASE] ensemble            : RMSE=  232989, MAE=  134808, R^2= 0.5068
2025-05-29 18:50:25,504 - MoETrainer - INFO -   [BASE] ridge               : RMSE=  234367, MAE=  136233, R^2= 0.5010
2025-05-29 18:50:25,504 - MoETrainer - INFO -   [BASE] random_forest       : RMSE=  237346, MAE=  136969, R^2= 0.4882
2025-05-29 18:50:25,504 - MoETrainer - INFO - WINNING MoE DETAILS:
2025-05-29 18:50:25,504 - MoETrainer - INFO -   Number of bins: 6
2025-05-29 18:50:25,505 - MoETrainer - INFO -   Bin 0: Ridge(a=10)
2025-05-29 18:50:25,505 - MoETrainer - INFO -   Bin 1: Ridge(a=100)
2025-05-29 18:50:25,505 - MoETrainer - INFO -   Bin 2: Ridge(a=100)
2025-05-29 18:50:25,505 - MoETrainer - INFO -   Bin 3: Ridge(a=100)
2025-05-29 18:50:25,506 - MoETrainer - INFO -   Bin 4: Ridge(a=10)
2025-05-29 18:50:25,506 - MoETrainer - INFO -   Bin 5: Ridge(a=100)
2025-05-29 18:50:25,514 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 18:50:25,516 - MoETrainer - INFO - Overall Performance:
2025-05-29 18:50:25,516 - MoETrainer - INFO -   RMSE: 179412.5730
2025-05-29 18:50:25,516 - MoETrainer - INFO -   MAE: 68195.0954
2025-05-29 18:50:25,517 - MoETrainer - INFO -   RÂ²: 0.7076
2025-05-29 18:50:25,517 - MoETrainer - INFO -   MAPE: 9.14%
2025-05-29 18:51:37,867 - MoETrainer - INFO - Starting DETAILED IMPROVED MoE Training Pipeline
2025-05-29 18:51:37,867 - MoETrainer - INFO - Loading data...
2025-05-29 18:51:38,757 - MoETrainer - INFO - Consolidating 744 features...
2025-05-29 18:51:41,691 - MoETrainer - INFO - Consolidated to 14 features
2025-05-29 18:51:41,709 - MoETrainer - INFO - Loaded dataset: 5555 samples, 14 features
2025-05-29 18:51:41,710 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 18:51:41,710 - MoETrainer - INFO - Preprocessing data...
2025-05-29 18:51:41,712 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 18:51:41,723 - MoETrainer - INFO - Applied robust scaling
2025-05-29 18:51:41,725 - MoETrainer - INFO - Splitting data...
2025-05-29 18:51:41,728 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 18:51:41,728 - MoETrainer - INFO - === Training Baseline Models ===
2025-05-29 18:51:42,399 - MoETrainer - INFO - BASELINE RESULTS:
2025-05-29 18:51:42,399 - MoETrainer - INFO -   RIDGE          : RMSE=  193206, MAE=  130890, R^2= 0.5114
2025-05-29 18:51:42,400 - MoETrainer - INFO -   RANDOM_FOREST  : RMSE=  178453, MAE=  120523, R^2= 0.5832
2025-05-29 18:51:42,400 - MoETrainer - INFO -   ENSEMBLE       : RMSE=  179655, MAE=  121133, R^2= 0.5776
2025-05-29 18:51:42,400 - MoETrainer - INFO - === Training DETAILED MoE ===
2025-05-29 18:51:42,401 - MoETrainer - INFO - ANALYZING MoE WITH 2 BINS:
2025-05-29 18:51:42,402 - MoETrainer - INFO - Bin boundaries: $465,000
2025-05-29 18:51:42,402 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:51:42,403 - MoETrainer - INFO -   Bin 0: Train=1784, Test=553, Range=$150,000 - $462,500, Mean=$354,850
2025-05-29 18:51:42,403 - MoETrainer - INFO -   Bin 1: Train=1792, Test=548, Range=$465,000 - $1,995,000, Mean=$714,145
2025-05-29 18:51:42,404 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:51:42,800 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R^2=0.266)
2025-05-29 18:51:43,185 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=0.342)
2025-05-29 18:51:43,187 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:51:43,188 - MoETrainer - INFO -   Bin 0: RMSE=   61770, MAE=   49921, R^2= 0.2322 (553 samples)
2025-05-29 18:51:43,188 - MoETrainer - INFO -   Bin 1: RMSE=  213660, MAE=  146115, R^2= 0.4087 (548 samples)
2025-05-29 18:51:43,189 - MoETrainer - INFO - ANALYZING MoE WITH 3 BINS:
2025-05-29 18:51:43,191 - MoETrainer - INFO - Bin boundaries: $395,000, $560,000
2025-05-29 18:51:43,191 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:51:43,192 - MoETrainer - INFO -   Bin 0: Train=1169, Test=373, Range=$150,000 - $391,000, Mean=$318,531
2025-05-29 18:51:43,192 - MoETrainer - INFO -   Bin 1: Train=1214, Test=359, Range=$395,000 - $559,000, Mean=$465,799
2025-05-29 18:51:43,193 - MoETrainer - INFO -   Bin 2: Train=1193, Test=369, Range=$560,000 - $1,995,000, Mean=$817,232
2025-05-29 18:51:43,193 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:51:43,479 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R^2=0.158)
2025-05-29 18:51:43,773 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=0.095)
2025-05-29 18:51:44,070 - MoETrainer - INFO -   Bin 2: Selected RandomForest (val_R^2=0.310)
2025-05-29 18:51:44,072 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:51:44,072 - MoETrainer - INFO -   Bin 0: RMSE=   51546, MAE=   42502, R^2= 0.1557 (373 samples)
2025-05-29 18:51:44,072 - MoETrainer - INFO -   Bin 1: RMSE=   44928, MAE=   37917, R^2= 0.0792 (359 samples)
2025-05-29 18:51:44,073 - MoETrainer - INFO -   Bin 2: RMSE=  240724, MAE=  170247, R^2= 0.2625 (369 samples)
2025-05-29 18:51:44,073 - MoETrainer - INFO - ANALYZING MoE WITH 4 BINS:
2025-05-29 18:51:44,075 - MoETrainer - INFO - Bin boundaries: $360,000, $465,000, $625,000
2025-05-29 18:51:44,075 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:51:44,077 - MoETrainer - INFO -   Bin 0: Train= 886, Test=272, Range=$150,000 - $359,500, Mean=$299,946
2025-05-29 18:51:44,079 - MoETrainer - INFO -   Bin 1: Train= 898, Test=281, Range=$360,000 - $462,500, Mean=$409,021
2025-05-29 18:51:44,080 - MoETrainer - INFO -   Bin 2: Train= 875, Test=253, Range=$465,000 - $624,500, Mean=$533,712
2025-05-29 18:51:44,082 - MoETrainer - INFO -   Bin 3: Train= 917, Test=295, Range=$625,000 - $1,995,000, Mean=$886,313
2025-05-29 18:51:44,083 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:51:44,331 - MoETrainer - INFO -   Bin 0: Selected RandomForest (val_R^2=0.173)
2025-05-29 18:51:44,573 - MoETrainer - INFO -   Bin 1: Selected Ridge(a=10) (val_R^2=0.085)
2025-05-29 18:51:44,813 - MoETrainer - INFO -   Bin 2: Selected Ridge(a=100) (val_R^2=0.040)
2025-05-29 18:51:45,063 - MoETrainer - INFO -   Bin 3: Selected Ridge(a=100) (val_R^2=0.171)
2025-05-29 18:51:45,064 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:51:45,064 - MoETrainer - INFO -   Bin 0: RMSE=   44373, MAE=   35240, R^2= 0.1253 (272 samples)
2025-05-29 18:51:45,065 - MoETrainer - INFO -   Bin 1: RMSE=   28153, MAE=   24575, R^2= 0.0432 (281 samples)
2025-05-29 18:51:45,065 - MoETrainer - INFO -   Bin 2: RMSE=   42908, MAE=   37903, R^2= 0.0553 (253 samples)
2025-05-29 18:51:45,066 - MoETrainer - INFO -   Bin 3: RMSE=  245249, MAE=  179913, R^2= 0.2332 (295 samples)
2025-05-29 18:51:45,067 - MoETrainer - INFO - ANALYZING MoE WITH 5 BINS:
2025-05-29 18:51:45,068 - MoETrainer - INFO - Bin boundaries: $345,000, $420,000, $525,000, $685,000
2025-05-29 18:51:45,068 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:51:45,069 - MoETrainer - INFO -   Bin 0: Train= 701, Test=223, Range=$150,000 - $342,000, Mean=$286,706
2025-05-29 18:51:45,071 - MoETrainer - INFO -   Bin 1: Train= 722, Test=215, Range=$345,000 - $419,500, Mean=$378,745
2025-05-29 18:51:45,071 - MoETrainer - INFO -   Bin 2: Train= 721, Test=233, Range=$420,000 - $524,950, Mean=$463,905
2025-05-29 18:51:45,075 - MoETrainer - INFO -   Bin 3: Train= 708, Test=201, Range=$525,000 - $679,000, Mean=$588,588
2025-05-29 18:51:45,077 - MoETrainer - INFO -   Bin 4: Train= 724, Test=229, Range=$685,000 - $1,995,000, Mean=$949,129
2025-05-29 18:51:45,078 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:51:45,296 - MoETrainer - INFO -   Bin 0: Selected Ridge(a=10) (val_R^2=0.086)
2025-05-29 18:51:45,524 - MoETrainer - INFO -   Bin 1: Selected RandomForest (val_R^2=-0.004)
2025-05-29 18:51:45,750 - MoETrainer - INFO -   Bin 2: Selected RandomForest (val_R^2=-0.022)
2025-05-29 18:51:45,964 - MoETrainer - INFO -   Bin 3: Selected Ridge(a=100) (val_R^2=0.010)
2025-05-29 18:51:46,193 - MoETrainer - INFO -   Bin 4: Selected RandomForest (val_R^2=0.185)
2025-05-29 18:51:46,195 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:51:46,195 - MoETrainer - INFO -   Bin 0: RMSE=   41037, MAE=   33017, R^2= 0.0767 (223 samples)
2025-05-29 18:51:46,195 - MoETrainer - INFO -   Bin 1: RMSE=   20123, MAE=   16624, R^2=-0.0164 (215 samples)
2025-05-29 18:51:46,196 - MoETrainer - INFO -   Bin 2: RMSE=   28353, MAE=   23964, R^2=-0.1044 (233 samples)
2025-05-29 18:51:46,196 - MoETrainer - INFO -   Bin 3: RMSE=   46001, MAE=   38889, R^2= 0.0307 (201 samples)
2025-05-29 18:51:46,196 - MoETrainer - INFO -   Bin 4: RMSE=  252784, MAE=  183212, R^2= 0.1814 (229 samples)
2025-05-29 18:51:46,197 - MoETrainer - INFO - ANALYZING MoE WITH 6 BINS:
2025-05-29 18:51:46,198 - MoETrainer - INFO - Bin boundaries: $325,000, $395,000, $465,000, $560,000, $725,000
2025-05-29 18:51:46,198 - MoETrainer - INFO - Bin distribution:
2025-05-29 18:51:46,199 - MoETrainer - INFO -   Bin 0: Train= 531, Test=178, Range=$150,000 - $324,500, Mean=$273,095
2025-05-29 18:51:46,200 - MoETrainer - INFO -   Bin 1: Train= 638, Test=195, Range=$325,000 - $391,000, Mean=$356,346
2025-05-29 18:51:46,201 - MoETrainer - INFO -   Bin 2: Train= 615, Test=180, Range=$395,000 - $462,500, Mean=$423,888
2025-05-29 18:51:46,201 - MoETrainer - INFO -   Bin 3: Train= 599, Test=179, Range=$465,000 - $559,000, Mean=$508,830
2025-05-29 18:51:46,202 - MoETrainer - INFO -   Bin 4: Train= 596, Test=172, Range=$560,000 - $719,000, Mean=$631,203
2025-05-29 18:51:46,203 - MoETrainer - INFO -   Bin 5: Train= 597, Test=197, Range=$725,000 - $1,995,000, Mean=$1,002,950
2025-05-29 18:51:46,203 - MoETrainer - INFO - Training experts for each bin:
2025-05-29 18:51:46,407 - MoETrainer - INFO -   Bin 0: Selected Ridge(a=100) (val_R^2=0.042)
2025-05-29 18:51:46,620 - MoETrainer - INFO -   Bin 1: Selected Ridge(a=100) (val_R^2=-0.043)
2025-05-29 18:51:46,813 - MoETrainer - INFO -   Bin 2: Selected Ridge(a=10) (val_R^2=0.062)
2025-05-29 18:51:47,008 - MoETrainer - INFO -   Bin 3: Selected Ridge(a=100) (val_R^2=-0.013)
2025-05-29 18:51:47,204 - MoETrainer - INFO -   Bin 4: Selected Ridge(a=100) (val_R^2=-0.024)
2025-05-29 18:51:47,406 - MoETrainer - INFO -   Bin 5: Selected Ridge(a=10) (val_R^2=0.256)
2025-05-29 18:51:47,408 - MoETrainer - INFO - Per-bin performance:
2025-05-29 18:51:47,409 - MoETrainer - INFO -   Bin 0: RMSE=   37524, MAE=   29322, R^2= 0.0346 (178 samples)
2025-05-29 18:51:47,409 - MoETrainer - INFO -   Bin 1: RMSE=   21623, MAE=   19025, R^2=-0.0202 (195 samples)
2025-05-29 18:51:47,411 - MoETrainer - INFO -   Bin 2: RMSE=   21054, MAE=   18353, R^2=-0.0100 (180 samples)
2025-05-29 18:51:47,418 - MoETrainer - INFO -   Bin 3: RMSE=   28050, MAE=   24921, R^2= 0.0190 (179 samples)
2025-05-29 18:51:47,419 - MoETrainer - INFO -   Bin 4: RMSE=   45665, MAE=   40610, R^2=-0.0003 (172 samples)
2025-05-29 18:51:47,420 - MoETrainer - INFO -   Bin 5: RMSE=  255486, MAE=  191659, R^2= 0.1467 (197 samples)
2025-05-29 18:51:47,421 - MoETrainer - INFO - MoE COMPARISON:
2025-05-29 18:51:47,422 - MoETrainer - INFO -   2 bins: RMSE=  156965, MAE=   97799, R^2= 0.6775
2025-05-29 18:51:47,422 - MoETrainer - INFO -   3 bins: RMSE=  144843, MAE=   83821, R^2= 0.7254
2025-05-29 18:51:47,423 - MoETrainer - INFO -   4 bins: RMSE=  131254, MAE=   71893, R^2= 0.7745
2025-05-29 18:51:47,423 - MoETrainer - INFO -   5 bins: RMSE=  119446, MAE=   60211, R^2= 0.8133
2025-05-29 18:51:47,424 - MoETrainer - INFO -   6 bins: RMSE=  111874, MAE=   55800, R^2= 0.8362 [BEST]
2025-05-29 18:51:47,425 - MoETrainer - INFO - === FINAL MODEL SELECTION ===
2025-05-29 18:51:47,425 - MoETrainer - INFO - FINAL COMPARISON (ranked by R^2):
2025-05-29 18:51:47,425 - MoETrainer - INFO -   [MoE] moe_6_bins          : RMSE=  111874, MAE=   55800, R^2= 0.8362 [WINNER]
2025-05-29 18:51:47,426 - MoETrainer - INFO -   [BASE] random_forest       : RMSE=  178453, MAE=  120523, R^2= 0.5832
2025-05-29 18:51:47,426 - MoETrainer - INFO -   [BASE] ensemble            : RMSE=  179655, MAE=  121133, R^2= 0.5776
2025-05-29 18:51:47,427 - MoETrainer - INFO -   [BASE] ridge               : RMSE=  193206, MAE=  130890, R^2= 0.5114
2025-05-29 18:51:47,433 - MoETrainer - INFO - WINNING MoE DETAILS:
2025-05-29 18:51:47,434 - MoETrainer - INFO -   Number of bins: 6
2025-05-29 18:51:47,434 - MoETrainer - INFO -   Bin 0: Ridge(a=100)
2025-05-29 18:51:47,435 - MoETrainer - INFO -   Bin 1: Ridge(a=100)
2025-05-29 18:51:47,435 - MoETrainer - INFO -   Bin 2: Ridge(a=10)
2025-05-29 18:51:47,435 - MoETrainer - INFO -   Bin 3: Ridge(a=100)
2025-05-29 18:51:47,435 - MoETrainer - INFO -   Bin 4: Ridge(a=100)
2025-05-29 18:51:47,436 - MoETrainer - INFO -   Bin 5: Ridge(a=10)
2025-05-29 18:51:47,439 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 18:51:47,439 - MoETrainer - INFO - Overall Performance:
2025-05-29 18:51:47,440 - MoETrainer - INFO -   RMSE: 111873.9690
2025-05-29 18:51:47,440 - MoETrainer - INFO -   MAE: 55799.6659
2025-05-29 18:51:47,441 - MoETrainer - INFO -   RÂ²: 0.8362
2025-05-29 18:51:47,441 - MoETrainer - INFO -   MAPE: 8.75%
2025-05-29 19:26:19,238 - MoETrainer - INFO - === COMPREHENSIVE COMPARISON STARTING ===
2025-05-29 19:26:19,240 - MoETrainer - INFO - 
=== TESTING ORIGINAL DATA MANAGER ===
2025-05-29 19:26:19,241 - MoETrainer - INFO - Loading data...
2025-05-29 19:26:21,418 - MoETrainer - INFO - Consolidating 744 features...
2025-05-29 19:26:24,401 - MoETrainer - INFO - Consolidated to 14 features
2025-05-29 19:26:24,417 - MoETrainer - INFO - Loaded dataset: 5555 samples, 14 features
2025-05-29 19:26:24,418 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 19:26:24,419 - MoETrainer - INFO - Preprocessing data...
2025-05-29 19:26:24,423 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 19:26:24,443 - MoETrainer - INFO - Applied robust scaling
2025-05-29 19:26:24,443 - MoETrainer - INFO - Splitting data...
2025-05-29 19:26:24,449 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 19:26:24,451 - MoETrainer - INFO - Testing baseline models...
2025-05-29 19:26:25,185 - MoETrainer - INFO -   ridge: RMSE=193206, MAE=130890, RÂ²=0.5114
2025-05-29 19:26:25,186 - MoETrainer - INFO -   random_forest: RMSE=178216, MAE=119943, RÂ²=0.5843
2025-05-29 19:26:25,186 - MoETrainer - INFO -   ensemble: RMSE=179520, MAE=120650, RÂ²=0.5782
2025-05-29 19:26:25,186 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 19:26:25,189 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:26:25,586 - MoETrainer - INFO - Bin 0: Selected lgb_simple (1169 samples)
2025-05-29 19:26:25,855 - MoETrainer - INFO - Bin 1: Selected lgb_simple (1214 samples)
2025-05-29 19:26:26,166 - MoETrainer - INFO - Bin 2: Selected lgb_simple (1193 samples)
2025-05-29 19:26:26,167 - MoETrainer - INFO - Training expert models...
2025-05-29 19:26:26,205 - MoETrainer - INFO - Trained expert for bin 0: 1169 samples
2025-05-29 19:26:26,228 - MoETrainer - INFO - Trained expert for bin 1: 1214 samples
2025-05-29 19:26:26,256 - MoETrainer - INFO - Trained expert for bin 2: 1193 samples
2025-05-29 19:26:26,267 - MoETrainer - INFO -   original MoE 3 bins: RMSE=288012, MAE=253189, RÂ²=-0.0857
2025-05-29 19:26:26,269 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:26:26,495 - MoETrainer - INFO - Bin 0: Selected lgb_simple (886 samples)
2025-05-29 19:26:26,711 - MoETrainer - INFO - Bin 1: Selected ridge_light (898 samples)
2025-05-29 19:26:26,933 - MoETrainer - INFO - Bin 2: Selected rf_simple (875 samples)
2025-05-29 19:26:27,145 - MoETrainer - INFO - Bin 3: Selected rf_simple (917 samples)
2025-05-29 19:26:27,146 - MoETrainer - INFO - Training expert models...
2025-05-29 19:26:27,169 - MoETrainer - INFO - Trained expert for bin 0: 886 samples
2025-05-29 19:26:27,171 - MoETrainer - INFO - Trained expert for bin 1: 898 samples
2025-05-29 19:26:27,369 - MoETrainer - INFO - Trained expert for bin 2: 875 samples
2025-05-29 19:26:27,574 - MoETrainer - INFO - Trained expert for bin 3: 917 samples
2025-05-29 19:26:27,592 - MoETrainer - INFO -   original MoE 4 bins: RMSE=171755, MAE=114402, RÂ²=0.6139
2025-05-29 19:26:27,595 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:26:27,785 - MoETrainer - INFO - Bin 0: Selected rf_simple (701 samples)
2025-05-29 19:26:27,982 - MoETrainer - INFO - Bin 1: Selected rf_simple (722 samples)
2025-05-29 19:26:28,187 - MoETrainer - INFO - Bin 2: Selected lgb_simple (721 samples)
2025-05-29 19:26:28,397 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (708 samples)
2025-05-29 19:26:28,603 - MoETrainer - INFO - Bin 4: Selected rf_simple (724 samples)
2025-05-29 19:26:28,604 - MoETrainer - INFO - Training expert models...
2025-05-29 19:26:28,785 - MoETrainer - INFO - Trained expert for bin 0: 701 samples
2025-05-29 19:26:28,966 - MoETrainer - INFO - Trained expert for bin 1: 722 samples
2025-05-29 19:26:28,988 - MoETrainer - INFO - Trained expert for bin 2: 721 samples
2025-05-29 19:26:28,992 - MoETrainer - INFO - Trained expert for bin 3: 708 samples
2025-05-29 19:26:29,170 - MoETrainer - INFO - Trained expert for bin 4: 724 samples
2025-05-29 19:26:29,196 - MoETrainer - INFO -   original MoE 5 bins: RMSE=309713, MAE=229024, RÂ²=-0.2554
2025-05-29 19:26:29,198 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:26:29,367 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 19:26:29,556 - MoETrainer - INFO - Bin 1: Selected lgb_simple (638 samples)
2025-05-29 19:26:29,747 - MoETrainer - INFO - Bin 2: Selected lgb_simple (615 samples)
2025-05-29 19:26:29,924 - MoETrainer - INFO - Bin 3: Selected ridge_light (599 samples)
2025-05-29 19:26:30,109 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 19:26:30,288 - MoETrainer - INFO - Bin 5: Selected ridge_heavy (597 samples)
2025-05-29 19:26:30,288 - MoETrainer - INFO - Training expert models...
2025-05-29 19:26:30,291 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 19:26:30,304 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 19:26:30,327 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 19:26:30,329 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 19:26:30,331 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 19:26:30,337 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 19:26:30,358 - MoETrainer - INFO -   original MoE 6 bins: RMSE=184730, MAE=116771, RÂ²=0.5534
2025-05-29 19:26:30,359 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 19:26:30,360 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:26:30,361 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:26:30,361 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:26:42,494 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:26:42,495 - MoETrainer - INFO -   1. xgb_balanced: MSE=2058559616Â±82129151, RÂ²=0.862 [SELECTED]
2025-05-29 19:26:42,495 - MoETrainer - INFO -   2. xgb_conservative: MSE=2088451285Â±72251646, RÂ²=0.340
2025-05-29 19:26:42,495 - MoETrainer - INFO -   3. lgb_conservative: MSE=2090972137Â±85906262, RÂ²=0.322
2025-05-29 19:26:55,563 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:26:55,564 - MoETrainer - INFO -   1. xgb_conservative: MSE=2066493141Â±60668199, RÂ²=0.329 [SELECTED]
2025-05-29 19:26:55,564 - MoETrainer - INFO -   2. rf_deep: MSE=2095703831Â±62700386, RÂ²=0.853
2025-05-29 19:26:55,564 - MoETrainer - INFO -   3. rf_medium: MSE=2096549599Â±68682261, RÂ²=0.667
2025-05-29 19:27:08,295 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:27:08,295 - MoETrainer - INFO -   1. lgb_conservative: MSE=53931435251Â±6410677087, RÂ²=0.461 [SELECTED]
2025-05-29 19:27:08,295 - MoETrainer - INFO -   2. xgb_conservative: MSE=54085068117Â±6608257121, RÂ²=0.524
2025-05-29 19:27:08,295 - MoETrainer - INFO -   3. ridge_heavy: MSE=54107536043Â±7943198396, RÂ²=0.302
2025-05-29 19:27:08,296 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:27:08,444 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 0: 1169 samples
2025-05-29 19:27:08,505 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-29 19:27:08,570 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-29 19:27:08,570 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 19:27:08,579 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=142672, MAE=82343, RÂ²=0.7336
2025-05-29 19:27:08,582 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:27:08,583 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:27:08,585 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:27:18,321 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:27:18,323 - MoETrainer - INFO -   1. xgb_conservative: MSE=1549621632Â±83842181, RÂ²=0.357 [SELECTED]
2025-05-29 19:27:18,324 - MoETrainer - INFO -   2. lgb_conservative: MSE=1551655785Â±74369979, RÂ²=0.312
2025-05-29 19:27:18,324 - MoETrainer - INFO -   3. rf_shallow: MSE=1569883295Â±94654736, RÂ²=0.310
2025-05-29 19:27:26,833 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:27:26,834 - MoETrainer - INFO -   1. ridge_medium: MSE=754990208Â±35139861, RÂ²=0.082 [SELECTED]
2025-05-29 19:27:26,834 - MoETrainer - INFO -   2. ridge_light: MSE=757644544Â±32530636, RÂ²=0.083
2025-05-29 19:27:26,835 - MoETrainer - INFO -   3. xgb_conservative: MSE=757818795Â±37350601, RÂ²=0.304
2025-05-29 19:27:35,282 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:27:35,283 - MoETrainer - INFO -   1. rf_shallow: MSE=1858068346Â±57729927, RÂ²=0.284 [SELECTED]
2025-05-29 19:27:35,283 - MoETrainer - INFO -   2. elastic_light: MSE=1874041344Â±26855585, RÂ²=0.049
2025-05-29 19:27:35,284 - MoETrainer - INFO -   3. rf_medium: MSE=1876526331Â±54958405, RÂ²=0.672
2025-05-29 19:27:45,492 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:27:45,494 - MoETrainer - INFO -   1. ridge_heavy: MSE=59398023851Â±5205668744, RÂ²=0.258 [SELECTED]
2025-05-29 19:27:45,494 - MoETrainer - INFO -   2. ridge_medium: MSE=59982476629Â±5363536201, RÂ²=0.260
2025-05-29 19:27:45,495 - MoETrainer - INFO -   3. rf_shallow: MSE=60135681679Â±5711732491, RÂ²=0.468
2025-05-29 19:27:45,497 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:27:45,559 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 886 samples
2025-05-29 19:27:45,564 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 898 samples
2025-05-29 19:27:45,806 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-29 19:27:45,809 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-29 19:27:45,810 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 19:27:45,824 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=131649, MAE=71051, RÂ²=0.7732
2025-05-29 19:27:45,827 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:27:45,828 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:27:45,829 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:27:55,290 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:27:55,290 - MoETrainer - INFO -   1. xgb_conservative: MSE=1284921941Â±101313868, RÂ²=0.353 [SELECTED]
2025-05-29 19:27:55,291 - MoETrainer - INFO -   2. lgb_conservative: MSE=1329147616Â±99984214, RÂ²=0.302
2025-05-29 19:27:55,291 - MoETrainer - INFO -   3. ridge_medium: MSE=1338779861Â±123653993, RÂ²=0.102
2025-05-29 19:28:04,107 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:28:04,108 - MoETrainer - INFO -   1. xgb_conservative: MSE=446374816Â±11587478, RÂ²=0.278 [SELECTED]
2025-05-29 19:28:04,108 - MoETrainer - INFO -   2. rf_shallow: MSE=450057760Â±16128974, RÂ²=0.241
2025-05-29 19:28:04,109 - MoETrainer - INFO -   3. elastic_balanced: MSE=451225664Â±17020293, RÂ²=0.003
2025-05-29 19:28:12,875 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:28:12,875 - MoETrainer - INFO -   1. lgb_conservative: MSE=712016623Â±28936841, RÂ²=0.318 [SELECTED]
2025-05-29 19:28:12,875 - MoETrainer - INFO -   2. xgb_conservative: MSE=723329280Â±28819446, RÂ²=0.347
2025-05-29 19:28:12,876 - MoETrainer - INFO -   3. rf_shallow: MSE=726160388Â±28832637, RÂ²=0.314
2025-05-29 19:28:20,850 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:28:20,851 - MoETrainer - INFO -   1. ridge_heavy: MSE=2018579285Â±144096076, RÂ²=0.062 [SELECTED]
2025-05-29 19:28:20,851 - MoETrainer - INFO -   2. elastic_light: MSE=2028669781Â±136224539, RÂ²=0.046
2025-05-29 19:28:20,852 - MoETrainer - INFO -   3. ridge_medium: MSE=2029319936Â±152828704, RÂ²=0.066
2025-05-29 19:28:29,876 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 19:28:29,877 - MoETrainer - INFO -   1. ridge_heavy: MSE=63511659861Â±8540214028, RÂ²=0.235 [SELECTED]
2025-05-29 19:28:29,877 - MoETrainer - INFO -   2. elastic_light: MSE=63804781909Â±9534077785, RÂ²=0.213
2025-05-29 19:28:29,877 - MoETrainer - INFO -   3. rf_shallow: MSE=64699364743Â±9773351996, RÂ²=0.458
2025-05-29 19:28:29,878 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:28:29,937 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-29 19:28:29,991 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 722 samples
2025-05-29 19:28:30,039 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-29 19:28:30,043 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-29 19:28:30,047 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 4: 724 samples
2025-05-29 19:28:30,048 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 19:28:30,062 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=171615, MAE=114838, RÂ²=0.6145
2025-05-29 19:28:30,063 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:28:30,064 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:28:30,064 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:29:03,832 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:29:03,833 - MoETrainer - INFO -   1. xgb_conservative: MSE=1087529685Â±86894409, RÂ²=0.355 [SELECTED]
2025-05-29 19:29:03,833 - MoETrainer - INFO -   2. ridge_heavy: MSE=1093859968Â±77828581, RÂ²=0.061
2025-05-29 19:29:03,834 - MoETrainer - INFO -   3. elastic_light: MSE=1097394304Â±70532203, RÂ²=0.043
2025-05-29 19:29:13,121 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:29:13,127 - MoETrainer - INFO -   1. elastic_heavy: MSE=435418965Â±13275293, RÂ²=0.001 [SELECTED]
2025-05-29 19:29:13,128 - MoETrainer - INFO -   2. elastic_balanced: MSE=436443029Â±13796451, RÂ²=0.003
2025-05-29 19:29:13,128 - MoETrainer - INFO -   3. elastic_light: MSE=441677419Â±15420827, RÂ²=0.011
2025-05-29 19:29:23,522 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:29:23,523 - MoETrainer - INFO -   1. ridge_medium: MSE=431439029Â±3018208, RÂ²=0.061 [SELECTED]
2025-05-29 19:29:23,523 - MoETrainer - INFO -   2. ridge_light: MSE=432326997Â±2486587, RÂ²=0.062
2025-05-29 19:29:23,524 - MoETrainer - INFO -   3. ridge_heavy: MSE=433374848Â±7439997, RÂ²=0.051
2025-05-29 19:29:31,543 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:29:31,543 - MoETrainer - INFO -   1. elastic_light: MSE=784278997Â±45644650, RÂ²=0.027 [SELECTED]
2025-05-29 19:29:31,544 - MoETrainer - INFO -   2. elastic_balanced: MSE=786378411Â±39068722, RÂ²=0.012
2025-05-29 19:29:31,544 - MoETrainer - INFO -   3. ridge_heavy: MSE=786602773Â±46870960, RÂ²=0.036
2025-05-29 19:29:40,441 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 19:29:40,443 - MoETrainer - INFO -   1. elastic_light: MSE=2074215467Â±81302535, RÂ²=0.045 [SELECTED]
2025-05-29 19:29:40,444 - MoETrainer - INFO -   2. elastic_balanced: MSE=2079837440Â±66135871, RÂ²=0.024
2025-05-29 19:29:40,444 - MoETrainer - INFO -   3. ridge_heavy: MSE=2081931947Â±79938999, RÂ²=0.057
2025-05-29 19:29:48,190 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 19:29:48,190 - MoETrainer - INFO -   1. ridge_heavy: MSE=65000153088Â±7725335925, RÂ²=0.228 [SELECTED]
2025-05-29 19:29:48,190 - MoETrainer - INFO -   2. elastic_light: MSE=65602710187Â±7270107820, RÂ²=0.207
2025-05-29 19:29:48,191 - MoETrainer - INFO -   3. ridge_medium: MSE=65991779669Â±7708135335, RÂ²=0.232
2025-05-29 19:29:48,191 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:29:48,281 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 531 samples
2025-05-29 19:29:48,286 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-29 19:29:48,289 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-05-29 19:29:48,295 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-29 19:29:48,303 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-29 19:29:48,305 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 5: 597 samples
2025-05-29 19:29:48,305 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 19:29:48,324 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=122225, MAE=71623, RÂ²=0.8045
2025-05-29 19:29:48,327 - MoETrainer - INFO - 
=== TESTING IMPROVED DATA MANAGER ===
2025-05-29 19:29:48,327 - MoETrainer - INFO - Loading data with improved processing...
2025-05-29 19:29:49,303 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 19:29:49,506 - MoETrainer - INFO - Feature types: 8 numeric, 736 binary, 0 categorical
2025-05-29 19:29:53,105 - MoETrainer - INFO - Processed features: 23 (from 744 original)
2025-05-29 19:29:53,106 - MoETrainer - INFO - Loaded dataset: 5555 samples, 23 features
2025-05-29 19:29:53,107 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 19:29:53,108 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 19:29:53,108 - MoETrainer - INFO - Preprocessing data with feature selection...
2025-05-29 19:29:53,111 - MoETrainer - INFO - Removed 7 outliers (0.1%)
2025-05-29 19:29:53,124 - MoETrainer - INFO - Selected 20 features from 23
2025-05-29 19:29:53,146 - MoETrainer - INFO - Applied robust scaling
2025-05-29 19:29:53,152 - MoETrainer - INFO - Splitting data...
2025-05-29 19:29:53,158 - MoETrainer - INFO - Data split - Train: 3605, Val: 833, Test: 1110
2025-05-29 19:29:53,162 - MoETrainer - INFO - Train target: mean=$550,360, std=$320,917
2025-05-29 19:29:53,165 - MoETrainer - INFO - Test target: mean=$560,582, std=$331,767
2025-05-29 19:29:53,174 - MoETrainer - INFO - Testing baseline models...
2025-05-29 19:29:54,718 - MoETrainer - INFO -   ridge: RMSE=234367, MAE=136233, RÂ²=0.5010
2025-05-29 19:29:54,718 - MoETrainer - INFO -   random_forest: RMSE=236962, MAE=137278, RÂ²=0.4899
2025-05-29 19:29:54,719 - MoETrainer - INFO -   ensemble: RMSE=232629, MAE=135005, RÂ²=0.5083
2025-05-29 19:29:54,719 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 19:29:54,720 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:29:55,167 - MoETrainer - INFO - Bin 0: Selected rf_simple (1202 samples)
2025-05-29 19:29:55,793 - MoETrainer - INFO - Bin 1: Selected rf_simple (1195 samples)
2025-05-29 19:29:56,376 - MoETrainer - INFO - Bin 2: Selected lgb_simple (1208 samples)
2025-05-29 19:29:56,376 - MoETrainer - INFO - Training expert models...
2025-05-29 19:29:56,881 - MoETrainer - INFO - Trained expert for bin 0: 1202 samples
2025-05-29 19:29:57,361 - MoETrainer - INFO - Trained expert for bin 1: 1195 samples
2025-05-29 19:29:57,384 - MoETrainer - INFO - Trained expert for bin 2: 1208 samples
2025-05-29 19:29:57,416 - MoETrainer - INFO -   original MoE 3 bins: RMSE=220152, MAE=123632, RÂ²=0.5597
2025-05-29 19:29:57,419 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:29:57,763 - MoETrainer - INFO - Bin 0: Selected lgb_simple (900 samples)
2025-05-29 19:29:58,253 - MoETrainer - INFO - Bin 1: Selected elastic_net (896 samples)
2025-05-29 19:29:58,740 - MoETrainer - INFO - Bin 2: Selected rf_simple (907 samples)
2025-05-29 19:29:59,188 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (902 samples)
2025-05-29 19:29:59,189 - MoETrainer - INFO - Training expert models...
2025-05-29 19:29:59,227 - MoETrainer - INFO - Trained expert for bin 0: 900 samples
2025-05-29 19:29:59,230 - MoETrainer - INFO - Trained expert for bin 1: 896 samples
2025-05-29 19:29:59,696 - MoETrainer - INFO - Trained expert for bin 2: 907 samples
2025-05-29 19:29:59,699 - MoETrainer - INFO - Trained expert for bin 3: 902 samples
2025-05-29 19:29:59,717 - MoETrainer - INFO -   original MoE 4 bins: RMSE=190661, MAE=80975, RÂ²=0.6697
2025-05-29 19:29:59,727 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:30:00,063 - MoETrainer - INFO - Bin 0: Selected lgb_simple (702 samples)
2025-05-29 19:30:00,381 - MoETrainer - INFO - Bin 1: Selected rf_simple (735 samples)
2025-05-29 19:30:00,690 - MoETrainer - INFO - Bin 2: Selected elastic_net (725 samples)
2025-05-29 19:30:01,050 - MoETrainer - INFO - Bin 3: Selected rf_simple (722 samples)
2025-05-29 19:30:01,636 - MoETrainer - INFO - Bin 4: Selected lgb_simple (721 samples)
2025-05-29 19:30:01,637 - MoETrainer - INFO - Training expert models...
2025-05-29 19:30:01,681 - MoETrainer - INFO - Trained expert for bin 0: 702 samples
2025-05-29 19:30:02,058 - MoETrainer - INFO - Trained expert for bin 1: 735 samples
2025-05-29 19:30:02,061 - MoETrainer - INFO - Trained expert for bin 2: 725 samples
2025-05-29 19:30:02,392 - MoETrainer - INFO - Trained expert for bin 3: 722 samples
2025-05-29 19:30:02,409 - MoETrainer - INFO - Trained expert for bin 4: 721 samples
2025-05-29 19:30:02,433 - MoETrainer - INFO -   original MoE 5 bins: RMSE=322716, MAE=210000, RÂ²=0.0538
2025-05-29 19:30:02,435 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:30:02,661 - MoETrainer - INFO - Bin 0: Selected ridge_medium (529 samples)
2025-05-29 19:30:02,941 - MoETrainer - INFO - Bin 1: Selected elastic_net (673 samples)
2025-05-29 19:30:03,208 - MoETrainer - INFO - Bin 2: Selected rf_simple (594 samples)
2025-05-29 19:30:03,717 - MoETrainer - INFO - Bin 3: Selected rf_simple (601 samples)
2025-05-29 19:30:04,018 - MoETrainer - INFO - Bin 4: Selected rf_simple (607 samples)
2025-05-29 19:30:04,287 - MoETrainer - INFO - Bin 5: Selected lgb_simple (601 samples)
2025-05-29 19:30:04,287 - MoETrainer - INFO - Training expert models...
2025-05-29 19:30:04,290 - MoETrainer - INFO - Trained expert for bin 0: 529 samples
2025-05-29 19:30:04,293 - MoETrainer - INFO - Trained expert for bin 1: 673 samples
2025-05-29 19:30:04,565 - MoETrainer - INFO - Trained expert for bin 2: 594 samples
2025-05-29 19:30:04,873 - MoETrainer - INFO - Trained expert for bin 3: 601 samples
2025-05-29 19:30:05,232 - MoETrainer - INFO - Trained expert for bin 4: 607 samples
2025-05-29 19:30:05,246 - MoETrainer - INFO - Trained expert for bin 5: 601 samples
2025-05-29 19:30:05,278 - MoETrainer - INFO -   original MoE 6 bins: RMSE=208813, MAE=120062, RÂ²=0.6039
2025-05-29 19:30:05,279 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 19:30:05,281 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:30:05,283 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:30:05,284 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:30:25,459 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:30:25,460 - MoETrainer - INFO -   1. lgb_conservative: MSE=2292195154Â±223605185, RÂ²=0.339 [SELECTED]
2025-05-29 19:30:25,460 - MoETrainer - INFO -   2. xgb_conservative: MSE=2314781824Â±238170204, RÂ²=0.364
2025-05-29 19:30:25,460 - MoETrainer - INFO -   3. ridge_light: MSE=2350123051Â±230845534, RÂ²=0.157
2025-05-29 19:30:44,977 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:30:44,978 - MoETrainer - INFO -   1. lgb_conservative: MSE=2072001530Â±41018723, RÂ²=0.318 [SELECTED]
2025-05-29 19:30:44,979 - MoETrainer - INFO -   2. rf_shallow: MSE=2072197437Â±46872278, RÂ²=0.314
2025-05-29 19:30:44,980 - MoETrainer - INFO -   3. xgb_conservative: MSE=2082037504Â±42002048, RÂ²=0.350
2025-05-29 19:31:08,538 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:31:08,539 - MoETrainer - INFO -   1. lgb_conservative: MSE=92990344180Â±3079823545, RÂ²=0.533 [SELECTED]
2025-05-29 19:31:08,540 - MoETrainer - INFO -   2. rf_shallow: MSE=93471535625Â±745885412, RÂ²=0.556
2025-05-29 19:31:08,541 - MoETrainer - INFO -   3. xgb_conservative: MSE=94155330901Â±3685950579, RÂ²=0.602
2025-05-29 19:31:08,542 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:31:08,605 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1202 samples
2025-05-29 19:31:08,674 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 1195 samples
2025-05-29 19:31:08,781 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1208 samples
2025-05-29 19:31:08,782 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 19:31:08,814 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=322566, MAE=263866, RÂ²=0.0547
2025-05-29 19:31:08,824 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:31:08,830 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:31:08,836 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:31:27,929 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:31:27,930 - MoETrainer - INFO -   1. ridge_light: MSE=1737842859Â±38349750, RÂ²=0.162 [SELECTED]
2025-05-29 19:31:27,931 - MoETrainer - INFO -   2. ridge_medium: MSE=1744908757Â±57437678, RÂ²=0.149
2025-05-29 19:31:27,931 - MoETrainer - INFO -   3. lgb_conservative: MSE=1765260494Â±57492101, RÂ²=0.359
2025-05-29 19:31:44,630 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:31:44,631 - MoETrainer - INFO -   1. ridge_heavy: MSE=749932096Â±28942301, RÂ²=0.059 [SELECTED]
2025-05-29 19:31:44,632 - MoETrainer - INFO -   2. ridge_medium: MSE=752240683Â±34855134, RÂ²=0.066
2025-05-29 19:31:44,632 - MoETrainer - INFO -   3. elastic_light: MSE=756732288Â±24301571, RÂ²=0.042
2025-05-29 19:32:00,893 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:32:00,896 - MoETrainer - INFO -   1. xgb_conservative: MSE=2099832917Â±81333906, RÂ²=0.344 [SELECTED]
2025-05-29 19:32:00,897 - MoETrainer - INFO -   2. rf_shallow: MSE=2113950337Â±57103307, RÂ²=0.297
2025-05-29 19:32:00,897 - MoETrainer - INFO -   3. lgb_conservative: MSE=2141939913Â±49175945, RÂ²=0.289
2025-05-29 19:32:16,400 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:32:16,401 - MoETrainer - INFO -   1. lgb_conservative: MSE=109113291397Â±2733001486, RÂ²=0.499 [SELECTED]
2025-05-29 19:32:16,401 - MoETrainer - INFO -   2. rf_shallow: MSE=111296773044Â±1263915990, RÂ²=0.536
2025-05-29 19:32:16,402 - MoETrainer - INFO -   3. rf_medium: MSE=113951536258Â±1055322830, RÂ²=0.784
2025-05-29 19:32:16,403 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:32:16,406 - MoETrainer - INFO - Successfully trained ridge_light for bin 0: 900 samples
2025-05-29 19:32:16,411 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 1: 896 samples
2025-05-29 19:32:16,483 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 907 samples
2025-05-29 19:32:16,521 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 3: 902 samples
2025-05-29 19:32:16,521 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 19:32:16,534 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=197576, MAE=82419, RÂ²=0.6453
2025-05-29 19:32:16,536 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:32:16,537 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:32:16,538 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:32:29,081 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:32:29,082 - MoETrainer - INFO -   1. xgb_conservative: MSE=1446151851Â±119773693, RÂ²=0.417 [SELECTED]
2025-05-29 19:32:29,082 - MoETrainer - INFO -   2. lgb_conservative: MSE=1446534352Â±114716012, RÂ²=0.376
2025-05-29 19:32:29,083 - MoETrainer - INFO -   3. ridge_light: MSE=1446806699Â±97938816, RÂ²=0.158
2025-05-29 19:32:43,458 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:32:43,459 - MoETrainer - INFO -   1. elastic_light: MSE=418947851Â±7957155, RÂ²=0.014 [SELECTED]
2025-05-29 19:32:43,460 - MoETrainer - INFO -   2. elastic_balanced: MSE=419519232Â±6939107, RÂ²=0.005
2025-05-29 19:32:43,460 - MoETrainer - INFO -   3. elastic_heavy: MSE=420093152Â±6888188, RÂ²=0.002
2025-05-29 19:33:08,060 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:33:08,060 - MoETrainer - INFO -   1. ridge_heavy: MSE=710504128Â±61865412, RÂ²=0.072 [SELECTED]
2025-05-29 19:33:08,060 - MoETrainer - INFO -   2. elastic_light: MSE=710725867Â±70879238, RÂ²=0.057
2025-05-29 19:33:08,061 - MoETrainer - INFO -   3. ridge_medium: MSE=714444395Â±48086182, RÂ²=0.083
2025-05-29 19:33:25,919 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:33:25,919 - MoETrainer - INFO -   1. ridge_heavy: MSE=2293766357Â±301700048, RÂ²=0.072 [SELECTED]
2025-05-29 19:33:25,920 - MoETrainer - INFO -   2. ridge_medium: MSE=2301482709Â±301241116, RÂ²=0.080
2025-05-29 19:33:25,920 - MoETrainer - INFO -   3. xgb_conservative: MSE=2304119552Â±304920160, RÂ²=0.352
2025-05-29 19:33:41,539 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 19:33:41,539 - MoETrainer - INFO -   1. rf_shallow: MSE=119861531832Â±14221579067, RÂ²=0.516 [SELECTED]
2025-05-29 19:33:41,539 - MoETrainer - INFO -   2. lgb_conservative: MSE=122523251612Â±17408127945, RÂ²=0.467
2025-05-29 19:33:41,539 - MoETrainer - INFO -   3. rf_medium: MSE=125252286335Â±14290200172, RÂ²=0.761
2025-05-29 19:33:41,540 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:33:41,597 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 702 samples
2025-05-29 19:33:41,600 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 735 samples
2025-05-29 19:33:41,603 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 725 samples
2025-05-29 19:33:41,605 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 722 samples
2025-05-29 19:33:41,943 - MoETrainer - INFO - Successfully trained rf_shallow for bin 4: 721 samples
2025-05-29 19:33:41,943 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 19:33:41,954 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=197128, MAE=96850, RÂ²=0.6470
2025-05-29 19:33:41,955 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:33:41,957 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:33:41,957 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:33:52,211 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:33:52,212 - MoETrainer - INFO -   1. ridge_medium: MSE=1213682197Â±139583397, RÂ²=0.097 [SELECTED]
2025-05-29 19:33:52,212 - MoETrainer - INFO -   2. xgb_conservative: MSE=1220099328Â±119851108, RÂ²=0.416
2025-05-29 19:33:52,212 - MoETrainer - INFO -   3. ridge_light: MSE=1220695275Â±134827629, RÂ²=0.106
2025-05-29 19:34:04,211 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:34:04,212 - MoETrainer - INFO -   1. elastic_light: MSE=440165632Â±25340256, RÂ²=0.011 [SELECTED]
2025-05-29 19:34:04,212 - MoETrainer - INFO -   2. ridge_heavy: MSE=440208064Â±25404245, RÂ²=0.019
2025-05-29 19:34:04,213 - MoETrainer - INFO -   3. elastic_balanced: MSE=441227424Â±25425446, RÂ²=0.003
2025-05-29 19:34:15,512 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:34:15,512 - MoETrainer - INFO -   1. ridge_heavy: MSE=428014603Â±22491804, RÂ²=0.039 [SELECTED]
2025-05-29 19:34:15,513 - MoETrainer - INFO -   2. elastic_light: MSE=428658187Â±24121504, RÂ²=0.028
2025-05-29 19:34:15,514 - MoETrainer - INFO -   3. elastic_balanced: MSE=431526507Â±27130723, RÂ²=0.011
2025-05-29 19:34:27,230 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:34:27,231 - MoETrainer - INFO -   1. ridge_heavy: MSE=780767851Â±27548117, RÂ²=0.041 [SELECTED]
2025-05-29 19:34:27,232 - MoETrainer - INFO -   2. elastic_light: MSE=781039573Â±29293264, RÂ²=0.033
2025-05-29 19:34:27,233 - MoETrainer - INFO -   3. ridge_medium: MSE=782163648Â±25554019, RÂ²=0.057
2025-05-29 19:34:40,376 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 19:34:40,376 - MoETrainer - INFO -   1. elastic_balanced: MSE=2316568491Â±211715248, RÂ²=0.029 [SELECTED]
2025-05-29 19:34:40,377 - MoETrainer - INFO -   2. elastic_light: MSE=2320115968Â±204100335, RÂ²=0.045
2025-05-29 19:34:40,377 - MoETrainer - INFO -   3. ridge_heavy: MSE=2330500139Â±197569375, RÂ²=0.055
2025-05-29 19:34:52,666 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 19:34:52,666 - MoETrainer - INFO -   1. lgb_conservative: MSE=138977976914Â±20582656960, RÂ²=0.445 [SELECTED]
2025-05-29 19:34:52,666 - MoETrainer - INFO -   2. rf_shallow: MSE=146253696460Â±24136397592, RÂ²=0.518
2025-05-29 19:34:52,667 - MoETrainer - INFO -   3. ridge_heavy: MSE=147421926741Â±14063630643, RÂ²=0.214
2025-05-29 19:34:52,667 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:34:52,670 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 529 samples
2025-05-29 19:34:52,674 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 673 samples
2025-05-29 19:34:52,676 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 594 samples
2025-05-29 19:34:52,679 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 601 samples
2025-05-29 19:34:52,682 - MoETrainer - INFO - Successfully trained elastic_balanced for bin 4: 607 samples
2025-05-29 19:34:52,727 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 5: 601 samples
2025-05-29 19:34:52,727 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 19:34:52,733 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=188256, MAE=81565, RÂ²=0.6780
2025-05-29 19:34:52,734 - MoETrainer - INFO - 
=== TESTING HYBRID DATA MANAGER ===
2025-05-29 19:34:52,742 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-29 19:34:53,777 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 19:34:53,838 - MoETrainer - INFO - Consolidating 744 features using original approach...
2025-05-29 19:34:57,426 - MoETrainer - INFO - Consolidated to 14 features
2025-05-29 19:34:57,473 - MoETrainer - INFO - Final features: 16 (from 16 after consolidation)
2025-05-29 19:34:57,474 - MoETrainer - INFO - Loaded dataset: 5555 samples, 16 features
2025-05-29 19:34:57,474 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 19:34:57,475 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 19:34:57,475 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-29 19:34:57,478 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 19:34:57,487 - MoETrainer - INFO - Applied robust scaling
2025-05-29 19:34:57,499 - MoETrainer - INFO - Splitting data...
2025-05-29 19:34:57,502 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 19:34:57,502 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-29 19:34:57,503 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-29 19:34:57,503 - MoETrainer - INFO - Testing baseline models...
2025-05-29 19:34:58,331 - MoETrainer - INFO -   ridge: RMSE=192354, MAE=130140, RÂ²=0.5157
2025-05-29 19:34:58,331 - MoETrainer - INFO -   random_forest: RMSE=180053, MAE=121445, RÂ²=0.5757
2025-05-29 19:34:58,331 - MoETrainer - INFO -   ensemble: RMSE=181036, MAE=121866, RÂ²=0.5711
2025-05-29 19:34:58,332 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 19:34:58,333 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:34:58,633 - MoETrainer - INFO - Bin 0: Selected lgb_simple (1169 samples)
2025-05-29 19:34:58,941 - MoETrainer - INFO - Bin 1: Selected lgb_simple (1214 samples)
2025-05-29 19:34:59,265 - MoETrainer - INFO - Bin 2: Selected rf_simple (1193 samples)
2025-05-29 19:34:59,266 - MoETrainer - INFO - Training expert models...
2025-05-29 19:34:59,299 - MoETrainer - INFO - Trained expert for bin 0: 1169 samples
2025-05-29 19:34:59,323 - MoETrainer - INFO - Trained expert for bin 1: 1214 samples
2025-05-29 19:34:59,641 - MoETrainer - INFO - Trained expert for bin 2: 1193 samples
2025-05-29 19:34:59,653 - MoETrainer - INFO -   original MoE 3 bins: RMSE=163807, MAE=116395, RÂ²=0.6488
2025-05-29 19:34:59,654 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:34:59,905 - MoETrainer - INFO - Bin 0: Selected rf_simple (886 samples)
2025-05-29 19:35:00,195 - MoETrainer - INFO - Bin 1: Selected lgb_simple (898 samples)
2025-05-29 19:35:00,484 - MoETrainer - INFO - Bin 2: Selected ridge_light (875 samples)
2025-05-29 19:35:00,748 - MoETrainer - INFO - Bin 3: Selected lgb_simple (917 samples)
2025-05-29 19:35:00,750 - MoETrainer - INFO - Training expert models...
2025-05-29 19:35:00,976 - MoETrainer - INFO - Trained expert for bin 0: 886 samples
2025-05-29 19:35:01,006 - MoETrainer - INFO - Trained expert for bin 1: 898 samples
2025-05-29 19:35:01,010 - MoETrainer - INFO - Trained expert for bin 2: 875 samples
2025-05-29 19:35:01,041 - MoETrainer - INFO - Trained expert for bin 3: 917 samples
2025-05-29 19:35:01,058 - MoETrainer - INFO -   original MoE 4 bins: RMSE=212164, MAE=148735, RÂ²=0.4109
2025-05-29 19:35:01,060 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:35:01,292 - MoETrainer - INFO - Bin 0: Selected ridge_heavy (701 samples)
2025-05-29 19:35:01,515 - MoETrainer - INFO - Bin 1: Selected rf_simple (722 samples)
2025-05-29 19:35:01,746 - MoETrainer - INFO - Bin 2: Selected elastic_net (721 samples)
2025-05-29 19:35:01,992 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (708 samples)
2025-05-29 19:35:02,244 - MoETrainer - INFO - Bin 4: Selected ridge_light (724 samples)
2025-05-29 19:35:02,245 - MoETrainer - INFO - Training expert models...
2025-05-29 19:35:02,248 - MoETrainer - INFO - Trained expert for bin 0: 701 samples
2025-05-29 19:35:02,456 - MoETrainer - INFO - Trained expert for bin 1: 722 samples
2025-05-29 19:35:02,459 - MoETrainer - INFO - Trained expert for bin 2: 721 samples
2025-05-29 19:35:02,461 - MoETrainer - INFO - Trained expert for bin 3: 708 samples
2025-05-29 19:35:02,470 - MoETrainer - INFO - Trained expert for bin 4: 724 samples
2025-05-29 19:35:02,495 - MoETrainer - INFO -   original MoE 5 bins: RMSE=181148, MAE=115044, RÂ²=0.5705
2025-05-29 19:35:02,499 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:35:02,696 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 19:35:02,891 - MoETrainer - INFO - Bin 1: Selected elastic_net (638 samples)
2025-05-29 19:35:03,080 - MoETrainer - INFO - Bin 2: Selected ridge_light (615 samples)
2025-05-29 19:35:03,273 - MoETrainer - INFO - Bin 3: Selected elastic_net (599 samples)
2025-05-29 19:35:03,495 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 19:35:03,737 - MoETrainer - INFO - Bin 5: Selected ridge_medium (597 samples)
2025-05-29 19:35:03,738 - MoETrainer - INFO - Training expert models...
2025-05-29 19:35:03,741 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 19:35:03,743 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 19:35:03,747 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 19:35:03,753 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 19:35:03,756 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 19:35:03,761 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 19:35:03,769 - MoETrainer - INFO -   original MoE 6 bins: RMSE=219280, MAE=168026, RÂ²=0.3707
2025-05-29 19:35:03,769 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 19:35:03,770 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:35:03,771 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:35:03,771 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:35:15,503 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:35:15,503 - MoETrainer - INFO -   1. lgb_conservative: MSE=2051982718Â±74036088, RÂ²=0.331 [SELECTED]
2025-05-29 19:35:15,504 - MoETrainer - INFO -   2. xgb_conservative: MSE=2087698048Â±78871521, RÂ²=0.355
2025-05-29 19:35:15,504 - MoETrainer - INFO -   3. rf_shallow: MSE=2098412265Â±76686485, RÂ²=0.322
2025-05-29 19:35:27,730 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:35:27,731 - MoETrainer - INFO -   1. xgb_conservative: MSE=2054866731Â±89257148, RÂ²=0.338 [SELECTED]
2025-05-29 19:35:27,731 - MoETrainer - INFO -   2. rf_deep: MSE=2088111771Â±77353401, RÂ²=0.840
2025-05-29 19:35:27,732 - MoETrainer - INFO -   3. rf_shallow: MSE=2092409478Â±71783444, RÂ²=0.307
2025-05-29 19:35:41,296 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:35:41,298 - MoETrainer - INFO -   1. lgb_conservative: MSE=52357390371Â±6340429334, RÂ²=0.476 [SELECTED]
2025-05-29 19:35:41,299 - MoETrainer - INFO -   2. xgb_conservative: MSE=53781113515Â±6419694667, RÂ²=0.534
2025-05-29 19:35:41,299 - MoETrainer - INFO -   3. ridge_medium: MSE=53909845333Â±6778669691, RÂ²=0.314
2025-05-29 19:35:41,301 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:35:41,367 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-29 19:35:41,422 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-29 19:35:41,502 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-29 19:35:41,503 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 19:35:41,509 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=252912, MAE=190187, RÂ²=0.1628
2025-05-29 19:35:41,511 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:35:41,512 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:35:41,513 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:35:51,743 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:35:51,744 - MoETrainer - INFO -   1. lgb_conservative: MSE=1554654244Â±89299290, RÂ²=0.315 [SELECTED]
2025-05-29 19:35:51,744 - MoETrainer - INFO -   2. xgb_conservative: MSE=1564688597Â±93382029, RÂ²=0.361
2025-05-29 19:35:51,744 - MoETrainer - INFO -   3. rf_shallow: MSE=1568346338Â±103771167, RÂ²=0.317
2025-05-29 19:36:01,773 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:36:01,773 - MoETrainer - INFO -   1. lgb_conservative: MSE=754670171Â±43348648, RÂ²=0.273 [SELECTED]
2025-05-29 19:36:01,774 - MoETrainer - INFO -   2. ridge_heavy: MSE=759384597Â±41296604, RÂ²=0.074
2025-05-29 19:36:01,774 - MoETrainer - INFO -   3. rf_shallow: MSE=760516979Â±43317031, RÂ²=0.266
2025-05-29 19:36:12,025 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:36:12,025 - MoETrainer - INFO -   1. rf_shallow: MSE=1872297560Â±67784030, RÂ²=0.294 [SELECTED]
2025-05-29 19:36:12,026 - MoETrainer - INFO -   2. rf_medium: MSE=1872657809Â±75033230, RÂ²=0.679
2025-05-29 19:36:12,026 - MoETrainer - INFO -   3. rf_deep: MSE=1881338592Â±86127913, RÂ²=0.847
2025-05-29 19:36:23,081 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:36:23,084 - MoETrainer - INFO -   1. ridge_heavy: MSE=59324588032Â±5632655155, RÂ²=0.262 [SELECTED]
2025-05-29 19:36:23,084 - MoETrainer - INFO -   2. ridge_medium: MSE=59466103467Â±5199318117, RÂ²=0.270
2025-05-29 19:36:23,084 - MoETrainer - INFO -   3. elastic_light: MSE=59576837461Â±5662047965, RÂ²=0.246
2025-05-29 19:36:23,085 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:36:23,129 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-29 19:36:23,177 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-29 19:36:23,426 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-29 19:36:23,429 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-29 19:36:23,430 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 19:36:23,447 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=143226, MAE=90232, RÂ²=0.7315
2025-05-29 19:36:23,448 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:36:23,458 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:36:23,461 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:36:32,429 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:36:32,430 - MoETrainer - INFO -   1. xgb_conservative: MSE=1324023381Â±105765990, RÂ²=0.355 [SELECTED]
2025-05-29 19:36:32,430 - MoETrainer - INFO -   2. ridge_heavy: MSE=1333652565Â±124505754, RÂ²=0.098
2025-05-29 19:36:32,430 - MoETrainer - INFO -   3. ridge_medium: MSE=1336999211Â±121049083, RÂ²=0.103
2025-05-29 19:36:41,217 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:36:41,217 - MoETrainer - INFO -   1. elastic_light: MSE=450224437Â±15195628, RÂ²=0.013 [SELECTED]
2025-05-29 19:36:41,218 - MoETrainer - INFO -   2. elastic_balanced: MSE=450853429Â±17010934, RÂ²=0.004
2025-05-29 19:36:41,218 - MoETrainer - INFO -   3. xgb_conservative: MSE=451126869Â±12800049, RÂ²=0.289
2025-05-29 19:36:50,084 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:36:50,084 - MoETrainer - INFO -   1. lgb_conservative: MSE=728136152Â±35073620, RÂ²=0.321 [SELECTED]
2025-05-29 19:36:50,085 - MoETrainer - INFO -   2. rf_medium: MSE=735865487Â±40225936, RÂ²=0.709
2025-05-29 19:36:50,086 - MoETrainer - INFO -   3. xgb_conservative: MSE=738120064Â±48823482, RÂ²=0.369
2025-05-29 19:36:59,215 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:36:59,216 - MoETrainer - INFO -   1. ridge_heavy: MSE=2030541653Â±156244371, RÂ²=0.062 [SELECTED]
2025-05-29 19:36:59,217 - MoETrainer - INFO -   2. xgb_conservative: MSE=2031406549Â±157956752, RÂ²=0.341
2025-05-29 19:36:59,219 - MoETrainer - INFO -   3. elastic_light: MSE=2032568320Â±147649533, RÂ²=0.048
2025-05-29 19:37:08,943 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 19:37:08,944 - MoETrainer - INFO -   1. elastic_light: MSE=63539971413Â±9335315964, RÂ²=0.221 [SELECTED]
2025-05-29 19:37:08,944 - MoETrainer - INFO -   2. ridge_heavy: MSE=64145036629Â±8449681071, RÂ²=0.234
2025-05-29 19:37:08,944 - MoETrainer - INFO -   3. ridge_medium: MSE=65425111723Â±6873181841, RÂ²=0.242
2025-05-29 19:37:08,945 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:37:09,002 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-29 19:37:09,008 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-29 19:37:09,072 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-29 19:37:09,076 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-29 19:37:09,079 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-29 19:37:09,079 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 19:37:09,094 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=220521, MAE=139061, RÂ²=0.3635
2025-05-29 19:37:09,095 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 19:37:09,096 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 19:37:09,096 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 19:37:16,517 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 19:37:16,517 - MoETrainer - INFO -   1. ridge_heavy: MSE=1091123840Â±84921785, RÂ²=0.067 [SELECTED]
2025-05-29 19:37:16,518 - MoETrainer - INFO -   2. elastic_light: MSE=1093135424Â±74582634, RÂ²=0.049
2025-05-29 19:37:16,518 - MoETrainer - INFO -   3. ridge_medium: MSE=1106090880Â±100381108, RÂ²=0.073
2025-05-29 19:37:24,966 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 19:37:24,966 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417760Â±13345440, RÂ²=0.001 [SELECTED]
2025-05-29 19:37:24,967 - MoETrainer - INFO -   2. elastic_balanced: MSE=436417632Â±14001111, RÂ²=0.004
2025-05-29 19:37:24,967 - MoETrainer - INFO -   3. elastic_light: MSE=441629664Â±16068301, RÂ²=0.014
2025-05-29 19:37:33,279 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 19:37:33,280 - MoETrainer - INFO -   1. ridge_heavy: MSE=433985696Â±8811551, RÂ²=0.052 [SELECTED]
2025-05-29 19:37:33,281 - MoETrainer - INFO -   2. ridge_medium: MSE=435630635Â±8191397, RÂ²=0.065
2025-05-29 19:37:33,281 - MoETrainer - INFO -   3. elastic_light: MSE=436093120Â±10345494, RÂ²=0.036
2025-05-29 19:37:42,263 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 19:37:42,263 - MoETrainer - INFO -   1. elastic_light: MSE=782845099Â±44801398, RÂ²=0.031 [SELECTED]
2025-05-29 19:37:42,264 - MoETrainer - INFO -   2. elastic_balanced: MSE=784591360Â±39203507, RÂ²=0.015
2025-05-29 19:37:42,264 - MoETrainer - INFO -   3. ridge_heavy: MSE=787478229Â±45545372, RÂ²=0.037
2025-05-29 19:37:52,105 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 19:37:52,105 - MoETrainer - INFO -   1. elastic_light: MSE=2063419947Â±85087551, RÂ²=0.051 [SELECTED]
2025-05-29 19:37:52,105 - MoETrainer - INFO -   2. elastic_balanced: MSE=2065335083Â±70425289, RÂ²=0.032
2025-05-29 19:37:52,106 - MoETrainer - INFO -   3. ridge_heavy: MSE=2079765504Â±83183898, RÂ²=0.059
2025-05-29 19:38:01,931 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 19:38:01,933 - MoETrainer - INFO -   1. elastic_light: MSE=65351457451Â±7898839953, RÂ²=0.214 [SELECTED]
2025-05-29 19:38:01,934 - MoETrainer - INFO -   2. ridge_heavy: MSE=65404768256Â±7996922579, RÂ²=0.226
2025-05-29 19:38:01,934 - MoETrainer - INFO -   3. ridge_medium: MSE=65720815616Â±7748739008, RÂ²=0.236
2025-05-29 19:38:01,935 - MoETrainer - INFO - Training selected expert models...
2025-05-29 19:38:01,938 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-29 19:38:01,943 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-29 19:38:01,947 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-29 19:38:01,956 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-29 19:38:01,961 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-29 19:38:01,965 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-29 19:38:01,968 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 19:38:01,974 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=229869, MAE=171346, RÂ²=0.3084
2025-05-29 20:38:39,929 - MoETrainer - INFO - === COMPREHENSIVE COMPARISON STARTING ===
2025-05-29 20:38:39,929 - MoETrainer - INFO - 
=== TESTING ORIGINAL DATA MANAGER ===
2025-05-29 20:38:39,930 - MoETrainer - INFO - Loading data...
2025-05-29 20:38:40,831 - MoETrainer - INFO - Raw data loaded: (5555, 745)
2025-05-29 20:38:40,834 - MoETrainer - INFO - Target column: Price
2025-05-29 20:38:40,836 - MoETrainer - INFO - Initial features: 744
2025-05-29 20:38:40,838 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-29 20:38:40,871 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-29 20:38:40,873 - MoETrainer - INFO - Clean features: 743
2025-05-29 20:38:40,904 - MoETrainer - INFO - Consolidating 743 features...
2025-05-29 20:38:43,350 - MoETrainer - INFO - Consolidated to 13 features
2025-05-29 20:38:43,364 - MoETrainer - INFO - Final data shape: (5555, 13)
2025-05-29 20:38:43,364 - MoETrainer - INFO - Loaded dataset: 5555 samples, 13 features
2025-05-29 20:38:43,365 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 20:38:43,365 - MoETrainer - INFO - Preprocessing data...
2025-05-29 20:38:43,367 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 20:38:43,374 - MoETrainer - INFO - Applied robust scaling
2025-05-29 20:38:43,375 - MoETrainer - INFO - Splitting data...
2025-05-29 20:38:43,379 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 20:38:43,380 - MoETrainer - INFO - Testing baseline models...
2025-05-29 20:38:43,979 - MoETrainer - INFO -   ridge: RMSE=193173, MAE=130941, RÂ²=0.5116
2025-05-29 20:38:43,980 - MoETrainer - INFO -   random_forest: RMSE=177513, MAE=119637, RÂ²=0.5876
2025-05-29 20:38:43,980 - MoETrainer - INFO -   ensemble: RMSE=178901, MAE=120456, RÂ²=0.5811
2025-05-29 20:38:43,981 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 20:38:43,983 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:38:44,315 - MoETrainer - INFO - Bin 0: Selected lgb_simple (1169 samples)
2025-05-29 20:38:44,482 - MoETrainer - INFO - Bin 1: Selected lgb_simple (1214 samples)
2025-05-29 20:38:44,660 - MoETrainer - INFO - Bin 2: Selected lgb_simple (1193 samples)
2025-05-29 20:38:44,660 - MoETrainer - INFO - Training expert models...
2025-05-29 20:38:44,685 - MoETrainer - INFO - Trained expert for bin 0: 1169 samples
2025-05-29 20:38:44,711 - MoETrainer - INFO - Trained expert for bin 1: 1214 samples
2025-05-29 20:38:44,733 - MoETrainer - INFO - Trained expert for bin 2: 1193 samples
2025-05-29 20:38:44,740 - MoETrainer - INFO -   original MoE 3 bins: RMSE=285723, MAE=251257, RÂ²=-0.0685
2025-05-29 20:38:44,741 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:38:44,897 - MoETrainer - INFO - Bin 0: Selected lgb_simple (886 samples)
2025-05-29 20:38:45,042 - MoETrainer - INFO - Bin 1: Selected lgb_simple (898 samples)
2025-05-29 20:38:45,187 - MoETrainer - INFO - Bin 2: Selected rf_simple (875 samples)
2025-05-29 20:38:45,361 - MoETrainer - INFO - Bin 3: Selected rf_simple (917 samples)
2025-05-29 20:38:45,361 - MoETrainer - INFO - Training expert models...
2025-05-29 20:38:45,374 - MoETrainer - INFO - Trained expert for bin 0: 886 samples
2025-05-29 20:38:45,392 - MoETrainer - INFO - Trained expert for bin 1: 898 samples
2025-05-29 20:38:45,530 - MoETrainer - INFO - Trained expert for bin 2: 875 samples
2025-05-29 20:38:45,683 - MoETrainer - INFO - Trained expert for bin 3: 917 samples
2025-05-29 20:38:45,702 - MoETrainer - INFO -   original MoE 4 bins: RMSE=179833, MAE=133156, RÂ²=0.5767
2025-05-29 20:38:45,703 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:38:45,838 - MoETrainer - INFO - Bin 0: Selected rf_simple (701 samples)
2025-05-29 20:38:45,979 - MoETrainer - INFO - Bin 1: Selected rf_simple (722 samples)
2025-05-29 20:38:46,116 - MoETrainer - INFO - Bin 2: Selected lgb_simple (721 samples)
2025-05-29 20:38:46,251 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (708 samples)
2025-05-29 20:38:46,388 - MoETrainer - INFO - Bin 4: Selected rf_simple (724 samples)
2025-05-29 20:38:46,388 - MoETrainer - INFO - Training expert models...
2025-05-29 20:38:46,505 - MoETrainer - INFO - Trained expert for bin 0: 701 samples
2025-05-29 20:38:46,630 - MoETrainer - INFO - Trained expert for bin 1: 722 samples
2025-05-29 20:38:46,641 - MoETrainer - INFO - Trained expert for bin 2: 721 samples
2025-05-29 20:38:46,643 - MoETrainer - INFO - Trained expert for bin 3: 708 samples
2025-05-29 20:38:46,776 - MoETrainer - INFO - Trained expert for bin 4: 724 samples
2025-05-29 20:38:46,797 - MoETrainer - INFO -   original MoE 5 bins: RMSE=305909, MAE=226676, RÂ²=-0.2248
2025-05-29 20:38:46,798 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:38:46,931 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 20:38:47,059 - MoETrainer - INFO - Bin 1: Selected lgb_simple (638 samples)
2025-05-29 20:38:47,182 - MoETrainer - INFO - Bin 2: Selected lgb_simple (615 samples)
2025-05-29 20:38:47,310 - MoETrainer - INFO - Bin 3: Selected ridge_light (599 samples)
2025-05-29 20:38:47,446 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 20:38:47,584 - MoETrainer - INFO - Bin 5: Selected ridge_heavy (597 samples)
2025-05-29 20:38:47,585 - MoETrainer - INFO - Training expert models...
2025-05-29 20:38:47,587 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 20:38:47,605 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 20:38:47,626 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 20:38:47,628 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 20:38:47,630 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 20:38:47,632 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 20:38:47,637 - MoETrainer - INFO -   original MoE 6 bins: RMSE=184851, MAE=116906, RÂ²=0.5528
2025-05-29 20:38:47,637 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 20:38:47,639 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:38:47,639 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:38:47,639 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:38:54,167 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:38:54,167 - MoETrainer - INFO -   1. xgb_conservative: MSE=2068370176Â±80336710, RÂ²=0.339 [SELECTED]
2025-05-29 20:38:54,167 - MoETrainer - INFO -   2. lgb_conservative: MSE=2082357967Â±87031102, RÂ²=0.311
2025-05-29 20:38:54,168 - MoETrainer - INFO -   3. xgb_balanced: MSE=2099220309Â±104499540, RÂ²=0.843
2025-05-29 20:39:01,112 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:39:01,112 - MoETrainer - INFO -   1. xgb_conservative: MSE=2062783445Â±50653558, RÂ²=0.314 [SELECTED]
2025-05-29 20:39:01,112 - MoETrainer - INFO -   2. rf_shallow: MSE=2107454671Â±42839708, RÂ²=0.292
2025-05-29 20:39:01,112 - MoETrainer - INFO -   3. lgb_conservative: MSE=2118515856Â±58550874, RÂ²=0.284
2025-05-29 20:39:08,303 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:39:08,304 - MoETrainer - INFO -   1. lgb_conservative: MSE=53224036578Â±6562499679, RÂ²=0.460 [SELECTED]
2025-05-29 20:39:08,304 - MoETrainer - INFO -   2. xgb_conservative: MSE=53905889963Â±7087657375, RÂ²=0.510
2025-05-29 20:39:08,304 - MoETrainer - INFO -   3. ridge_heavy: MSE=53982306304Â±8016030072, RÂ²=0.302
2025-05-29 20:39:08,305 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:39:08,349 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1169 samples
2025-05-29 20:39:08,411 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-29 20:39:08,449 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-29 20:39:08,449 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 20:39:08,454 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=163745, MAE=115440, RÂ²=0.6491
2025-05-29 20:39:08,456 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:39:08,457 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:39:08,457 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:39:14,323 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:39:14,323 - MoETrainer - INFO -   1. lgb_conservative: MSE=1553582481Â±87569483, RÂ²=0.299 [SELECTED]
2025-05-29 20:39:14,323 - MoETrainer - INFO -   2. xgb_conservative: MSE=1555315968Â±74613499, RÂ²=0.351
2025-05-29 20:39:14,323 - MoETrainer - INFO -   3. rf_shallow: MSE=1571607916Â±100023801, RÂ²=0.303
2025-05-29 20:39:19,848 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:39:19,849 - MoETrainer - INFO -   1. ridge_medium: MSE=755851435Â±35704609, RÂ²=0.081 [SELECTED]
2025-05-29 20:39:19,850 - MoETrainer - INFO -   2. ridge_light: MSE=758557696Â±33158437, RÂ²=0.081
2025-05-29 20:39:19,850 - MoETrainer - INFO -   3. ridge_heavy: MSE=760900907Â±38614911, RÂ²=0.072
2025-05-29 20:39:25,440 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:39:25,440 - MoETrainer - INFO -   1. rf_shallow: MSE=1867756619Â±64391612, RÂ²=0.272 [SELECTED]
2025-05-29 20:39:25,440 - MoETrainer - INFO -   2. elastic_light: MSE=1871610069Â±24614202, RÂ²=0.049
2025-05-29 20:39:25,440 - MoETrainer - INFO -   3. xgb_conservative: MSE=1877442517Â±43697920, RÂ²=0.293
2025-05-29 20:39:32,077 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:39:32,077 - MoETrainer - INFO -   1. ridge_heavy: MSE=59178078208Â±5174271554, RÂ²=0.258 [SELECTED]
2025-05-29 20:39:32,078 - MoETrainer - INFO -   2. ridge_medium: MSE=59763374763Â±5354027477, RÂ²=0.260
2025-05-29 20:39:32,078 - MoETrainer - INFO -   3. ridge_light: MSE=60091098453Â±5481574595, RÂ²=0.260
2025-05-29 20:39:32,079 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:39:32,102 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-29 20:39:32,104 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 898 samples
2025-05-29 20:39:32,265 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-29 20:39:32,267 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-29 20:39:32,267 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 20:39:32,277 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=131758, MAE=71185, RÂ²=0.7728
2025-05-29 20:39:32,279 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:39:32,280 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:39:32,280 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:39:37,337 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:39:37,338 - MoETrainer - INFO -   1. xgb_conservative: MSE=1301453483Â±104339594, RÂ²=0.354 [SELECTED]
2025-05-29 20:39:37,339 - MoETrainer - INFO -   2. ridge_medium: MSE=1338154581Â±123521320, RÂ²=0.102
2025-05-29 20:39:37,340 - MoETrainer - INFO -   3. lgb_conservative: MSE=1339620474Â±103437411, RÂ²=0.288
2025-05-29 20:39:42,492 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:39:42,492 - MoETrainer - INFO -   1. elastic_light: MSE=450002603Â±15750746, RÂ²=0.011 [SELECTED]
2025-05-29 20:39:42,493 - MoETrainer - INFO -   2. ridge_heavy: MSE=450619829Â±14320688, RÂ²=0.018
2025-05-29 20:39:42,493 - MoETrainer - INFO -   3. elastic_balanced: MSE=450939243Â±17131197, RÂ²=0.003
2025-05-29 20:39:47,617 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:39:47,618 - MoETrainer - INFO -   1. lgb_conservative: MSE=715141310Â±28168823, RÂ²=0.295 [SELECTED]
2025-05-29 20:39:47,618 - MoETrainer - INFO -   2. rf_shallow: MSE=728371498Â±27310415, RÂ²=0.300
2025-05-29 20:39:47,619 - MoETrainer - INFO -   3. rf_medium: MSE=728414409Â±38144202, RÂ²=0.682
2025-05-29 20:39:54,465 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:39:54,465 - MoETrainer - INFO -   1. ridge_heavy: MSE=2009116629Â±132426173, RÂ²=0.062 [SELECTED]
2025-05-29 20:39:54,466 - MoETrainer - INFO -   2. xgb_conservative: MSE=2012675584Â±140791986, RÂ²=0.313
2025-05-29 20:39:54,466 - MoETrainer - INFO -   3. ridge_medium: MSE=2016706987Â±140891984, RÂ²=0.065
2025-05-29 20:39:59,931 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 20:39:59,931 - MoETrainer - INFO -   1. ridge_heavy: MSE=63370514432Â±8528700329, RÂ²=0.235 [SELECTED]
2025-05-29 20:39:59,931 - MoETrainer - INFO -   2. elastic_light: MSE=63750871723Â±9508986665, RÂ²=0.212
2025-05-29 20:39:59,931 - MoETrainer - INFO -   3. ridge_medium: MSE=64514804395Â±7158038832, RÂ²=0.238
2025-05-29 20:39:59,932 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:39:59,970 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-29 20:39:59,974 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-29 20:40:00,011 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-29 20:40:00,013 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-29 20:40:00,015 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 4: 724 samples
2025-05-29 20:40:00,015 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 20:40:00,031 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=165761, MAE=101576, RÂ²=0.6404
2025-05-29 20:40:00,032 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:40:00,034 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:40:00,035 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:40:04,492 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:40:04,492 - MoETrainer - INFO -   1. xgb_conservative: MSE=1076868779Â±77585311, RÂ²=0.345 [SELECTED]
2025-05-29 20:40:04,492 - MoETrainer - INFO -   2. ridge_heavy: MSE=1088950101Â±73274682, RÂ²=0.060
2025-05-29 20:40:04,492 - MoETrainer - INFO -   3. rf_shallow: MSE=1093751961Â±83778989, RÂ²=0.298
2025-05-29 20:40:09,311 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:40:09,312 - MoETrainer - INFO -   1. elastic_heavy: MSE=435418635Â±13280305, RÂ²=0.001 [SELECTED]
2025-05-29 20:40:09,312 - MoETrainer - INFO -   2. elastic_balanced: MSE=436443947Â±13809645, RÂ²=0.003
2025-05-29 20:40:09,312 - MoETrainer - INFO -   3. lgb_conservative: MSE=440194661Â±14756072, RÂ²=0.179
2025-05-29 20:40:16,436 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:40:16,436 - MoETrainer - INFO -   1. ridge_medium: MSE=431316885Â±1791642, RÂ²=0.060 [SELECTED]
2025-05-29 20:40:16,436 - MoETrainer - INFO -   2. ridge_light: MSE=432205728Â±1488841, RÂ²=0.060
2025-05-29 20:40:16,436 - MoETrainer - INFO -   3. ridge_heavy: MSE=433315861Â±6494829, RÂ²=0.049
2025-05-29 20:40:22,611 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:40:22,611 - MoETrainer - INFO -   1. elastic_light: MSE=779803648Â±41272382, RÂ²=0.026 [SELECTED]
2025-05-29 20:40:22,612 - MoETrainer - INFO -   2. ridge_heavy: MSE=779867712Â±40621660, RÂ²=0.036
2025-05-29 20:40:22,612 - MoETrainer - INFO -   3. elastic_balanced: MSE=785369643Â±38112666, RÂ²=0.012
2025-05-29 20:40:28,354 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 20:40:28,354 - MoETrainer - INFO -   1. elastic_light: MSE=2057194368Â±74029301, RÂ²=0.044 [SELECTED]
2025-05-29 20:40:28,354 - MoETrainer - INFO -   2. ridge_heavy: MSE=2059406165Â±73173751, RÂ²=0.056
2025-05-29 20:40:28,354 - MoETrainer - INFO -   3. elastic_balanced: MSE=2074405931Â±62806202, RÂ²=0.023
2025-05-29 20:40:33,310 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 20:40:33,310 - MoETrainer - INFO -   1. ridge_heavy: MSE=64971011413Â±7742270042, RÂ²=0.228 [SELECTED]
2025-05-29 20:40:33,310 - MoETrainer - INFO -   2. elastic_light: MSE=65569656832Â±7278452673, RÂ²=0.207
2025-05-29 20:40:33,311 - MoETrainer - INFO -   3. ridge_medium: MSE=65966043136Â±7725607677, RÂ²=0.232
2025-05-29 20:40:33,311 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:40:33,337 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 531 samples
2025-05-29 20:40:33,340 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-29 20:40:33,349 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-05-29 20:40:33,359 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-29 20:40:33,362 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-29 20:40:33,364 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 5: 597 samples
2025-05-29 20:40:33,365 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 20:40:33,369 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=122272, MAE=71647, RÂ²=0.8043
2025-05-29 20:40:33,376 - MoETrainer - INFO - 
=== TESTING IMPROVED DATA MANAGER ===
2025-05-29 20:40:33,378 - MoETrainer - INFO - Loading data with improved processing...
2025-05-29 20:40:34,121 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 20:40:34,123 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-29 20:40:34,126 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-29 20:40:34,293 - MoETrainer - INFO - Feature types: 7 numeric, 736 binary
2025-05-29 20:40:37,221 - MoETrainer - INFO - Processed features: 22 (from 743 original)
2025-05-29 20:40:37,222 - MoETrainer - INFO - Loaded dataset: 5555 samples, 22 features
2025-05-29 20:40:37,223 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 20:40:37,223 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 20:40:37,223 - MoETrainer - INFO - Preprocessing data with feature selection...
2025-05-29 20:40:37,225 - MoETrainer - INFO - Removed 7 outliers (0.1%)
2025-05-29 20:40:37,232 - MoETrainer - INFO - Selected 20 features from 22
2025-05-29 20:40:37,241 - MoETrainer - INFO - Applied robust scaling
2025-05-29 20:40:37,241 - MoETrainer - INFO - Splitting data...
2025-05-29 20:40:37,244 - MoETrainer - INFO - Data split - Train: 3605, Val: 833, Test: 1110
2025-05-29 20:40:37,245 - MoETrainer - INFO - Train target: mean=$550,360, std=$320,917
2025-05-29 20:40:37,245 - MoETrainer - INFO - Test target: mean=$560,582, std=$331,767
2025-05-29 20:40:37,246 - MoETrainer - INFO - Testing baseline models...
2025-05-29 20:40:38,975 - MoETrainer - INFO -   ridge: RMSE=234367, MAE=136233, RÂ²=0.5010
2025-05-29 20:40:38,976 - MoETrainer - INFO -   random_forest: RMSE=236962, MAE=137278, RÂ²=0.4899
2025-05-29 20:40:38,976 - MoETrainer - INFO -   ensemble: RMSE=232629, MAE=135005, RÂ²=0.5083
2025-05-29 20:40:38,977 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 20:40:38,977 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:40:39,379 - MoETrainer - INFO - Bin 0: Selected rf_simple (1202 samples)
2025-05-29 20:40:39,863 - MoETrainer - INFO - Bin 1: Selected rf_simple (1195 samples)
2025-05-29 20:40:40,245 - MoETrainer - INFO - Bin 2: Selected lgb_simple (1208 samples)
2025-05-29 20:40:40,245 - MoETrainer - INFO - Training expert models...
2025-05-29 20:40:40,629 - MoETrainer - INFO - Trained expert for bin 0: 1202 samples
2025-05-29 20:40:41,019 - MoETrainer - INFO - Trained expert for bin 1: 1195 samples
2025-05-29 20:40:41,036 - MoETrainer - INFO - Trained expert for bin 2: 1208 samples
2025-05-29 20:40:41,064 - MoETrainer - INFO -   original MoE 3 bins: RMSE=220152, MAE=123632, RÂ²=0.5597
2025-05-29 20:40:41,065 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:40:41,342 - MoETrainer - INFO - Bin 0: Selected lgb_simple (900 samples)
2025-05-29 20:40:41,630 - MoETrainer - INFO - Bin 1: Selected elastic_net (896 samples)
2025-05-29 20:40:41,912 - MoETrainer - INFO - Bin 2: Selected rf_simple (907 samples)
2025-05-29 20:40:42,192 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (902 samples)
2025-05-29 20:40:42,193 - MoETrainer - INFO - Training expert models...
2025-05-29 20:40:42,209 - MoETrainer - INFO - Trained expert for bin 0: 900 samples
2025-05-29 20:40:42,214 - MoETrainer - INFO - Trained expert for bin 1: 896 samples
2025-05-29 20:40:42,523 - MoETrainer - INFO - Trained expert for bin 2: 907 samples
2025-05-29 20:40:42,525 - MoETrainer - INFO - Trained expert for bin 3: 902 samples
2025-05-29 20:40:42,537 - MoETrainer - INFO -   original MoE 4 bins: RMSE=190661, MAE=80975, RÂ²=0.6697
2025-05-29 20:40:42,538 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:40:42,780 - MoETrainer - INFO - Bin 0: Selected lgb_simple (702 samples)
2025-05-29 20:40:43,030 - MoETrainer - INFO - Bin 1: Selected rf_simple (735 samples)
2025-05-29 20:40:43,273 - MoETrainer - INFO - Bin 2: Selected elastic_net (725 samples)
2025-05-29 20:40:43,518 - MoETrainer - INFO - Bin 3: Selected rf_simple (722 samples)
2025-05-29 20:40:43,757 - MoETrainer - INFO - Bin 4: Selected lgb_simple (721 samples)
2025-05-29 20:40:43,758 - MoETrainer - INFO - Training expert models...
2025-05-29 20:40:43,776 - MoETrainer - INFO - Trained expert for bin 0: 702 samples
2025-05-29 20:40:44,029 - MoETrainer - INFO - Trained expert for bin 1: 735 samples
2025-05-29 20:40:44,031 - MoETrainer - INFO - Trained expert for bin 2: 725 samples
2025-05-29 20:40:44,307 - MoETrainer - INFO - Trained expert for bin 3: 722 samples
2025-05-29 20:40:44,316 - MoETrainer - INFO - Trained expert for bin 4: 721 samples
2025-05-29 20:40:44,334 - MoETrainer - INFO -   original MoE 5 bins: RMSE=322716, MAE=210000, RÂ²=0.0538
2025-05-29 20:40:44,335 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:40:44,534 - MoETrainer - INFO - Bin 0: Selected ridge_medium (529 samples)
2025-05-29 20:40:44,758 - MoETrainer - INFO - Bin 1: Selected elastic_net (673 samples)
2025-05-29 20:40:44,968 - MoETrainer - INFO - Bin 2: Selected rf_simple (594 samples)
2025-05-29 20:40:45,175 - MoETrainer - INFO - Bin 3: Selected rf_simple (601 samples)
2025-05-29 20:40:45,390 - MoETrainer - INFO - Bin 4: Selected rf_simple (607 samples)
2025-05-29 20:40:45,621 - MoETrainer - INFO - Bin 5: Selected lgb_simple (601 samples)
2025-05-29 20:40:45,621 - MoETrainer - INFO - Training expert models...
2025-05-29 20:40:45,623 - MoETrainer - INFO - Trained expert for bin 0: 529 samples
2025-05-29 20:40:45,625 - MoETrainer - INFO - Trained expert for bin 1: 673 samples
2025-05-29 20:40:45,845 - MoETrainer - INFO - Trained expert for bin 2: 594 samples
2025-05-29 20:40:46,083 - MoETrainer - INFO - Trained expert for bin 3: 601 samples
2025-05-29 20:40:46,314 - MoETrainer - INFO - Trained expert for bin 4: 607 samples
2025-05-29 20:40:46,323 - MoETrainer - INFO - Trained expert for bin 5: 601 samples
2025-05-29 20:40:46,346 - MoETrainer - INFO -   original MoE 6 bins: RMSE=208813, MAE=120062, RÂ²=0.6039
2025-05-29 20:40:46,347 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 20:40:46,347 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:40:46,348 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:40:46,348 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:41:00,879 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:41:00,879 - MoETrainer - INFO -   1. lgb_conservative: MSE=2292195154Â±223605185, RÂ²=0.339 [SELECTED]
2025-05-29 20:41:00,880 - MoETrainer - INFO -   2. xgb_conservative: MSE=2314781824Â±238170204, RÂ²=0.364
2025-05-29 20:41:00,880 - MoETrainer - INFO -   3. ridge_light: MSE=2350123051Â±230845534, RÂ²=0.157
2025-05-29 20:41:18,146 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:41:18,146 - MoETrainer - INFO -   1. lgb_conservative: MSE=2072001530Â±41018723, RÂ²=0.318 [SELECTED]
2025-05-29 20:41:18,147 - MoETrainer - INFO -   2. rf_shallow: MSE=2072197437Â±46872278, RÂ²=0.314
2025-05-29 20:41:18,147 - MoETrainer - INFO -   3. xgb_conservative: MSE=2082037504Â±42002048, RÂ²=0.350
2025-05-29 20:41:34,016 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:41:34,016 - MoETrainer - INFO -   1. lgb_conservative: MSE=92990344180Â±3079823545, RÂ²=0.533 [SELECTED]
2025-05-29 20:41:34,017 - MoETrainer - INFO -   2. rf_shallow: MSE=93471535625Â±745885412, RÂ²=0.556
2025-05-29 20:41:34,017 - MoETrainer - INFO -   3. xgb_conservative: MSE=94155330901Â±3685950579, RÂ²=0.602
2025-05-29 20:41:34,018 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:41:34,054 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1202 samples
2025-05-29 20:41:34,091 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 1195 samples
2025-05-29 20:41:34,119 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1208 samples
2025-05-29 20:41:34,119 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 20:41:34,124 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=322566, MAE=263866, RÂ²=0.0547
2025-05-29 20:41:34,125 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:41:34,126 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:41:34,126 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:41:46,718 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:41:46,718 - MoETrainer - INFO -   1. ridge_light: MSE=1737842859Â±38349750, RÂ²=0.162 [SELECTED]
2025-05-29 20:41:46,719 - MoETrainer - INFO -   2. ridge_medium: MSE=1744908757Â±57437678, RÂ²=0.149
2025-05-29 20:41:46,719 - MoETrainer - INFO -   3. lgb_conservative: MSE=1765260494Â±57492101, RÂ²=0.359
2025-05-29 20:41:59,252 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:41:59,252 - MoETrainer - INFO -   1. ridge_heavy: MSE=749932096Â±28942301, RÂ²=0.059 [SELECTED]
2025-05-29 20:41:59,252 - MoETrainer - INFO -   2. ridge_medium: MSE=752240683Â±34855134, RÂ²=0.066
2025-05-29 20:41:59,253 - MoETrainer - INFO -   3. elastic_light: MSE=756732288Â±24301571, RÂ²=0.042
2025-05-29 20:42:11,394 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:42:11,394 - MoETrainer - INFO -   1. xgb_conservative: MSE=2099832917Â±81333906, RÂ²=0.344 [SELECTED]
2025-05-29 20:42:11,394 - MoETrainer - INFO -   2. rf_shallow: MSE=2113950337Â±57103307, RÂ²=0.297
2025-05-29 20:42:11,394 - MoETrainer - INFO -   3. lgb_conservative: MSE=2141939913Â±49175945, RÂ²=0.289
2025-05-29 20:42:24,205 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:42:24,205 - MoETrainer - INFO -   1. lgb_conservative: MSE=109113291397Â±2733001486, RÂ²=0.499 [SELECTED]
2025-05-29 20:42:24,205 - MoETrainer - INFO -   2. rf_shallow: MSE=111296773044Â±1263915990, RÂ²=0.536
2025-05-29 20:42:24,206 - MoETrainer - INFO -   3. rf_medium: MSE=113951536258Â±1055322830, RÂ²=0.784
2025-05-29 20:42:24,206 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:42:24,209 - MoETrainer - INFO - Successfully trained ridge_light for bin 0: 900 samples
2025-05-29 20:42:24,211 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 1: 896 samples
2025-05-29 20:42:24,258 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 907 samples
2025-05-29 20:42:24,282 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 3: 902 samples
2025-05-29 20:42:24,283 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 20:42:24,286 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=197576, MAE=82419, RÂ²=0.6453
2025-05-29 20:42:24,288 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:42:24,288 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:42:24,289 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:42:34,926 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:42:34,926 - MoETrainer - INFO -   1. xgb_conservative: MSE=1446151851Â±119773693, RÂ²=0.417 [SELECTED]
2025-05-29 20:42:34,926 - MoETrainer - INFO -   2. lgb_conservative: MSE=1446534352Â±114716012, RÂ²=0.376
2025-05-29 20:42:34,927 - MoETrainer - INFO -   3. ridge_light: MSE=1446806699Â±97938816, RÂ²=0.158
2025-05-29 20:42:45,696 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:42:45,697 - MoETrainer - INFO -   1. elastic_light: MSE=418947851Â±7957155, RÂ²=0.014 [SELECTED]
2025-05-29 20:42:45,697 - MoETrainer - INFO -   2. elastic_balanced: MSE=419519232Â±6939107, RÂ²=0.005
2025-05-29 20:42:45,697 - MoETrainer - INFO -   3. elastic_heavy: MSE=420093152Â±6888188, RÂ²=0.002
2025-05-29 20:42:57,716 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:42:57,716 - MoETrainer - INFO -   1. ridge_heavy: MSE=710504128Â±61865412, RÂ²=0.072 [SELECTED]
2025-05-29 20:42:57,717 - MoETrainer - INFO -   2. elastic_light: MSE=710725867Â±70879238, RÂ²=0.057
2025-05-29 20:42:57,717 - MoETrainer - INFO -   3. ridge_medium: MSE=714444395Â±48086182, RÂ²=0.083
2025-05-29 20:43:08,617 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:43:08,617 - MoETrainer - INFO -   1. ridge_heavy: MSE=2293766357Â±301700048, RÂ²=0.072 [SELECTED]
2025-05-29 20:43:08,617 - MoETrainer - INFO -   2. ridge_medium: MSE=2301482709Â±301241116, RÂ²=0.080
2025-05-29 20:43:08,618 - MoETrainer - INFO -   3. xgb_conservative: MSE=2304119552Â±304920160, RÂ²=0.352
2025-05-29 20:43:18,685 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 20:43:18,686 - MoETrainer - INFO -   1. rf_shallow: MSE=119861531832Â±14221579067, RÂ²=0.516 [SELECTED]
2025-05-29 20:43:18,686 - MoETrainer - INFO -   2. lgb_conservative: MSE=122523251612Â±17408127945, RÂ²=0.467
2025-05-29 20:43:18,686 - MoETrainer - INFO -   3. rf_medium: MSE=125252286335Â±14290200172, RÂ²=0.761
2025-05-29 20:43:18,687 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:43:18,737 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 702 samples
2025-05-29 20:43:18,739 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 735 samples
2025-05-29 20:43:18,741 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 725 samples
2025-05-29 20:43:18,743 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 722 samples
2025-05-29 20:43:19,011 - MoETrainer - INFO - Successfully trained rf_shallow for bin 4: 721 samples
2025-05-29 20:43:19,011 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 20:43:19,020 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=197128, MAE=96850, RÂ²=0.6470
2025-05-29 20:43:19,021 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:43:19,022 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:43:19,022 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:43:26,929 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:43:26,929 - MoETrainer - INFO -   1. ridge_medium: MSE=1213682197Â±139583397, RÂ²=0.097 [SELECTED]
2025-05-29 20:43:26,930 - MoETrainer - INFO -   2. xgb_conservative: MSE=1220099328Â±119851108, RÂ²=0.416
2025-05-29 20:43:26,930 - MoETrainer - INFO -   3. ridge_light: MSE=1220695275Â±134827629, RÂ²=0.106
2025-05-29 20:43:35,701 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:43:35,701 - MoETrainer - INFO -   1. elastic_light: MSE=440165632Â±25340256, RÂ²=0.011 [SELECTED]
2025-05-29 20:43:35,701 - MoETrainer - INFO -   2. ridge_heavy: MSE=440208064Â±25404245, RÂ²=0.019
2025-05-29 20:43:35,701 - MoETrainer - INFO -   3. elastic_balanced: MSE=441227424Â±25425446, RÂ²=0.003
2025-05-29 20:43:43,917 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:43:43,917 - MoETrainer - INFO -   1. ridge_heavy: MSE=428014603Â±22491804, RÂ²=0.039 [SELECTED]
2025-05-29 20:43:43,917 - MoETrainer - INFO -   2. elastic_light: MSE=428658187Â±24121504, RÂ²=0.028
2025-05-29 20:43:43,918 - MoETrainer - INFO -   3. elastic_balanced: MSE=431526507Â±27130723, RÂ²=0.011
2025-05-29 20:43:52,645 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:43:52,645 - MoETrainer - INFO -   1. ridge_heavy: MSE=780767851Â±27548117, RÂ²=0.041 [SELECTED]
2025-05-29 20:43:52,645 - MoETrainer - INFO -   2. elastic_light: MSE=781039573Â±29293264, RÂ²=0.033
2025-05-29 20:43:52,646 - MoETrainer - INFO -   3. ridge_medium: MSE=782163648Â±25554019, RÂ²=0.057
2025-05-29 20:44:01,340 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 20:44:01,340 - MoETrainer - INFO -   1. elastic_balanced: MSE=2316568491Â±211715248, RÂ²=0.029 [SELECTED]
2025-05-29 20:44:01,340 - MoETrainer - INFO -   2. elastic_light: MSE=2320115968Â±204100335, RÂ²=0.045
2025-05-29 20:44:01,340 - MoETrainer - INFO -   3. ridge_heavy: MSE=2330500139Â±197569375, RÂ²=0.055
2025-05-29 20:44:09,869 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 20:44:09,869 - MoETrainer - INFO -   1. lgb_conservative: MSE=138977976914Â±20582656960, RÂ²=0.445 [SELECTED]
2025-05-29 20:44:09,869 - MoETrainer - INFO -   2. rf_shallow: MSE=146253696460Â±24136397592, RÂ²=0.518
2025-05-29 20:44:09,870 - MoETrainer - INFO -   3. ridge_heavy: MSE=147421926741Â±14063630643, RÂ²=0.214
2025-05-29 20:44:09,870 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:44:09,872 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 529 samples
2025-05-29 20:44:09,874 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 673 samples
2025-05-29 20:44:09,876 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 594 samples
2025-05-29 20:44:09,879 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 601 samples
2025-05-29 20:44:09,881 - MoETrainer - INFO - Successfully trained elastic_balanced for bin 4: 607 samples
2025-05-29 20:44:09,903 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 5: 601 samples
2025-05-29 20:44:09,903 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 20:44:09,907 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=188256, MAE=81565, RÂ²=0.6780
2025-05-29 20:44:09,907 - MoETrainer - INFO - 
=== TESTING HYBRID DATA MANAGER ===
2025-05-29 20:44:09,907 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-29 20:44:10,603 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 20:44:10,605 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-29 20:44:10,608 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-29 20:44:10,634 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-29 20:44:13,097 - MoETrainer - INFO - Consolidated to 13 features
2025-05-29 20:44:13,127 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-29 20:44:13,128 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-29 20:44:13,129 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 20:44:13,129 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 20:44:13,131 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-29 20:44:13,133 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 20:44:13,140 - MoETrainer - INFO - Applied robust scaling
2025-05-29 20:44:13,141 - MoETrainer - INFO - Splitting data...
2025-05-29 20:44:13,143 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 20:44:13,143 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-29 20:44:13,144 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-29 20:44:13,144 - MoETrainer - INFO - Testing baseline models...
2025-05-29 20:44:13,821 - MoETrainer - INFO -   ridge: RMSE=192339, MAE=130322, RÂ²=0.5158
2025-05-29 20:44:13,822 - MoETrainer - INFO -   random_forest: RMSE=178930, MAE=120494, RÂ²=0.5810
2025-05-29 20:44:13,822 - MoETrainer - INFO -   ensemble: RMSE=180259, MAE=121381, RÂ²=0.5747
2025-05-29 20:44:13,823 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 20:44:13,823 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:44:14,020 - MoETrainer - INFO - Bin 0: Selected lgb_simple (1169 samples)
2025-05-29 20:44:14,224 - MoETrainer - INFO - Bin 1: Selected lgb_simple (1214 samples)
2025-05-29 20:44:14,440 - MoETrainer - INFO - Bin 2: Selected lgb_simple (1193 samples)
2025-05-29 20:44:14,440 - MoETrainer - INFO - Training expert models...
2025-05-29 20:44:14,451 - MoETrainer - INFO - Trained expert for bin 0: 1169 samples
2025-05-29 20:44:14,463 - MoETrainer - INFO - Trained expert for bin 1: 1214 samples
2025-05-29 20:44:14,476 - MoETrainer - INFO - Trained expert for bin 2: 1193 samples
2025-05-29 20:44:14,483 - MoETrainer - INFO -   original MoE 3 bins: RMSE=284779, MAE=250557, RÂ²=-0.0614
2025-05-29 20:44:14,485 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:44:14,654 - MoETrainer - INFO - Bin 0: Selected lgb_simple (886 samples)
2025-05-29 20:44:14,820 - MoETrainer - INFO - Bin 1: Selected lgb_simple (898 samples)
2025-05-29 20:44:15,001 - MoETrainer - INFO - Bin 2: Selected ridge_light (875 samples)
2025-05-29 20:44:15,182 - MoETrainer - INFO - Bin 3: Selected lgb_simple (917 samples)
2025-05-29 20:44:15,182 - MoETrainer - INFO - Training expert models...
2025-05-29 20:44:15,191 - MoETrainer - INFO - Trained expert for bin 0: 886 samples
2025-05-29 20:44:15,205 - MoETrainer - INFO - Trained expert for bin 1: 898 samples
2025-05-29 20:44:15,207 - MoETrainer - INFO - Trained expert for bin 2: 875 samples
2025-05-29 20:44:15,219 - MoETrainer - INFO - Trained expert for bin 3: 917 samples
2025-05-29 20:44:15,225 - MoETrainer - INFO -   original MoE 4 bins: RMSE=305281, MAE=248984, RÂ²=-0.2197
2025-05-29 20:44:15,225 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:44:15,378 - MoETrainer - INFO - Bin 0: Selected lgb_simple (701 samples)
2025-05-29 20:44:15,526 - MoETrainer - INFO - Bin 1: Selected rf_simple (722 samples)
2025-05-29 20:44:15,681 - MoETrainer - INFO - Bin 2: Selected elastic_net (721 samples)
2025-05-29 20:44:15,845 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (708 samples)
2025-05-29 20:44:16,014 - MoETrainer - INFO - Bin 4: Selected ridge_light (724 samples)
2025-05-29 20:44:16,014 - MoETrainer - INFO - Training expert models...
2025-05-29 20:44:16,025 - MoETrainer - INFO - Trained expert for bin 0: 701 samples
2025-05-29 20:44:16,177 - MoETrainer - INFO - Trained expert for bin 1: 722 samples
2025-05-29 20:44:16,180 - MoETrainer - INFO - Trained expert for bin 2: 721 samples
2025-05-29 20:44:16,182 - MoETrainer - INFO - Trained expert for bin 3: 708 samples
2025-05-29 20:44:16,184 - MoETrainer - INFO - Trained expert for bin 4: 724 samples
2025-05-29 20:44:16,194 - MoETrainer - INFO -   original MoE 5 bins: RMSE=120755, MAE=60883, RÂ²=0.8092
2025-05-29 20:44:16,195 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:44:16,337 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 20:44:16,477 - MoETrainer - INFO - Bin 1: Selected elastic_net (638 samples)
2025-05-29 20:44:16,621 - MoETrainer - INFO - Bin 2: Selected rf_simple (615 samples)
2025-05-29 20:44:16,771 - MoETrainer - INFO - Bin 3: Selected elastic_net (599 samples)
2025-05-29 20:44:16,913 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 20:44:17,069 - MoETrainer - INFO - Bin 5: Selected ridge_medium (597 samples)
2025-05-29 20:44:17,069 - MoETrainer - INFO - Training expert models...
2025-05-29 20:44:17,071 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 20:44:17,073 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 20:44:17,205 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 20:44:17,207 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 20:44:17,208 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 20:44:17,210 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 20:44:17,221 - MoETrainer - INFO -   original MoE 6 bins: RMSE=219403, MAE=168110, RÂ²=0.3700
2025-05-29 20:44:17,221 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 20:44:17,222 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:44:17,223 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:44:17,223 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:44:25,225 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:44:25,225 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.328 [SELECTED]
2025-05-29 20:44:25,225 - MoETrainer - INFO -   2. xgb_conservative: MSE=2077541205Â±59190120, RÂ²=0.354
2025-05-29 20:44:25,226 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.765
2025-05-29 20:44:33,397 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:44:33,397 - MoETrainer - INFO -   1. xgb_conservative: MSE=2069896704Â±87342816, RÂ²=0.329 [SELECTED]
2025-05-29 20:44:33,397 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.293
2025-05-29 20:44:33,397 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.293
2025-05-29 20:44:42,067 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:44:42,067 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.475 [SELECTED]
2025-05-29 20:44:42,068 - MoETrainer - INFO -   2. xgb_conservative: MSE=53316070059Â±6601910759, RÂ²=0.532
2025-05-29 20:44:42,068 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.314
2025-05-29 20:44:42,069 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:44:42,106 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-29 20:44:42,148 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-29 20:44:42,180 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-29 20:44:42,180 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 20:44:42,185 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=251305, MAE=189040, RÂ²=0.1734
2025-05-29 20:44:42,186 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:44:42,187 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:44:42,187 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:44:49,105 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:44:49,105 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.308 [SELECTED]
2025-05-29 20:44:49,105 - MoETrainer - INFO -   2. xgb_conservative: MSE=1572216363Â±100660845, RÂ²=0.352
2025-05-29 20:44:49,106 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.310
2025-05-29 20:44:55,629 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:44:55,629 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.250 [SELECTED]
2025-05-29 20:44:55,629 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.073
2025-05-29 20:44:55,630 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.252
2025-05-29 20:45:02,305 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:45:02,305 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.280 [SELECTED]
2025-05-29 20:45:02,306 - MoETrainer - INFO -   2. xgb_conservative: MSE=1889926784Â±90634533, RÂ²=0.304
2025-05-29 20:45:02,306 - MoETrainer - INFO -   3. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.660
2025-05-29 20:45:09,707 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:45:09,707 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.262 [SELECTED]
2025-05-29 20:45:09,707 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.269
2025-05-29 20:45:09,708 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.245
2025-05-29 20:45:09,708 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:45:09,737 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-29 20:45:09,761 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-29 20:45:09,942 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-29 20:45:09,944 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-29 20:45:09,945 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 20:45:09,955 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=143282, MAE=90285, RÂ²=0.7313
2025-05-29 20:45:09,956 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:45:09,956 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:45:09,956 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:45:16,005 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:45:16,005 - MoETrainer - INFO -   1. xgb_conservative: MSE=1313205248Â±101473386, RÂ²=0.355 [SELECTED]
2025-05-29 20:45:16,005 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.097
2025-05-29 20:45:16,006 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.103
2025-05-29 20:45:25,182 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:45:25,183 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=0.013 [SELECTED]
2025-05-29 20:45:25,183 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=0.019
2025-05-29 20:45:25,184 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=0.004
2025-05-29 20:45:32,114 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:45:32,115 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.302 [SELECTED]
2025-05-29 20:45:32,115 - MoETrainer - INFO -   2. xgb_conservative: MSE=741044160Â±33153857, RÂ²=0.364
2025-05-29 20:45:32,115 - MoETrainer - INFO -   3. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.303
2025-05-29 20:45:38,567 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:45:38,567 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.062 [SELECTED]
2025-05-29 20:45:38,568 - MoETrainer - INFO -   2. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.048
2025-05-29 20:45:38,568 - MoETrainer - INFO -   3. xgb_conservative: MSE=2027397973Â±150213010, RÂ²=0.337
2025-05-29 20:45:45,257 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 20:45:45,258 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.221 [SELECTED]
2025-05-29 20:45:45,258 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.234
2025-05-29 20:45:45,258 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.242
2025-05-29 20:45:45,259 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:45:45,282 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-29 20:45:45,284 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-29 20:45:45,318 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-29 20:45:45,320 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-29 20:45:45,322 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-29 20:45:45,322 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 20:45:45,329 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=220538, MAE=139225, RÂ²=0.3634
2025-05-29 20:45:45,333 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:45:45,333 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 20:45:45,333 - MoETrainer - INFO - Created expert pool with 14 models
2025-05-29 20:45:50,093 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 20:45:50,094 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.066 [SELECTED]
2025-05-29 20:45:50,094 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.049
2025-05-29 20:45:50,094 - MoETrainer - INFO -   3. xgb_conservative: MSE=1094780288Â±71825372, RÂ²=0.369
2025-05-29 20:45:55,691 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 20:45:55,691 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=0.001 [SELECTED]
2025-05-29 20:45:55,691 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=0.004
2025-05-29 20:45:55,691 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=0.013
2025-05-29 20:46:00,989 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 20:46:00,990 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.050 [SELECTED]
2025-05-29 20:46:00,990 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.064
2025-05-29 20:46:00,990 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.035
2025-05-29 20:46:06,553 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 20:46:06,553 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=0.031 [SELECTED]
2025-05-29 20:46:06,553 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=0.037
2025-05-29 20:46:06,553 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=0.015
2025-05-29 20:46:12,641 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 20:46:12,641 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.050 [SELECTED]
2025-05-29 20:46:12,641 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.058
2025-05-29 20:46:12,642 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.031
2025-05-29 20:46:18,496 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 20:46:18,496 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.214 [SELECTED]
2025-05-29 20:46:18,497 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.226
2025-05-29 20:46:18,497 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.236
2025-05-29 20:46:18,497 - MoETrainer - INFO - Training selected expert models...
2025-05-29 20:46:18,499 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-29 20:46:18,502 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-29 20:46:18,504 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-29 20:46:18,506 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-29 20:46:18,508 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-29 20:46:18,512 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-29 20:46:18,512 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 20:46:18,516 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=229903, MAE=171390, RÂ²=0.3082
2025-05-29 20:51:29,044 - MoETrainer - INFO - Using device: cpu
2025-05-29 20:51:29,045 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 20:51:29,045 - MoETrainer - INFO - Loading data...
2025-05-29 20:51:29,741 - MoETrainer - INFO - Raw data loaded: (5555, 745)
2025-05-29 20:51:29,742 - MoETrainer - INFO - Target column: Price
2025-05-29 20:51:29,742 - MoETrainer - INFO - Initial features: 744
2025-05-29 20:51:29,744 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-29 20:51:29,747 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-29 20:51:29,748 - MoETrainer - INFO - Clean features: 743
2025-05-29 20:51:29,770 - MoETrainer - INFO - Consolidating 743 features...
2025-05-29 20:51:32,252 - MoETrainer - INFO - Consolidated to 13 features
2025-05-29 20:51:32,267 - MoETrainer - INFO - Final data shape: (5555, 13)
2025-05-29 20:51:32,268 - MoETrainer - INFO - Loaded dataset: 5555 samples, 13 features
2025-05-29 20:51:32,268 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 20:51:32,269 - MoETrainer - INFO - Preprocessing data...
2025-05-29 20:51:32,271 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 20:51:32,285 - MoETrainer - INFO - Applied robust scaling
2025-05-29 20:51:32,286 - MoETrainer - INFO - Splitting data...
2025-05-29 20:51:32,290 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 20:51:32,293 - MoETrainer - INFO - Optimizing binning strategy...
2025-05-29 20:51:32,305 - MoETrainer - INFO - Optimal bins: 6, Score: 0.8626
2025-05-29 20:51:32,306 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 20:51:32,567 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 20:51:32,703 - MoETrainer - INFO - Bin 1: Selected lgb_simple (638 samples)
2025-05-29 20:51:32,838 - MoETrainer - INFO - Bin 2: Selected lgb_simple (615 samples)
2025-05-29 20:51:32,971 - MoETrainer - INFO - Bin 3: Selected ridge_light (599 samples)
2025-05-29 20:51:33,262 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 20:51:33,468 - MoETrainer - INFO - Bin 5: Selected ridge_heavy (597 samples)
2025-05-29 20:51:33,469 - MoETrainer - INFO - Training expert models...
2025-05-29 20:51:33,472 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 20:51:33,484 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 20:51:33,498 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 20:51:33,500 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 20:51:33,506 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 20:51:33,508 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 20:51:33,524 - MoETrainer - INFO - Training enhanced gating network...
2025-05-29 20:51:39,021 - MoETrainer - INFO - Epoch 0: Train=64882016256, Val=69016174592
2025-05-29 20:51:39,074 - MoETrainer - INFO - Epoch 10: Train=64859496448, Val=68832993280
2025-05-29 20:51:39,119 - MoETrainer - INFO - Epoch 20: Train=64494776320, Val=68648341504
2025-05-29 20:51:39,183 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 20:51:39,184 - MoETrainer - INFO - Overall Performance:
2025-05-29 20:51:39,184 - MoETrainer - INFO -   RMSE: 265639.0603
2025-05-29 20:51:39,184 - MoETrainer - INFO -   MAE: 202238.2344
2025-05-29 20:51:39,184 - MoETrainer - INFO -   RÂ²: 0.0765
2025-05-29 20:51:39,184 - MoETrainer - INFO -   MAPE: 45.38%
2025-05-29 20:51:39,184 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 20:51:39,184 - MoETrainer - INFO -   Bin 0: RMSE=302316.2195, RÂ²=-61.6654, Samples=178
2025-05-29 20:51:39,185 - MoETrainer - INFO -   Bin 1: RMSE=211250.5346, RÂ²=-96.3741, Samples=195
2025-05-29 20:51:39,185 - MoETrainer - INFO -   Bin 2: RMSE=149364.9079, RÂ²=-49.8334, Samples=180
2025-05-29 20:51:39,185 - MoETrainer - INFO -   Bin 3: RMSE=80283.8516, RÂ²=-7.0359, Samples=179
2025-05-29 20:51:39,185 - MoETrainer - INFO -   Bin 4: RMSE=66845.4341, RÂ²=-1.1434, Samples=172
2025-05-29 20:51:39,185 - MoETrainer - INFO -   Bin 5: RMSE=487313.4833, RÂ²=-2.1044, Samples=197
2025-05-29 20:51:39,186 - MoETrainer - INFO - 
=== VOTING Ensemble Results ===
2025-05-29 20:51:39,197 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 20:51:39,198 - MoETrainer - INFO - Overall Performance:
2025-05-29 20:51:39,198 - MoETrainer - INFO -   RMSE: 264476.7386
2025-05-29 20:51:39,198 - MoETrainer - INFO -   MAE: 201775.0193
2025-05-29 20:51:39,198 - MoETrainer - INFO -   RÂ²: 0.0845
2025-05-29 20:51:39,198 - MoETrainer - INFO -   MAPE: 45.33%
2025-05-29 20:51:39,199 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 20:51:39,199 - MoETrainer - INFO -   Bin 0: RMSE=302572.5882, RÂ²=-61.7717, Samples=178
2025-05-29 20:51:39,199 - MoETrainer - INFO -   Bin 1: RMSE=211277.4571, RÂ²=-96.3989, Samples=195
2025-05-29 20:51:39,199 - MoETrainer - INFO -   Bin 2: RMSE=149194.3152, RÂ²=-49.7174, Samples=180
2025-05-29 20:51:39,199 - MoETrainer - INFO -   Bin 3: RMSE=79864.6854, RÂ²=-6.9522, Samples=179
2025-05-29 20:51:39,199 - MoETrainer - INFO -   Bin 4: RMSE=62820.9475, RÂ²=-0.8930, Samples=172
2025-05-29 20:51:39,200 - MoETrainer - INFO -   Bin 5: RMSE=484192.6899, RÂ²=-2.0647, Samples=197
2025-05-29 20:51:39,200 - MoETrainer - INFO - 
=== STACKING Ensemble Results ===
2025-05-29 20:51:39,214 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 20:51:39,214 - MoETrainer - INFO - Overall Performance:
2025-05-29 20:51:39,214 - MoETrainer - INFO -   RMSE: 264476.7386
2025-05-29 20:51:39,215 - MoETrainer - INFO -   MAE: 201775.0193
2025-05-29 20:51:39,215 - MoETrainer - INFO -   RÂ²: 0.0845
2025-05-29 20:51:39,215 - MoETrainer - INFO -   MAPE: 45.33%
2025-05-29 20:51:39,215 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 20:51:39,216 - MoETrainer - INFO -   Bin 0: RMSE=302572.5882, RÂ²=-61.7717, Samples=178
2025-05-29 20:51:39,216 - MoETrainer - INFO -   Bin 1: RMSE=211277.4571, RÂ²=-96.3989, Samples=195
2025-05-29 20:51:39,216 - MoETrainer - INFO -   Bin 2: RMSE=149194.3152, RÂ²=-49.7174, Samples=180
2025-05-29 20:51:39,217 - MoETrainer - INFO -   Bin 3: RMSE=79864.6854, RÂ²=-6.9522, Samples=179
2025-05-29 20:51:39,217 - MoETrainer - INFO -   Bin 4: RMSE=62820.9475, RÂ²=-0.8930, Samples=172
2025-05-29 20:51:39,217 - MoETrainer - INFO -   Bin 5: RMSE=484192.6899, RÂ²=-2.0647, Samples=197
2025-05-29 20:51:39,243 - MoETrainer - INFO - Model saved to models_enhanced
2025-05-29 20:51:39,243 - MoETrainer - INFO - Training completed successfully!
2025-05-29 21:22:05,005 - MoETrainer - INFO - Using device: cpu
2025-05-29 21:22:05,006 - MoETrainer - INFO - Starting Enhanced MoE Training Pipeline
2025-05-29 21:22:05,006 - MoETrainer - INFO - Loading data...
2025-05-29 21:22:06,082 - MoETrainer - INFO - Raw data loaded: (5555, 745)
2025-05-29 21:22:06,083 - MoETrainer - INFO - Target column: Price
2025-05-29 21:22:06,083 - MoETrainer - INFO - Initial features: 744
2025-05-29 21:22:06,085 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-29 21:22:06,103 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-29 21:22:06,104 - MoETrainer - INFO - Clean features: 743
2025-05-29 21:22:06,137 - MoETrainer - INFO - Consolidating 743 features...
2025-05-29 21:22:09,474 - MoETrainer - INFO - Consolidated to 13 features
2025-05-29 21:22:09,496 - MoETrainer - INFO - Final data shape: (5555, 13)
2025-05-29 21:22:09,498 - MoETrainer - INFO - Loaded dataset: 5555 samples, 13 features
2025-05-29 21:22:09,502 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 21:22:09,504 - MoETrainer - INFO - Preprocessing data...
2025-05-29 21:22:09,509 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 21:22:09,519 - MoETrainer - INFO - Applied robust scaling
2025-05-29 21:22:09,519 - MoETrainer - INFO - Splitting data...
2025-05-29 21:22:09,524 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 21:22:09,525 - MoETrainer - INFO - Optimizing binning strategy...
2025-05-29 21:22:09,539 - MoETrainer - INFO - Optimal bins: 6, Score: 0.8626
2025-05-29 21:22:09,543 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:22:09,976 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 21:22:10,184 - MoETrainer - INFO - Bin 1: Selected lgb_simple (638 samples)
2025-05-29 21:22:10,390 - MoETrainer - INFO - Bin 2: Selected lgb_simple (615 samples)
2025-05-29 21:22:10,630 - MoETrainer - INFO - Bin 3: Selected ridge_light (599 samples)
2025-05-29 21:22:10,835 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 21:22:11,052 - MoETrainer - INFO - Bin 5: Selected ridge_heavy (597 samples)
2025-05-29 21:22:11,052 - MoETrainer - INFO - Training expert models...
2025-05-29 21:22:11,057 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 21:22:11,085 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 21:22:11,113 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 21:22:11,118 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 21:22:11,123 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 21:22:11,125 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 21:22:11,147 - MoETrainer - INFO - Training enhanced gating network...
2025-05-29 21:22:15,817 - MoETrainer - INFO - Epoch 0: Train=62706655232, Val=63503175680
2025-05-29 21:22:15,897 - MoETrainer - INFO - Epoch 10: Train=62124601344, Val=63147085824
2025-05-29 21:22:15,978 - MoETrainer - INFO - Epoch 20: Train=63092436992, Val=62800191488
2025-05-29 21:22:16,079 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 21:22:16,080 - MoETrainer - INFO - Overall Performance:
2025-05-29 21:22:16,080 - MoETrainer - INFO -   RMSE: 256656.9969
2025-05-29 21:22:16,080 - MoETrainer - INFO -   MAE: 198129.0156
2025-05-29 21:22:16,081 - MoETrainer - INFO -   RÂ²: 0.1379
2025-05-29 21:22:16,081 - MoETrainer - INFO -   MAPE: 45.11%
2025-05-29 21:22:16,081 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 21:22:16,082 - MoETrainer - INFO -   Bin 0: RMSE=302951.3535, RÂ²=-61.9290, Samples=178
2025-05-29 21:22:16,082 - MoETrainer - INFO -   Bin 1: RMSE=212124.6861, RÂ²=-97.1816, Samples=195
2025-05-29 21:22:16,083 - MoETrainer - INFO -   Bin 2: RMSE=150759.6856, RÂ²=-50.7872, Samples=180
2025-05-29 21:22:16,083 - MoETrainer - INFO -   Bin 3: RMSE=83602.1083, RÂ²=-7.7139, Samples=179
2025-05-29 21:22:16,083 - MoETrainer - INFO -   Bin 4: RMSE=59092.5836, RÂ²=-0.6750, Samples=172
2025-05-29 21:22:16,084 - MoETrainer - INFO -   Bin 5: RMSE=458822.1196, RÂ²=-1.7520, Samples=197
2025-05-29 21:22:16,084 - MoETrainer - INFO - 
=== VOTING Ensemble Results ===
2025-05-29 21:22:16,098 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 21:22:16,098 - MoETrainer - INFO - Overall Performance:
2025-05-29 21:22:16,099 - MoETrainer - INFO -   RMSE: 260079.1092
2025-05-29 21:22:16,099 - MoETrainer - INFO -   MAE: 199633.5701
2025-05-29 21:22:16,099 - MoETrainer - INFO -   RÂ²: 0.1147
2025-05-29 21:22:16,100 - MoETrainer - INFO -   MAPE: 45.19%
2025-05-29 21:22:16,100 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 21:22:16,101 - MoETrainer - INFO -   Bin 0: RMSE=302888.9706, RÂ²=-61.9031, Samples=178
2025-05-29 21:22:16,101 - MoETrainer - INFO -   Bin 1: RMSE=211708.2933, RÂ²=-96.7965, Samples=195
2025-05-29 21:22:16,101 - MoETrainer - INFO -   Bin 2: RMSE=149869.9533, RÂ²=-50.1778, Samples=180
2025-05-29 21:22:16,102 - MoETrainer - INFO -   Bin 3: RMSE=81454.0014, RÂ²=-7.2718, Samples=179
2025-05-29 21:22:16,102 - MoETrainer - INFO -   Bin 4: RMSE=59285.4778, RÂ²=-0.6860, Samples=172
2025-05-29 21:22:16,102 - MoETrainer - INFO -   Bin 5: RMSE=470272.3635, RÂ²=-1.8910, Samples=197
2025-05-29 21:22:16,103 - MoETrainer - INFO - 
=== STACKING Ensemble Results ===
2025-05-29 21:22:16,119 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-29 21:22:16,119 - MoETrainer - INFO - Overall Performance:
2025-05-29 21:22:16,120 - MoETrainer - INFO -   RMSE: 260079.1092
2025-05-29 21:22:16,122 - MoETrainer - INFO -   MAE: 199633.5701
2025-05-29 21:22:16,122 - MoETrainer - INFO -   RÂ²: 0.1147
2025-05-29 21:22:16,122 - MoETrainer - INFO -   MAPE: 45.19%
2025-05-29 21:22:16,122 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-29 21:22:16,123 - MoETrainer - INFO -   Bin 0: RMSE=302888.9706, RÂ²=-61.9031, Samples=178
2025-05-29 21:22:16,123 - MoETrainer - INFO -   Bin 1: RMSE=211708.2933, RÂ²=-96.7965, Samples=195
2025-05-29 21:22:16,123 - MoETrainer - INFO -   Bin 2: RMSE=149869.9533, RÂ²=-50.1778, Samples=180
2025-05-29 21:22:16,124 - MoETrainer - INFO -   Bin 3: RMSE=81454.0014, RÂ²=-7.2718, Samples=179
2025-05-29 21:22:16,124 - MoETrainer - INFO -   Bin 4: RMSE=59285.4778, RÂ²=-0.6860, Samples=172
2025-05-29 21:22:16,124 - MoETrainer - INFO -   Bin 5: RMSE=470272.3635, RÂ²=-1.8910, Samples=197
2025-05-29 21:22:16,140 - MoETrainer - INFO - Model saved to models_enhanced
2025-05-29 21:22:16,140 - MoETrainer - INFO - Training completed successfully!
2025-05-29 21:22:32,250 - MoETrainer - INFO - === COMPREHENSIVE COMPARISON STARTING ===
2025-05-29 21:22:32,252 - MoETrainer - INFO - 
=== TESTING ORIGINAL DATA MANAGER ===
2025-05-29 21:22:32,254 - MoETrainer - INFO - Loading data...
2025-05-29 21:22:33,399 - MoETrainer - INFO - Raw data loaded: (5555, 745)
2025-05-29 21:22:33,413 - MoETrainer - INFO - Target column: Price
2025-05-29 21:22:33,417 - MoETrainer - INFO - Initial features: 744
2025-05-29 21:22:33,425 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-29 21:22:33,443 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-29 21:22:33,462 - MoETrainer - INFO - Clean features: 743
2025-05-29 21:22:33,509 - MoETrainer - INFO - Consolidating 743 features...
2025-05-29 21:22:37,130 - MoETrainer - INFO - Consolidated to 13 features
2025-05-29 21:22:37,163 - MoETrainer - INFO - Final data shape: (5555, 13)
2025-05-29 21:22:37,164 - MoETrainer - INFO - Loaded dataset: 5555 samples, 13 features
2025-05-29 21:22:37,164 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 21:22:37,165 - MoETrainer - INFO - Preprocessing data...
2025-05-29 21:22:37,167 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 21:22:37,183 - MoETrainer - INFO - Applied robust scaling
2025-05-29 21:22:37,185 - MoETrainer - INFO - Splitting data...
2025-05-29 21:22:37,195 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 21:22:37,196 - MoETrainer - INFO - Testing baseline models...
2025-05-29 21:22:37,856 - MoETrainer - INFO -   ridge: RMSE=193173, MAE=130941, RÂ²=0.5116
2025-05-29 21:22:37,857 - MoETrainer - INFO -   random_forest: RMSE=177513, MAE=119637, RÂ²=0.5876
2025-05-29 21:22:37,858 - MoETrainer - INFO -   ensemble: RMSE=178901, MAE=120456, RÂ²=0.5811
2025-05-29 21:22:37,858 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 21:22:37,861 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:22:38,270 - MoETrainer - INFO - Bin 0: Selected lgb_simple (1169 samples)
2025-05-29 21:22:38,561 - MoETrainer - INFO - Bin 1: Selected lgb_simple (1214 samples)
2025-05-29 21:22:38,838 - MoETrainer - INFO - Bin 2: Selected lgb_simple (1193 samples)
2025-05-29 21:22:38,840 - MoETrainer - INFO - Training expert models...
2025-05-29 21:22:38,869 - MoETrainer - INFO - Trained expert for bin 0: 1169 samples
2025-05-29 21:22:38,911 - MoETrainer - INFO - Trained expert for bin 1: 1214 samples
2025-05-29 21:22:38,948 - MoETrainer - INFO - Trained expert for bin 2: 1193 samples
2025-05-29 21:22:38,955 - MoETrainer - INFO -   original MoE 3 bins: RMSE=285723, MAE=251257, RÂ²=-0.0685
2025-05-29 21:22:38,958 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:22:39,184 - MoETrainer - INFO - Bin 0: Selected lgb_simple (886 samples)
2025-05-29 21:22:39,413 - MoETrainer - INFO - Bin 1: Selected lgb_simple (898 samples)
2025-05-29 21:22:39,659 - MoETrainer - INFO - Bin 2: Selected rf_simple (875 samples)
2025-05-29 21:22:39,913 - MoETrainer - INFO - Bin 3: Selected rf_simple (917 samples)
2025-05-29 21:22:39,914 - MoETrainer - INFO - Training expert models...
2025-05-29 21:22:39,947 - MoETrainer - INFO - Trained expert for bin 0: 886 samples
2025-05-29 21:22:39,973 - MoETrainer - INFO - Trained expert for bin 1: 898 samples
2025-05-29 21:22:40,184 - MoETrainer - INFO - Trained expert for bin 2: 875 samples
2025-05-29 21:22:40,411 - MoETrainer - INFO - Trained expert for bin 3: 917 samples
2025-05-29 21:22:40,439 - MoETrainer - INFO -   original MoE 4 bins: RMSE=179833, MAE=133156, RÂ²=0.5767
2025-05-29 21:22:40,440 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:22:40,680 - MoETrainer - INFO - Bin 0: Selected rf_simple (701 samples)
2025-05-29 21:22:40,903 - MoETrainer - INFO - Bin 1: Selected rf_simple (722 samples)
2025-05-29 21:22:41,121 - MoETrainer - INFO - Bin 2: Selected lgb_simple (721 samples)
2025-05-29 21:22:41,336 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (708 samples)
2025-05-29 21:22:41,569 - MoETrainer - INFO - Bin 4: Selected rf_simple (724 samples)
2025-05-29 21:22:41,570 - MoETrainer - INFO - Training expert models...
2025-05-29 21:22:41,779 - MoETrainer - INFO - Trained expert for bin 0: 701 samples
2025-05-29 21:22:41,968 - MoETrainer - INFO - Trained expert for bin 1: 722 samples
2025-05-29 21:22:41,990 - MoETrainer - INFO - Trained expert for bin 2: 721 samples
2025-05-29 21:22:41,996 - MoETrainer - INFO - Trained expert for bin 3: 708 samples
2025-05-29 21:22:42,199 - MoETrainer - INFO - Trained expert for bin 4: 724 samples
2025-05-29 21:22:42,241 - MoETrainer - INFO -   original MoE 5 bins: RMSE=305909, MAE=226676, RÂ²=-0.2248
2025-05-29 21:22:42,242 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:22:42,454 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 21:22:42,664 - MoETrainer - INFO - Bin 1: Selected lgb_simple (638 samples)
2025-05-29 21:22:42,875 - MoETrainer - INFO - Bin 2: Selected lgb_simple (615 samples)
2025-05-29 21:22:43,088 - MoETrainer - INFO - Bin 3: Selected ridge_light (599 samples)
2025-05-29 21:22:43,297 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 21:22:43,506 - MoETrainer - INFO - Bin 5: Selected ridge_heavy (597 samples)
2025-05-29 21:22:43,507 - MoETrainer - INFO - Training expert models...
2025-05-29 21:22:43,509 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 21:22:43,541 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 21:22:43,567 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 21:22:43,570 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 21:22:43,572 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 21:22:43,580 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 21:22:43,591 - MoETrainer - INFO -   original MoE 6 bins: RMSE=184851, MAE=116906, RÂ²=0.5528
2025-05-29 21:22:43,602 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 21:22:43,604 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:22:43,605 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:22:43,605 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:22:49,864 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:22:49,864 - MoETrainer - INFO -   1. xgb_conservative: MSE=2067072256Â±91152539, RÂ²=0.162 [SELECTED]
2025-05-29 21:22:49,864 - MoETrainer - INFO -   2. xgb_balanced: MSE=2081993429Â±84814355, RÂ²=0.156
2025-05-29 21:22:49,865 - MoETrainer - INFO -   3. lgb_conservative: MSE=2082357967Â±87031102, RÂ²=0.156
2025-05-29 21:22:56,007 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:22:56,008 - MoETrainer - INFO -   1. xgb_conservative: MSE=2075272960Â±61922649, RÂ²=0.139 [SELECTED]
2025-05-29 21:22:56,009 - MoETrainer - INFO -   2. rf_shallow: MSE=2107454671Â±42839708, RÂ²=0.125
2025-05-29 21:22:56,009 - MoETrainer - INFO -   3. lgb_conservative: MSE=2118515856Â±58550874, RÂ²=0.121
2025-05-29 21:23:02,438 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:23:02,439 - MoETrainer - INFO -   1. lgb_conservative: MSE=53224036578Â±6562499679, RÂ²=0.285 [SELECTED]
2025-05-29 21:23:02,439 - MoETrainer - INFO -   2. ridge_heavy: MSE=53982306304Â±8016030072, RÂ²=0.276
2025-05-29 21:23:02,440 - MoETrainer - INFO -   3. xgb_conservative: MSE=54007271424Â±7462185814, RÂ²=0.276
2025-05-29 21:23:02,441 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:23:02,497 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1169 samples
2025-05-29 21:23:02,553 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-29 21:23:02,645 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-29 21:23:02,647 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 21:23:02,655 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=142014, MAE=82785, RÂ²=0.7360
2025-05-29 21:23:02,656 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:23:02,658 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:23:02,659 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:23:07,680 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:23:07,682 - MoETrainer - INFO -   1. xgb_conservative: MSE=1545967445Â±68170022, RÂ²=0.141 [SELECTED]
2025-05-29 21:23:07,682 - MoETrainer - INFO -   2. lgb_conservative: MSE=1553582481Â±87569483, RÂ²=0.137
2025-05-29 21:23:07,683 - MoETrainer - INFO -   3. rf_shallow: MSE=1571607916Â±100023801, RÂ²=0.127
2025-05-29 21:23:12,729 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:23:12,730 - MoETrainer - INFO -   1. ridge_medium: MSE=755851435Â±35704609, RÂ²=0.064 [SELECTED]
2025-05-29 21:23:12,730 - MoETrainer - INFO -   2. ridge_light: MSE=758557696Â±33158437, RÂ²=0.061
2025-05-29 21:23:12,731 - MoETrainer - INFO -   3. ridge_heavy: MSE=760900907Â±38614911, RÂ²=0.058
2025-05-29 21:23:17,855 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:23:17,855 - MoETrainer - INFO -   1. rf_shallow: MSE=1867756619Â±64391612, RÂ²=0.038 [SELECTED]
2025-05-29 21:23:17,855 - MoETrainer - INFO -   2. elastic_light: MSE=1871610069Â±24614202, RÂ²=0.036
2025-05-29 21:23:17,857 - MoETrainer - INFO -   3. xgb_conservative: MSE=1875422763Â±65735626, RÂ²=0.034
2025-05-29 21:23:23,301 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:23:23,302 - MoETrainer - INFO -   1. ridge_heavy: MSE=59178078208Â±5174271554, RÂ²=0.229 [SELECTED]
2025-05-29 21:23:23,302 - MoETrainer - INFO -   2. ridge_medium: MSE=59763374763Â±5354027477, RÂ²=0.221
2025-05-29 21:23:23,303 - MoETrainer - INFO -   3. ridge_light: MSE=60091098453Â±5481574595, RÂ²=0.217
2025-05-29 21:23:23,304 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:23:23,365 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 886 samples
2025-05-29 21:23:23,371 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 898 samples
2025-05-29 21:23:23,620 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-29 21:23:23,626 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-29 21:23:23,626 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 21:23:23,642 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=131710, MAE=71084, RÂ²=0.7730
2025-05-29 21:23:23,648 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:23:23,650 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:23:23,652 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:23:29,730 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:23:29,732 - MoETrainer - INFO -   1. xgb_conservative: MSE=1298187435Â±101031608, RÂ²=0.094 [SELECTED]
2025-05-29 21:23:29,732 - MoETrainer - INFO -   2. ridge_medium: MSE=1338154581Â±123521320, RÂ²=0.068
2025-05-29 21:23:29,733 - MoETrainer - INFO -   3. lgb_conservative: MSE=1339620474Â±103437411, RÂ²=0.066
2025-05-29 21:23:34,814 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:23:34,815 - MoETrainer - INFO -   1. elastic_light: MSE=450002603Â±15750746, RÂ²=-0.007 [SELECTED]
2025-05-29 21:23:34,815 - MoETrainer - INFO -   2. ridge_heavy: MSE=450619829Â±14320688, RÂ²=-0.008
2025-05-29 21:23:34,815 - MoETrainer - INFO -   3. elastic_balanced: MSE=450939243Â±17131197, RÂ²=-0.008
2025-05-29 21:23:39,330 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:23:39,330 - MoETrainer - INFO -   1. lgb_conservative: MSE=715141310Â±28168823, RÂ²=0.058 [SELECTED]
2025-05-29 21:23:39,331 - MoETrainer - INFO -   2. xgb_conservative: MSE=723986432Â±35654796, RÂ²=0.046
2025-05-29 21:23:39,331 - MoETrainer - INFO -   3. rf_shallow: MSE=728371498Â±27310415, RÂ²=0.041
2025-05-29 21:23:43,991 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:23:43,992 - MoETrainer - INFO -   1. ridge_heavy: MSE=2009116629Â±132426173, RÂ²=0.030 [SELECTED]
2025-05-29 21:23:43,993 - MoETrainer - INFO -   2. ridge_medium: MSE=2016706987Â±140891984, RÂ²=0.027
2025-05-29 21:23:43,993 - MoETrainer - INFO -   3. elastic_light: MSE=2023039872Â±127470215, RÂ²=0.024
2025-05-29 21:23:48,879 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 21:23:48,879 - MoETrainer - INFO -   1. ridge_heavy: MSE=63370514432Â±8528700329, RÂ²=0.196 [SELECTED]
2025-05-29 21:23:48,880 - MoETrainer - INFO -   2. elastic_light: MSE=63750871723Â±9508986665, RÂ²=0.193
2025-05-29 21:23:48,880 - MoETrainer - INFO -   3. ridge_medium: MSE=64514804395Â±7158038832, RÂ²=0.178
2025-05-29 21:23:48,881 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:23:48,942 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-29 21:23:48,946 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-29 21:23:49,095 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-29 21:23:49,101 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-29 21:23:49,109 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 4: 724 samples
2025-05-29 21:23:49,112 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 21:23:49,126 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=119289, MAE=60592, RÂ²=0.8138
2025-05-29 21:23:49,129 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:23:49,130 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:23:49,130 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:23:53,104 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:23:53,105 - MoETrainer - INFO -   1. xgb_conservative: MSE=1076277461Â±76173381, RÂ²=0.044 [SELECTED]
2025-05-29 21:23:53,105 - MoETrainer - INFO -   2. ridge_heavy: MSE=1088950101Â±73274682, RÂ²=0.033
2025-05-29 21:23:53,106 - MoETrainer - INFO -   3. rf_shallow: MSE=1093751961Â±83778989, RÂ²=0.029
2025-05-29 21:23:57,580 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:23:57,581 - MoETrainer - INFO -   1. elastic_heavy: MSE=435418635Â±13280305, RÂ²=-0.001 [SELECTED]
2025-05-29 21:23:57,581 - MoETrainer - INFO -   2. elastic_balanced: MSE=436443947Â±13809645, RÂ²=-0.004
2025-05-29 21:23:57,582 - MoETrainer - INFO -   3. lgb_conservative: MSE=440194661Â±14756072, RÂ²=-0.012
2025-05-29 21:24:01,951 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:24:01,951 - MoETrainer - INFO -   1. ridge_medium: MSE=431316885Â±1791642, RÂ²=0.034 [SELECTED]
2025-05-29 21:24:01,952 - MoETrainer - INFO -   2. ridge_light: MSE=432205728Â±1488841, RÂ²=0.032
2025-05-29 21:24:01,952 - MoETrainer - INFO -   3. ridge_heavy: MSE=433315861Â±6494829, RÂ²=0.030
2025-05-29 21:24:06,245 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:24:06,246 - MoETrainer - INFO -   1. elastic_light: MSE=779803648Â±41272382, RÂ²=-0.007 [SELECTED]
2025-05-29 21:24:06,247 - MoETrainer - INFO -   2. ridge_heavy: MSE=779867712Â±40621660, RÂ²=-0.007
2025-05-29 21:24:06,248 - MoETrainer - INFO -   3. elastic_balanced: MSE=785369643Â±38112666, RÂ²=-0.015
2025-05-29 21:24:10,413 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 21:24:10,413 - MoETrainer - INFO -   1. elastic_light: MSE=2057194368Â±74029301, RÂ²=0.026 [SELECTED]
2025-05-29 21:24:10,414 - MoETrainer - INFO -   2. ridge_heavy: MSE=2059406165Â±73173751, RÂ²=0.025
2025-05-29 21:24:10,414 - MoETrainer - INFO -   3. elastic_balanced: MSE=2074405931Â±62806202, RÂ²=0.018
2025-05-29 21:24:14,952 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 21:24:14,953 - MoETrainer - INFO -   1. ridge_heavy: MSE=64971011413Â±7742270042, RÂ²=0.180 [SELECTED]
2025-05-29 21:24:14,953 - MoETrainer - INFO -   2. elastic_light: MSE=65569656832Â±7278452673, RÂ²=0.172
2025-05-29 21:24:14,954 - MoETrainer - INFO -   3. ridge_medium: MSE=65966043136Â±7725607677, RÂ²=0.167
2025-05-29 21:24:14,956 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:24:15,001 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 531 samples
2025-05-29 21:24:15,007 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-29 21:24:15,011 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-05-29 21:24:15,015 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-29 21:24:15,020 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-29 21:24:15,030 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 5: 597 samples
2025-05-29 21:24:15,031 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 21:24:15,037 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=111778, MAE=55778, RÂ²=0.8365
2025-05-29 21:24:15,041 - MoETrainer - INFO - 
=== TESTING IMPROVED DATA MANAGER ===
2025-05-29 21:24:15,042 - MoETrainer - INFO - Loading data with improved processing...
2025-05-29 21:24:16,128 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 21:24:16,130 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-29 21:24:16,134 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-29 21:24:16,371 - MoETrainer - INFO - Feature types: 7 numeric, 736 binary
2025-05-29 21:24:21,253 - MoETrainer - INFO - Processed features: 22 (from 743 original)
2025-05-29 21:24:21,254 - MoETrainer - INFO - Loaded dataset: 5555 samples, 22 features
2025-05-29 21:24:21,255 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 21:24:21,255 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 21:24:21,256 - MoETrainer - INFO - Preprocessing data with feature selection...
2025-05-29 21:24:21,257 - MoETrainer - INFO - Removed 7 outliers (0.1%)
2025-05-29 21:24:21,267 - MoETrainer - INFO - Selected 20 features from 22
2025-05-29 21:24:21,291 - MoETrainer - INFO - Applied robust scaling
2025-05-29 21:24:21,300 - MoETrainer - INFO - Splitting data...
2025-05-29 21:24:21,306 - MoETrainer - INFO - Data split - Train: 3605, Val: 833, Test: 1110
2025-05-29 21:24:21,306 - MoETrainer - INFO - Train target: mean=$550,360, std=$320,917
2025-05-29 21:24:21,307 - MoETrainer - INFO - Test target: mean=$560,582, std=$331,767
2025-05-29 21:24:21,308 - MoETrainer - INFO - Testing baseline models...
2025-05-29 21:24:23,422 - MoETrainer - INFO -   ridge: RMSE=234367, MAE=136233, RÂ²=0.5010
2025-05-29 21:24:23,423 - MoETrainer - INFO -   random_forest: RMSE=236962, MAE=137278, RÂ²=0.4899
2025-05-29 21:24:23,424 - MoETrainer - INFO -   ensemble: RMSE=232629, MAE=135005, RÂ²=0.5083
2025-05-29 21:24:23,424 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 21:24:23,425 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:24:23,955 - MoETrainer - INFO - Bin 0: Selected rf_simple (1202 samples)
2025-05-29 21:24:24,570 - MoETrainer - INFO - Bin 1: Selected rf_simple (1195 samples)
2025-05-29 21:24:25,174 - MoETrainer - INFO - Bin 2: Selected lgb_simple (1208 samples)
2025-05-29 21:24:25,175 - MoETrainer - INFO - Training expert models...
2025-05-29 21:24:25,898 - MoETrainer - INFO - Trained expert for bin 0: 1202 samples
2025-05-29 21:24:26,424 - MoETrainer - INFO - Trained expert for bin 1: 1195 samples
2025-05-29 21:24:26,455 - MoETrainer - INFO - Trained expert for bin 2: 1208 samples
2025-05-29 21:24:26,483 - MoETrainer - INFO -   original MoE 3 bins: RMSE=220152, MAE=123632, RÂ²=0.5597
2025-05-29 21:24:26,485 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:24:26,925 - MoETrainer - INFO - Bin 0: Selected lgb_simple (900 samples)
2025-05-29 21:24:27,371 - MoETrainer - INFO - Bin 1: Selected elastic_net (896 samples)
2025-05-29 21:24:27,776 - MoETrainer - INFO - Bin 2: Selected rf_simple (907 samples)
2025-05-29 21:24:28,160 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (902 samples)
2025-05-29 21:24:28,160 - MoETrainer - INFO - Training expert models...
2025-05-29 21:24:28,197 - MoETrainer - INFO - Trained expert for bin 0: 900 samples
2025-05-29 21:24:28,203 - MoETrainer - INFO - Trained expert for bin 1: 896 samples
2025-05-29 21:24:28,637 - MoETrainer - INFO - Trained expert for bin 2: 907 samples
2025-05-29 21:24:28,641 - MoETrainer - INFO - Trained expert for bin 3: 902 samples
2025-05-29 21:24:28,662 - MoETrainer - INFO -   original MoE 4 bins: RMSE=190661, MAE=80975, RÂ²=0.6697
2025-05-29 21:24:28,669 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:24:29,115 - MoETrainer - INFO - Bin 0: Selected lgb_simple (702 samples)
2025-05-29 21:24:29,530 - MoETrainer - INFO - Bin 1: Selected rf_simple (735 samples)
2025-05-29 21:24:29,913 - MoETrainer - INFO - Bin 2: Selected elastic_net (725 samples)
2025-05-29 21:24:30,432 - MoETrainer - INFO - Bin 3: Selected rf_simple (722 samples)
2025-05-29 21:24:30,807 - MoETrainer - INFO - Bin 4: Selected lgb_simple (721 samples)
2025-05-29 21:24:30,808 - MoETrainer - INFO - Training expert models...
2025-05-29 21:24:30,842 - MoETrainer - INFO - Trained expert for bin 0: 702 samples
2025-05-29 21:24:31,212 - MoETrainer - INFO - Trained expert for bin 1: 735 samples
2025-05-29 21:24:31,215 - MoETrainer - INFO - Trained expert for bin 2: 725 samples
2025-05-29 21:24:31,589 - MoETrainer - INFO - Trained expert for bin 3: 722 samples
2025-05-29 21:24:31,643 - MoETrainer - INFO - Trained expert for bin 4: 721 samples
2025-05-29 21:24:31,678 - MoETrainer - INFO -   original MoE 5 bins: RMSE=322716, MAE=210000, RÂ²=0.0538
2025-05-29 21:24:31,680 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:24:31,965 - MoETrainer - INFO - Bin 0: Selected ridge_medium (529 samples)
2025-05-29 21:24:32,299 - MoETrainer - INFO - Bin 1: Selected elastic_net (673 samples)
2025-05-29 21:24:32,616 - MoETrainer - INFO - Bin 2: Selected rf_simple (594 samples)
2025-05-29 21:24:32,935 - MoETrainer - INFO - Bin 3: Selected rf_simple (601 samples)
2025-05-29 21:24:33,285 - MoETrainer - INFO - Bin 4: Selected rf_simple (607 samples)
2025-05-29 21:24:33,611 - MoETrainer - INFO - Bin 5: Selected lgb_simple (601 samples)
2025-05-29 21:24:33,613 - MoETrainer - INFO - Training expert models...
2025-05-29 21:24:33,617 - MoETrainer - INFO - Trained expert for bin 0: 529 samples
2025-05-29 21:24:33,628 - MoETrainer - INFO - Trained expert for bin 1: 673 samples
2025-05-29 21:24:34,075 - MoETrainer - INFO - Trained expert for bin 2: 594 samples
2025-05-29 21:24:34,393 - MoETrainer - INFO - Trained expert for bin 3: 601 samples
2025-05-29 21:24:34,732 - MoETrainer - INFO - Trained expert for bin 4: 607 samples
2025-05-29 21:24:34,752 - MoETrainer - INFO - Trained expert for bin 5: 601 samples
2025-05-29 21:24:34,794 - MoETrainer - INFO -   original MoE 6 bins: RMSE=208813, MAE=120062, RÂ²=0.6039
2025-05-29 21:24:34,794 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 21:24:34,795 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:24:34,796 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:24:34,797 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:24:47,647 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:24:47,649 - MoETrainer - INFO -   1. lgb_conservative: MSE=2292195154Â±223605185, RÂ²=0.136 [SELECTED]
2025-05-29 21:24:47,650 - MoETrainer - INFO -   2. xgb_conservative: MSE=2297763541Â±229458044, RÂ²=0.134
2025-05-29 21:24:47,651 - MoETrainer - INFO -   3. ridge_light: MSE=2350123051Â±230845534, RÂ²=0.114
2025-05-29 21:25:01,288 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:25:01,290 - MoETrainer - INFO -   1. lgb_conservative: MSE=2072001530Â±41018723, RÂ²=0.111 [SELECTED]
2025-05-29 21:25:01,291 - MoETrainer - INFO -   2. rf_shallow: MSE=2072197437Â±46872278, RÂ²=0.111
2025-05-29 21:25:01,292 - MoETrainer - INFO -   3. xgb_conservative: MSE=2073431979Â±40301471, RÂ²=0.110
2025-05-29 21:25:15,625 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:25:15,625 - MoETrainer - INFO -   1. lgb_conservative: MSE=92990344180Â±3079823545, RÂ²=0.351 [SELECTED]
2025-05-29 21:25:15,626 - MoETrainer - INFO -   2. xgb_conservative: MSE=93436979883Â±4454969526, RÂ²=0.349
2025-05-29 21:25:15,626 - MoETrainer - INFO -   3. rf_shallow: MSE=93471535625Â±745885412, RÂ²=0.347
2025-05-29 21:25:15,627 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:25:15,709 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1202 samples
2025-05-29 21:25:15,782 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 1195 samples
2025-05-29 21:25:15,844 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1208 samples
2025-05-29 21:25:15,845 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 21:25:15,854 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=205791, MAE=93868, RÂ²=0.6152
2025-05-29 21:25:15,860 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:25:15,863 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:25:15,865 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:25:27,029 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:25:27,029 - MoETrainer - INFO -   1. ridge_light: MSE=1737842859Â±38349750, RÂ²=0.125 [SELECTED]
2025-05-29 21:25:27,030 - MoETrainer - INFO -   2. ridge_medium: MSE=1744908757Â±57437678, RÂ²=0.122
2025-05-29 21:25:27,030 - MoETrainer - INFO -   3. lgb_conservative: MSE=1765260494Â±57492101, RÂ²=0.112
2025-05-29 21:25:38,444 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:25:38,447 - MoETrainer - INFO -   1. ridge_heavy: MSE=749932096Â±28942301, RÂ²=0.041 [SELECTED]
2025-05-29 21:25:38,448 - MoETrainer - INFO -   2. ridge_medium: MSE=752240683Â±34855134, RÂ²=0.038
2025-05-29 21:25:38,451 - MoETrainer - INFO -   3. elastic_light: MSE=756732288Â±24301571, RÂ²=0.032
2025-05-29 21:25:49,928 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:25:49,929 - MoETrainer - INFO -   1. rf_shallow: MSE=2113950337Â±57103307, RÂ²=0.062 [SELECTED]
2025-05-29 21:25:49,929 - MoETrainer - INFO -   2. xgb_conservative: MSE=2131094272Â±67837208, RÂ²=0.055
2025-05-29 21:25:49,930 - MoETrainer - INFO -   3. lgb_conservative: MSE=2141939913Â±49175945, RÂ²=0.050
2025-05-29 21:26:01,101 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:26:01,102 - MoETrainer - INFO -   1. lgb_conservative: MSE=109113291397Â±2733001486, RÂ²=0.304 [SELECTED]
2025-05-29 21:26:01,102 - MoETrainer - INFO -   2. rf_shallow: MSE=111296773044Â±1263915990, RÂ²=0.288
2025-05-29 21:26:01,103 - MoETrainer - INFO -   3. rf_medium: MSE=113951536258Â±1055322830, RÂ²=0.270
2025-05-29 21:26:01,104 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:26:01,109 - MoETrainer - INFO - Successfully trained ridge_light for bin 0: 900 samples
2025-05-29 21:26:01,117 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 1: 896 samples
2025-05-29 21:26:01,736 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 907 samples
2025-05-29 21:26:01,804 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 3: 902 samples
2025-05-29 21:26:01,805 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 21:26:01,825 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=197564, MAE=82270, RÂ²=0.6454
2025-05-29 21:26:01,832 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:26:01,834 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:26:01,838 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:26:11,218 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:26:11,223 - MoETrainer - INFO -   1. xgb_conservative: MSE=1445208405Â±125250115, RÂ²=0.099 [SELECTED]
2025-05-29 21:26:11,224 - MoETrainer - INFO -   2. lgb_conservative: MSE=1446534352Â±114716012, RÂ²=0.098
2025-05-29 21:26:11,226 - MoETrainer - INFO -   3. ridge_light: MSE=1446806699Â±97938816, RÂ²=0.096
2025-05-29 21:26:20,842 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:26:20,847 - MoETrainer - INFO -   1. elastic_light: MSE=418947851Â±7957155, RÂ²=0.002 [SELECTED]
2025-05-29 21:26:20,848 - MoETrainer - INFO -   2. elastic_balanced: MSE=419519232Â±6939107, RÂ²=0.001
2025-05-29 21:26:20,850 - MoETrainer - INFO -   3. elastic_heavy: MSE=420093152Â±6888188, RÂ²=-0.001
2025-05-29 21:26:31,162 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:26:31,165 - MoETrainer - INFO -   1. ridge_heavy: MSE=710504128Â±61865412, RÂ²=0.024 [SELECTED]
2025-05-29 21:26:31,165 - MoETrainer - INFO -   2. elastic_light: MSE=710725867Â±70879238, RÂ²=0.025
2025-05-29 21:26:31,165 - MoETrainer - INFO -   3. ridge_medium: MSE=714444395Â±48086182, RÂ²=0.016
2025-05-29 21:26:41,914 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:26:41,915 - MoETrainer - INFO -   1. xgb_conservative: MSE=2274640000Â±301071234, RÂ²=0.041 [SELECTED]
2025-05-29 21:26:41,915 - MoETrainer - INFO -   2. ridge_heavy: MSE=2293766357Â±301700048, RÂ²=0.033
2025-05-29 21:26:41,916 - MoETrainer - INFO -   3. ridge_medium: MSE=2301482709Â±301241116, RÂ²=0.030
2025-05-29 21:26:51,272 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 21:26:51,272 - MoETrainer - INFO -   1. rf_shallow: MSE=119861531832Â±14221579067, RÂ²=0.302 [SELECTED]
2025-05-29 21:26:51,273 - MoETrainer - INFO -   2. lgb_conservative: MSE=122523251612Â±17408127945, RÂ²=0.288
2025-05-29 21:26:51,273 - MoETrainer - INFO -   3. xgb_conservative: MSE=125000567467Â±11511682397, RÂ²=0.272
2025-05-29 21:26:51,274 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:26:51,377 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 702 samples
2025-05-29 21:26:51,385 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 735 samples
2025-05-29 21:26:51,395 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 725 samples
2025-05-29 21:26:51,523 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 3: 722 samples
2025-05-29 21:26:51,898 - MoETrainer - INFO - Successfully trained rf_shallow for bin 4: 721 samples
2025-05-29 21:26:51,899 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 21:26:51,917 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=188734, MAE=75319, RÂ²=0.6764
2025-05-29 21:26:51,924 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:26:51,924 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:26:51,926 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:26:59,095 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:26:59,096 - MoETrainer - INFO -   1. ridge_medium: MSE=1213682197Â±139583397, RÂ²=0.040 [SELECTED]
2025-05-29 21:26:59,097 - MoETrainer - INFO -   2. ridge_light: MSE=1220695275Â±134827629, RÂ²=0.034
2025-05-29 21:26:59,097 - MoETrainer - INFO -   3. ridge_heavy: MSE=1225529088Â±150460982, RÂ²=0.031
2025-05-29 21:27:07,138 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:27:07,139 - MoETrainer - INFO -   1. elastic_light: MSE=440165632Â±25340256, RÂ²=-0.001 [SELECTED]
2025-05-29 21:27:07,140 - MoETrainer - INFO -   2. ridge_heavy: MSE=440208064Â±25404245, RÂ²=-0.001
2025-05-29 21:27:07,140 - MoETrainer - INFO -   3. elastic_balanced: MSE=441227424Â±25425446, RÂ²=-0.003
2025-05-29 21:27:14,593 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:27:14,593 - MoETrainer - INFO -   1. ridge_heavy: MSE=428014603Â±22491804, RÂ²=-0.003 [SELECTED]
2025-05-29 21:27:14,594 - MoETrainer - INFO -   2. elastic_light: MSE=428658187Â±24121504, RÂ²=-0.004
2025-05-29 21:27:14,594 - MoETrainer - INFO -   3. elastic_balanced: MSE=431526507Â±27130723, RÂ²=-0.011
2025-05-29 21:27:22,119 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:27:22,120 - MoETrainer - INFO -   1. ridge_heavy: MSE=780767851Â±27548117, RÂ²=0.022 [SELECTED]
2025-05-29 21:27:22,120 - MoETrainer - INFO -   2. elastic_light: MSE=781039573Â±29293264, RÂ²=0.022
2025-05-29 21:27:22,121 - MoETrainer - INFO -   3. ridge_medium: MSE=782163648Â±25554019, RÂ²=0.020
2025-05-29 21:27:29,898 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 21:27:29,898 - MoETrainer - INFO -   1. elastic_balanced: MSE=2316568491Â±211715248, RÂ²=0.000 [SELECTED]
2025-05-29 21:27:29,899 - MoETrainer - INFO -   2. elastic_light: MSE=2320115968Â±204100335, RÂ²=-0.002
2025-05-29 21:27:29,899 - MoETrainer - INFO -   3. ridge_heavy: MSE=2330500139Â±197569375, RÂ²=-0.007
2025-05-29 21:27:38,368 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 21:27:38,371 - MoETrainer - INFO -   1. lgb_conservative: MSE=138977976914Â±20582656960, RÂ²=0.231 [SELECTED]
2025-05-29 21:27:38,373 - MoETrainer - INFO -   2. rf_shallow: MSE=146253696460Â±24136397592, RÂ²=0.192
2025-05-29 21:27:38,374 - MoETrainer - INFO -   3. ridge_heavy: MSE=147421926741Â±14063630643, RÂ²=0.181
2025-05-29 21:27:38,375 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:27:38,380 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 529 samples
2025-05-29 21:27:38,385 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 673 samples
2025-05-29 21:27:38,388 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 594 samples
2025-05-29 21:27:38,394 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 601 samples
2025-05-29 21:27:38,397 - MoETrainer - INFO - Successfully trained elastic_balanced for bin 4: 607 samples
2025-05-29 21:27:38,484 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 5: 601 samples
2025-05-29 21:27:38,486 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 21:27:38,498 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=185172, MAE=70431, RÂ²=0.6885
2025-05-29 21:27:38,499 - MoETrainer - INFO - 
=== TESTING HYBRID DATA MANAGER ===
2025-05-29 21:27:38,500 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-29 21:27:39,923 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-29 21:27:39,925 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-29 21:27:39,930 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-29 21:27:39,976 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-29 21:27:43,898 - MoETrainer - INFO - Consolidated to 13 features
2025-05-29 21:27:43,945 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-29 21:27:43,946 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-29 21:27:43,946 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-29 21:27:43,948 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-29 21:27:43,949 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-29 21:27:43,952 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-29 21:27:43,960 - MoETrainer - INFO - Applied robust scaling
2025-05-29 21:27:43,961 - MoETrainer - INFO - Splitting data...
2025-05-29 21:27:43,967 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-29 21:27:43,968 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-29 21:27:43,968 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-29 21:27:43,975 - MoETrainer - INFO - Testing baseline models...
2025-05-29 21:27:45,025 - MoETrainer - INFO -   ridge: RMSE=192339, MAE=130322, RÂ²=0.5158
2025-05-29 21:27:45,025 - MoETrainer - INFO -   random_forest: RMSE=178930, MAE=120494, RÂ²=0.5810
2025-05-29 21:27:45,026 - MoETrainer - INFO -   ensemble: RMSE=180259, MAE=121381, RÂ²=0.5747
2025-05-29 21:27:45,026 - MoETrainer - INFO - Testing MoE with original experts...
2025-05-29 21:27:45,028 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:27:45,396 - MoETrainer - INFO - Bin 0: Selected lgb_simple (1169 samples)
2025-05-29 21:27:45,830 - MoETrainer - INFO - Bin 1: Selected lgb_simple (1214 samples)
2025-05-29 21:27:46,272 - MoETrainer - INFO - Bin 2: Selected lgb_simple (1193 samples)
2025-05-29 21:27:46,273 - MoETrainer - INFO - Training expert models...
2025-05-29 21:27:46,327 - MoETrainer - INFO - Trained expert for bin 0: 1169 samples
2025-05-29 21:27:46,380 - MoETrainer - INFO - Trained expert for bin 1: 1214 samples
2025-05-29 21:27:46,426 - MoETrainer - INFO - Trained expert for bin 2: 1193 samples
2025-05-29 21:27:46,446 - MoETrainer - INFO -   original MoE 3 bins: RMSE=284779, MAE=250557, RÂ²=-0.0614
2025-05-29 21:27:46,467 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:27:46,805 - MoETrainer - INFO - Bin 0: Selected lgb_simple (886 samples)
2025-05-29 21:27:47,113 - MoETrainer - INFO - Bin 1: Selected lgb_simple (898 samples)
2025-05-29 21:27:47,462 - MoETrainer - INFO - Bin 2: Selected ridge_light (875 samples)
2025-05-29 21:27:47,926 - MoETrainer - INFO - Bin 3: Selected lgb_simple (917 samples)
2025-05-29 21:27:47,927 - MoETrainer - INFO - Training expert models...
2025-05-29 21:27:47,980 - MoETrainer - INFO - Trained expert for bin 0: 886 samples
2025-05-29 21:27:48,013 - MoETrainer - INFO - Trained expert for bin 1: 898 samples
2025-05-29 21:27:48,015 - MoETrainer - INFO - Trained expert for bin 2: 875 samples
2025-05-29 21:27:48,050 - MoETrainer - INFO - Trained expert for bin 3: 917 samples
2025-05-29 21:27:48,066 - MoETrainer - INFO -   original MoE 4 bins: RMSE=305281, MAE=248984, RÂ²=-0.2197
2025-05-29 21:27:48,072 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:27:48,403 - MoETrainer - INFO - Bin 0: Selected lgb_simple (701 samples)
2025-05-29 21:27:48,665 - MoETrainer - INFO - Bin 1: Selected rf_simple (722 samples)
2025-05-29 21:27:48,930 - MoETrainer - INFO - Bin 2: Selected elastic_net (721 samples)
2025-05-29 21:27:49,183 - MoETrainer - INFO - Bin 3: Selected ridge_heavy (708 samples)
2025-05-29 21:27:49,450 - MoETrainer - INFO - Bin 4: Selected ridge_light (724 samples)
2025-05-29 21:27:49,454 - MoETrainer - INFO - Training expert models...
2025-05-29 21:27:49,497 - MoETrainer - INFO - Trained expert for bin 0: 701 samples
2025-05-29 21:27:49,710 - MoETrainer - INFO - Trained expert for bin 1: 722 samples
2025-05-29 21:27:49,714 - MoETrainer - INFO - Trained expert for bin 2: 721 samples
2025-05-29 21:27:49,717 - MoETrainer - INFO - Trained expert for bin 3: 708 samples
2025-05-29 21:27:49,723 - MoETrainer - INFO - Trained expert for bin 4: 724 samples
2025-05-29 21:27:49,742 - MoETrainer - INFO -   original MoE 5 bins: RMSE=120755, MAE=60883, RÂ²=0.8092
2025-05-29 21:27:49,745 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:27:49,968 - MoETrainer - INFO - Bin 0: Selected elastic_net (531 samples)
2025-05-29 21:27:50,342 - MoETrainer - INFO - Bin 1: Selected elastic_net (638 samples)
2025-05-29 21:27:50,642 - MoETrainer - INFO - Bin 2: Selected rf_simple (615 samples)
2025-05-29 21:27:50,891 - MoETrainer - INFO - Bin 3: Selected elastic_net (599 samples)
2025-05-29 21:27:51,202 - MoETrainer - INFO - Bin 4: Selected elastic_net (596 samples)
2025-05-29 21:27:51,601 - MoETrainer - INFO - Bin 5: Selected ridge_medium (597 samples)
2025-05-29 21:27:51,603 - MoETrainer - INFO - Training expert models...
2025-05-29 21:27:51,616 - MoETrainer - INFO - Trained expert for bin 0: 531 samples
2025-05-29 21:27:51,633 - MoETrainer - INFO - Trained expert for bin 1: 638 samples
2025-05-29 21:27:51,908 - MoETrainer - INFO - Trained expert for bin 2: 615 samples
2025-05-29 21:27:51,912 - MoETrainer - INFO - Trained expert for bin 3: 599 samples
2025-05-29 21:27:51,916 - MoETrainer - INFO - Trained expert for bin 4: 596 samples
2025-05-29 21:27:51,918 - MoETrainer - INFO - Trained expert for bin 5: 597 samples
2025-05-29 21:27:51,943 - MoETrainer - INFO -   original MoE 6 bins: RMSE=219403, MAE=168110, RÂ²=0.3700
2025-05-29 21:27:51,944 - MoETrainer - INFO - Testing MoE with enhanced experts...
2025-05-29 21:27:51,945 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:27:51,946 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:27:51,947 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:28:00,843 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:28:00,843 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-29 21:28:00,844 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-29 21:28:00,846 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-29 21:28:09,540 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:28:09,542 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-29 21:28:09,543 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-29 21:28:09,544 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-29 21:28:18,664 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:28:18,665 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-29 21:28:18,667 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-29 21:28:18,668 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-29 21:28:18,670 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:28:19,056 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-29 21:28:19,131 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-29 21:28:19,247 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-29 21:28:19,247 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-29 21:28:19,264 - MoETrainer - INFO -   enhanced MoE 3 bins: RMSE=141212, MAE=82758, RÂ²=0.7390
2025-05-29 21:28:19,269 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:28:19,270 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:28:19,270 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:28:25,894 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:28:25,895 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-29 21:28:25,895 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-29 21:28:25,896 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-29 21:28:31,965 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:28:31,966 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-29 21:28:31,967 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-29 21:28:31,967 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-29 21:28:37,932 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:28:37,933 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-29 21:28:37,933 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-29 21:28:37,934 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-29 21:28:44,675 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:28:44,675 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-29 21:28:44,676 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-29 21:28:44,677 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-29 21:28:44,677 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:28:44,735 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-29 21:28:44,793 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-29 21:28:45,030 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-29 21:28:45,034 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-29 21:28:45,034 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-29 21:28:45,058 - MoETrainer - INFO -   enhanced MoE 4 bins: RMSE=131774, MAE=71137, RÂ²=0.7727
2025-05-29 21:28:45,059 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:28:45,060 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:28:45,060 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:28:50,287 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:28:50,288 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-29 21:28:50,289 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-29 21:28:50,290 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-29 21:28:55,475 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:28:55,477 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-29 21:28:55,477 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-29 21:28:55,480 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-29 21:29:01,109 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:29:01,112 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-29 21:29:01,118 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-29 21:29:01,120 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-29 21:29:06,393 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:29:06,394 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-29 21:29:06,394 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-29 21:29:06,395 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-29 21:29:12,001 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 21:29:12,002 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-29 21:29:12,002 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-29 21:29:12,003 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-29 21:29:12,004 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:29:12,051 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-29 21:29:12,057 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-29 21:29:12,120 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-29 21:29:12,124 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-29 21:29:12,126 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-29 21:29:12,127 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-29 21:29:12,141 - MoETrainer - INFO -   enhanced MoE 5 bins: RMSE=118989, MAE=60600, RÂ²=0.8147
2025-05-29 21:29:12,145 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-29 21:29:12,146 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-29 21:29:12,146 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-29 21:29:16,472 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-29 21:29:16,473 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-29 21:29:16,473 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-29 21:29:16,474 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-29 21:29:21,550 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-29 21:29:21,550 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-29 21:29:21,551 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-29 21:29:21,551 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-29 21:29:26,404 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-29 21:29:26,405 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-29 21:29:26,406 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-29 21:29:26,406 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-29 21:29:31,436 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-29 21:29:31,440 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-29 21:29:31,442 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-29 21:29:31,443 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-29 21:29:36,296 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-29 21:29:36,297 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-29 21:29:36,297 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-29 21:29:36,298 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-29 21:29:41,312 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-29 21:29:41,312 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-29 21:29:41,315 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-29 21:29:41,315 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-29 21:29:41,315 - MoETrainer - INFO - Training selected expert models...
2025-05-29 21:29:41,318 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-29 21:29:41,321 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-29 21:29:41,326 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-29 21:29:41,334 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-29 21:29:41,339 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-29 21:29:41,344 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-29 21:29:41,344 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-29 21:29:41,354 - MoETrainer - INFO -   enhanced MoE 6 bins: RMSE=111248, MAE=55539, RÂ²=0.8380
2025-05-30 00:23:32,125 - MoETrainer - INFO - === NEURAL GATE COMPARISON STARTING ===
2025-05-30 00:23:32,126 - MoETrainer - INFO - Loading data with Hybrid DataManager...
2025-05-30 00:23:32,126 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 00:23:32,807 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 00:23:32,816 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 00:23:32,830 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 00:23:32,859 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 00:23:35,076 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 00:23:35,105 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 00:23:35,106 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 00:23:35,107 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 00:23:35,109 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 00:23:35,109 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 00:23:35,112 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 00:23:35,119 - MoETrainer - INFO - Applied robust scaling
2025-05-30 00:23:35,120 - MoETrainer - INFO - Splitting data...
2025-05-30 00:23:35,124 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 00:23:35,125 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 00:23:35,126 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 00:23:35,127 - MoETrainer - INFO - 
=== TESTING ENHANCED MoE (BASELINE) ===
2025-05-30 00:23:35,127 - MoETrainer - INFO - Testing Enhanced MoE baseline...
2025-05-30 00:23:35,128 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:23:35,129 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:23:35,129 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:23:39,859 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:23:39,860 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-30 00:23:39,860 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-30 00:23:39,861 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-30 00:23:44,312 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:23:44,312 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-30 00:23:44,313 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-30 00:23:44,313 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-30 00:23:49,114 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:23:49,114 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-30 00:23:49,115 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-30 00:23:49,115 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-30 00:23:49,116 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:23:49,139 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-30 00:23:49,177 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-30 00:23:49,199 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-30 00:23:49,200 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 00:23:49,206 - MoETrainer - INFO -   Enhanced MoE baseline 3 bins: RMSE=141212, MAE=82758, RÂ²=0.7390
2025-05-30 00:23:49,208 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:23:49,208 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:23:49,209 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:23:52,738 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:23:52,739 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-30 00:23:52,739 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-30 00:23:52,740 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-30 00:23:56,409 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:23:56,410 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-30 00:23:56,410 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-30 00:23:56,411 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-30 00:24:00,177 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:24:00,178 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-30 00:24:00,178 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-30 00:24:00,178 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-30 00:24:04,198 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 00:24:04,198 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-30 00:24:04,199 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-30 00:24:04,199 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-30 00:24:04,200 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:24:04,218 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-30 00:24:04,237 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-30 00:24:04,403 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-30 00:24:04,406 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-30 00:24:04,406 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-30 00:24:04,416 - MoETrainer - INFO -   Enhanced MoE baseline 4 bins: RMSE=131774, MAE=71137, RÂ²=0.7727
2025-05-30 00:24:04,418 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:24:04,418 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:24:04,419 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:24:07,577 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:24:07,577 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-30 00:24:07,578 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-30 00:24:07,578 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-30 00:24:10,757 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:24:10,758 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-30 00:24:10,758 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-30 00:24:10,758 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-30 00:24:13,922 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:24:13,922 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-30 00:24:13,923 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-30 00:24:13,923 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-30 00:24:17,121 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 00:24:17,122 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-30 00:24:17,122 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-30 00:24:17,123 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-30 00:24:20,887 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 00:24:20,888 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-30 00:24:20,888 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-30 00:24:20,888 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-30 00:24:20,889 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:24:20,922 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-30 00:24:20,925 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-30 00:24:20,956 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-30 00:24:20,958 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-30 00:24:20,960 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-30 00:24:20,960 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-30 00:24:20,967 - MoETrainer - INFO -   Enhanced MoE baseline 5 bins: RMSE=118989, MAE=60600, RÂ²=0.8147
2025-05-30 00:24:20,968 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:24:20,969 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:24:20,969 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:24:23,734 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:24:23,734 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 00:24:23,735 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 00:24:23,735 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 00:24:26,670 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:24:26,670 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 00:24:26,671 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 00:24:26,671 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 00:24:29,487 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:24:29,487 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 00:24:29,488 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 00:24:29,488 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 00:24:32,375 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 00:24:32,376 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 00:24:32,376 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 00:24:32,376 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 00:24:35,296 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 00:24:35,297 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 00:24:35,297 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 00:24:35,297 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 00:24:38,327 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 00:24:38,328 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 00:24:38,328 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 00:24:38,329 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 00:24:38,329 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:24:38,332 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 00:24:38,334 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 00:24:38,337 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 00:24:38,339 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 00:24:38,342 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 00:24:38,346 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 00:24:38,347 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 00:24:38,351 - MoETrainer - INFO -   Enhanced MoE baseline 6 bins: RMSE=111248, MAE=55539, RÂ²=0.8380
2025-05-30 00:24:38,351 - MoETrainer - INFO - 
=== TESTING ENHANCED MoE + NEURAL GATE ===
2025-05-30 00:24:38,352 - MoETrainer - INFO - Testing Enhanced MoE with neural gate...
2025-05-30 00:24:38,353 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:24:38,353 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:24:38,353 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:24:42,749 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:24:42,749 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-30 00:24:42,750 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-30 00:24:42,750 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-30 00:24:47,241 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:24:47,242 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-30 00:24:47,242 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-30 00:24:47,243 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-30 00:24:52,005 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:24:52,006 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-30 00:24:52,006 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-30 00:24:52,007 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-30 00:24:52,007 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:24:52,032 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-30 00:24:52,069 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-30 00:24:52,092 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-30 00:24:52,092 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 00:24:52,117 - MoETrainer - INFO - Using device: cpu
2025-05-30 00:24:52,117 - MoETrainer - INFO - Training enhanced gating network...
2025-05-30 00:24:55,968 - MoETrainer - INFO - Epoch 0: Train=58681503744, Val=67756843008
2025-05-30 00:24:56,009 - MoETrainer - INFO - Epoch 10: Train=57867190272, Val=66801455104
2025-05-30 00:24:56,043 - MoETrainer - INFO - Epoch 20: Train=57236467712, Val=65828790272
2025-05-30 00:24:56,088 - MoETrainer - INFO - Epoch 30: Train=56677257216, Val=64825163776
2025-05-30 00:24:56,131 - MoETrainer - INFO - Epoch 40: Train=56006717440, Val=63762743296
2025-05-30 00:24:56,170 - MoETrainer - INFO - Loaded best model from epoch 49
2025-05-30 00:24:56,172 - MoETrainer - INFO -   Enhanced MoE + Neural Gate 3 bins: RMSE=248231, MAE=168246, RÂ²=0.1935
2025-05-30 00:24:56,173 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:24:56,174 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:24:56,174 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:24:59,772 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:24:59,773 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-30 00:24:59,773 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-30 00:24:59,774 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-30 00:25:03,342 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:25:03,342 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-30 00:25:03,343 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-30 00:25:03,343 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-30 00:25:07,142 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:25:07,142 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-30 00:25:07,142 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-30 00:25:07,143 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-30 00:25:11,300 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 00:25:11,300 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-30 00:25:11,301 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-30 00:25:11,301 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-30 00:25:11,302 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:25:11,321 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-30 00:25:11,342 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-30 00:25:11,621 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-30 00:25:11,624 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-30 00:25:11,624 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-30 00:25:11,673 - MoETrainer - INFO - Using device: cpu
2025-05-30 00:25:11,674 - MoETrainer - INFO - Training enhanced gating network...
2025-05-30 00:25:11,679 - MoETrainer - INFO - Epoch 0: Train=64371183616, Val=70450192384
2025-05-30 00:25:11,719 - MoETrainer - INFO - Epoch 10: Train=63975096320, Val=69987827712
2025-05-30 00:25:11,760 - MoETrainer - INFO - Epoch 20: Train=63384031232, Val=69516025856
2025-05-30 00:25:11,802 - MoETrainer - INFO - Epoch 30: Train=63322742784, Val=69035032576
2025-05-30 00:25:11,846 - MoETrainer - INFO - Epoch 40: Train=62967619584, Val=68544335872
2025-05-30 00:25:11,883 - MoETrainer - INFO - Loaded best model from epoch 49
2025-05-30 00:25:11,885 - MoETrainer - INFO -   Enhanced MoE + Neural Gate 4 bins: RMSE=262845, MAE=173307, RÂ²=0.0958
2025-05-30 00:25:11,886 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:25:11,886 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:25:11,886 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:25:14,942 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:25:14,942 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-30 00:25:14,943 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-30 00:25:14,943 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-30 00:25:18,088 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:25:18,088 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-30 00:25:18,089 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-30 00:25:18,089 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-30 00:25:21,304 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:25:21,304 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-30 00:25:21,305 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-30 00:25:21,305 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-30 00:25:24,514 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 00:25:24,514 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-30 00:25:24,515 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-30 00:25:24,515 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-30 00:25:27,972 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 00:25:27,973 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-30 00:25:27,973 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-30 00:25:27,974 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-30 00:25:27,974 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:25:28,005 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-30 00:25:28,007 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-30 00:25:28,027 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-30 00:25:28,029 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-30 00:25:28,031 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-30 00:25:28,031 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-30 00:25:28,050 - MoETrainer - INFO - Using device: cpu
2025-05-30 00:25:28,051 - MoETrainer - INFO - Training enhanced gating network...
2025-05-30 00:25:28,058 - MoETrainer - INFO - Epoch 0: Train=61136764928, Val=66508967936
2025-05-30 00:25:28,100 - MoETrainer - INFO - Epoch 10: Train=60785090560, Val=66122121216
2025-05-30 00:25:28,142 - MoETrainer - INFO - Epoch 20: Train=60601241600, Val=65732354048
2025-05-30 00:25:28,182 - MoETrainer - INFO - Epoch 30: Train=59956301824, Val=65340399616
2025-05-30 00:25:28,223 - MoETrainer - INFO - Epoch 40: Train=59600371712, Val=64948097024
2025-05-30 00:25:28,259 - MoETrainer - INFO - Loaded best model from epoch 49
2025-05-30 00:25:28,261 - MoETrainer - INFO -   Enhanced MoE + Neural Gate 5 bins: RMSE=254298, MAE=177794, RÂ²=0.1536
2025-05-30 00:25:28,262 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:25:28,263 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:25:28,263 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:25:30,974 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:25:30,974 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 00:25:30,974 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 00:25:30,975 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 00:25:34,193 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:25:34,194 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 00:25:34,194 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 00:25:34,195 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 00:25:37,182 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:25:37,183 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 00:25:37,183 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 00:25:37,183 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 00:25:40,059 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 00:25:40,059 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 00:25:40,060 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 00:25:40,060 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 00:25:42,975 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 00:25:42,975 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 00:25:42,976 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 00:25:42,976 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 00:25:46,016 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 00:25:46,016 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 00:25:46,017 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 00:25:46,017 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 00:25:46,018 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:25:46,020 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 00:25:46,023 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 00:25:46,025 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 00:25:46,029 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 00:25:46,031 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 00:25:46,033 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 00:25:46,034 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 00:25:46,040 - MoETrainer - INFO - Using device: cpu
2025-05-30 00:25:46,041 - MoETrainer - INFO - Training enhanced gating network...
2025-05-30 00:25:46,047 - MoETrainer - INFO - Epoch 0: Train=67212017664, Val=71923007488
2025-05-30 00:25:46,093 - MoETrainer - INFO - Epoch 10: Train=66737496064, Val=71483334656
2025-05-30 00:25:46,133 - MoETrainer - INFO - Epoch 20: Train=66257604608, Val=71041507328
2025-05-30 00:25:46,175 - MoETrainer - INFO - Epoch 30: Train=66192269312, Val=70599671808
2025-05-30 00:25:46,216 - MoETrainer - INFO - Epoch 40: Train=65537941504, Val=70154461184
2025-05-30 00:25:46,252 - MoETrainer - INFO - Loaded best model from epoch 49
2025-05-30 00:25:46,254 - MoETrainer - INFO -   Enhanced MoE + Neural Gate 6 bins: RMSE=267931, MAE=184216, RÂ²=0.0605
2025-05-30 00:54:27,656 - MoETrainer - INFO - === FIXED NEURAL GATE COMPARISON STARTING ===
2025-05-30 00:54:27,656 - MoETrainer - INFO - Loading data with Hybrid DataManager...
2025-05-30 00:54:27,656 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 00:54:28,372 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 00:54:28,374 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 00:54:28,377 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 00:54:28,397 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 00:54:30,795 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 00:54:30,823 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 00:54:30,828 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 00:54:30,830 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 00:54:30,831 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 00:54:30,832 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 00:54:30,840 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 00:54:30,862 - MoETrainer - INFO - Applied robust scaling
2025-05-30 00:54:30,869 - MoETrainer - INFO - Splitting data...
2025-05-30 00:54:30,873 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 00:54:30,874 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 00:54:30,874 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 00:54:30,875 - MoETrainer - INFO - 
=== TESTING FEATURE-BASED BINNING ===
2025-05-30 00:54:30,876 - MoETrainer - INFO - Testing feature-based expert assignment...
2025-05-30 00:54:30,877 - MoETrainer - INFO - Created 1 feature-based binning rules
2025-05-30 00:54:30,877 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:54:30,878 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:54:30,878 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:54:35,834 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:54:35,835 - MoETrainer - INFO -   1. lgb_conservative: MSE=15092421370Â±1925839169, RÂ²=0.546 [SELECTED]
2025-05-30 00:54:35,835 - MoETrainer - INFO -   2. xgb_conservative: MSE=15474786645Â±1567864236, RÂ²=0.533
2025-05-30 00:54:35,835 - MoETrainer - INFO -   3. xgb_balanced: MSE=15663191723Â±1367322274, RÂ²=0.526
2025-05-30 00:54:40,551 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:54:40,551 - MoETrainer - INFO -   1. xgb_balanced: MSE=21903401643Â±1876338900, RÂ²=0.510 [SELECTED]
2025-05-30 00:54:40,552 - MoETrainer - INFO -   2. rf_medium: MSE=21922542685Â±1281674973, RÂ²=0.510
2025-05-30 00:54:40,552 - MoETrainer - INFO -   3. rf_deep: MSE=22304118116Â±938567705, RÂ²=0.501
2025-05-30 00:54:45,430 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:54:45,430 - MoETrainer - INFO -   1. xgb_conservative: MSE=56332790443Â±2367071926, RÂ²=0.411 [SELECTED]
2025-05-30 00:54:45,431 - MoETrainer - INFO -   2. rf_shallow: MSE=56749990535Â±2312864697, RÂ²=0.406
2025-05-30 00:54:45,431 - MoETrainer - INFO -   3. rf_medium: MSE=57270018677Â±1788117122, RÂ²=0.401
2025-05-30 00:54:45,431 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:54:45,463 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1165 samples
2025-05-30 00:54:45,575 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 1231 samples
2025-05-30 00:54:45,618 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1180 samples
2025-05-30 00:54:45,618 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 00:54:45,633 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 00:54:45,633 - MoETrainer - INFO - Overall Performance:
2025-05-30 00:54:45,633 - MoETrainer - INFO -   RMSE: 184573.2428
2025-05-30 00:54:45,633 - MoETrainer - INFO -   MAE: 122905.7780
2025-05-30 00:54:45,634 - MoETrainer - INFO -   RÂ²: 0.5541
2025-05-30 00:54:45,634 - MoETrainer - INFO -   MAPE: 23.68%
2025-05-30 00:54:45,634 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 00:54:45,634 - MoETrainer - INFO -   Bin 0: RMSE=127246.1994, RÂ²=0.5597, Samples=362
2025-05-30 00:54:45,634 - MoETrainer - INFO -   Bin 1: RMSE=159761.8841, RÂ²=0.3925, Samples=388
2025-05-30 00:54:45,635 - MoETrainer - INFO -   Bin 2: RMSE=248891.9170, RÂ²=0.4375, Samples=351
2025-05-30 00:54:45,636 - MoETrainer - INFO - 
=== TESTING FIXED NEURAL GATE ===
2025-05-30 00:54:45,637 - MoETrainer - INFO - Testing fixed neural gate...
2025-05-30 00:54:46,974 - MoETrainer - INFO - Using device: cpu
2025-05-30 00:54:46,974 - MoETrainer - INFO - Training FIXED neural gating network...
2025-05-30 00:54:49,843 - MoETrainer - INFO - Epoch   0: Train RMSE=   63352, Val RMSE=   71983
2025-05-30 00:54:49,857 - MoETrainer - ERROR - Comparison failed: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.
2025-05-30 00:55:51,756 - MoETrainer - INFO - === FIXED NEURAL GATE COMPARISON STARTING ===
2025-05-30 00:55:51,756 - MoETrainer - INFO - Loading data with Hybrid DataManager...
2025-05-30 00:55:51,756 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 00:55:52,424 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 00:55:52,426 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 00:55:52,429 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 00:55:52,449 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 00:55:54,865 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 00:55:54,890 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 00:55:54,892 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 00:55:54,892 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 00:55:54,893 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 00:55:54,893 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 00:55:54,895 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 00:55:54,902 - MoETrainer - INFO - Applied robust scaling
2025-05-30 00:55:54,905 - MoETrainer - INFO - Splitting data...
2025-05-30 00:55:54,908 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 00:55:54,909 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 00:55:54,909 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 00:55:54,910 - MoETrainer - INFO - 
=== TESTING FEATURE-BASED BINNING ===
2025-05-30 00:55:54,910 - MoETrainer - INFO - Testing feature-based expert assignment...
2025-05-30 00:55:54,911 - MoETrainer - INFO - Created 1 feature-based binning rules
2025-05-30 00:55:54,912 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 00:55:54,913 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 00:55:54,913 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 00:56:00,434 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 00:56:00,435 - MoETrainer - INFO -   1. lgb_conservative: MSE=15092421370Â±1925839169, RÂ²=0.546 [SELECTED]
2025-05-30 00:56:00,435 - MoETrainer - INFO -   2. xgb_conservative: MSE=15474786645Â±1567864236, RÂ²=0.533
2025-05-30 00:56:00,435 - MoETrainer - INFO -   3. xgb_balanced: MSE=15663191723Â±1367322274, RÂ²=0.526
2025-05-30 00:56:05,001 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 00:56:05,002 - MoETrainer - INFO -   1. xgb_balanced: MSE=21903401643Â±1876338900, RÂ²=0.510 [SELECTED]
2025-05-30 00:56:05,002 - MoETrainer - INFO -   2. rf_medium: MSE=21922542685Â±1281674973, RÂ²=0.510
2025-05-30 00:56:05,002 - MoETrainer - INFO -   3. rf_deep: MSE=22304118116Â±938567705, RÂ²=0.501
2025-05-30 00:56:09,861 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 00:56:09,862 - MoETrainer - INFO -   1. xgb_conservative: MSE=56332790443Â±2367071926, RÂ²=0.411 [SELECTED]
2025-05-30 00:56:09,862 - MoETrainer - INFO -   2. rf_shallow: MSE=56749990535Â±2312864697, RÂ²=0.406
2025-05-30 00:56:09,862 - MoETrainer - INFO -   3. rf_medium: MSE=57270018677Â±1788117122, RÂ²=0.401
2025-05-30 00:56:09,863 - MoETrainer - INFO - Training selected expert models...
2025-05-30 00:56:09,884 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1165 samples
2025-05-30 00:56:09,997 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 1231 samples
2025-05-30 00:56:10,037 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1180 samples
2025-05-30 00:56:10,037 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 00:56:10,053 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 00:56:10,053 - MoETrainer - INFO - Overall Performance:
2025-05-30 00:56:10,053 - MoETrainer - INFO -   RMSE: 184573.2428
2025-05-30 00:56:10,053 - MoETrainer - INFO -   MAE: 122905.7780
2025-05-30 00:56:10,054 - MoETrainer - INFO -   RÂ²: 0.5541
2025-05-30 00:56:10,054 - MoETrainer - INFO -   MAPE: 23.68%
2025-05-30 00:56:10,054 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 00:56:10,055 - MoETrainer - INFO -   Bin 0: RMSE=127246.1994, RÂ²=0.5597, Samples=362
2025-05-30 00:56:10,055 - MoETrainer - INFO -   Bin 1: RMSE=159761.8841, RÂ²=0.3925, Samples=388
2025-05-30 00:56:10,055 - MoETrainer - INFO -   Bin 2: RMSE=248891.9170, RÂ²=0.4375, Samples=351
2025-05-30 00:56:10,056 - MoETrainer - INFO - 
=== TESTING FIXED NEURAL GATE ===
2025-05-30 00:56:10,056 - MoETrainer - INFO - Testing fixed neural gate...
2025-05-30 00:56:11,595 - MoETrainer - INFO - Using device: cpu
2025-05-30 00:56:11,596 - MoETrainer - INFO - Training FIXED neural gating network...
2025-05-30 00:56:14,360 - MoETrainer - INFO - Epoch   0: Train RMSE=   63351, Val RMSE=   71984
2025-05-30 00:56:14,361 - MoETrainer - INFO -          Avg expert weights: [0.250, 0.250, 0.250, 0.250]
2025-05-30 00:56:14,366 - MoETrainer - INFO - Epoch   1: Train RMSE=   63353, Val RMSE=   71983
2025-05-30 00:56:14,373 - MoETrainer - INFO - Epoch   2: Train RMSE=   63349, Val RMSE=   71983
2025-05-30 00:56:14,381 - MoETrainer - INFO - Epoch   3: Train RMSE=   63348, Val RMSE=   71983
2025-05-30 00:56:14,389 - MoETrainer - INFO - Epoch   4: Train RMSE=   63347, Val RMSE=   71983
2025-05-30 00:56:14,396 - MoETrainer - INFO - Epoch   5: Train RMSE=   63348, Val RMSE=   71983
2025-05-30 00:56:14,401 - MoETrainer - INFO - Epoch   6: Train RMSE=   63347, Val RMSE=   71982
2025-05-30 00:56:14,408 - MoETrainer - INFO - Epoch   7: Train RMSE=   63345, Val RMSE=   71982
2025-05-30 00:56:14,414 - MoETrainer - INFO - Epoch   8: Train RMSE=   63342, Val RMSE=   71982
2025-05-30 00:56:14,422 - MoETrainer - INFO - Epoch   9: Train RMSE=   63340, Val RMSE=   71982
2025-05-30 00:56:14,484 - MoETrainer - INFO - Epoch  20: Train RMSE=   63331, Val RMSE=   71980
2025-05-30 00:56:14,593 - MoETrainer - INFO - Epoch  40: Train RMSE=   63307, Val RMSE=   71975
2025-05-30 00:56:14,593 - MoETrainer - INFO -          Avg expert weights: [0.249, 0.251, 0.251, 0.249]
2025-05-30 00:56:14,704 - MoETrainer - INFO - Epoch  60: Train RMSE=   63281, Val RMSE=   71970
2025-05-30 00:56:14,808 - MoETrainer - INFO - Epoch  80: Train RMSE=   63251, Val RMSE=   71965
2025-05-30 00:56:14,809 - MoETrainer - INFO -          Avg expert weights: [0.248, 0.253, 0.252, 0.247]
2025-05-30 00:56:14,922 - MoETrainer - INFO - Loaded best model with validation RMSE: 71960
2025-05-30 00:56:14,926 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 00:56:14,927 - MoETrainer - INFO - Overall Performance:
2025-05-30 00:56:14,927 - MoETrainer - INFO -   RMSE: 175770.3112
2025-05-30 00:56:14,927 - MoETrainer - INFO -   MAE: 118270.5234
2025-05-30 00:56:14,927 - MoETrainer - INFO -   RÂ²: 0.5956
2025-05-30 00:56:14,928 - MoETrainer - INFO -   MAPE: 22.87%
2025-05-30 00:56:14,928 - MoETrainer - INFO - Gate weight statistics:
2025-05-30 00:56:14,928 - MoETrainer - INFO -   lgb_conservative: 0.247 average weight
2025-05-30 00:56:14,928 - MoETrainer - INFO -   xgb_balanced: 0.254 average weight
2025-05-30 00:56:14,929 - MoETrainer - INFO -   rf_medium: 0.253 average weight
2025-05-30 00:56:14,929 - MoETrainer - INFO -   ridge_ensemble: 0.246 average weight
2025-05-30 00:56:14,929 - MoETrainer - INFO - 
=== TESTING SIMPLE BASELINE ===
2025-05-30 00:56:14,930 - MoETrainer - INFO - Testing simple baseline...
2025-05-30 00:56:17,185 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 00:56:17,186 - MoETrainer - INFO - Overall Performance:
2025-05-30 00:56:17,186 - MoETrainer - INFO -   RMSE: 178930.1258
2025-05-30 00:56:17,186 - MoETrainer - INFO -   MAE: 120493.8892
2025-05-30 00:56:17,187 - MoETrainer - INFO -   RÂ²: 0.5810
2025-05-30 00:56:17,187 - MoETrainer - INFO -   MAPE: 23.29%
2025-05-30 00:56:17,188 - MoETrainer - ERROR - Comparison failed: 'mae_percentage'
2025-05-30 01:00:13,568 - MoETrainer - INFO - === FIXED NEURAL GATE COMPARISON STARTING ===
2025-05-30 01:00:13,568 - MoETrainer - INFO - Loading data with Hybrid DataManager...
2025-05-30 01:00:13,569 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 01:00:14,277 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 01:00:14,279 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 01:00:14,283 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 01:00:14,309 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 01:00:16,719 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 01:00:16,747 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 01:00:16,748 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 01:00:16,749 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 01:00:16,749 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 01:00:16,749 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 01:00:16,751 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 01:00:16,760 - MoETrainer - INFO - Applied robust scaling
2025-05-30 01:00:16,760 - MoETrainer - INFO - Splitting data...
2025-05-30 01:00:16,763 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 01:00:16,763 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 01:00:16,764 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 01:00:16,764 - MoETrainer - INFO - 
=== TESTING FEATURE-BASED BINNING ===
2025-05-30 01:00:16,765 - MoETrainer - INFO - Testing feature-based expert assignment...
2025-05-30 01:00:16,765 - MoETrainer - INFO - Created 1 feature-based binning rules
2025-05-30 01:00:16,766 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:00:16,767 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:00:16,767 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:00:21,512 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:00:21,512 - MoETrainer - INFO -   1. lgb_conservative: MSE=15092421370Â±1925839169, RÂ²=0.546 [SELECTED]
2025-05-30 01:00:21,513 - MoETrainer - INFO -   2. xgb_conservative: MSE=15474786645Â±1567864236, RÂ²=0.533
2025-05-30 01:00:21,513 - MoETrainer - INFO -   3. xgb_balanced: MSE=15663191723Â±1367322274, RÂ²=0.526
2025-05-30 01:00:26,246 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:00:26,247 - MoETrainer - INFO -   1. xgb_balanced: MSE=21903401643Â±1876338900, RÂ²=0.510 [SELECTED]
2025-05-30 01:00:26,247 - MoETrainer - INFO -   2. rf_medium: MSE=21922542685Â±1281674973, RÂ²=0.510
2025-05-30 01:00:26,248 - MoETrainer - INFO -   3. rf_deep: MSE=22304118116Â±938567705, RÂ²=0.501
2025-05-30 01:00:31,474 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:00:31,474 - MoETrainer - INFO -   1. xgb_conservative: MSE=56332790443Â±2367071926, RÂ²=0.411 [SELECTED]
2025-05-30 01:00:31,475 - MoETrainer - INFO -   2. rf_shallow: MSE=56749990535Â±2312864697, RÂ²=0.406
2025-05-30 01:00:31,475 - MoETrainer - INFO -   3. rf_medium: MSE=57270018677Â±1788117122, RÂ²=0.401
2025-05-30 01:00:31,476 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:00:31,502 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1165 samples
2025-05-30 01:00:31,616 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 1231 samples
2025-05-30 01:00:31,661 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1180 samples
2025-05-30 01:00:31,661 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 01:00:31,677 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:00:31,678 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:00:31,678 - MoETrainer - INFO -   RMSE: 184573.2428
2025-05-30 01:00:31,678 - MoETrainer - INFO -   MAE: 122905.7780
2025-05-30 01:00:31,678 - MoETrainer - INFO -   RÂ²: 0.5541
2025-05-30 01:00:31,679 - MoETrainer - INFO -   MAPE: 23.68%
2025-05-30 01:00:31,679 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:00:31,679 - MoETrainer - INFO -   Bin 0: RMSE=127246.1994, RÂ²=0.5597, Samples=362
2025-05-30 01:00:31,679 - MoETrainer - INFO -   Bin 1: RMSE=159761.8841, RÂ²=0.3925, Samples=388
2025-05-30 01:00:31,680 - MoETrainer - INFO -   Bin 2: RMSE=248891.9170, RÂ²=0.4375, Samples=351
2025-05-30 01:00:31,680 - MoETrainer - INFO - 
=== TESTING FIXED NEURAL GATE ===
2025-05-30 01:00:31,680 - MoETrainer - INFO - Testing fixed neural gate...
2025-05-30 01:00:33,058 - MoETrainer - INFO - Using device: cpu
2025-05-30 01:00:33,058 - MoETrainer - INFO - Training FIXED neural gating network...
2025-05-30 01:00:35,972 - MoETrainer - INFO - Epoch   0: Train RMSE=   63348, Val RMSE=   71981
2025-05-30 01:00:35,973 - MoETrainer - INFO -          Avg expert weights: [0.250, 0.250, 0.250, 0.250]
2025-05-30 01:00:35,979 - MoETrainer - INFO - Epoch   1: Train RMSE=   63347, Val RMSE=   71981
2025-05-30 01:00:35,991 - MoETrainer - INFO - Epoch   2: Train RMSE=   63347, Val RMSE=   71980
2025-05-30 01:00:35,998 - MoETrainer - INFO - Epoch   3: Train RMSE=   63345, Val RMSE=   71980
2025-05-30 01:00:36,008 - MoETrainer - INFO - Epoch   4: Train RMSE=   63345, Val RMSE=   71980
2025-05-30 01:00:36,014 - MoETrainer - INFO - Epoch   5: Train RMSE=   63344, Val RMSE=   71980
2025-05-30 01:00:36,022 - MoETrainer - INFO - Epoch   6: Train RMSE=   63346, Val RMSE=   71979
2025-05-30 01:00:36,030 - MoETrainer - INFO - Epoch   7: Train RMSE=   63341, Val RMSE=   71979
2025-05-30 01:00:36,035 - MoETrainer - INFO - Epoch   8: Train RMSE=   63339, Val RMSE=   71979
2025-05-30 01:00:36,045 - MoETrainer - INFO - Epoch   9: Train RMSE=   63339, Val RMSE=   71979
2025-05-30 01:00:36,112 - MoETrainer - INFO - Epoch  20: Train RMSE=   63331, Val RMSE=   71976
2025-05-30 01:00:36,225 - MoETrainer - INFO - Epoch  40: Train RMSE=   63306, Val RMSE=   71970
2025-05-30 01:00:36,226 - MoETrainer - INFO -          Avg expert weights: [0.249, 0.252, 0.251, 0.249]
2025-05-30 01:00:36,349 - MoETrainer - INFO - Epoch  60: Train RMSE=   63278, Val RMSE=   71965
2025-05-30 01:00:36,470 - MoETrainer - INFO - Epoch  80: Train RMSE=   63250, Val RMSE=   71958
2025-05-30 01:00:36,470 - MoETrainer - INFO -          Avg expert weights: [0.247, 0.253, 0.251, 0.248]
2025-05-30 01:00:36,588 - MoETrainer - INFO - Loaded best model with validation RMSE: 71951
2025-05-30 01:00:36,593 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:00:36,593 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:00:36,593 - MoETrainer - INFO -   RMSE: 175789.8906
2025-05-30 01:00:36,594 - MoETrainer - INFO -   MAE: 118280.8359
2025-05-30 01:00:36,594 - MoETrainer - INFO -   RÂ²: 0.5956
2025-05-30 01:00:36,594 - MoETrainer - INFO -   MAPE: 22.87%
2025-05-30 01:00:36,594 - MoETrainer - INFO - Gate weight statistics:
2025-05-30 01:00:36,595 - MoETrainer - INFO -   lgb_conservative: 0.246 average weight
2025-05-30 01:00:36,595 - MoETrainer - INFO -   xgb_balanced: 0.255 average weight
2025-05-30 01:00:36,595 - MoETrainer - INFO -   rf_medium: 0.252 average weight
2025-05-30 01:00:36,596 - MoETrainer - INFO -   ridge_ensemble: 0.248 average weight
2025-05-30 01:00:36,597 - MoETrainer - INFO - 
=== TESTING SIMPLE BASELINE ===
2025-05-30 01:00:36,598 - MoETrainer - INFO - Testing simple baseline...
2025-05-30 01:00:38,364 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:00:38,365 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:00:38,365 - MoETrainer - INFO -   RMSE: 178930.1258
2025-05-30 01:00:38,366 - MoETrainer - INFO -   MAE: 120493.8892
2025-05-30 01:00:38,366 - MoETrainer - INFO -   RÂ²: 0.5810
2025-05-30 01:00:38,366 - MoETrainer - INFO -   MAPE: 23.29%
2025-05-30 01:12:42,658 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-05-30 01:12:42,658 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-05-30 01:12:42,659 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 01:12:43,324 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 01:12:43,326 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 01:12:43,331 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 01:12:43,353 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 01:12:45,824 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 01:12:45,856 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 01:12:45,857 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 01:12:45,857 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 01:12:45,858 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 01:12:45,858 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 01:12:45,860 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 01:12:45,872 - MoETrainer - INFO - Applied robust scaling
2025-05-30 01:12:45,872 - MoETrainer - INFO - Splitting data...
2025-05-30 01:12:45,875 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 01:12:45,875 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 01:12:45,875 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 01:12:45,876 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-30 01:12:45,876 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:12:45,877 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:12:45,877 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:12:51,465 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:12:51,465 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-30 01:12:51,466 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-30 01:12:51,466 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-30 01:12:56,414 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:12:56,415 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-30 01:12:56,415 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-30 01:12:56,415 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-30 01:13:01,679 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:13:01,680 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-30 01:13:01,680 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-30 01:13:01,681 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-30 01:13:01,681 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:13:01,708 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-30 01:13:01,752 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-30 01:13:01,774 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-30 01:13:01,774 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 01:13:01,784 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-05-30 01:13:01,785 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:13:01,785 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:13:01,786 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:13:06,409 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:13:06,409 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-30 01:13:06,409 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-30 01:13:06,410 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-30 01:13:10,449 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:13:10,449 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-30 01:13:10,450 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-30 01:13:10,450 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-30 01:13:14,417 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:13:14,418 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-30 01:13:14,418 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-30 01:13:14,418 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-30 01:13:18,800 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:13:18,800 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-30 01:13:18,801 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-30 01:13:18,801 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-30 01:13:18,801 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:13:18,824 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-30 01:13:18,854 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-30 01:13:19,045 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-30 01:13:19,048 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-30 01:13:19,048 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-30 01:13:19,061 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-05-30 01:13:19,062 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:13:19,063 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:13:19,063 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:13:22,601 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:13:22,601 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-30 01:13:22,602 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-30 01:13:22,602 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-30 01:13:25,798 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:13:25,798 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-30 01:13:25,799 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-30 01:13:25,799 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-30 01:13:29,013 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:13:29,013 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-30 01:13:29,014 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-30 01:13:29,014 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-30 01:13:32,414 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:13:32,414 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-30 01:13:32,415 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-30 01:13:32,415 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-30 01:13:35,843 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:13:35,844 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-30 01:13:35,844 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-30 01:13:35,844 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-30 01:13:35,845 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:13:35,876 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-30 01:13:35,879 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-30 01:13:35,900 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-30 01:13:35,902 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-30 01:13:35,905 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-30 01:13:35,907 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-30 01:13:35,913 - MoETrainer - INFO -   5 bins: RÂ²=0.8147, RMSE=$118,989
2025-05-30 01:13:35,914 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:13:35,915 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:13:35,915 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:13:38,499 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:13:38,499 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:13:38,499 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:13:38,500 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:13:41,667 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:13:41,667 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:13:41,667 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:13:41,668 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:13:44,482 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:13:44,482 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:13:44,483 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:13:44,483 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:13:47,373 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:13:47,374 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:13:47,374 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:13:47,375 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:13:50,279 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:13:50,280 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:13:50,280 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:13:50,281 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:13:53,341 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:13:53,341 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:13:53,342 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:13:53,342 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:13:53,343 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:13:53,344 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:13:53,346 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:13:53,348 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:13:53,351 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:13:53,354 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:13:53,359 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:13:53,359 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:13:53,362 - MoETrainer - INFO -   6 bins: RÂ²=0.8380, RMSE=$111,248
2025-05-30 01:13:53,363 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-05-30 01:13:53,363 - MoETrainer - INFO - Training final model with 6 bins...
2025-05-30 01:13:53,365 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:13:53,365 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:13:53,365 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:13:57,704 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:13:57,705 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:13:57,705 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:13:57,706 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:14:01,182 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:14:01,182 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:14:01,182 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:14:01,183 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:14:05,798 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:14:05,798 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:14:05,799 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:14:05,799 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:14:09,410 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:14:09,411 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:14:09,411 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:14:09,412 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:14:12,955 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:14:12,956 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:14:12,956 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:14:12,956 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:14:16,128 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:14:16,129 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:14:16,129 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:14:16,130 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:14:16,130 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:14:16,132 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:14:16,134 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:14:16,136 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:14:16,139 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:14:16,141 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:14:16,146 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:14:16,147 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:14:16,150 - MoETrainer - INFO - Final Expert Configuration:
2025-05-30 01:14:16,150 - MoETrainer - INFO -   Bin 0: ridge_heavy
2025-05-30 01:14:16,151 - MoETrainer - INFO -   Bin 1: elastic_heavy
2025-05-30 01:14:16,151 - MoETrainer - INFO -   Bin 2: ridge_heavy
2025-05-30 01:14:16,152 - MoETrainer - INFO -   Bin 3: elastic_light
2025-05-30 01:14:16,152 - MoETrainer - INFO -   Bin 4: elastic_light
2025-05-30 01:14:16,152 - MoETrainer - INFO -   Bin 5: elastic_light
2025-05-30 01:14:16,153 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-05-30 01:14:16,153 - MoETrainer - INFO - Final Performance: RÂ² = 0.8380
2025-05-30 01:14:16,153 - MoETrainer - INFO - Final RMSE: $111,248
2025-05-30 01:14:16,154 - MoETrainer - INFO - Final MAE: $55,539
2025-05-30 01:22:13,175 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-05-30 01:22:13,175 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-05-30 01:22:13,175 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 01:22:13,851 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 01:22:13,854 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 01:22:13,857 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 01:22:13,882 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 01:22:16,380 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 01:22:16,411 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 01:22:16,411 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 01:22:16,412 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 01:22:16,412 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 01:22:16,413 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 01:22:16,414 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 01:22:16,423 - MoETrainer - INFO - Applied robust scaling
2025-05-30 01:22:16,423 - MoETrainer - INFO - Splitting data...
2025-05-30 01:22:16,426 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 01:22:16,426 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 01:22:16,427 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 01:22:16,427 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-30 01:22:16,429 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:22:16,430 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:22:16,433 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:22:21,263 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:22:21,263 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-30 01:22:21,264 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-30 01:22:21,264 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-30 01:22:25,858 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:22:25,858 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-30 01:22:25,858 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-30 01:22:25,859 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-30 01:22:30,907 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:22:30,907 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-30 01:22:30,907 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-30 01:22:30,908 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-30 01:22:30,908 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:22:30,930 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-30 01:22:30,975 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-30 01:22:30,997 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-30 01:22:30,998 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 01:22:31,006 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-05-30 01:22:31,007 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:22:31,008 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:22:31,008 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:22:34,622 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:22:34,623 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-30 01:22:34,623 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-30 01:22:34,623 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-30 01:22:38,791 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:22:38,791 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-30 01:22:38,792 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-30 01:22:38,792 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-30 01:22:42,629 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:22:42,630 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-30 01:22:42,630 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-30 01:22:42,631 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-30 01:22:46,873 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:22:46,874 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-30 01:22:46,874 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-30 01:22:46,874 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-30 01:22:46,875 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:22:46,896 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-30 01:22:46,919 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-30 01:22:47,099 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-30 01:22:47,101 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-30 01:22:47,102 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-30 01:22:47,111 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-05-30 01:22:47,112 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:22:47,112 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:22:47,112 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:22:50,382 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:22:50,383 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-30 01:22:50,383 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-30 01:22:50,384 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-30 01:22:53,889 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:22:53,889 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-30 01:22:53,889 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-30 01:22:53,890 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-30 01:22:57,944 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:22:57,944 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-30 01:22:57,945 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-30 01:22:57,946 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-30 01:23:01,609 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:23:01,610 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-30 01:23:01,610 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-30 01:23:01,610 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-30 01:23:05,970 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:23:05,970 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-30 01:23:05,971 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-30 01:23:05,971 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-30 01:23:05,972 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:23:06,019 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-30 01:23:06,023 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-30 01:23:06,067 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-30 01:23:06,070 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-30 01:23:06,072 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-30 01:23:06,072 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-30 01:23:06,078 - MoETrainer - INFO -   5 bins: RÂ²=0.8147, RMSE=$118,989
2025-05-30 01:23:06,078 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:23:06,079 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:23:06,079 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:23:09,295 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:23:09,295 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:23:09,295 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:23:09,296 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:23:12,949 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:23:12,950 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:23:12,950 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:23:12,950 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:23:16,183 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:23:16,183 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:23:16,183 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:23:16,184 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:23:19,578 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:23:19,578 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:23:19,579 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:23:19,579 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:23:23,023 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:23:23,023 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:23:23,023 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:23:23,024 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:23:27,093 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:23:27,094 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:23:27,094 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:23:27,094 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:23:27,095 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:23:27,096 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:23:27,098 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:23:27,100 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:23:27,102 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:23:27,104 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:23:27,109 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:23:27,109 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:23:27,113 - MoETrainer - INFO -   6 bins: RÂ²=0.8380, RMSE=$111,248
2025-05-30 01:23:27,113 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-05-30 01:23:27,115 - MoETrainer - INFO - Training final model with 6 bins...
2025-05-30 01:23:27,116 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:23:27,117 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:23:27,117 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:23:29,901 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:23:29,902 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:23:29,902 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:23:29,903 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:23:32,912 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:23:32,913 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:23:32,913 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:23:32,913 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:23:35,919 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:23:35,919 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:23:35,920 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:23:35,920 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:23:39,137 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:23:39,137 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:23:39,138 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:23:39,138 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:23:42,166 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:23:42,166 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:23:42,167 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:23:42,167 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:23:47,205 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:23:47,208 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:23:47,210 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:23:47,211 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:23:47,213 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:23:47,241 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:23:47,279 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:23:47,312 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:23:47,328 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:23:47,339 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:23:47,345 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:23:47,347 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:23:47,371 - MoETrainer - INFO - Final Expert Configuration:
2025-05-30 01:23:47,372 - MoETrainer - INFO -   Bin 0: ridge_heavy
2025-05-30 01:23:47,373 - MoETrainer - INFO -   Bin 1: elastic_heavy
2025-05-30 01:23:47,374 - MoETrainer - INFO -   Bin 2: ridge_heavy
2025-05-30 01:23:47,375 - MoETrainer - INFO -   Bin 3: elastic_light
2025-05-30 01:23:47,375 - MoETrainer - INFO -   Bin 4: elastic_light
2025-05-30 01:23:47,376 - MoETrainer - INFO -   Bin 5: elastic_light
2025-05-30 01:23:47,377 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-05-30 01:23:47,377 - MoETrainer - INFO - Final Performance: RÂ² = 0.8380
2025-05-30 01:23:47,380 - MoETrainer - INFO - Final RMSE: $111,248
2025-05-30 01:23:47,380 - MoETrainer - INFO - Final MAE: $55,539
2025-05-30 01:28:55,201 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-05-30 01:28:55,202 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-05-30 01:28:55,202 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 01:28:55,948 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 01:28:55,950 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 01:28:55,954 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 01:28:55,985 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 01:28:58,443 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 01:28:58,469 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 01:28:58,471 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 01:28:58,472 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 01:28:58,472 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 01:28:58,473 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 01:28:58,476 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 01:28:58,485 - MoETrainer - INFO - Applied robust scaling
2025-05-30 01:28:58,485 - MoETrainer - INFO - Splitting data...
2025-05-30 01:28:58,488 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 01:28:58,489 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 01:28:58,489 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 01:28:58,490 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-30 01:28:58,491 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:28:58,492 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:28:58,493 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:29:03,527 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:29:03,527 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-30 01:29:03,528 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-30 01:29:03,528 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-30 01:29:08,357 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:29:08,357 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-30 01:29:08,358 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-30 01:29:08,358 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-30 01:29:13,760 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:29:13,760 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-30 01:29:13,761 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-30 01:29:13,761 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-30 01:29:13,762 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:29:13,785 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-30 01:29:13,826 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-30 01:29:13,850 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-30 01:29:13,851 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 01:29:13,864 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:29:13,864 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:29:13,864 - MoETrainer - INFO -   RMSE: 141212.4705
2025-05-30 01:29:13,865 - MoETrainer - INFO -   MAE: 82757.5135
2025-05-30 01:29:13,865 - MoETrainer - INFO -   RÂ²: 0.7390
2025-05-30 01:29:13,865 - MoETrainer - INFO -   MAPE: 14.13%
2025-05-30 01:29:13,865 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:29:13,866 - MoETrainer - INFO -   Bin 0: RMSE=50404.7567, RÂ²=0.1927, Samples=373
2025-05-30 01:29:13,866 - MoETrainer - INFO -   Bin 1: RMSE=43955.6581, RÂ²=0.1187, Samples=359
2025-05-30 01:29:13,866 - MoETrainer - INFO -   Bin 2: RMSE=234628.9036, RÂ²=0.2994, Samples=369
2025-05-30 01:29:13,866 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-05-30 01:29:13,867 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:29:13,867 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:29:13,868 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:29:18,329 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:29:18,329 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-30 01:29:18,330 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-30 01:29:18,330 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-30 01:29:22,217 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:29:22,217 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-30 01:29:22,217 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-30 01:29:22,218 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-30 01:29:26,195 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:29:26,196 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-30 01:29:26,196 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-30 01:29:26,196 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-30 01:29:30,790 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:29:30,790 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-30 01:29:30,791 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-30 01:29:30,791 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-30 01:29:30,792 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:29:30,813 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-30 01:29:30,834 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-30 01:29:31,014 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-30 01:29:31,016 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-30 01:29:31,016 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-30 01:29:31,036 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:29:31,039 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:29:31,039 - MoETrainer - INFO -   RMSE: 131773.6979
2025-05-30 01:29:31,039 - MoETrainer - INFO -   MAE: 71136.8624
2025-05-30 01:29:31,040 - MoETrainer - INFO -   RÂ²: 0.7727
2025-05-30 01:29:31,040 - MoETrainer - INFO -   MAPE: 11.60%
2025-05-30 01:29:31,040 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:29:31,041 - MoETrainer - INFO -   Bin 0: RMSE=44408.6343, RÂ²=0.1239, Samples=272
2025-05-30 01:29:31,041 - MoETrainer - INFO -   Bin 1: RMSE=28491.5132, RÂ²=0.0200, Samples=281
2025-05-30 01:29:31,041 - MoETrainer - INFO -   Bin 2: RMSE=40906.3907, RÂ²=0.1414, Samples=253
2025-05-30 01:29:31,041 - MoETrainer - INFO -   Bin 3: RMSE=246536.8572, RÂ²=0.2252, Samples=295
2025-05-30 01:29:31,042 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-05-30 01:29:31,042 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:29:31,043 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:29:31,043 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:29:34,381 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:29:34,381 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-30 01:29:34,382 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-30 01:29:34,382 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-30 01:29:38,300 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:29:38,301 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-30 01:29:38,301 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-30 01:29:38,302 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-30 01:29:41,809 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:29:41,810 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-30 01:29:41,810 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-30 01:29:41,810 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-30 01:29:45,481 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:29:45,482 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-30 01:29:45,482 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-30 01:29:45,482 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-30 01:29:49,306 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:29:49,306 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-30 01:29:49,307 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-30 01:29:49,307 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-30 01:29:49,308 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:29:49,340 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-30 01:29:49,342 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-30 01:29:49,361 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-30 01:29:49,364 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-30 01:29:49,366 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-30 01:29:49,366 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-30 01:29:49,381 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:29:49,381 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:29:49,382 - MoETrainer - INFO -   RMSE: 118989.3498
2025-05-30 01:29:49,382 - MoETrainer - INFO -   MAE: 60600.3087
2025-05-30 01:29:49,386 - MoETrainer - INFO -   RÂ²: 0.8147
2025-05-30 01:29:49,386 - MoETrainer - INFO -   MAPE: 9.61%
2025-05-30 01:29:49,386 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:29:49,387 - MoETrainer - INFO -   Bin 0: RMSE=40645.8562, RÂ²=0.0942, Samples=223
2025-05-30 01:29:49,389 - MoETrainer - INFO -   Bin 1: RMSE=19773.5884, RÂ²=0.0186, Samples=215
2025-05-30 01:29:49,389 - MoETrainer - INFO -   Bin 2: RMSE=28330.5392, RÂ²=-0.1027, Samples=233
2025-05-30 01:29:49,390 - MoETrainer - INFO -   Bin 3: RMSE=45827.7211, RÂ²=0.0380, Samples=201
2025-05-30 01:29:49,390 - MoETrainer - INFO -   Bin 4: RMSE=251865.0508, RÂ²=0.1874, Samples=229
2025-05-30 01:29:49,390 - MoETrainer - INFO -   5 bins: RÂ²=0.8147, RMSE=$118,989
2025-05-30 01:29:49,391 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:29:49,391 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:29:49,392 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:29:52,482 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:29:52,483 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:29:52,483 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:29:52,483 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:29:55,754 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:29:55,755 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:29:55,755 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:29:55,756 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:29:58,759 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:29:58,759 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:29:58,760 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:29:58,761 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:30:01,795 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:30:01,796 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:30:01,796 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:30:01,797 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:30:04,915 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:30:04,915 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:30:04,916 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:30:04,916 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:30:08,386 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:30:08,386 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:30:08,387 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:30:08,387 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:30:08,388 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:30:08,390 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:30:08,391 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:30:08,394 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:30:08,397 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:30:08,401 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:30:08,404 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:30:08,404 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:30:08,422 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:30:08,423 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:30:08,423 - MoETrainer - INFO -   RMSE: 111248.4396
2025-05-30 01:30:08,423 - MoETrainer - INFO -   MAE: 55539.2363
2025-05-30 01:30:08,424 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-30 01:30:08,424 - MoETrainer - INFO -   MAPE: 8.70%
2025-05-30 01:30:08,424 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:30:08,425 - MoETrainer - INFO -   Bin 0: RMSE=36946.0269, RÂ²=0.0641, Samples=178
2025-05-30 01:30:08,425 - MoETrainer - INFO -   Bin 1: RMSE=21685.4472, RÂ²=-0.0261, Samples=195
2025-05-30 01:30:08,425 - MoETrainer - INFO -   Bin 2: RMSE=20769.5319, RÂ²=0.0171, Samples=180
2025-05-30 01:30:08,426 - MoETrainer - INFO -   Bin 3: RMSE=28081.8817, RÂ²=0.0168, Samples=179
2025-05-30 01:30:08,426 - MoETrainer - INFO -   Bin 4: RMSE=45257.7392, RÂ²=0.0175, Samples=172
2025-05-30 01:30:08,426 - MoETrainer - INFO -   Bin 5: RMSE=254107.7215, RÂ²=0.1559, Samples=197
2025-05-30 01:30:08,427 - MoETrainer - INFO -   6 bins: RÂ²=0.8380, RMSE=$111,248
2025-05-30 01:30:08,427 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-05-30 01:30:08,428 - MoETrainer - INFO - Training final model with 6 bins...
2025-05-30 01:30:08,429 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:30:08,429 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:30:08,430 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:30:11,249 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:30:11,250 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:30:11,250 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:30:11,250 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:30:14,290 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:30:14,291 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:30:14,291 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:30:14,291 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:30:17,349 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:30:17,350 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:30:17,350 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:30:17,351 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:30:21,242 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:30:21,242 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:30:21,243 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:30:21,245 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:30:25,160 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:30:25,161 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:30:25,161 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:30:25,161 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:30:29,487 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:30:29,487 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:30:29,487 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:30:29,487 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:30:29,488 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:30:29,489 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:30:29,491 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:30:29,492 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:30:29,494 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:30:29,496 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:30:29,497 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:30:29,498 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:30:29,516 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:30:29,516 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:30:29,516 - MoETrainer - INFO -   RMSE: 111248.4396
2025-05-30 01:30:29,517 - MoETrainer - INFO -   MAE: 55539.2363
2025-05-30 01:30:29,517 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-30 01:30:29,519 - MoETrainer - INFO -   MAPE: 8.70%
2025-05-30 01:30:29,520 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:30:29,521 - MoETrainer - INFO -   Bin 0: RMSE=36946.0269, RÂ²=0.0641, Samples=178
2025-05-30 01:30:29,521 - MoETrainer - INFO -   Bin 1: RMSE=21685.4472, RÂ²=-0.0261, Samples=195
2025-05-30 01:30:29,521 - MoETrainer - INFO -   Bin 2: RMSE=20769.5319, RÂ²=0.0171, Samples=180
2025-05-30 01:30:29,521 - MoETrainer - INFO -   Bin 3: RMSE=28081.8817, RÂ²=0.0168, Samples=179
2025-05-30 01:30:29,521 - MoETrainer - INFO -   Bin 4: RMSE=45257.7392, RÂ²=0.0175, Samples=172
2025-05-30 01:30:29,522 - MoETrainer - INFO -   Bin 5: RMSE=254107.7215, RÂ²=0.1559, Samples=197
2025-05-30 01:30:29,522 - MoETrainer - INFO - Final Expert Configuration:
2025-05-30 01:30:29,522 - MoETrainer - INFO -   Bin 0: ridge_heavy
2025-05-30 01:30:29,522 - MoETrainer - INFO -   Bin 1: elastic_heavy
2025-05-30 01:30:29,522 - MoETrainer - INFO -   Bin 2: ridge_heavy
2025-05-30 01:30:29,523 - MoETrainer - INFO -   Bin 3: elastic_light
2025-05-30 01:30:29,523 - MoETrainer - INFO -   Bin 4: elastic_light
2025-05-30 01:30:29,523 - MoETrainer - INFO -   Bin 5: elastic_light
2025-05-30 01:30:29,523 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-05-30 01:30:29,523 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-05-30 01:30:29,523 - MoETrainer - INFO - Final Performance: RÂ² = 0.8380
2025-05-30 01:30:29,524 - MoETrainer - INFO - Final RMSE: $111,248
2025-05-30 01:30:29,524 - MoETrainer - INFO - Final MAE: $55,539
2025-05-30 01:32:20,460 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-05-30 01:32:20,460 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-05-30 01:32:20,461 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 01:32:21,285 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 01:32:21,288 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 01:32:21,291 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 01:32:21,315 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 01:32:24,468 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 01:32:24,503 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 01:32:24,504 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 01:32:24,505 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 01:32:24,505 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 01:32:24,505 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 01:32:24,507 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 01:32:24,515 - MoETrainer - INFO - Applied robust scaling
2025-05-30 01:32:24,515 - MoETrainer - INFO - Splitting data...
2025-05-30 01:32:24,518 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 01:32:24,519 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 01:32:24,519 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 01:32:24,519 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-30 01:32:24,520 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:32:24,521 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:32:24,521 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:32:31,272 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:32:31,273 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-30 01:32:31,273 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-30 01:32:31,273 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-30 01:32:36,064 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:32:36,064 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-30 01:32:36,065 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-30 01:32:36,065 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-30 01:32:41,222 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:32:41,222 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-30 01:32:41,223 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-30 01:32:41,223 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-30 01:32:41,224 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:32:41,254 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-30 01:32:41,293 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-30 01:32:41,318 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-30 01:32:41,319 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 01:32:41,332 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:32:41,332 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:32:41,333 - MoETrainer - INFO -   RMSE: 141212.4705
2025-05-30 01:32:41,333 - MoETrainer - INFO -   MAE: 82757.5135
2025-05-30 01:32:41,333 - MoETrainer - INFO -   RÂ²: 0.7390
2025-05-30 01:32:41,333 - MoETrainer - INFO -   MAPE: 14.13%
2025-05-30 01:32:41,334 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:32:41,334 - MoETrainer - INFO -   Bin 0: RMSE=50404.7567, RÂ²=0.1927, Samples=373
2025-05-30 01:32:41,334 - MoETrainer - INFO -   Bin 1: RMSE=43955.6581, RÂ²=0.1187, Samples=359
2025-05-30 01:32:41,334 - MoETrainer - INFO -   Bin 2: RMSE=234628.9036, RÂ²=0.2994, Samples=369
2025-05-30 01:32:41,335 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-05-30 01:32:41,335 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:32:41,336 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:32:41,336 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:32:45,116 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:32:45,116 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-30 01:32:45,117 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-30 01:32:45,117 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-30 01:32:49,063 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:32:49,063 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-30 01:32:49,064 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-30 01:32:49,064 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-30 01:32:53,516 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:32:53,516 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-30 01:32:53,517 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-30 01:32:53,517 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-30 01:32:57,729 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:32:57,729 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-30 01:32:57,730 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-30 01:32:57,730 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-30 01:32:57,730 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:32:57,753 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-30 01:32:57,773 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-30 01:32:57,943 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-30 01:32:57,945 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-30 01:32:57,946 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-30 01:32:57,964 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:32:57,964 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:32:57,964 - MoETrainer - INFO -   RMSE: 131773.6979
2025-05-30 01:32:57,965 - MoETrainer - INFO -   MAE: 71136.8624
2025-05-30 01:32:57,965 - MoETrainer - INFO -   RÂ²: 0.7727
2025-05-30 01:32:57,965 - MoETrainer - INFO -   MAPE: 11.60%
2025-05-30 01:32:57,966 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:32:57,966 - MoETrainer - INFO -   Bin 0: RMSE=44408.6343, RÂ²=0.1239, Samples=272
2025-05-30 01:32:57,966 - MoETrainer - INFO -   Bin 1: RMSE=28491.5132, RÂ²=0.0200, Samples=281
2025-05-30 01:32:57,966 - MoETrainer - INFO -   Bin 2: RMSE=40906.3907, RÂ²=0.1414, Samples=253
2025-05-30 01:32:57,967 - MoETrainer - INFO -   Bin 3: RMSE=246536.8572, RÂ²=0.2252, Samples=295
2025-05-30 01:32:57,967 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-05-30 01:32:57,968 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:32:57,968 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:32:57,968 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:33:01,229 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:33:01,229 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-30 01:33:01,230 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-30 01:33:01,230 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-30 01:33:04,508 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:33:04,508 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-30 01:33:04,508 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-30 01:33:04,509 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-30 01:33:07,843 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:33:07,843 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-30 01:33:07,844 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-30 01:33:07,844 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-30 01:33:11,591 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:33:11,591 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-30 01:33:11,592 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-30 01:33:11,592 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-30 01:33:15,586 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:33:15,586 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-30 01:33:15,586 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-30 01:33:15,587 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-30 01:33:15,587 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:33:15,619 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-30 01:33:15,622 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-30 01:33:15,655 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-30 01:33:15,657 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-30 01:33:15,662 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-30 01:33:15,662 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-30 01:33:15,678 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:33:15,678 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:33:15,678 - MoETrainer - INFO -   RMSE: 118989.3498
2025-05-30 01:33:15,678 - MoETrainer - INFO -   MAE: 60600.3087
2025-05-30 01:33:15,679 - MoETrainer - INFO -   RÂ²: 0.8147
2025-05-30 01:33:15,679 - MoETrainer - INFO -   MAPE: 9.61%
2025-05-30 01:33:15,679 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:33:15,679 - MoETrainer - INFO -   Bin 0: RMSE=40645.8562, RÂ²=0.0942, Samples=223
2025-05-30 01:33:15,680 - MoETrainer - INFO -   Bin 1: RMSE=19773.5884, RÂ²=0.0186, Samples=215
2025-05-30 01:33:15,680 - MoETrainer - INFO -   Bin 2: RMSE=28330.5392, RÂ²=-0.1027, Samples=233
2025-05-30 01:33:15,680 - MoETrainer - INFO -   Bin 3: RMSE=45827.7211, RÂ²=0.0380, Samples=201
2025-05-30 01:33:15,680 - MoETrainer - INFO -   Bin 4: RMSE=251865.0508, RÂ²=0.1874, Samples=229
2025-05-30 01:33:15,681 - MoETrainer - INFO -   5 bins: RÂ²=0.8147, RMSE=$118,989
2025-05-30 01:33:15,682 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:33:15,682 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:33:15,682 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:33:19,001 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:33:19,002 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:33:19,002 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:33:19,002 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:33:22,525 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:33:22,525 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:33:22,526 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:33:22,526 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:33:25,594 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:33:25,594 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:33:25,595 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:33:25,595 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:33:28,804 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:33:28,805 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:33:28,805 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:33:28,805 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:33:31,922 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:33:31,922 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:33:31,923 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:33:31,923 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:33:35,210 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:33:35,211 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:33:35,211 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:33:35,212 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:33:35,212 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:33:35,214 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:33:35,216 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:33:35,217 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:33:35,220 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:33:35,225 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:33:35,227 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:33:35,228 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:33:35,244 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:33:35,244 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:33:35,245 - MoETrainer - INFO -   RMSE: 111248.4396
2025-05-30 01:33:35,245 - MoETrainer - INFO -   MAE: 55539.2363
2025-05-30 01:33:35,246 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-30 01:33:35,246 - MoETrainer - INFO -   MAPE: 8.70%
2025-05-30 01:33:35,246 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:33:35,247 - MoETrainer - INFO -   Bin 0: RMSE=36946.0269, RÂ²=0.0641, Samples=178
2025-05-30 01:33:35,247 - MoETrainer - INFO -   Bin 1: RMSE=21685.4472, RÂ²=-0.0261, Samples=195
2025-05-30 01:33:35,247 - MoETrainer - INFO -   Bin 2: RMSE=20769.5319, RÂ²=0.0171, Samples=180
2025-05-30 01:33:35,248 - MoETrainer - INFO -   Bin 3: RMSE=28081.8817, RÂ²=0.0168, Samples=179
2025-05-30 01:33:35,248 - MoETrainer - INFO -   Bin 4: RMSE=45257.7392, RÂ²=0.0175, Samples=172
2025-05-30 01:33:35,249 - MoETrainer - INFO -   Bin 5: RMSE=254107.7215, RÂ²=0.1559, Samples=197
2025-05-30 01:33:35,249 - MoETrainer - INFO -   6 bins: RÂ²=0.8380, RMSE=$111,248
2025-05-30 01:33:35,250 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-05-30 01:33:35,250 - MoETrainer - INFO - Training final model with 6 bins...
2025-05-30 01:33:35,251 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:33:35,252 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:33:35,252 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:33:38,283 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:33:38,283 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:33:38,284 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:33:38,284 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:33:41,490 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:33:41,490 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:33:41,491 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:33:41,491 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:33:44,567 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:33:44,567 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:33:44,568 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:33:44,568 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:33:47,708 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:33:47,708 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:33:47,708 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:33:47,709 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:33:51,150 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:33:51,150 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:33:51,151 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:33:51,151 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:33:54,744 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:33:54,745 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:33:54,745 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:33:54,746 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:33:54,746 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:33:54,748 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:33:54,750 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:33:54,752 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:33:54,755 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:33:54,758 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:33:54,761 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:33:54,762 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:33:54,778 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:33:54,778 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:33:54,779 - MoETrainer - INFO -   RMSE: 111248.4396
2025-05-30 01:33:54,779 - MoETrainer - INFO -   MAE: 55539.2363
2025-05-30 01:33:54,780 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-30 01:33:54,780 - MoETrainer - INFO -   MAPE: 8.70%
2025-05-30 01:33:54,781 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:33:54,781 - MoETrainer - INFO -   Bin 0: RMSE=36946.0269, RÂ²=0.0641, Samples=178
2025-05-30 01:33:54,781 - MoETrainer - INFO -   Bin 1: RMSE=21685.4472, RÂ²=-0.0261, Samples=195
2025-05-30 01:33:54,782 - MoETrainer - INFO -   Bin 2: RMSE=20769.5319, RÂ²=0.0171, Samples=180
2025-05-30 01:33:54,782 - MoETrainer - INFO -   Bin 3: RMSE=28081.8817, RÂ²=0.0168, Samples=179
2025-05-30 01:33:54,783 - MoETrainer - INFO -   Bin 4: RMSE=45257.7392, RÂ²=0.0175, Samples=172
2025-05-30 01:33:54,783 - MoETrainer - INFO -   Bin 5: RMSE=254107.7215, RÂ²=0.1559, Samples=197
2025-05-30 01:33:54,784 - MoETrainer - INFO - Final Expert Configuration:
2025-05-30 01:33:54,784 - MoETrainer - INFO -   Bin 0: ridge_heavy
2025-05-30 01:33:54,784 - MoETrainer - INFO -   Bin 1: elastic_heavy
2025-05-30 01:33:54,784 - MoETrainer - INFO -   Bin 2: ridge_heavy
2025-05-30 01:33:54,785 - MoETrainer - INFO -   Bin 3: elastic_light
2025-05-30 01:33:54,785 - MoETrainer - INFO -   Bin 4: elastic_light
2025-05-30 01:33:54,786 - MoETrainer - INFO -   Bin 5: elastic_light
2025-05-30 01:33:54,786 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-05-30 01:33:54,786 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-05-30 01:33:54,786 - MoETrainer - INFO - Final Performance: RÂ² = 0.8380
2025-05-30 01:33:54,787 - MoETrainer - INFO - Final RMSE: $111,248
2025-05-30 01:33:54,787 - MoETrainer - INFO - Final MAE: $55,539
2025-05-30 01:38:32,379 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-05-30 01:38:32,379 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-05-30 01:38:32,380 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 01:38:33,088 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 01:38:33,091 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 01:38:33,095 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 01:38:33,116 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 01:38:35,715 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 01:38:35,753 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 01:38:35,753 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 01:38:35,754 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 01:38:35,754 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 01:38:35,754 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 01:38:35,756 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 01:38:35,765 - MoETrainer - INFO - Applied robust scaling
2025-05-30 01:38:35,765 - MoETrainer - INFO - Splitting data...
2025-05-30 01:38:35,768 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 01:38:35,768 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 01:38:35,769 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 01:38:35,769 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-30 01:38:35,770 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:38:35,770 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:38:35,771 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:38:41,640 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:38:41,641 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-30 01:38:41,641 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-30 01:38:41,642 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-30 01:38:46,979 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:38:46,979 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-30 01:38:46,980 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-30 01:38:46,980 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-30 01:38:51,964 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:38:51,964 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-30 01:38:51,965 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-30 01:38:51,965 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-30 01:38:51,966 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:38:51,992 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-30 01:38:52,030 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-30 01:38:52,055 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-30 01:38:52,056 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 01:38:52,069 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:38:52,069 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:38:52,070 - MoETrainer - INFO -   RMSE: $141,212
2025-05-30 01:38:52,070 - MoETrainer - INFO -   MAE: $82,758 (15.4% of mean)
2025-05-30 01:38:52,071 - MoETrainer - INFO -   RÂ²: 0.7390
2025-05-30 01:38:52,071 - MoETrainer - INFO -   MAPE: 14.1%
2025-05-30 01:38:52,072 - MoETrainer - INFO -   MPE: +3.5% (bias: overprediction)
2025-05-30 01:38:52,072 - MoETrainer - INFO -   Median APE: 10.7%
2025-05-30 01:38:52,073 - MoETrainer - INFO -   Within 5%: 23.9% of predictions
2025-05-30 01:38:52,073 - MoETrainer - INFO -   Within 10%: 47.2% of predictions
2025-05-30 01:38:52,074 - MoETrainer - INFO -   Within 15%: 67.7% of predictions
2025-05-30 01:38:52,074 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:38:52,075 - MoETrainer - INFO -   Bin 0: RMSE=$50,405, RÂ²=0.1927, Samples=373
2025-05-30 01:38:52,075 - MoETrainer - INFO -   Bin 1: RMSE=$43,956, RÂ²=0.1187, Samples=359
2025-05-30 01:38:52,076 - MoETrainer - INFO -   Bin 2: RMSE=$234,629, RÂ²=0.2994, Samples=369
2025-05-30 01:38:52,076 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-05-30 01:38:52,077 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:38:52,077 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:38:52,077 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:38:56,087 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:38:56,088 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-30 01:38:56,088 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-30 01:38:56,089 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-30 01:38:59,825 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:38:59,826 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-30 01:38:59,826 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-30 01:38:59,826 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-30 01:39:03,686 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:39:03,687 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-30 01:39:03,687 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-30 01:39:03,687 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-30 01:39:08,095 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:39:08,095 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-30 01:39:08,096 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-30 01:39:08,096 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-30 01:39:08,097 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:39:08,118 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-30 01:39:08,140 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-30 01:39:08,314 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-30 01:39:08,316 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-30 01:39:08,316 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-30 01:39:08,336 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:39:08,337 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:39:08,337 - MoETrainer - INFO -   RMSE: $131,774
2025-05-30 01:39:08,338 - MoETrainer - INFO -   MAE: $71,137 (13.2% of mean)
2025-05-30 01:39:08,338 - MoETrainer - INFO -   RÂ²: 0.7727
2025-05-30 01:39:08,338 - MoETrainer - INFO -   MAPE: 11.6%
2025-05-30 01:39:08,339 - MoETrainer - INFO -   MPE: +3.2% (bias: overprediction)
2025-05-30 01:39:08,339 - MoETrainer - INFO -   Median APE: 8.3%
2025-05-30 01:39:08,339 - MoETrainer - INFO -   Within 5%: 29.8% of predictions
2025-05-30 01:39:08,339 - MoETrainer - INFO -   Within 10%: 60.5% of predictions
2025-05-30 01:39:08,340 - MoETrainer - INFO -   Within 15%: 77.5% of predictions
2025-05-30 01:39:08,340 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:39:08,340 - MoETrainer - INFO -   Bin 0: RMSE=$44,409, RÂ²=0.1239, Samples=272
2025-05-30 01:39:08,340 - MoETrainer - INFO -   Bin 1: RMSE=$28,492, RÂ²=0.0200, Samples=281
2025-05-30 01:39:08,341 - MoETrainer - INFO -   Bin 2: RMSE=$40,906, RÂ²=0.1414, Samples=253
2025-05-30 01:39:08,341 - MoETrainer - INFO -   Bin 3: RMSE=$246,537, RÂ²=0.2252, Samples=295
2025-05-30 01:39:08,341 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-05-30 01:39:08,342 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:39:08,343 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:39:08,343 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:39:11,779 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:39:11,780 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-30 01:39:11,780 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-30 01:39:11,781 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-30 01:39:15,220 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:39:15,220 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-30 01:39:15,221 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-30 01:39:15,221 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-30 01:39:18,710 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:39:18,710 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-30 01:39:18,711 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-30 01:39:18,711 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-30 01:39:22,116 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:39:22,116 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-30 01:39:22,117 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-30 01:39:22,117 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-30 01:39:25,987 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:39:25,987 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-30 01:39:25,988 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-30 01:39:25,988 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-30 01:39:25,989 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:39:26,027 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-30 01:39:26,029 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-30 01:39:26,053 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-30 01:39:26,056 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-30 01:39:26,058 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-30 01:39:26,058 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-30 01:39:26,075 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:39:26,075 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:39:26,075 - MoETrainer - INFO -   RMSE: $118,989
2025-05-30 01:39:26,075 - MoETrainer - INFO -   MAE: $60,600 (11.3% of mean)
2025-05-30 01:39:26,076 - MoETrainer - INFO -   RÂ²: 0.8147
2025-05-30 01:39:26,076 - MoETrainer - INFO -   MAPE: 9.6%
2025-05-30 01:39:26,076 - MoETrainer - INFO -   MPE: +2.0% (bias: overprediction)
2025-05-30 01:39:26,076 - MoETrainer - INFO -   Median APE: 6.8%
2025-05-30 01:39:26,077 - MoETrainer - INFO -   Within 5%: 38.1% of predictions
2025-05-30 01:39:26,077 - MoETrainer - INFO -   Within 10%: 69.7% of predictions
2025-05-30 01:39:26,077 - MoETrainer - INFO -   Within 15%: 83.1% of predictions
2025-05-30 01:39:26,077 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:39:26,077 - MoETrainer - INFO -   Bin 0: RMSE=$40,646, RÂ²=0.0942, Samples=223
2025-05-30 01:39:26,078 - MoETrainer - INFO -   Bin 1: RMSE=$19,774, RÂ²=0.0186, Samples=215
2025-05-30 01:39:26,078 - MoETrainer - INFO -   Bin 2: RMSE=$28,331, RÂ²=-0.1027, Samples=233
2025-05-30 01:39:26,078 - MoETrainer - INFO -   Bin 3: RMSE=$45,828, RÂ²=0.0380, Samples=201
2025-05-30 01:39:26,078 - MoETrainer - INFO -   Bin 4: RMSE=$251,865, RÂ²=0.1874, Samples=229
2025-05-30 01:39:26,079 - MoETrainer - INFO -   5 bins: RÂ²=0.8147, RMSE=$118,989
2025-05-30 01:39:26,079 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:39:26,080 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:39:26,080 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:39:29,053 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:39:29,053 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:39:29,053 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:39:29,054 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:39:32,335 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:39:32,335 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:39:32,336 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:39:32,336 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:39:35,579 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:39:35,580 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:39:35,581 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:39:35,581 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:39:38,750 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:39:38,750 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:39:38,751 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:39:38,751 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:39:41,979 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:39:41,980 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:39:41,980 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:39:41,981 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:39:45,331 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:39:45,332 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:39:45,332 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:39:45,333 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:39:45,333 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:39:45,335 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:39:45,336 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:39:45,339 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:39:45,341 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:39:45,344 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:39:45,347 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:39:45,347 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:39:45,363 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:39:45,363 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:39:45,363 - MoETrainer - INFO -   RMSE: $111,248
2025-05-30 01:39:45,364 - MoETrainer - INFO -   MAE: $55,539 (10.3% of mean)
2025-05-30 01:39:45,364 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-30 01:39:45,364 - MoETrainer - INFO -   MAPE: 8.7%
2025-05-30 01:39:45,365 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-05-30 01:39:45,366 - MoETrainer - INFO -   Median APE: 6.3%
2025-05-30 01:39:45,366 - MoETrainer - INFO -   Within 5%: 37.4% of predictions
2025-05-30 01:39:45,366 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-05-30 01:39:45,367 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-05-30 01:39:45,368 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:39:45,370 - MoETrainer - INFO -   Bin 0: RMSE=$36,946, RÂ²=0.0641, Samples=178
2025-05-30 01:39:45,370 - MoETrainer - INFO -   Bin 1: RMSE=$21,685, RÂ²=-0.0261, Samples=195
2025-05-30 01:39:45,371 - MoETrainer - INFO -   Bin 2: RMSE=$20,770, RÂ²=0.0171, Samples=180
2025-05-30 01:39:45,371 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-05-30 01:39:45,372 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-05-30 01:39:45,372 - MoETrainer - INFO -   Bin 5: RMSE=$254,108, RÂ²=0.1559, Samples=197
2025-05-30 01:39:45,372 - MoETrainer - INFO -   6 bins: RÂ²=0.8380, RMSE=$111,248
2025-05-30 01:39:45,373 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-05-30 01:39:45,373 - MoETrainer - INFO - Training final model with 6 bins...
2025-05-30 01:39:45,374 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 01:39:45,374 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 01:39:45,374 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 01:39:48,085 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 01:39:48,086 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 01:39:48,086 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 01:39:48,087 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 01:39:51,442 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 01:39:51,443 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 01:39:51,443 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 01:39:51,443 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 01:39:54,600 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 01:39:54,600 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 01:39:54,600 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 01:39:54,601 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 01:39:57,794 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 01:39:57,794 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 01:39:57,794 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 01:39:57,795 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 01:40:00,984 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 01:40:00,985 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 01:40:00,985 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 01:40:00,986 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 01:40:04,277 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 01:40:04,278 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 01:40:04,278 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 01:40:04,279 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 01:40:04,279 - MoETrainer - INFO - Training selected expert models...
2025-05-30 01:40:04,282 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 01:40:04,285 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 01:40:04,288 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 01:40:04,291 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 01:40:04,293 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 01:40:04,295 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 01:40:04,296 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 01:40:04,312 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 01:40:04,312 - MoETrainer - INFO - Overall Performance:
2025-05-30 01:40:04,313 - MoETrainer - INFO -   RMSE: $111,248
2025-05-30 01:40:04,313 - MoETrainer - INFO -   MAE: $55,539 (10.3% of mean)
2025-05-30 01:40:04,313 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-30 01:40:04,314 - MoETrainer - INFO -   MAPE: 8.7%
2025-05-30 01:40:04,314 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-05-30 01:40:04,315 - MoETrainer - INFO -   Median APE: 6.3%
2025-05-30 01:40:04,315 - MoETrainer - INFO -   Within 5%: 37.4% of predictions
2025-05-30 01:40:04,316 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-05-30 01:40:04,316 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-05-30 01:40:04,317 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 01:40:04,318 - MoETrainer - INFO -   Bin 0: RMSE=$36,946, RÂ²=0.0641, Samples=178
2025-05-30 01:40:04,319 - MoETrainer - INFO -   Bin 1: RMSE=$21,685, RÂ²=-0.0261, Samples=195
2025-05-30 01:40:04,319 - MoETrainer - INFO -   Bin 2: RMSE=$20,770, RÂ²=0.0171, Samples=180
2025-05-30 01:40:04,320 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-05-30 01:40:04,320 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-05-30 01:40:04,321 - MoETrainer - INFO -   Bin 5: RMSE=$254,108, RÂ²=0.1559, Samples=197
2025-05-30 01:40:04,321 - MoETrainer - INFO - Final Expert Configuration:
2025-05-30 01:40:04,321 - MoETrainer - INFO -   Bin 0: ridge_heavy
2025-05-30 01:40:04,322 - MoETrainer - INFO -   Bin 1: elastic_heavy
2025-05-30 01:40:04,322 - MoETrainer - INFO -   Bin 2: ridge_heavy
2025-05-30 01:40:04,322 - MoETrainer - INFO -   Bin 3: elastic_light
2025-05-30 01:40:04,323 - MoETrainer - INFO -   Bin 4: elastic_light
2025-05-30 01:40:04,323 - MoETrainer - INFO -   Bin 5: elastic_light
2025-05-30 01:40:04,324 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-05-30 01:40:04,324 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-05-30 01:40:04,325 - MoETrainer - INFO - Final Performance: RÂ² = 0.8380
2025-05-30 01:40:04,325 - MoETrainer - INFO - Final RMSE: $111,248
2025-05-30 01:40:04,325 - MoETrainer - INFO - Final MAE: $55,539
2025-05-30 02:30:21,375 - MoETrainer - INFO - === TRAINING FIXED BASELINE MODEL (NO DATA LEAKAGE) ===
2025-05-30 02:30:21,377 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-05-30 02:30:21,377 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-30 02:30:22,097 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-30 02:30:22,104 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-30 02:30:22,116 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-30 02:30:22,145 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-30 02:30:25,403 - MoETrainer - INFO - Consolidated to 13 features
2025-05-30 02:30:25,433 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-30 02:30:25,434 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-30 02:30:25,434 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-30 02:30:25,435 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-30 02:30:25,435 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-30 02:30:25,437 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-30 02:30:25,446 - MoETrainer - INFO - Applied robust scaling
2025-05-30 02:30:25,447 - MoETrainer - INFO - Splitting data...
2025-05-30 02:30:25,450 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-30 02:30:25,450 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-30 02:30:25,451 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-30 02:30:25,451 - MoETrainer - INFO - Data splits - Train: 3576, Val: 826, Test: 1101
2025-05-30 02:30:25,451 - MoETrainer - INFO - Finding optimal bin configuration using VALIDATION set...
2025-05-30 02:30:25,452 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 02:30:25,453 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 02:30:25,453 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 02:30:31,019 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 02:30:31,019 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-30 02:30:31,020 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-30 02:30:31,020 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-30 02:30:38,083 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 02:30:38,083 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-30 02:30:38,084 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-30 02:30:38,084 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-30 02:30:45,000 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 02:30:45,000 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-30 02:30:45,001 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-30 02:30:45,001 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-30 02:30:45,002 - MoETrainer - INFO - Training selected expert models...
2025-05-30 02:30:45,025 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-30 02:30:45,067 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-30 02:30:45,089 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-30 02:30:45,089 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-30 02:30:45,096 - MoETrainer - INFO -   3 bins: Val RÂ²=0.7657, Val RMSE=$133,045
2025-05-30 02:30:45,097 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 02:30:45,098 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 02:30:45,098 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 02:30:49,852 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 02:30:49,852 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-30 02:30:49,853 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-30 02:30:49,853 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-30 02:30:53,676 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 02:30:53,676 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-30 02:30:53,677 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-30 02:30:53,677 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-30 02:30:57,454 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 02:30:57,454 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-30 02:30:57,455 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-30 02:30:57,455 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-30 02:31:01,699 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 02:31:01,699 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-30 02:31:01,700 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-30 02:31:01,700 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-30 02:31:01,700 - MoETrainer - INFO - Training selected expert models...
2025-05-30 02:31:01,728 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-30 02:31:01,755 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-30 02:31:01,923 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-30 02:31:01,925 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-30 02:31:01,926 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-30 02:31:01,936 - MoETrainer - INFO -   4 bins: Val RÂ²=0.7806, Val RMSE=$128,744
2025-05-30 02:31:01,937 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 02:31:01,938 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 02:31:01,939 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 02:31:05,190 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 02:31:05,190 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-30 02:31:05,191 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-30 02:31:05,191 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-30 02:31:09,532 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 02:31:09,532 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-30 02:31:09,532 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-30 02:31:09,533 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-30 02:31:12,956 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 02:31:12,957 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-30 02:31:12,957 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-30 02:31:12,957 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-30 02:31:16,911 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 02:31:16,911 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-30 02:31:16,912 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-30 02:31:16,912 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-30 02:31:20,917 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 02:31:20,917 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-30 02:31:20,918 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-30 02:31:20,918 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-30 02:31:20,919 - MoETrainer - INFO - Training selected expert models...
2025-05-30 02:31:20,949 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-30 02:31:20,952 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-30 02:31:20,971 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-30 02:31:20,973 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-30 02:31:20,975 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-30 02:31:20,976 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-30 02:31:20,981 - MoETrainer - INFO -   5 bins: Val RÂ²=0.8085, Val RMSE=$120,292
2025-05-30 02:31:20,982 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 02:31:20,982 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 02:31:20,982 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 02:31:23,625 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 02:31:23,626 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-30 02:31:23,626 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-30 02:31:23,626 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-30 02:31:26,506 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 02:31:26,506 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-30 02:31:26,507 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-30 02:31:26,507 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-30 02:31:29,416 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 02:31:29,416 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-30 02:31:29,417 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-30 02:31:29,417 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-30 02:31:32,933 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 02:31:32,933 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-30 02:31:32,934 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-30 02:31:32,934 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-30 02:31:36,222 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 02:31:36,222 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-30 02:31:36,222 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-30 02:31:36,223 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-30 02:31:39,276 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 02:31:39,277 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-30 02:31:39,277 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-30 02:31:39,277 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-30 02:31:39,278 - MoETrainer - INFO - Training selected expert models...
2025-05-30 02:31:39,279 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-30 02:31:39,281 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-30 02:31:39,282 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-30 02:31:39,284 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-30 02:31:39,286 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-30 02:31:39,288 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-30 02:31:39,288 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 02:31:39,291 - MoETrainer - INFO -   6 bins: Val RÂ²=0.8356, Val RMSE=$111,445
2025-05-30 02:31:39,291 - MoETrainer - INFO - â Optimal configuration selected: 6 bins (based on validation)
2025-05-30 02:31:39,291 - MoETrainer - INFO - Training final model with 6 bins...
2025-05-30 02:31:39,291 - MoETrainer - INFO - ð¯ Final evaluation on TEST set (unbiased)
2025-05-30 02:31:39,292 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-30 02:31:39,292 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-30 02:31:39,293 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-30 02:31:42,179 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-30 02:31:42,179 - MoETrainer - INFO -   1. elastic_light: MSE=1113711061Â±36954126, RÂ²=0.036 [SELECTED]
2025-05-30 02:31:42,180 - MoETrainer - INFO -   2. ridge_heavy: MSE=1114521600Â±44026829, RÂ²=0.035
2025-05-30 02:31:42,180 - MoETrainer - INFO -   3. lgb_conservative: MSE=1120846668Â±57699251, RÂ²=0.029
2025-05-30 02:31:45,455 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-30 02:31:45,455 - MoETrainer - INFO -   1. elastic_light: MSE=431569600Â±30519282, RÂ²=0.003 [SELECTED]
2025-05-30 02:31:45,455 - MoETrainer - INFO -   2. ridge_heavy: MSE=431934667Â±30500680, RÂ²=0.002
2025-05-30 02:31:45,456 - MoETrainer - INFO -   3. elastic_balanced: MSE=432724693Â±30171566, RÂ²=0.000
2025-05-30 02:31:48,569 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-30 02:31:48,570 - MoETrainer - INFO -   1. elastic_light: MSE=440304000Â±16776242, RÂ²=0.009 [SELECTED]
2025-05-30 02:31:48,570 - MoETrainer - INFO -   2. ridge_heavy: MSE=442685045Â±19871239, RÂ²=0.004
2025-05-30 02:31:48,570 - MoETrainer - INFO -   3. elastic_balanced: MSE=442784352Â±16303317, RÂ²=0.004
2025-05-30 02:31:51,765 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-30 02:31:51,766 - MoETrainer - INFO -   1. elastic_light: MSE=774460267Â±48863640, RÂ²=0.002 [SELECTED]
2025-05-30 02:31:51,766 - MoETrainer - INFO -   2. elastic_balanced: MSE=777296107Â±48849861, RÂ²=-0.002
2025-05-30 02:31:51,766 - MoETrainer - INFO -   3. elastic_heavy: MSE=781600299Â±50055961, RÂ²=-0.007
2025-05-30 02:31:55,025 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-30 02:31:55,025 - MoETrainer - INFO -   1. elastic_light: MSE=2013743104Â±57124178, RÂ²=0.031 [SELECTED]
2025-05-30 02:31:55,026 - MoETrainer - INFO -   2. ridge_heavy: MSE=2021018667Â±79780584, RÂ²=0.028
2025-05-30 02:31:55,026 - MoETrainer - INFO -   3. elastic_balanced: MSE=2022343424Â±38679814, RÂ²=0.027
2025-05-30 02:31:58,543 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-30 02:31:58,544 - MoETrainer - INFO -   1. ridge_medium: MSE=64438340267Â±4950328599, RÂ²=0.176 [SELECTED]
2025-05-30 02:31:58,544 - MoETrainer - INFO -   2. ridge_light: MSE=64456504661Â±4709125625, RÂ²=0.176
2025-05-30 02:31:58,544 - MoETrainer - INFO -   3. ridge_heavy: MSE=64900070059Â±6152595380, RÂ²=0.170
2025-05-30 02:31:58,545 - MoETrainer - INFO - Training selected expert models...
2025-05-30 02:31:58,547 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 655 samples
2025-05-30 02:31:58,549 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 783 samples
2025-05-30 02:31:58,551 - MoETrainer - INFO - Successfully trained elastic_light for bin 2: 755 samples
2025-05-30 02:31:58,552 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 741 samples
2025-05-30 02:31:58,555 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 714 samples
2025-05-30 02:31:58,557 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 754 samples
2025-05-30 02:31:58,558 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-30 02:31:58,575 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-30 02:31:58,576 - MoETrainer - INFO - Overall Performance:
2025-05-30 02:31:58,577 - MoETrainer - INFO -   RMSE: $112,153
2025-05-30 02:31:58,578 - MoETrainer - INFO -   MAE: $55,537 (10.3% of mean)
2025-05-30 02:31:58,579 - MoETrainer - INFO -   RÂ²: 0.8354
2025-05-30 02:31:58,580 - MoETrainer - INFO -   MAPE: 8.7%
2025-05-30 02:31:58,580 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-05-30 02:31:58,580 - MoETrainer - INFO -   Median APE: 6.3%
2025-05-30 02:31:58,581 - MoETrainer - INFO -   Within 5%: 36.4% of predictions
2025-05-30 02:31:58,581 - MoETrainer - INFO -   Within 10%: 77.8% of predictions
2025-05-30 02:31:58,582 - MoETrainer - INFO -   Within 15%: 87.2% of predictions
2025-05-30 02:31:58,582 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-30 02:31:58,583 - MoETrainer - INFO -   Bin 0: RMSE=$37,436, RÂ²=0.0391, Samples=178
2025-05-30 02:31:58,583 - MoETrainer - INFO -   Bin 1: RMSE=$21,590, RÂ²=-0.0171, Samples=195
2025-05-30 02:31:58,584 - MoETrainer - INFO -   Bin 2: RMSE=$20,706, RÂ²=0.0231, Samples=180
2025-05-30 02:31:58,584 - MoETrainer - INFO -   Bin 3: RMSE=$28,076, RÂ²=0.0173, Samples=179
2025-05-30 02:31:58,585 - MoETrainer - INFO -   Bin 4: RMSE=$45,137, RÂ²=0.0227, Samples=172
2025-05-30 02:31:58,585 - MoETrainer - INFO -   Bin 5: RMSE=$256,287, RÂ²=0.1414, Samples=197
2025-05-30 02:31:58,585 - MoETrainer - INFO - Final Expert Configuration:
2025-05-30 02:31:58,586 - MoETrainer - INFO -   Bin 0: elastic_light
2025-05-30 02:31:58,586 - MoETrainer - INFO -   Bin 1: elastic_light
2025-05-30 02:31:58,588 - MoETrainer - INFO -   Bin 2: elastic_light
2025-05-30 02:31:58,588 - MoETrainer - INFO -   Bin 3: elastic_light
2025-05-30 02:31:58,589 - MoETrainer - INFO -   Bin 4: elastic_light
2025-05-30 02:31:58,589 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-05-30 02:31:58,589 - MoETrainer - INFO - === FIXED BASELINE MODEL TRAINING COMPLETE ===
2025-05-30 02:31:58,590 - MoETrainer - INFO - Final Test Performance: RÂ² = 0.8354
2025-05-30 02:31:58,590 - MoETrainer - INFO - Final Test RMSE: $112,153
2025-05-30 02:31:58,590 - MoETrainer - INFO - Final Test MAE: $55,537
2025-05-31 14:51:57,109 - MoETrainer - INFO - === FIXED NEURAL GATE COMPARISON STARTING ===
2025-05-31 14:51:57,110 - MoETrainer - INFO - Loading data with Hybrid DataManager...
2025-05-31 14:51:57,111 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 14:51:58,089 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 14:51:58,097 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 14:51:58,110 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 14:51:58,151 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 14:52:00,904 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 14:52:00,945 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 14:52:00,946 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 14:52:00,947 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 14:52:00,948 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 14:52:00,950 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 14:52:00,952 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 14:52:00,964 - MoETrainer - INFO - Applied robust scaling
2025-05-31 14:52:00,964 - MoETrainer - INFO - Splitting data...
2025-05-31 14:52:00,971 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 14:52:00,971 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 14:52:00,972 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 14:52:00,972 - MoETrainer - INFO - 
=== TESTING FEATURE-BASED BINNING ===
2025-05-31 14:52:00,973 - MoETrainer - INFO - Testing feature-based expert assignment...
2025-05-31 14:52:00,974 - MoETrainer - INFO - Created 1 feature-based binning rules
2025-05-31 14:52:00,974 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 14:52:00,975 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 14:52:00,975 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 14:52:06,810 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 14:52:06,810 - MoETrainer - INFO -   1. lgb_conservative: MSE=15092421370Â±1925839169, RÂ²=0.546 [SELECTED]
2025-05-31 14:52:06,811 - MoETrainer - INFO -   2. xgb_conservative: MSE=15474786645Â±1567864236, RÂ²=0.533
2025-05-31 14:52:06,811 - MoETrainer - INFO -   3. xgb_balanced: MSE=15663191723Â±1367322274, RÂ²=0.526
2025-05-31 14:52:12,442 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 14:52:12,443 - MoETrainer - INFO -   1. xgb_balanced: MSE=21903401643Â±1876338900, RÂ²=0.510 [SELECTED]
2025-05-31 14:52:12,443 - MoETrainer - INFO -   2. rf_medium: MSE=21922542685Â±1281674973, RÂ²=0.510
2025-05-31 14:52:12,443 - MoETrainer - INFO -   3. rf_deep: MSE=22304118116Â±938567705, RÂ²=0.501
2025-05-31 14:52:18,197 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 14:52:18,197 - MoETrainer - INFO -   1. xgb_conservative: MSE=56332790443Â±2367071926, RÂ²=0.411 [SELECTED]
2025-05-31 14:52:18,198 - MoETrainer - INFO -   2. rf_shallow: MSE=56749990535Â±2312864697, RÂ²=0.406
2025-05-31 14:52:18,198 - MoETrainer - INFO -   3. rf_medium: MSE=57270018677Â±1788117122, RÂ²=0.401
2025-05-31 14:52:18,199 - MoETrainer - INFO - Training selected expert models...
2025-05-31 14:52:18,244 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1165 samples
2025-05-31 14:52:18,377 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 1231 samples
2025-05-31 14:52:18,423 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1180 samples
2025-05-31 14:52:18,423 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-31 14:52:18,438 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 14:52:18,438 - MoETrainer - INFO - Overall Performance:
2025-05-31 14:52:18,439 - MoETrainer - INFO -   RMSE: $184,573
2025-05-31 14:52:18,439 - MoETrainer - INFO -   MAE: $122,906 (22.8% of mean)
2025-05-31 14:52:18,440 - MoETrainer - INFO -   RÂ²: 0.5541
2025-05-31 14:52:18,440 - MoETrainer - INFO -   MAPE: 23.7%
2025-05-31 14:52:18,440 - MoETrainer - INFO -   MPE: +9.2% (bias: overprediction)
2025-05-31 14:52:18,441 - MoETrainer - INFO -   Median APE: 17.6%
2025-05-31 14:52:18,441 - MoETrainer - INFO -   Within 5%: 14.9% of predictions
2025-05-31 14:52:18,442 - MoETrainer - INFO -   Within 10%: 29.3% of predictions
2025-05-31 14:52:18,442 - MoETrainer - INFO -   Within 15%: 44.0% of predictions
2025-05-31 14:52:18,443 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 14:52:18,443 - MoETrainer - INFO -   Bin 0: RMSE=$127,246, RÂ²=0.5597, Samples=362
2025-05-31 14:52:18,444 - MoETrainer - INFO -   Bin 1: RMSE=$159,762, RÂ²=0.3925, Samples=388
2025-05-31 14:52:18,444 - MoETrainer - INFO -   Bin 2: RMSE=$248,892, RÂ²=0.4375, Samples=351
2025-05-31 14:52:18,444 - MoETrainer - INFO - 
=== TESTING FIXED NEURAL GATE ===
2025-05-31 14:52:18,445 - MoETrainer - INFO - Testing fixed neural gate...
2025-05-31 14:52:20,170 - MoETrainer - INFO - Using device: cpu
2025-05-31 14:52:20,171 - MoETrainer - INFO - Training FIXED neural gating network...
2025-05-31 14:52:25,137 - MoETrainer - INFO - Epoch   0: Train RMSE=   63353, Val RMSE=   71983
2025-05-31 14:52:25,138 - MoETrainer - INFO -          Avg expert weights: [0.250, 0.250, 0.250, 0.250]
2025-05-31 14:52:25,150 - MoETrainer - INFO - Epoch   1: Train RMSE=   63352, Val RMSE=   71982
2025-05-31 14:52:25,161 - MoETrainer - INFO - Epoch   2: Train RMSE=   63352, Val RMSE=   71982
2025-05-31 14:52:25,170 - MoETrainer - INFO - Epoch   3: Train RMSE=   63350, Val RMSE=   71982
2025-05-31 14:52:25,181 - MoETrainer - INFO - Epoch   4: Train RMSE=   63348, Val RMSE=   71982
2025-05-31 14:52:25,195 - MoETrainer - INFO - Epoch   5: Train RMSE=   63348, Val RMSE=   71981
2025-05-31 14:52:25,207 - MoETrainer - INFO - Epoch   6: Train RMSE=   63346, Val RMSE=   71981
2025-05-31 14:52:25,216 - MoETrainer - INFO - Epoch   7: Train RMSE=   63345, Val RMSE=   71981
2025-05-31 14:52:25,225 - MoETrainer - INFO - Epoch   8: Train RMSE=   63346, Val RMSE=   71981
2025-05-31 14:52:25,234 - MoETrainer - INFO - Epoch   9: Train RMSE=   63344, Val RMSE=   71980
2025-05-31 14:52:25,321 - MoETrainer - INFO - Epoch  20: Train RMSE=   63333, Val RMSE=   71978
2025-05-31 14:52:25,461 - MoETrainer - INFO - Epoch  40: Train RMSE=   63311, Val RMSE=   71973
2025-05-31 14:52:25,462 - MoETrainer - INFO -          Avg expert weights: [0.249, 0.251, 0.251, 0.249]
2025-05-31 14:52:25,607 - MoETrainer - INFO - Epoch  60: Train RMSE=   63290, Val RMSE=   71968
2025-05-31 14:52:25,744 - MoETrainer - INFO - Epoch  80: Train RMSE=   63260, Val RMSE=   71962
2025-05-31 14:52:25,745 - MoETrainer - INFO -          Avg expert weights: [0.248, 0.253, 0.252, 0.248]
2025-05-31 14:52:25,876 - MoETrainer - INFO - Loaded best model with validation RMSE: 71957
2025-05-31 14:52:25,883 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 14:52:25,884 - MoETrainer - INFO - Overall Performance:
2025-05-31 14:52:25,884 - MoETrainer - INFO -   RMSE: $175,782
2025-05-31 14:52:25,884 - MoETrainer - INFO -   MAE: $118,278 (22.0% of mean)
2025-05-31 14:52:25,885 - MoETrainer - INFO -   RÂ²: 0.5956
2025-05-31 14:52:25,885 - MoETrainer - INFO -   MAPE: 22.9%
2025-05-31 14:52:25,885 - MoETrainer - INFO -   MPE: +8.8% (bias: overprediction)
2025-05-31 14:52:25,886 - MoETrainer - INFO -   Median APE: 17.4%
2025-05-31 14:52:25,887 - MoETrainer - INFO -   Within 5%: 15.9% of predictions
2025-05-31 14:52:25,887 - MoETrainer - INFO -   Within 10%: 31.9% of predictions
2025-05-31 14:52:25,887 - MoETrainer - INFO -   Within 15%: 43.2% of predictions
2025-05-31 14:52:25,888 - MoETrainer - INFO - Gate weight statistics:
2025-05-31 14:52:25,888 - MoETrainer - INFO -   lgb_conservative: 0.247 average weight
2025-05-31 14:52:25,889 - MoETrainer - INFO -   xgb_balanced: 0.253 average weight
2025-05-31 14:52:25,890 - MoETrainer - INFO -   rf_medium: 0.253 average weight
2025-05-31 14:52:25,890 - MoETrainer - INFO -   ridge_ensemble: 0.247 average weight
2025-05-31 14:52:25,891 - MoETrainer - INFO - 
=== TESTING SIMPLE BASELINE ===
2025-05-31 14:52:25,891 - MoETrainer - INFO - Testing simple baseline...
2025-05-31 14:52:27,856 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 14:52:27,857 - MoETrainer - INFO - Overall Performance:
2025-05-31 14:52:27,857 - MoETrainer - INFO -   RMSE: $178,930
2025-05-31 14:52:27,858 - MoETrainer - INFO -   MAE: $120,494 (22.4% of mean)
2025-05-31 14:52:27,858 - MoETrainer - INFO -   RÂ²: 0.5810
2025-05-31 14:52:27,859 - MoETrainer - INFO -   MAPE: 23.3%
2025-05-31 14:52:27,859 - MoETrainer - INFO -   MPE: +8.7% (bias: overprediction)
2025-05-31 14:52:27,860 - MoETrainer - INFO -   Median APE: 16.7%
2025-05-31 14:52:27,860 - MoETrainer - INFO -   Within 5%: 15.7% of predictions
2025-05-31 14:52:27,861 - MoETrainer - INFO -   Within 10%: 30.3% of predictions
2025-05-31 14:52:27,861 - MoETrainer - INFO -   Within 15%: 44.5% of predictions
2025-05-31 15:02:33,970 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-05-31 15:02:33,971 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-05-31 15:02:33,972 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 15:02:34,782 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 15:02:34,784 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 15:02:34,788 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 15:02:34,817 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 15:02:37,795 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 15:02:37,824 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 15:02:37,824 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 15:02:37,825 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 15:02:37,828 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 15:02:37,828 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 15:02:37,830 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 15:02:37,844 - MoETrainer - INFO - Applied robust scaling
2025-05-31 15:02:37,844 - MoETrainer - INFO - Splitting data...
2025-05-31 15:02:37,848 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 15:02:37,848 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 15:02:37,849 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 15:02:37,850 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-31 15:02:37,854 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 15:02:37,855 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 15:02:37,855 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 15:02:43,685 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 15:02:43,685 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-31 15:02:43,686 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-31 15:02:43,687 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-31 15:02:49,593 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 15:02:49,594 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-31 15:02:49,594 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-31 15:02:49,594 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-31 15:02:55,659 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 15:02:55,659 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-31 15:02:55,660 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-31 15:02:55,660 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-31 15:02:55,661 - MoETrainer - INFO - Training selected expert models...
2025-05-31 15:02:55,710 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-31 15:02:55,754 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-31 15:02:55,795 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-31 15:02:55,795 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-31 15:02:55,810 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 15:02:55,811 - MoETrainer - INFO - Overall Performance:
2025-05-31 15:02:55,811 - MoETrainer - INFO -   RMSE: $141,212
2025-05-31 15:02:55,811 - MoETrainer - INFO -   MAE: $82,758 (15.4% of mean)
2025-05-31 15:02:55,812 - MoETrainer - INFO -   RÂ²: 0.7390
2025-05-31 15:02:55,812 - MoETrainer - INFO -   MAPE: 14.1%
2025-05-31 15:02:55,812 - MoETrainer - INFO -   MPE: +3.5% (bias: overprediction)
2025-05-31 15:02:55,812 - MoETrainer - INFO -   Median APE: 10.7%
2025-05-31 15:02:55,813 - MoETrainer - INFO -   Within 5%: 23.9% of predictions
2025-05-31 15:02:55,813 - MoETrainer - INFO -   Within 10%: 47.2% of predictions
2025-05-31 15:02:55,813 - MoETrainer - INFO -   Within 15%: 67.7% of predictions
2025-05-31 15:02:55,813 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 15:02:55,814 - MoETrainer - INFO -   Bin 0: RMSE=$50,405, RÂ²=0.1927, Samples=373
2025-05-31 15:02:55,814 - MoETrainer - INFO -   Bin 1: RMSE=$43,956, RÂ²=0.1187, Samples=359
2025-05-31 15:02:55,815 - MoETrainer - INFO -   Bin 2: RMSE=$234,629, RÂ²=0.2994, Samples=369
2025-05-31 15:02:55,816 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-05-31 15:02:55,816 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 15:02:55,817 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 15:02:55,817 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 15:03:00,435 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 15:03:00,436 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-31 15:03:00,436 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-31 15:03:00,436 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-31 15:03:05,093 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 15:03:05,093 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-31 15:03:05,093 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-31 15:03:05,094 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-31 15:03:09,825 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 15:03:09,825 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-31 15:03:09,826 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-31 15:03:09,827 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-31 15:03:15,218 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 15:03:15,218 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-31 15:03:15,219 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-31 15:03:15,219 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-31 15:03:15,220 - MoETrainer - INFO - Training selected expert models...
2025-05-31 15:03:15,259 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-31 15:03:15,291 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-31 15:03:15,512 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-31 15:03:15,515 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-31 15:03:15,516 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-31 15:03:15,542 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 15:03:15,543 - MoETrainer - INFO - Overall Performance:
2025-05-31 15:03:15,543 - MoETrainer - INFO -   RMSE: $131,774
2025-05-31 15:03:15,544 - MoETrainer - INFO -   MAE: $71,137 (13.2% of mean)
2025-05-31 15:03:15,544 - MoETrainer - INFO -   RÂ²: 0.7727
2025-05-31 15:03:15,545 - MoETrainer - INFO -   MAPE: 11.6%
2025-05-31 15:03:15,545 - MoETrainer - INFO -   MPE: +3.2% (bias: overprediction)
2025-05-31 15:03:15,545 - MoETrainer - INFO -   Median APE: 8.3%
2025-05-31 15:03:15,546 - MoETrainer - INFO -   Within 5%: 29.8% of predictions
2025-05-31 15:03:15,546 - MoETrainer - INFO -   Within 10%: 60.5% of predictions
2025-05-31 15:03:15,546 - MoETrainer - INFO -   Within 15%: 77.5% of predictions
2025-05-31 15:03:15,547 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 15:03:15,547 - MoETrainer - INFO -   Bin 0: RMSE=$44,409, RÂ²=0.1239, Samples=272
2025-05-31 15:03:15,547 - MoETrainer - INFO -   Bin 1: RMSE=$28,492, RÂ²=0.0200, Samples=281
2025-05-31 15:03:15,547 - MoETrainer - INFO -   Bin 2: RMSE=$40,906, RÂ²=0.1414, Samples=253
2025-05-31 15:03:15,548 - MoETrainer - INFO -   Bin 3: RMSE=$246,537, RÂ²=0.2252, Samples=295
2025-05-31 15:03:15,548 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-05-31 15:03:15,549 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 15:03:15,550 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 15:03:15,550 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 15:03:19,586 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 15:03:19,587 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-31 15:03:19,587 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-31 15:03:19,587 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-31 15:03:23,763 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 15:03:23,764 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-31 15:03:23,764 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-31 15:03:23,765 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-31 15:03:27,942 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 15:03:27,942 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-31 15:03:27,942 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-31 15:03:27,943 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-31 15:03:32,456 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 15:03:32,457 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-31 15:03:32,457 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-31 15:03:32,457 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-31 15:03:37,179 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 15:03:37,179 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-31 15:03:37,180 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-31 15:03:37,180 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-31 15:03:37,181 - MoETrainer - INFO - Training selected expert models...
2025-05-31 15:03:37,220 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-31 15:03:37,222 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-31 15:03:37,258 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-31 15:03:37,263 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-31 15:03:37,265 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-31 15:03:37,266 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-31 15:03:37,284 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 15:03:37,286 - MoETrainer - INFO - Overall Performance:
2025-05-31 15:03:37,286 - MoETrainer - INFO -   RMSE: $118,989
2025-05-31 15:03:37,287 - MoETrainer - INFO -   MAE: $60,600 (11.3% of mean)
2025-05-31 15:03:37,287 - MoETrainer - INFO -   RÂ²: 0.8147
2025-05-31 15:03:37,287 - MoETrainer - INFO -   MAPE: 9.6%
2025-05-31 15:03:37,287 - MoETrainer - INFO -   MPE: +2.0% (bias: overprediction)
2025-05-31 15:03:37,288 - MoETrainer - INFO -   Median APE: 6.8%
2025-05-31 15:03:37,288 - MoETrainer - INFO -   Within 5%: 38.1% of predictions
2025-05-31 15:03:37,288 - MoETrainer - INFO -   Within 10%: 69.7% of predictions
2025-05-31 15:03:37,289 - MoETrainer - INFO -   Within 15%: 83.1% of predictions
2025-05-31 15:03:37,289 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 15:03:37,289 - MoETrainer - INFO -   Bin 0: RMSE=$40,646, RÂ²=0.0942, Samples=223
2025-05-31 15:03:37,289 - MoETrainer - INFO -   Bin 1: RMSE=$19,774, RÂ²=0.0186, Samples=215
2025-05-31 15:03:37,290 - MoETrainer - INFO -   Bin 2: RMSE=$28,331, RÂ²=-0.1027, Samples=233
2025-05-31 15:03:37,290 - MoETrainer - INFO -   Bin 3: RMSE=$45,828, RÂ²=0.0380, Samples=201
2025-05-31 15:03:37,290 - MoETrainer - INFO -   Bin 4: RMSE=$251,865, RÂ²=0.1874, Samples=229
2025-05-31 15:03:37,291 - MoETrainer - INFO -   5 bins: RÂ²=0.8147, RMSE=$118,989
2025-05-31 15:03:37,296 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 15:03:37,296 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 15:03:37,297 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 15:03:40,817 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 15:03:40,817 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 15:03:40,818 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 15:03:40,818 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 15:03:44,657 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 15:03:44,658 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 15:03:44,658 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 15:03:44,658 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 15:03:48,432 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 15:03:48,432 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 15:03:48,433 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 15:03:48,433 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 15:03:52,205 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 15:03:52,206 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 15:03:52,206 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 15:03:52,207 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 15:03:56,333 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 15:03:56,334 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 15:03:56,335 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 15:03:56,335 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 15:04:00,406 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 15:04:00,406 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 15:04:00,407 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 15:04:00,407 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 15:04:00,407 - MoETrainer - INFO - Training selected expert models...
2025-05-31 15:04:00,409 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 15:04:00,412 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 15:04:00,415 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 15:04:00,420 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 15:04:00,423 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 15:04:00,426 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 15:04:00,426 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 15:04:00,448 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 15:04:00,448 - MoETrainer - INFO - Overall Performance:
2025-05-31 15:04:00,449 - MoETrainer - INFO -   RMSE: $111,248
2025-05-31 15:04:00,449 - MoETrainer - INFO -   MAE: $55,539 (10.3% of mean)
2025-05-31 15:04:00,450 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-31 15:04:00,450 - MoETrainer - INFO -   MAPE: 8.7%
2025-05-31 15:04:00,451 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-05-31 15:04:00,452 - MoETrainer - INFO -   Median APE: 6.3%
2025-05-31 15:04:00,452 - MoETrainer - INFO -   Within 5%: 37.4% of predictions
2025-05-31 15:04:00,452 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-05-31 15:04:00,453 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-05-31 15:04:00,453 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 15:04:00,454 - MoETrainer - INFO -   Bin 0: RMSE=$36,946, RÂ²=0.0641, Samples=178
2025-05-31 15:04:00,456 - MoETrainer - INFO -   Bin 1: RMSE=$21,685, RÂ²=-0.0261, Samples=195
2025-05-31 15:04:00,456 - MoETrainer - INFO -   Bin 2: RMSE=$20,770, RÂ²=0.0171, Samples=180
2025-05-31 15:04:00,457 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-05-31 15:04:00,457 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-05-31 15:04:00,457 - MoETrainer - INFO -   Bin 5: RMSE=$254,108, RÂ²=0.1559, Samples=197
2025-05-31 15:04:00,458 - MoETrainer - INFO -   6 bins: RÂ²=0.8380, RMSE=$111,248
2025-05-31 15:04:00,459 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-05-31 15:04:00,459 - MoETrainer - INFO - Training final model with 6 bins...
2025-05-31 15:04:00,462 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 15:04:00,462 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 15:04:00,463 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 15:04:04,033 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 15:04:04,034 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 15:04:04,034 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 15:04:04,034 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 15:04:07,960 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 15:04:07,961 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 15:04:07,961 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 15:04:07,962 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 15:04:11,925 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 15:04:11,926 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 15:04:11,926 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 15:04:11,926 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 15:04:15,642 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 15:04:15,643 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 15:04:15,643 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 15:04:15,643 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 15:04:19,516 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 15:04:19,516 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 15:04:19,517 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 15:04:19,517 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 15:04:23,528 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 15:04:23,529 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 15:04:23,529 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 15:04:23,531 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 15:04:23,531 - MoETrainer - INFO - Training selected expert models...
2025-05-31 15:04:23,533 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 15:04:23,536 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 15:04:23,540 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 15:04:23,543 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 15:04:23,547 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 15:04:23,552 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 15:04:23,552 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 15:04:23,574 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 15:04:23,575 - MoETrainer - INFO - Overall Performance:
2025-05-31 15:04:23,575 - MoETrainer - INFO -   RMSE: $111,248
2025-05-31 15:04:23,575 - MoETrainer - INFO -   MAE: $55,539 (10.3% of mean)
2025-05-31 15:04:23,576 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-31 15:04:23,576 - MoETrainer - INFO -   MAPE: 8.7%
2025-05-31 15:04:23,576 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-05-31 15:04:23,576 - MoETrainer - INFO -   Median APE: 6.3%
2025-05-31 15:04:23,577 - MoETrainer - INFO -   Within 5%: 37.4% of predictions
2025-05-31 15:04:23,577 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-05-31 15:04:23,577 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-05-31 15:04:23,578 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 15:04:23,578 - MoETrainer - INFO -   Bin 0: RMSE=$36,946, RÂ²=0.0641, Samples=178
2025-05-31 15:04:23,579 - MoETrainer - INFO -   Bin 1: RMSE=$21,685, RÂ²=-0.0261, Samples=195
2025-05-31 15:04:23,579 - MoETrainer - INFO -   Bin 2: RMSE=$20,770, RÂ²=0.0171, Samples=180
2025-05-31 15:04:23,581 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-05-31 15:04:23,582 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-05-31 15:04:23,582 - MoETrainer - INFO -   Bin 5: RMSE=$254,108, RÂ²=0.1559, Samples=197
2025-05-31 15:04:23,583 - MoETrainer - INFO - Final Expert Configuration:
2025-05-31 15:04:23,585 - MoETrainer - INFO -   Bin 0: ridge_heavy
2025-05-31 15:04:23,586 - MoETrainer - INFO -   Bin 1: elastic_heavy
2025-05-31 15:04:23,586 - MoETrainer - INFO -   Bin 2: ridge_heavy
2025-05-31 15:04:23,586 - MoETrainer - INFO -   Bin 3: elastic_light
2025-05-31 15:04:23,587 - MoETrainer - INFO -   Bin 4: elastic_light
2025-05-31 15:04:23,587 - MoETrainer - INFO -   Bin 5: elastic_light
2025-05-31 15:04:23,588 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-05-31 15:04:23,588 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-05-31 15:04:23,589 - MoETrainer - INFO - Final Performance: RÂ² = 0.8380
2025-05-31 15:04:23,589 - MoETrainer - INFO - Final RMSE: $111,248
2025-05-31 15:04:23,589 - MoETrainer - INFO - Final MAE: $55,539
2025-05-31 15:36:34,451 - MoETrainer - INFO - === TRAINING IMPROVED NEURAL MOE ===
2025-05-31 15:36:34,452 - MoETrainer - INFO - Target: Beat baseline RÂ² = 0.8380
2025-05-31 15:36:34,452 - MoETrainer - INFO - Loading data with Hybrid DataManager...
2025-05-31 15:36:34,452 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 15:36:35,349 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 15:36:35,355 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 15:36:35,359 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 15:36:35,396 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 15:36:37,981 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 15:36:38,028 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 15:36:38,028 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 15:36:38,029 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 15:36:38,029 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 15:36:38,030 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 15:36:38,031 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 15:36:38,043 - MoETrainer - INFO - Applied robust scaling
2025-05-31 15:36:38,044 - MoETrainer - INFO - Splitting data...
2025-05-31 15:36:38,048 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 15:36:38,049 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 15:36:38,051 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 15:36:38,052 - MoETrainer - INFO - Creating specialized expert pool...
2025-05-31 15:36:38,528 - MoETrainer - INFO - â Added LightGBM conservative expert
2025-05-31 15:36:39,439 - MoETrainer - INFO - â Added XGBoost high-end specialist
2025-05-31 15:36:39,865 - MoETrainer - INFO - â Added Random Forest interaction expert
2025-05-31 15:36:39,869 - MoETrainer - INFO - â Added Ridge smooth expert
2025-05-31 15:36:39,874 - MoETrainer - INFO - â Added Elastic Net sparse expert
2025-05-31 15:36:39,875 - MoETrainer - INFO - Created 5 specialized experts: ['lgb_conservative', 'xgb_highend', 'rf_interactions', 'ridge_smooth', 'elastic_sparse']
2025-05-31 15:36:39,876 - MoETrainer - INFO - Generating expert predictions...
2025-05-31 15:36:40,076 - MoETrainer - INFO - Evaluating expert diversity...
2025-05-31 15:36:40,081 - MoETrainer - INFO -   lgb_conservative: RÂ² = 0.6154, RMSE = $170,471
2025-05-31 15:36:40,087 - MoETrainer - INFO -   xgb_highend: RÂ² = 0.6324, RMSE = $166,643
2025-05-31 15:36:40,142 - MoETrainer - INFO -   rf_interactions: RÂ² = 0.6049, RMSE = $172,778
2025-05-31 15:36:40,144 - MoETrainer - INFO -   ridge_smooth: RÂ² = 0.5604, RMSE = $182,254
2025-05-31 15:36:40,145 - MoETrainer - INFO -   elastic_sparse: RÂ² = 0.3916, RMSE = $214,396
2025-05-31 15:36:40,146 - MoETrainer - INFO - Average expert correlation: 0.899 (lower = more diverse)
2025-05-31 15:36:40,146 - MoETrainer - INFO - Training improved neural gate...
2025-05-31 15:36:40,147 - MoETrainer - INFO - Using device: cpu
2025-05-31 15:36:40,147 - MoETrainer - INFO - Training IMPROVED neural gate...
2025-05-31 15:38:28,584 - MoETrainer - INFO - === TRAINING IMPROVED NEURAL MOE ===
2025-05-31 15:38:28,584 - MoETrainer - INFO - Target: Beat baseline RÂ² = 0.8380
2025-05-31 15:38:28,584 - MoETrainer - INFO - Loading data with Hybrid DataManager...
2025-05-31 15:38:28,585 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 15:38:29,244 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 15:38:29,246 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 15:38:29,249 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 15:38:29,270 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 15:38:32,008 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 15:38:32,038 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 15:38:32,038 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 15:38:32,039 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 15:38:32,039 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 15:38:32,040 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 15:38:32,042 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 15:38:32,052 - MoETrainer - INFO - Applied robust scaling
2025-05-31 15:38:32,053 - MoETrainer - INFO - Splitting data...
2025-05-31 15:38:32,056 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 15:38:32,057 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 15:38:32,057 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 15:38:32,058 - MoETrainer - INFO - Creating specialized expert pool...
2025-05-31 15:38:32,507 - MoETrainer - INFO - â Added LightGBM conservative expert
2025-05-31 15:38:33,381 - MoETrainer - INFO - â Added XGBoost high-end specialist
2025-05-31 15:38:33,804 - MoETrainer - INFO - â Added Random Forest interaction expert
2025-05-31 15:38:33,808 - MoETrainer - INFO - â Added Ridge smooth expert
2025-05-31 15:38:33,810 - MoETrainer - INFO - â Added Elastic Net sparse expert
2025-05-31 15:38:33,811 - MoETrainer - INFO - Created 5 specialized experts: ['lgb_conservative', 'xgb_highend', 'rf_interactions', 'ridge_smooth', 'elastic_sparse']
2025-05-31 15:38:33,811 - MoETrainer - INFO - Generating expert predictions...
2025-05-31 15:38:34,025 - MoETrainer - INFO - Evaluating expert diversity...
2025-05-31 15:38:34,033 - MoETrainer - INFO -   lgb_conservative: RÂ² = 0.6154, RMSE = $170,471
2025-05-31 15:38:34,039 - MoETrainer - INFO -   xgb_highend: RÂ² = 0.6324, RMSE = $166,643
2025-05-31 15:38:34,089 - MoETrainer - INFO -   rf_interactions: RÂ² = 0.6049, RMSE = $172,778
2025-05-31 15:38:34,091 - MoETrainer - INFO -   ridge_smooth: RÂ² = 0.5604, RMSE = $182,254
2025-05-31 15:38:34,092 - MoETrainer - INFO -   elastic_sparse: RÂ² = 0.3916, RMSE = $214,396
2025-05-31 15:38:34,093 - MoETrainer - INFO - Average expert correlation: 0.899 (lower = more diverse)
2025-05-31 15:38:34,093 - MoETrainer - INFO - Training improved neural gate...
2025-05-31 15:38:34,094 - MoETrainer - INFO - Using device: cpu
2025-05-31 15:38:34,094 - MoETrainer - INFO - Training IMPROVED neural gate...
2025-05-31 15:38:36,837 - MoETrainer - INFO - Epoch   0: Train RMSE=33097370774, Val RMSE=45153439949, Temp=3.00
2025-05-31 15:38:36,837 - MoETrainer - INFO -          Expert weights: [0.200, 0.200, 0.200, 0.200, 0.200]
2025-05-31 15:38:37,077 - MoETrainer - INFO - Epoch  25: Train RMSE=32743927041, Val RMSE=45156789914, Temp=2.75
2025-05-31 15:38:37,166 - MoETrainer - INFO - Early stopping at epoch 36
2025-05-31 15:38:37,167 - MoETrainer - INFO - Loaded best model with validation RMSE: 45151408195
2025-05-31 15:38:37,168 - MoETrainer - INFO - Making final predictions...
2025-05-31 15:38:37,173 - MoETrainer - INFO - === COMPREHENSIVE EVALUATION ===
2025-05-31 15:38:37,174 - MoETrainer - INFO - Overall Performance:
2025-05-31 15:38:37,174 - MoETrainer - INFO -   RÂ²: 0.5804
2025-05-31 15:38:37,175 - MoETrainer - INFO -   RMSE: $179,064
2025-05-31 15:38:37,175 - MoETrainer - INFO -   MAE: $120,477 (22.4% of mean)
2025-05-31 15:38:37,175 - MoETrainer - INFO -   MAPE: 23.6%
2025-05-31 15:38:37,175 - MoETrainer - INFO -   Within 5%: 15.3% of predictions
2025-05-31 15:38:37,176 - MoETrainer - INFO -   Within 10%: 29.8% of predictions
2025-05-31 15:38:37,176 - MoETrainer - INFO -   Within 15%: 43.3% of predictions
2025-05-31 15:38:37,176 - MoETrainer - INFO - 
Gate Analysis:
2025-05-31 15:38:37,177 - MoETrainer - INFO -   Best individual expert: lgb_conservative (RÂ² = 0.6100)
2025-05-31 15:38:37,177 - MoETrainer - INFO -   Gate improvement: -4.9% over best expert
2025-05-31 15:38:37,177 - MoETrainer - INFO -   Gate entropy: 1.000 (1.0 = perfect blending)
2025-05-31 15:38:37,177 - MoETrainer - INFO - 
Expert Utilization:
2025-05-31 15:38:37,178 - MoETrainer - INFO -   lgb_conservative    :  19.8% â
2025-05-31 15:38:37,178 - MoETrainer - INFO -   xgb_highend         :  20.2% ââ
2025-05-31 15:38:37,178 - MoETrainer - INFO -   rf_interactions     :  20.4% ââ
2025-05-31 15:38:37,179 - MoETrainer - INFO -   ridge_smooth        :  19.8% â
2025-05-31 15:38:37,179 - MoETrainer - INFO -   elastic_sparse      :  19.7% â
2025-05-31 15:38:37,180 - MoETrainer - INFO - â Gate is blending experts well
2025-05-31 15:38:37,181 - MoETrainer - INFO - === NEURAL MOE TRAINING COMPLETE ===
2025-05-31 15:38:37,181 - MoETrainer - INFO - Final Performance: RÂ² = 0.5804
2025-05-31 15:38:37,181 - MoETrainer - INFO - Baseline Target: RÂ² = 0.8380
2025-05-31 15:38:37,181 - MoETrainer - INFO - â ï¸ Neural MoE performance 30.7% below baseline
2025-05-31 16:45:16,696 - MoETrainer - INFO - === TRAINING NEURAL BASELINE MODEL ===
2025-05-31 16:45:16,696 - MoETrainer - INFO - Configuration: Neural Gate + Enhanced Expert Factory
2025-05-31 16:45:16,697 - MoETrainer - INFO - Goal: Beat baseline RÂ² = 0.8380
2025-05-31 16:45:16,697 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 16:45:17,520 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 16:45:17,522 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 16:45:17,525 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 16:45:17,547 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 16:45:20,362 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 16:45:20,390 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 16:45:20,391 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 16:45:20,391 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 16:45:20,392 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 16:45:20,392 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 16:45:20,394 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 16:45:20,400 - MoETrainer - INFO - Applied robust scaling
2025-05-31 16:45:20,401 - MoETrainer - INFO - Splitting data...
2025-05-31 16:45:20,405 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 16:45:20,406 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 16:45:20,407 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 16:45:20,407 - MoETrainer - INFO - Creating bin-specific experts using EnhancedExpertFactory...
2025-05-31 16:45:20,408 - MoETrainer - INFO - Created 6 bins with boundaries: [325000. 395000. 465000. 560000. 725000.]
2025-05-31 16:45:20,409 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 16:45:20,409 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 16:45:20,409 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 16:45:23,660 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 16:45:23,661 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 16:45:23,661 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 16:45:23,662 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 16:45:27,091 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 16:45:27,092 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 16:45:27,093 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 16:45:27,093 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 16:45:30,272 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 16:45:30,272 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 16:45:30,273 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 16:45:30,273 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 16:45:33,899 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 16:45:33,900 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 16:45:33,900 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 16:45:33,900 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 16:45:37,236 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 16:45:37,237 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 16:45:37,237 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 16:45:37,237 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 16:45:40,685 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 16:45:40,686 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 16:45:40,687 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 16:45:40,688 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 16:45:40,688 - MoETrainer - INFO - Training selected expert models...
2025-05-31 16:45:40,690 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 16:45:40,692 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 16:45:40,694 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 16:45:40,697 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 16:45:40,699 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 16:45:40,702 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 16:45:40,703 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 16:45:40,703 - MoETrainer - INFO - Bin-specific expert configuration:
2025-05-31 16:45:40,704 - MoETrainer - INFO -   Bin 0: ridge_heavy_bin0 (531 samples)
2025-05-31 16:45:40,704 - MoETrainer - INFO -   Bin 1: elastic_heavy_bin1 (638 samples)
2025-05-31 16:45:40,705 - MoETrainer - INFO -   Bin 2: ridge_heavy_bin2 (615 samples)
2025-05-31 16:45:40,705 - MoETrainer - INFO -   Bin 3: elastic_light_bin3 (599 samples)
2025-05-31 16:45:40,706 - MoETrainer - INFO -   Bin 4: elastic_light_bin4 (596 samples)
2025-05-31 16:45:40,706 - MoETrainer - INFO -   Bin 5: elastic_light_bin5 (597 samples)
2025-05-31 16:45:40,707 - MoETrainer - INFO - Training neural gate for soft bin routing...
2025-05-31 16:45:40,710 - MoETrainer - INFO - Individual bin expert performance:
2025-05-31 16:45:40,712 - MoETrainer - INFO -   ridge_heavy_bin0: RÂ² = -0.8294, RMSE = $371,776
2025-05-31 16:45:40,714 - MoETrainer - INFO -   elastic_heavy_bin1: RÂ² = -0.4579, RMSE = $331,894
2025-05-31 16:45:40,715 - MoETrainer - INFO -   ridge_heavy_bin2: RÂ² = -0.1032, RMSE = $288,699
2025-05-31 16:45:40,719 - MoETrainer - INFO -   elastic_light_bin3: RÂ² = 0.0108, RMSE = $273,376
2025-05-31 16:45:40,721 - MoETrainer - INFO -   elastic_light_bin4: RÂ² = -0.0284, RMSE = $278,749
2025-05-31 16:45:40,723 - MoETrainer - INFO -   elastic_light_bin5: RÂ² = -1.2219, RMSE = $409,722
2025-05-31 16:45:40,725 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 16:45:43,648 - MoETrainer - INFO - Epoch   0: Pred RMSE=66827564116, Val RMSE=68253983908, Bin Loss=1.7927
2025-05-31 16:45:43,648 - MoETrainer - INFO -          Bin weights: [0.167, 0.166, 0.167, 0.167, 0.167, 0.166]
2025-05-31 16:45:43,985 - MoETrainer - INFO - Epoch  25: Pred RMSE=66817747473, Val RMSE=68225942135, Bin Loss=1.7916
2025-05-31 16:45:44,311 - MoETrainer - INFO - Epoch  50: Pred RMSE=66789989684, Val RMSE=68208451281, Bin Loss=1.7911
2025-05-31 16:45:44,312 - MoETrainer - INFO -          Bin weights: [0.167, 0.166, 0.167, 0.167, 0.167, 0.166]
2025-05-31 16:45:44,638 - MoETrainer - INFO - Epoch  75: Pred RMSE=66764460245, Val RMSE=68177246223, Bin Loss=1.7901
2025-05-31 16:45:44,960 - MoETrainer - INFO - Epoch 100: Pred RMSE=66716816224, Val RMSE=68123405591, Bin Loss=1.7892
2025-05-31 16:45:44,960 - MoETrainer - INFO -          Bin weights: [0.167, 0.166, 0.167, 0.167, 0.167, 0.167]
2025-05-31 16:45:45,296 - MoETrainer - INFO - Epoch 125: Pred RMSE=66638837084, Val RMSE=68031076167, Bin Loss=1.7880
2025-05-31 16:45:45,609 - MoETrainer - INFO - Loaded best model with validation RMSE: 67868819789
2025-05-31 16:45:45,609 - MoETrainer - INFO - Final model evaluation...
2025-05-31 16:45:45,626 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 16:45:45,627 - MoETrainer - INFO - Overall Performance:
2025-05-31 16:45:45,627 - MoETrainer - INFO -   RMSE: $261,648
2025-05-31 16:45:45,627 - MoETrainer - INFO -   MAE: $181,915 (33.8% of mean)
2025-05-31 16:45:45,628 - MoETrainer - INFO -   RÂ²: 0.1040
2025-05-31 16:45:45,628 - MoETrainer - INFO -   MAPE: 36.6%
2025-05-31 16:45:45,628 - MoETrainer - INFO -   MPE: +15.4% (bias: overprediction)
2025-05-31 16:45:45,628 - MoETrainer - INFO -   Median APE: 29.4%
2025-05-31 16:45:45,628 - MoETrainer - INFO -   Within 5%: 8.4% of predictions
2025-05-31 16:45:45,629 - MoETrainer - INFO -   Within 10%: 17.9% of predictions
2025-05-31 16:45:45,629 - MoETrainer - INFO -   Within 15%: 27.6% of predictions
2025-05-31 16:45:45,629 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 16:45:45,630 - MoETrainer - INFO -   Bin 0: RMSE=$159,607, RÂ²=-0.3738, Samples=276
2025-05-31 16:45:45,631 - MoETrainer - INFO -   Bin 1: RMSE=$188,862, RÂ²=-0.2713, Samples=2
2025-05-31 16:45:45,631 - MoETrainer - INFO -   Bin 2: RMSE=$174,034, RÂ²=-0.8951, Samples=223
2025-05-31 16:45:45,631 - MoETrainer - INFO -   Bin 3: RMSE=$373,168, RÂ²=-0.1855, Samples=317
2025-05-31 16:45:45,632 - MoETrainer - INFO -   Bin 4: RMSE=$165,430, RÂ²=-0.0065, Samples=93
2025-05-31 16:45:45,632 - MoETrainer - INFO -   Bin 5: RMSE=$279,368, RÂ²=-0.1394, Samples=190
2025-05-31 16:45:45,636 - MoETrainer - INFO - === NEURAL BASELINE EVALUATION ===
2025-05-31 16:45:45,636 - MoETrainer - INFO - Neural Gate Analysis:
2025-05-31 16:45:45,636 - MoETrainer - INFO -   Best individual expert: elastic_light_bin3 (RÂ² = 0.0133)
2025-05-31 16:45:45,637 - MoETrainer - INFO -   Gate improvement: +683.2% over best expert
2025-05-31 16:45:45,637 - MoETrainer - INFO -   Gate entropy: 1.000 (1.0 = perfect blending)
2025-05-31 16:45:45,637 - MoETrainer - INFO - Bin Utilization:
2025-05-31 16:45:45,637 - MoETrainer - INFO -   ridge_heavy_bin0:  16.7%
2025-05-31 16:45:45,638 - MoETrainer - INFO -   elastic_heavy_bin1:  16.5%
2025-05-31 16:45:45,638 - MoETrainer - INFO -   ridge_heavy_bin2:  16.6%
2025-05-31 16:45:45,638 - MoETrainer - INFO -   elastic_light_bin3:  16.8%
2025-05-31 16:45:45,638 - MoETrainer - INFO -   elastic_light_bin4:  16.7%
2025-05-31 16:45:45,638 - MoETrainer - INFO -   elastic_light_bin5:  16.7%
2025-05-31 16:45:45,639 - MoETrainer - INFO - === NEURAL BASELINE TRAINING COMPLETE ===
2025-05-31 16:45:45,639 - MoETrainer - INFO - Final Performance: RÂ² = 0.1040
2025-05-31 16:45:45,639 - MoETrainer - INFO - Baseline Target: RÂ² = 0.8380
2025-05-31 16:45:45,639 - MoETrainer - INFO - â ï¸ Neural baseline performance 87.6% below target
2025-05-31 17:37:13,226 - MoETrainer - INFO - === TRAINING NEURAL BASELINE MODEL ===
2025-05-31 17:37:13,227 - MoETrainer - INFO - Configuration: Neural Gate + Enhanced Expert Factory
2025-05-31 17:37:13,227 - MoETrainer - INFO - Goal: Beat baseline RÂ² = 0.8380
2025-05-31 17:37:13,227 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 17:37:14,298 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 17:37:14,300 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 17:37:14,304 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 17:37:14,331 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 17:37:17,275 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 17:37:17,312 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 17:37:17,312 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 17:37:17,312 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 17:37:17,313 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 17:37:17,313 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 17:37:17,314 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 17:37:17,321 - MoETrainer - INFO - Applied robust scaling
2025-05-31 17:37:17,324 - MoETrainer - INFO - Splitting data...
2025-05-31 17:37:17,327 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 17:37:17,327 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 17:37:17,327 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 17:37:17,327 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-31 17:37:17,328 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 17:37:17,328 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 17:37:17,329 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 17:37:23,430 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 17:37:23,430 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-31 17:37:23,431 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-31 17:37:23,431 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-31 17:37:29,018 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 17:37:29,019 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-31 17:37:29,019 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-31 17:37:29,019 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-31 17:37:35,978 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 17:37:35,978 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-31 17:37:35,979 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-31 17:37:35,979 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-31 17:37:35,980 - MoETrainer - INFO - Training selected expert models...
2025-05-31 17:37:36,037 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-31 17:37:36,086 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-31 17:37:36,124 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-31 17:37:36,124 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-31 17:37:36,152 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 17:37:39,298 - MoETrainer - INFO - Epoch   0: Pred RMSE=61227663697, Val RMSE=64783274755, Bin Loss=1.0976
2025-05-31 17:37:39,299 - MoETrainer - INFO -          Bin weights: [0.333, 0.333, 0.333]
2025-05-31 17:37:39,681 - MoETrainer - INFO - Epoch  25: Pred RMSE=61186344984, Val RMSE=64699089531, Bin Loss=1.0964
2025-05-31 17:37:40,046 - MoETrainer - INFO - Epoch  50: Pred RMSE=61123124201, Val RMSE=64578279566, Bin Loss=1.0951
2025-05-31 17:37:40,046 - MoETrainer - INFO -          Bin weights: [0.333, 0.333, 0.334]
2025-05-31 17:37:40,420 - MoETrainer - INFO - Epoch  75: Pred RMSE=61035751817, Val RMSE=64432240031, Bin Loss=1.0939
2025-05-31 17:37:40,816 - MoETrainer - INFO - Epoch 100: Pred RMSE=60887348550, Val RMSE=64221133898, Bin Loss=1.0923
2025-05-31 17:37:40,817 - MoETrainer - INFO -          Bin weights: [0.333, 0.333, 0.335]
2025-05-31 17:37:41,196 - MoETrainer - INFO - Epoch 125: Pred RMSE=60679030620, Val RMSE=63890620222, Bin Loss=1.0903
2025-05-31 17:37:41,572 - MoETrainer - INFO - Loaded best model with validation RMSE: 63353827847
2025-05-31 17:37:41,584 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 17:37:41,584 - MoETrainer - INFO - Overall Performance:
2025-05-31 17:37:41,585 - MoETrainer - INFO -   RMSE: $241,228
2025-05-31 17:37:41,585 - MoETrainer - INFO -   MAE: $164,174 (30.5% of mean)
2025-05-31 17:37:41,585 - MoETrainer - INFO -   RÂ²: 0.2384
2025-05-31 17:37:41,586 - MoETrainer - INFO -   MAPE: 32.6%
2025-05-31 17:37:41,586 - MoETrainer - INFO -   MPE: +12.7% (bias: overprediction)
2025-05-31 17:37:41,586 - MoETrainer - INFO -   Median APE: 25.5%
2025-05-31 17:37:41,586 - MoETrainer - INFO -   Within 5%: 11.6% of predictions
2025-05-31 17:37:41,587 - MoETrainer - INFO -   Within 10%: 21.9% of predictions
2025-05-31 17:37:41,587 - MoETrainer - INFO -   Within 15%: 31.6% of predictions
2025-05-31 17:37:41,587 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 17:37:41,588 - MoETrainer - INFO -   Bin 0: RMSE=$174,041, RÂ²=-8.6252, Samples=373
2025-05-31 17:37:41,588 - MoETrainer - INFO -   Bin 1: RMSE=$56,346, RÂ²=-0.4482, Samples=359
2025-05-31 17:37:41,588 - MoETrainer - INFO -   Bin 2: RMSE=$374,059, RÂ²=-0.7808, Samples=369
2025-05-31 17:37:41,588 - MoETrainer - INFO -   3 bins: RÂ²=0.2384, RMSE=$241,228
2025-05-31 17:37:41,589 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 17:37:41,590 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 17:37:41,590 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 17:37:46,201 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 17:37:46,202 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-31 17:37:46,202 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-31 17:37:46,202 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-31 17:37:50,996 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 17:37:50,996 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-31 17:37:50,996 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-31 17:37:50,997 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-31 17:37:56,369 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 17:37:56,369 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-31 17:37:56,370 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-31 17:37:56,370 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-31 17:38:03,986 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 17:38:03,987 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-31 17:38:03,987 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-31 17:38:03,987 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-31 17:38:03,988 - MoETrainer - INFO - Training selected expert models...
2025-05-31 17:38:04,009 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-31 17:38:04,050 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-31 17:38:04,274 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-31 17:38:04,276 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-31 17:38:04,276 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-31 17:38:04,353 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 17:38:04,375 - MoETrainer - INFO - Epoch   0: Pred RMSE=63993114921, Val RMSE=65451079151, Bin Loss=1.3861
2025-05-31 17:38:04,376 - MoETrainer - INFO -          Bin weights: [0.250, 0.250, 0.250, 0.250]
2025-05-31 17:38:04,771 - MoETrainer - INFO - Epoch  25: Pred RMSE=63971585281, Val RMSE=65430510532, Bin Loss=1.3854
2025-05-31 17:38:05,135 - MoETrainer - INFO - Epoch  50: Pred RMSE=63943093440, Val RMSE=65384155251, Bin Loss=1.3846
2025-05-31 17:38:05,135 - MoETrainer - INFO -          Bin weights: [0.250, 0.250, 0.249, 0.251]
2025-05-31 17:38:05,509 - MoETrainer - INFO - Epoch  75: Pred RMSE=63912001651, Val RMSE=65339283369, Bin Loss=1.3835
2025-05-31 17:38:05,873 - MoETrainer - INFO - Epoch 100: Pred RMSE=63833191132, Val RMSE=65265210474, Bin Loss=1.3825
2025-05-31 17:38:05,874 - MoETrainer - INFO -          Bin weights: [0.250, 0.250, 0.249, 0.251]
2025-05-31 17:38:06,336 - MoETrainer - INFO - Epoch 125: Pred RMSE=63704439836, Val RMSE=65143631588, Bin Loss=1.3811
2025-05-31 17:38:06,700 - MoETrainer - INFO - Loaded best model with validation RMSE: 64934867050
2025-05-31 17:38:06,710 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 17:38:06,711 - MoETrainer - INFO - Overall Performance:
2025-05-31 17:38:06,711 - MoETrainer - INFO -   RMSE: $250,734
2025-05-31 17:38:06,711 - MoETrainer - INFO -   MAE: $169,444 (31.5% of mean)
2025-05-31 17:38:06,711 - MoETrainer - INFO -   RÂ²: 0.1772
2025-05-31 17:38:06,712 - MoETrainer - INFO -   MAPE: 33.2%
2025-05-31 17:38:06,712 - MoETrainer - INFO -   MPE: +12.4% (bias: overprediction)
2025-05-31 17:38:06,712 - MoETrainer - INFO -   Median APE: 26.2%
2025-05-31 17:38:06,712 - MoETrainer - INFO -   Within 5%: 11.1% of predictions
2025-05-31 17:38:06,716 - MoETrainer - INFO -   Within 10%: 20.4% of predictions
2025-05-31 17:38:06,716 - MoETrainer - INFO -   Within 15%: 29.9% of predictions
2025-05-31 17:38:06,717 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 17:38:06,717 - MoETrainer - INFO -   Bin 0: RMSE=$192,356, RÂ²=-15.4369, Samples=272
2025-05-31 17:38:06,717 - MoETrainer - INFO -   Bin 1: RMSE=$89,312, RÂ²=-8.6298, Samples=281
2025-05-31 17:38:06,718 - MoETrainer - INFO -   Bin 2: RMSE=$46,181, RÂ²=-0.0943, Samples=253
2025-05-31 17:38:06,718 - MoETrainer - INFO -   Bin 3: RMSE=$437,140, RÂ²=-1.4361, Samples=295
2025-05-31 17:38:06,718 - MoETrainer - INFO -   4 bins: RÂ²=0.1772, RMSE=$250,734
2025-05-31 17:38:06,719 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 17:38:06,720 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 17:38:06,721 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 17:38:10,468 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 17:38:10,469 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-31 17:38:10,469 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-31 17:38:10,469 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-31 17:38:14,688 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 17:38:14,689 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-31 17:38:14,689 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-31 17:38:14,689 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-31 17:38:18,829 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 17:38:18,829 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-31 17:38:18,830 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-31 17:38:18,830 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-31 17:38:24,601 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 17:38:24,602 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-31 17:38:24,602 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-31 17:38:24,603 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-31 17:38:30,630 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 17:38:30,630 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-31 17:38:30,631 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-31 17:38:30,631 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-31 17:38:30,632 - MoETrainer - INFO - Training selected expert models...
2025-05-31 17:38:30,693 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-31 17:38:30,695 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-31 17:38:30,732 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-31 17:38:30,740 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-31 17:38:30,742 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-31 17:38:30,743 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-31 17:38:30,776 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 17:38:30,810 - MoETrainer - INFO - Epoch   0: Pred RMSE=66240342897, Val RMSE=67748341217, Bin Loss=1.6082
2025-05-31 17:38:30,811 - MoETrainer - INFO -          Bin weights: [0.200, 0.200, 0.200, 0.200, 0.200]
2025-05-31 17:38:31,266 - MoETrainer - INFO - Epoch  25: Pred RMSE=66203586322, Val RMSE=67648664507, Bin Loss=1.6074
2025-05-31 17:38:31,727 - MoETrainer - INFO - Epoch  50: Pred RMSE=66171209825, Val RMSE=67580763603, Bin Loss=1.6065
2025-05-31 17:38:31,728 - MoETrainer - INFO -          Bin weights: [0.200, 0.200, 0.200, 0.200, 0.201]
2025-05-31 17:38:32,174 - MoETrainer - INFO - Epoch  75: Pred RMSE=66126708934, Val RMSE=67522018080, Bin Loss=1.6055
2025-05-31 17:38:32,655 - MoETrainer - INFO - Epoch 100: Pred RMSE=66036744040, Val RMSE=67429436693, Bin Loss=1.6043
2025-05-31 17:38:32,655 - MoETrainer - INFO -          Bin weights: [0.200, 0.200, 0.199, 0.200, 0.201]
2025-05-31 17:38:33,235 - MoETrainer - INFO - Epoch 125: Pred RMSE=65892330864, Val RMSE=67269264663, Bin Loss=1.6028
2025-05-31 17:38:33,680 - MoETrainer - INFO - Loaded best model with validation RMSE: 66989043413
2025-05-31 17:38:33,695 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 17:38:33,696 - MoETrainer - INFO - Overall Performance:
2025-05-31 17:38:33,696 - MoETrainer - INFO -   RMSE: $258,467
2025-05-31 17:38:33,697 - MoETrainer - INFO -   MAE: $179,087 (33.3% of mean)
2025-05-31 17:38:33,697 - MoETrainer - INFO -   RÂ²: 0.1257
2025-05-31 17:38:33,699 - MoETrainer - INFO -   MAPE: 35.9%
2025-05-31 17:38:33,700 - MoETrainer - INFO -   MPE: +15.0% (bias: overprediction)
2025-05-31 17:38:33,700 - MoETrainer - INFO -   Median APE: 28.8%
2025-05-31 17:38:33,700 - MoETrainer - INFO -   Within 5%: 9.5% of predictions
2025-05-31 17:38:33,706 - MoETrainer - INFO -   Within 10%: 18.6% of predictions
2025-05-31 17:38:33,709 - MoETrainer - INFO -   Within 15%: 27.8% of predictions
2025-05-31 17:38:33,709 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 17:38:33,711 - MoETrainer - INFO -   Bin 0: RMSE=$221,747, RÂ²=-25.9589, Samples=223
2025-05-31 17:38:33,714 - MoETrainer - INFO -   Bin 1: RMSE=$126,056, RÂ²=-38.8846, Samples=215
2025-05-31 17:38:33,715 - MoETrainer - INFO -   Bin 2: RMSE=$54,741, RÂ²=-3.1168, Samples=233
2025-05-31 17:38:33,717 - MoETrainer - INFO -   Bin 3: RMSE=$84,034, RÂ²=-2.2346, Samples=201
2025-05-31 17:38:33,717 - MoETrainer - INFO -   Bin 4: RMSE=$499,140, RÂ²=-2.1915, Samples=229
2025-05-31 17:38:33,720 - MoETrainer - INFO -   5 bins: RÂ²=0.1257, RMSE=$258,467
2025-05-31 17:38:33,721 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 17:38:33,722 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 17:38:33,724 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 17:38:36,770 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 17:38:36,770 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 17:38:36,771 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 17:38:36,771 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 17:38:40,452 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 17:38:40,453 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 17:38:40,453 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 17:38:40,454 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 17:38:44,541 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 17:38:44,541 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 17:38:44,542 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 17:38:44,543 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 17:38:49,409 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 17:38:49,410 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 17:38:49,411 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 17:38:49,411 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 17:38:53,579 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 17:38:53,580 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 17:38:53,580 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 17:38:53,580 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 17:38:57,903 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 17:38:57,904 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 17:38:57,905 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 17:38:57,907 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 17:38:57,909 - MoETrainer - INFO - Training selected expert models...
2025-05-31 17:38:57,911 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 17:38:57,913 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 17:38:57,915 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 17:38:57,917 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 17:38:57,919 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 17:38:57,922 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 17:38:57,925 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 17:38:57,931 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 17:38:57,955 - MoETrainer - INFO - Epoch   0: Pred RMSE=66827753463, Val RMSE=68251521127, Bin Loss=1.7921
2025-05-31 17:38:57,955 - MoETrainer - INFO -          Bin weights: [0.167, 0.167, 0.167, 0.167, 0.166, 0.167]
2025-05-31 17:38:58,279 - MoETrainer - INFO - Epoch  25: Pred RMSE=66809401547, Val RMSE=68219882604, Bin Loss=1.7914
2025-05-31 17:38:58,670 - MoETrainer - INFO - Epoch  50: Pred RMSE=66782846042, Val RMSE=68193374520, Bin Loss=1.7906
2025-05-31 17:38:58,671 - MoETrainer - INFO -          Bin weights: [0.166, 0.167, 0.167, 0.167, 0.166, 0.167]
2025-05-31 17:38:59,161 - MoETrainer - INFO - Epoch  75: Pred RMSE=66751133945, Val RMSE=68158019294, Bin Loss=1.7900
2025-05-31 17:38:59,655 - MoETrainer - INFO - Epoch 100: Pred RMSE=66695904939, Val RMSE=68098131102, Bin Loss=1.7893
2025-05-31 17:38:59,656 - MoETrainer - INFO -          Bin weights: [0.166, 0.166, 0.167, 0.167, 0.166, 0.168]
2025-05-31 17:39:00,262 - MoETrainer - INFO - Epoch 125: Pred RMSE=66631092417, Val RMSE=67990548374, Bin Loss=1.7880
2025-05-31 17:39:00,729 - MoETrainer - INFO - Loaded best model with validation RMSE: 67794040761
2025-05-31 17:39:00,745 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 17:39:00,745 - MoETrainer - INFO - Overall Performance:
2025-05-31 17:39:00,746 - MoETrainer - INFO -   RMSE: $261,517
2025-05-31 17:39:00,746 - MoETrainer - INFO -   MAE: $182,164 (33.8% of mean)
2025-05-31 17:39:00,747 - MoETrainer - INFO -   RÂ²: 0.1049
2025-05-31 17:39:00,747 - MoETrainer - INFO -   MAPE: 36.7%
2025-05-31 17:39:00,747 - MoETrainer - INFO -   MPE: +15.6% (bias: overprediction)
2025-05-31 17:39:00,747 - MoETrainer - INFO -   Median APE: 29.4%
2025-05-31 17:39:00,748 - MoETrainer - INFO -   Within 5%: 8.3% of predictions
2025-05-31 17:39:00,748 - MoETrainer - INFO -   Within 10%: 17.7% of predictions
2025-05-31 17:39:00,749 - MoETrainer - INFO -   Within 15%: 27.5% of predictions
2025-05-31 17:39:00,749 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 17:39:00,750 - MoETrainer - INFO -   Bin 0: RMSE=$238,914, RÂ²=-38.1371, Samples=178
2025-05-31 17:39:00,750 - MoETrainer - INFO -   Bin 1: RMSE=$147,395, RÂ²=-46.4040, Samples=195
2025-05-31 17:39:00,751 - MoETrainer - INFO -   Bin 2: RMSE=$85,969, RÂ²=-15.8396, Samples=180
2025-05-31 17:39:00,751 - MoETrainer - INFO -   Bin 3: RMSE=$30,197, RÂ²=-0.1368, Samples=179
2025-05-31 17:39:00,751 - MoETrainer - INFO -   Bin 4: RMSE=$115,805, RÂ²=-5.4329, Samples=172
2025-05-31 17:39:00,752 - MoETrainer - INFO -   Bin 5: RMSE=$538,384, RÂ²=-2.7891, Samples=197
2025-05-31 17:39:00,752 - MoETrainer - INFO -   6 bins: RÂ²=0.1049, RMSE=$261,517
2025-05-31 17:39:00,752 - MoETrainer - INFO - Optimal configuration: 3 bins
2025-05-31 17:39:00,753 - MoETrainer - INFO - Training final model with 3 bins...
2025-05-31 17:39:00,754 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 17:39:00,755 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 17:39:00,755 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 17:39:05,958 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 17:39:05,958 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-31 17:39:05,959 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-31 17:39:05,959 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-31 17:39:11,166 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 17:39:11,167 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-31 17:39:11,168 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-31 17:39:11,169 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-31 17:39:16,820 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 17:39:16,820 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-31 17:39:16,820 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-31 17:39:16,820 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-31 17:39:16,821 - MoETrainer - INFO - Training selected expert models...
2025-05-31 17:39:16,863 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-31 17:39:16,908 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-31 17:39:16,950 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-31 17:39:16,951 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-31 17:39:16,982 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 17:39:17,002 - MoETrainer - INFO - Epoch   0: Pred RMSE=61299435289, Val RMSE=64794888716, Bin Loss=1.1001
2025-05-31 17:39:17,003 - MoETrainer - INFO -          Bin weights: [0.334, 0.333, 0.333]
2025-05-31 17:39:17,379 - MoETrainer - INFO - Early stopping at epoch 20
2025-05-31 17:39:17,380 - MoETrainer - INFO - Loaded best model with validation RMSE: 64794888716
2025-05-31 17:39:17,391 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 17:39:17,391 - MoETrainer - INFO - Overall Performance:
2025-05-31 17:39:17,391 - MoETrainer - INFO -   RMSE: $245,021
2025-05-31 17:39:17,392 - MoETrainer - INFO -   MAE: $166,283 (30.9% of mean)
2025-05-31 17:39:17,393 - MoETrainer - INFO -   RÂ²: 0.2143
2025-05-31 17:39:17,393 - MoETrainer - INFO -   MAPE: 32.9%
2025-05-31 17:39:17,393 - MoETrainer - INFO -   MPE: +12.4% (bias: overprediction)
2025-05-31 17:39:17,393 - MoETrainer - INFO -   Median APE: 25.7%
2025-05-31 17:39:17,394 - MoETrainer - INFO -   Within 5%: 11.5% of predictions
2025-05-31 17:39:17,394 - MoETrainer - INFO -   Within 10%: 21.3% of predictions
2025-05-31 17:39:17,394 - MoETrainer - INFO -   Within 15%: 31.2% of predictions
2025-05-31 17:39:17,395 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 17:39:17,395 - MoETrainer - INFO -   Bin 0: RMSE=$174,470, RÂ²=-8.6726, Samples=373
2025-05-31 17:39:17,396 - MoETrainer - INFO -   Bin 1: RMSE=$55,545, RÂ²=-0.4074, Samples=359
2025-05-31 17:39:17,399 - MoETrainer - INFO -   Bin 2: RMSE=$381,260, RÂ²=-0.8500, Samples=369
2025-05-31 17:39:17,400 - MoETrainer - INFO - Final Expert Configuration:
2025-05-31 17:39:17,400 - MoETrainer - INFO -   Bin 0: lgb_conservative
2025-05-31 17:39:17,400 - MoETrainer - INFO -   Bin 1: xgb_conservative
2025-05-31 17:39:17,401 - MoETrainer - INFO -   Bin 2: lgb_conservative
2025-05-31 17:39:17,401 - MoETrainer - INFO - === COMPREHENSIVE NEURAL BASELINE EVALUATION ===
2025-05-31 17:39:17,401 - MoETrainer - INFO - === NEURAL BASELINE TRAINING COMPLETE ===
2025-05-31 17:39:17,401 - MoETrainer - INFO - Final Performance: RÂ² = 0.2143
2025-05-31 17:39:17,402 - MoETrainer - INFO - Baseline Target: RÂ² = 0.8380
2025-05-31 17:39:17,402 - MoETrainer - INFO - â ï¸ Neural baseline performance 74.4% below target
2025-05-31 22:44:17,043 - MoETrainer - INFO - === TRAINING NEURAL BASELINE MODEL ===
2025-05-31 22:44:17,044 - MoETrainer - INFO - Configuration: Neural Gate + Enhanced Expert Factory
2025-05-31 22:44:17,045 - MoETrainer - INFO - Goal: Beat baseline RÂ² = 0.8380
2025-05-31 22:44:17,045 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 22:44:17,973 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 22:44:17,975 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 22:44:17,979 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 22:44:18,000 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 22:44:21,773 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 22:44:21,824 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 22:44:21,825 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 22:44:21,826 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 22:44:21,826 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 22:44:21,826 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 22:44:21,828 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 22:44:21,837 - MoETrainer - INFO - Applied robust scaling
2025-05-31 22:44:21,837 - MoETrainer - INFO - Splitting data...
2025-05-31 22:44:21,844 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 22:44:21,845 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 22:44:21,845 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 22:44:21,846 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-31 22:44:21,846 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:44:21,847 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:44:21,847 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:44:35,119 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:44:35,121 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-31 22:44:35,122 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-31 22:44:35,122 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-31 22:44:43,104 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:44:43,105 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-31 22:44:43,105 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-31 22:44:43,105 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-31 22:44:50,671 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:44:50,671 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-31 22:44:50,672 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-31 22:44:50,672 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-31 22:44:50,672 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:44:50,724 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-31 22:44:50,852 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-31 22:44:50,945 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-31 22:44:50,945 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-31 22:44:51,127 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 22:44:57,496 - MoETrainer - INFO - Epoch   0: Pred RMSE=61258333991, Val RMSE=64788326296, Bin Loss=1.0988
2025-05-31 22:44:57,497 - MoETrainer - INFO -          Bin weights: [0.333, 0.334, 0.334]
2025-05-31 22:44:58,030 - MoETrainer - INFO - Epoch  25: Pred RMSE=61229420323, Val RMSE=64757618121, Bin Loss=1.0978
2025-05-31 22:44:58,463 - MoETrainer - INFO - Epoch  50: Pred RMSE=61191543072, Val RMSE=64690276890, Bin Loss=1.0966
2025-05-31 22:44:58,464 - MoETrainer - INFO -          Bin weights: [0.333, 0.334, 0.334]
2025-05-31 22:44:58,896 - MoETrainer - INFO - Epoch  75: Pred RMSE=61127059773, Val RMSE=64607239098, Bin Loss=1.0953
2025-05-31 22:44:59,360 - MoETrainer - INFO - Epoch 100: Pred RMSE=61046201461, Val RMSE=64472297052, Bin Loss=1.0941
2025-05-31 22:44:59,360 - MoETrainer - INFO -          Bin weights: [0.332, 0.334, 0.334]
2025-05-31 22:44:59,852 - MoETrainer - INFO - Epoch 125: Pred RMSE=60888375833, Val RMSE=64256768842, Bin Loss=1.0925
2025-05-31 22:45:00,333 - MoETrainer - INFO - Loaded best model with validation RMSE: 63903991766
2025-05-31 22:45:00,346 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:45:00,346 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:45:00,346 - MoETrainer - INFO -   RMSE: $242,649
2025-05-31 22:45:00,347 - MoETrainer - INFO -   MAE: $164,886 (30.6% of mean)
2025-05-31 22:45:00,347 - MoETrainer - INFO -   RÂ²: 0.2294
2025-05-31 22:45:00,348 - MoETrainer - INFO -   MAPE: 32.7%
2025-05-31 22:45:00,348 - MoETrainer - INFO -   MPE: +12.6% (bias: overprediction)
2025-05-31 22:45:00,348 - MoETrainer - INFO -   Median APE: 25.7%
2025-05-31 22:45:00,349 - MoETrainer - INFO -   Within 5%: 11.6% of predictions
2025-05-31 22:45:00,349 - MoETrainer - INFO -   Within 10%: 21.5% of predictions
2025-05-31 22:45:00,349 - MoETrainer - INFO -   Within 15%: 31.4% of predictions
2025-05-31 22:45:00,349 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:45:00,350 - MoETrainer - INFO -   Bin 0: RMSE=$174,110, RÂ²=-8.6328, Samples=373
2025-05-31 22:45:00,350 - MoETrainer - INFO -   Bin 1: RMSE=$56,244, RÂ²=-0.4430, Samples=359
2025-05-31 22:45:00,351 - MoETrainer - INFO -   Bin 2: RMSE=$376,773, RÂ²=-0.8067, Samples=369
2025-05-31 22:45:00,351 - MoETrainer - INFO -   3 bins: RÂ²=0.2294, RMSE=$242,649
2025-05-31 22:45:00,352 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:45:00,352 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:45:00,353 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:45:06,356 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:45:06,357 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-31 22:45:06,357 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-31 22:45:06,358 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-31 22:45:13,210 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:45:13,213 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-31 22:45:13,224 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-31 22:45:13,261 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-31 22:45:18,543 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:45:18,543 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-31 22:45:18,545 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-31 22:45:18,545 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-31 22:45:24,940 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 22:45:24,942 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-31 22:45:24,943 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-31 22:45:24,943 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-31 22:45:24,944 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:45:25,043 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-31 22:45:25,179 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-31 22:45:25,443 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-31 22:45:25,450 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-31 22:45:25,451 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-31 22:45:25,638 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 22:45:25,697 - MoETrainer - INFO - Epoch   0: Pred RMSE=64009306820, Val RMSE=65460830562, Bin Loss=1.3868
2025-05-31 22:45:25,698 - MoETrainer - INFO -          Bin weights: [0.250, 0.250, 0.250, 0.250]
2025-05-31 22:45:26,599 - MoETrainer - INFO - Epoch  25: Pred RMSE=63987434317, Val RMSE=65453486933, Bin Loss=1.3863
2025-05-31 22:45:27,876 - MoETrainer - INFO - Epoch  50: Pred RMSE=63959765619, Val RMSE=65435380261, Bin Loss=1.3858
2025-05-31 22:45:27,881 - MoETrainer - INFO -          Bin weights: [0.249, 0.250, 0.250, 0.250]
2025-05-31 22:45:28,641 - MoETrainer - INFO - Epoch  75: Pred RMSE=63922266785, Val RMSE=65414017568, Bin Loss=1.3851
2025-05-31 22:45:29,002 - MoETrainer - INFO - Epoch 100: Pred RMSE=63897895931, Val RMSE=65381857077, Bin Loss=1.3845
2025-05-31 22:45:29,002 - MoETrainer - INFO -          Bin weights: [0.249, 0.250, 0.250, 0.251]
2025-05-31 22:45:29,448 - MoETrainer - INFO - Epoch 125: Pred RMSE=63825191633, Val RMSE=65324420480, Bin Loss=1.3839
2025-05-31 22:45:30,026 - MoETrainer - INFO - Loaded best model with validation RMSE: 65221222408
2025-05-31 22:45:30,039 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:45:30,039 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:45:30,040 - MoETrainer - INFO -   RMSE: $251,340
2025-05-31 22:45:30,041 - MoETrainer - INFO -   MAE: $169,902 (31.5% of mean)
2025-05-31 22:45:30,041 - MoETrainer - INFO -   RÂ²: 0.1732
2025-05-31 22:45:30,041 - MoETrainer - INFO -   MAPE: 33.3%
2025-05-31 22:45:30,042 - MoETrainer - INFO -   MPE: +12.5% (bias: overprediction)
2025-05-31 22:45:30,042 - MoETrainer - INFO -   Median APE: 26.4%
2025-05-31 22:45:30,042 - MoETrainer - INFO -   Within 5%: 10.9% of predictions
2025-05-31 22:45:30,042 - MoETrainer - INFO -   Within 10%: 20.3% of predictions
2025-05-31 22:45:30,042 - MoETrainer - INFO -   Within 15%: 29.8% of predictions
2025-05-31 22:45:30,043 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:45:30,043 - MoETrainer - INFO -   Bin 0: RMSE=$193,096, RÂ²=-15.5637, Samples=272
2025-05-31 22:45:30,043 - MoETrainer - INFO -   Bin 1: RMSE=$89,597, RÂ²=-8.6913, Samples=281
2025-05-31 22:45:30,044 - MoETrainer - INFO -   Bin 2: RMSE=$45,946, RÂ²=-0.0832, Samples=253
2025-05-31 22:45:30,044 - MoETrainer - INFO -   Bin 3: RMSE=$438,103, RÂ²=-1.4468, Samples=295
2025-05-31 22:45:30,045 - MoETrainer - INFO -   4 bins: RÂ²=0.1732, RMSE=$251,340
2025-05-31 22:45:30,047 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:45:30,048 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:45:30,049 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:45:34,641 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:45:34,641 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-31 22:45:34,642 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-31 22:45:34,642 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-31 22:45:39,267 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:45:39,268 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-31 22:45:39,268 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-31 22:45:39,268 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-31 22:45:45,406 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:45:45,406 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-31 22:45:45,407 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-31 22:45:45,407 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-31 22:45:50,172 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 22:45:50,173 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-31 22:45:50,173 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-31 22:45:50,173 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-31 22:45:54,711 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 22:45:54,711 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-31 22:45:54,712 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-31 22:45:54,712 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-31 22:45:54,712 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:45:54,747 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-31 22:45:54,749 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-31 22:45:54,786 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-31 22:45:54,788 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-31 22:45:54,793 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-31 22:45:54,793 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-31 22:45:54,823 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 22:45:54,848 - MoETrainer - INFO - Epoch   0: Pred RMSE=66217824099, Val RMSE=67771463237, Bin Loss=1.6083
2025-05-31 22:45:54,849 - MoETrainer - INFO -          Bin weights: [0.200, 0.200, 0.200, 0.200, 0.200]
2025-05-31 22:45:55,265 - MoETrainer - INFO - Epoch  25: Pred RMSE=66194743720, Val RMSE=67755232387, Bin Loss=1.6072
2025-05-31 22:45:55,629 - MoETrainer - INFO - Epoch  50: Pred RMSE=66130575038, Val RMSE=67687684809, Bin Loss=1.6059
2025-05-31 22:45:55,630 - MoETrainer - INFO -          Bin weights: [0.200, 0.200, 0.200, 0.200, 0.201]
2025-05-31 22:45:55,994 - MoETrainer - INFO - Epoch  75: Pred RMSE=66055885301, Val RMSE=67611350736, Bin Loss=1.6044
2025-05-31 22:45:56,374 - MoETrainer - INFO - Epoch 100: Pred RMSE=65945374320, Val RMSE=67493305761, Bin Loss=1.6026
2025-05-31 22:45:56,375 - MoETrainer - INFO -          Bin weights: [0.200, 0.199, 0.200, 0.199, 0.202]
2025-05-31 22:45:56,721 - MoETrainer - INFO - Epoch 125: Pred RMSE=65768085245, Val RMSE=67309568780, Bin Loss=1.6009
2025-05-31 22:45:57,055 - MoETrainer - INFO - Loaded best model with validation RMSE: 66994838669
2025-05-31 22:45:57,067 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:45:57,067 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:45:57,070 - MoETrainer - INFO -   RMSE: $257,913
2025-05-31 22:45:57,071 - MoETrainer - INFO -   MAE: $178,715 (33.2% of mean)
2025-05-31 22:45:57,072 - MoETrainer - INFO -   RÂ²: 0.1294
2025-05-31 22:45:57,072 - MoETrainer - INFO -   MAPE: 35.9%
2025-05-31 22:45:57,072 - MoETrainer - INFO -   MPE: +15.1% (bias: overprediction)
2025-05-31 22:45:57,073 - MoETrainer - INFO -   Median APE: 28.8%
2025-05-31 22:45:57,074 - MoETrainer - INFO -   Within 5%: 9.4% of predictions
2025-05-31 22:45:57,074 - MoETrainer - INFO -   Within 10%: 18.9% of predictions
2025-05-31 22:45:57,074 - MoETrainer - INFO -   Within 15%: 27.9% of predictions
2025-05-31 22:45:57,075 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:45:57,075 - MoETrainer - INFO -   Bin 0: RMSE=$221,393, RÂ²=-25.8728, Samples=223
2025-05-31 22:45:57,075 - MoETrainer - INFO -   Bin 1: RMSE=$126,011, RÂ²=-38.8563, Samples=215
2025-05-31 22:45:57,076 - MoETrainer - INFO -   Bin 2: RMSE=$55,177, RÂ²=-3.1827, Samples=233
2025-05-31 22:45:57,076 - MoETrainer - INFO -   Bin 3: RMSE=$83,521, RÂ²=-2.1952, Samples=201
2025-05-31 22:45:57,076 - MoETrainer - INFO -   Bin 4: RMSE=$497,951, RÂ²=-2.1763, Samples=229
2025-05-31 22:45:57,077 - MoETrainer - INFO -   5 bins: RÂ²=0.1294, RMSE=$257,913
2025-05-31 22:45:57,077 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:45:57,078 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:45:57,080 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:46:00,323 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:46:00,324 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 22:46:00,325 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 22:46:00,325 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 22:46:03,732 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:46:03,732 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 22:46:03,733 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 22:46:03,733 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 22:46:07,011 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:46:07,011 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 22:46:07,012 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 22:46:07,012 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 22:46:10,469 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 22:46:10,469 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 22:46:10,470 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 22:46:10,470 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 22:46:13,974 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 22:46:13,974 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 22:46:13,974 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 22:46:13,975 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 22:46:17,568 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 22:46:17,569 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 22:46:17,569 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 22:46:17,570 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 22:46:17,571 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:46:17,572 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 22:46:17,574 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 22:46:17,576 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 22:46:17,578 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 22:46:17,580 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 22:46:17,583 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 22:46:17,584 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 22:46:17,593 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 22:46:17,632 - MoETrainer - INFO - Epoch   0: Pred RMSE=66811779747, Val RMSE=68246894482, Bin Loss=1.7910
2025-05-31 22:46:17,633 - MoETrainer - INFO -          Bin weights: [0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
2025-05-31 22:46:17,980 - MoETrainer - INFO - Epoch  25: Pred RMSE=66792626912, Val RMSE=68209014144, Bin Loss=1.7905
2025-05-31 22:46:18,299 - MoETrainer - INFO - Epoch  50: Pred RMSE=66771207460, Val RMSE=68171808811, Bin Loss=1.7898
2025-05-31 22:46:18,299 - MoETrainer - INFO -          Bin weights: [0.167, 0.166, 0.167, 0.166, 0.167, 0.167]
2025-05-31 22:46:18,634 - MoETrainer - INFO - Epoch  75: Pred RMSE=66740995819, Val RMSE=68130436109, Bin Loss=1.7891
2025-05-31 22:46:18,981 - MoETrainer - INFO - Epoch 100: Pred RMSE=66690266975, Val RMSE=68062396831, Bin Loss=1.7880
2025-05-31 22:46:18,981 - MoETrainer - INFO -          Bin weights: [0.167, 0.166, 0.167, 0.166, 0.167, 0.167]
2025-05-31 22:46:19,413 - MoETrainer - INFO - Epoch 125: Pred RMSE=66607889712, Val RMSE=67952288138, Bin Loss=1.7869
2025-05-31 22:46:19,761 - MoETrainer - INFO - Loaded best model with validation RMSE: 67783029775
2025-05-31 22:46:19,774 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:46:19,775 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:46:19,775 - MoETrainer - INFO -   RMSE: $261,385
2025-05-31 22:46:19,777 - MoETrainer - INFO -   MAE: $181,827 (33.8% of mean)
2025-05-31 22:46:19,778 - MoETrainer - INFO -   RÂ²: 0.1058
2025-05-31 22:46:19,779 - MoETrainer - INFO -   MAPE: 36.6%
2025-05-31 22:46:19,780 - MoETrainer - INFO -   MPE: +15.5% (bias: overprediction)
2025-05-31 22:46:19,780 - MoETrainer - INFO -   Median APE: 29.4%
2025-05-31 22:46:19,780 - MoETrainer - INFO -   Within 5%: 8.4% of predictions
2025-05-31 22:46:19,781 - MoETrainer - INFO -   Within 10%: 17.7% of predictions
2025-05-31 22:46:19,781 - MoETrainer - INFO -   Within 15%: 27.5% of predictions
2025-05-31 22:46:19,781 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:46:19,782 - MoETrainer - INFO -   Bin 0: RMSE=$238,023, RÂ²=-37.8456, Samples=178
2025-05-31 22:46:19,782 - MoETrainer - INFO -   Bin 1: RMSE=$146,785, RÂ²=-46.0120, Samples=195
2025-05-31 22:46:19,782 - MoETrainer - INFO -   Bin 2: RMSE=$85,538, RÂ²=-15.6715, Samples=180
2025-05-31 22:46:19,783 - MoETrainer - INFO -   Bin 3: RMSE=$30,139, RÂ²=-0.1325, Samples=179
2025-05-31 22:46:19,783 - MoETrainer - INFO -   Bin 4: RMSE=$115,538, RÂ²=-5.4033, Samples=172
2025-05-31 22:46:19,783 - MoETrainer - INFO -   Bin 5: RMSE=$538,663, RÂ²=-2.7931, Samples=197
2025-05-31 22:46:19,784 - MoETrainer - INFO -   6 bins: RÂ²=0.1058, RMSE=$261,385
2025-05-31 22:46:19,784 - MoETrainer - INFO - Optimal configuration: 3 bins
2025-05-31 22:46:19,785 - MoETrainer - INFO - Training final model with 3 bins...
2025-05-31 22:46:19,790 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:46:19,790 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:46:19,791 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:46:24,701 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:46:24,701 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-31 22:46:24,702 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-31 22:46:24,702 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-31 22:46:29,908 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:46:29,908 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-31 22:46:29,909 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-31 22:46:29,909 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-31 22:46:35,524 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:46:35,525 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-31 22:46:35,525 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-31 22:46:35,525 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-31 22:46:35,526 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:46:35,596 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-31 22:46:35,643 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-31 22:46:35,671 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-31 22:46:35,672 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-31 22:46:35,708 - MoETrainer - INFO - Training target-aware neural gate...
2025-05-31 22:46:35,730 - MoETrainer - INFO - Epoch   0: Pred RMSE=61280924814, Val RMSE=64781203865, Bin Loss=1.0992
2025-05-31 22:46:35,730 - MoETrainer - INFO -          Bin weights: [0.333, 0.333, 0.333]
2025-05-31 22:46:36,051 - MoETrainer - INFO - Epoch  25: Pred RMSE=61258817530, Val RMSE=64751893554, Bin Loss=1.0985
2025-05-31 22:46:36,372 - MoETrainer - INFO - Epoch  50: Pred RMSE=61228701709, Val RMSE=64702758703, Bin Loss=1.0976
2025-05-31 22:46:36,372 - MoETrainer - INFO -          Bin weights: [0.333, 0.333, 0.334]
2025-05-31 22:46:36,689 - MoETrainer - INFO - Epoch  75: Pred RMSE=61193975118, Val RMSE=64630666138, Bin Loss=1.0967
2025-05-31 22:46:37,019 - MoETrainer - INFO - Epoch 100: Pred RMSE=61137841895, Val RMSE=64520780601, Bin Loss=1.0959
2025-05-31 22:46:37,020 - MoETrainer - INFO -          Bin weights: [0.332, 0.333, 0.335]
2025-05-31 22:46:37,375 - MoETrainer - INFO - Epoch 125: Pred RMSE=61036632897, Val RMSE=64346337463, Bin Loss=1.0945
2025-05-31 22:46:37,709 - MoETrainer - INFO - Loaded best model with validation RMSE: 64070891629
2025-05-31 22:46:37,720 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:46:37,720 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:46:37,720 - MoETrainer - INFO -   RMSE: $243,232
2025-05-31 22:46:37,720 - MoETrainer - INFO -   MAE: $165,271 (30.7% of mean)
2025-05-31 22:46:37,721 - MoETrainer - INFO -   RÂ²: 0.2257
2025-05-31 22:46:37,721 - MoETrainer - INFO -   MAPE: 32.8%
2025-05-31 22:46:37,721 - MoETrainer - INFO -   MPE: +12.6% (bias: overprediction)
2025-05-31 22:46:37,722 - MoETrainer - INFO -   Median APE: 25.6%
2025-05-31 22:46:37,722 - MoETrainer - INFO -   Within 5%: 11.5% of predictions
2025-05-31 22:46:37,722 - MoETrainer - INFO -   Within 10%: 21.6% of predictions
2025-05-31 22:46:37,722 - MoETrainer - INFO -   Within 15%: 31.4% of predictions
2025-05-31 22:46:37,723 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:46:37,723 - MoETrainer - INFO -   Bin 0: RMSE=$174,480, RÂ²=-8.6738, Samples=373
2025-05-31 22:46:37,723 - MoETrainer - INFO -   Bin 1: RMSE=$55,974, RÂ²=-0.4292, Samples=359
2025-05-31 22:46:37,723 - MoETrainer - INFO -   Bin 2: RMSE=$377,760, RÂ²=-0.8162, Samples=369
2025-05-31 22:46:37,724 - MoETrainer - INFO - Final Expert Configuration:
2025-05-31 22:46:37,724 - MoETrainer - INFO -   Bin 0: lgb_conservative
2025-05-31 22:46:37,724 - MoETrainer - INFO -   Bin 1: xgb_conservative
2025-05-31 22:46:37,724 - MoETrainer - INFO -   Bin 2: lgb_conservative
2025-05-31 22:46:37,725 - MoETrainer - INFO - === COMPREHENSIVE NEURAL BASELINE EVALUATION ===
2025-05-31 22:46:37,725 - MoETrainer - INFO - === NEURAL BASELINE TRAINING COMPLETE ===
2025-05-31 22:46:37,726 - MoETrainer - INFO - Final Performance: RÂ² = 0.2257
2025-05-31 22:46:37,727 - MoETrainer - INFO - Baseline Target: RÂ² = 0.8380
2025-05-31 22:46:37,727 - MoETrainer - INFO - â ï¸ Neural baseline performance 73.1% below target
2025-05-31 22:54:16,586 - MoETrainer - INFO - === TRAINING NEURAL BASELINE MODEL ===
2025-05-31 22:54:16,587 - MoETrainer - INFO - Configuration: Neural Gate + Enhanced Expert Factory
2025-05-31 22:54:16,587 - MoETrainer - INFO - Goal: Beat baseline RÂ² = 0.8380
2025-05-31 22:54:16,588 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 22:54:17,306 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 22:54:17,308 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 22:54:17,312 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 22:54:17,335 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 22:54:19,980 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 22:54:20,002 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 22:54:20,003 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 22:54:20,003 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 22:54:20,004 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 22:54:20,004 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 22:54:20,006 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 22:54:20,015 - MoETrainer - INFO - Applied robust scaling
2025-05-31 22:54:20,016 - MoETrainer - INFO - Splitting data...
2025-05-31 22:54:20,019 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 22:54:20,019 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 22:54:20,020 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 22:54:20,020 - MoETrainer - INFO - Finding optimal bin configuration...
2025-05-31 22:54:20,021 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:54:20,022 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:54:20,022 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:54:26,201 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:54:26,202 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-31 22:54:26,202 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-31 22:54:26,202 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-31 22:54:31,626 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:54:31,626 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-31 22:54:31,627 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-31 22:54:31,627 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-31 22:54:37,084 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:54:37,085 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-31 22:54:37,085 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-31 22:54:37,087 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-31 22:54:37,087 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:54:37,115 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-31 22:54:37,167 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-31 22:54:37,196 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-31 22:54:37,196 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-31 22:54:37,201 - MoETrainer - INFO - BASELINE HARD ASSIGNMENT: RÂ² = 0.7390, RMSE = $141,212
2025-05-31 22:54:37,217 - MoETrainer - INFO - EQUAL WEIGHTING: RÂ² = 0.2145
2025-05-31 22:54:37,218 - MoETrainer - INFO - PERFORMANCE WEIGHTING: RÂ² = 0.2145
2025-05-31 22:54:37,218 - MoETrainer - INFO - â HARD ASSIGNMENT WINS!
2025-05-31 22:54:37,230 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:54:37,230 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:54:37,230 - MoETrainer - INFO -   RMSE: $141,212
2025-05-31 22:54:37,230 - MoETrainer - INFO -   MAE: $82,758 (15.4% of mean)
2025-05-31 22:54:37,230 - MoETrainer - INFO -   RÂ²: 0.7390
2025-05-31 22:54:37,231 - MoETrainer - INFO -   MAPE: 14.1%
2025-05-31 22:54:37,231 - MoETrainer - INFO -   MPE: +3.5% (bias: overprediction)
2025-05-31 22:54:37,231 - MoETrainer - INFO -   Median APE: 10.7%
2025-05-31 22:54:37,231 - MoETrainer - INFO -   Within 5%: 23.9% of predictions
2025-05-31 22:54:37,231 - MoETrainer - INFO -   Within 10%: 47.2% of predictions
2025-05-31 22:54:37,231 - MoETrainer - INFO -   Within 15%: 67.7% of predictions
2025-05-31 22:54:37,231 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:54:37,232 - MoETrainer - INFO -   Bin 0: RMSE=$50,405, RÂ²=0.1927, Samples=373
2025-05-31 22:54:37,232 - MoETrainer - INFO -   Bin 1: RMSE=$43,956, RÂ²=0.1187, Samples=359
2025-05-31 22:54:37,232 - MoETrainer - INFO -   Bin 2: RMSE=$234,629, RÂ²=0.2994, Samples=369
2025-05-31 22:54:37,232 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-05-31 22:54:37,233 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:54:37,233 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:54:37,233 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:54:41,399 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:54:41,399 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-05-31 22:54:41,400 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-05-31 22:54:41,400 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-05-31 22:54:45,563 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:54:45,565 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-05-31 22:54:45,566 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-05-31 22:54:45,566 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-05-31 22:54:49,866 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:54:49,867 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-05-31 22:54:49,867 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-05-31 22:54:49,868 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-05-31 22:54:54,649 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 22:54:54,650 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-05-31 22:54:54,651 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-05-31 22:54:54,651 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-05-31 22:54:54,652 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:54:54,685 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-05-31 22:54:54,708 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-05-31 22:54:54,917 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-05-31 22:54:54,919 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-05-31 22:54:54,920 - MoETrainer - INFO - Training completed: 4 experts trained
2025-05-31 22:54:54,930 - MoETrainer - INFO - BASELINE HARD ASSIGNMENT: RÂ² = 0.7727, RMSE = $131,774
2025-05-31 22:54:54,969 - MoETrainer - INFO - EQUAL WEIGHTING: RÂ² = 0.1659
2025-05-31 22:54:54,969 - MoETrainer - INFO - PERFORMANCE WEIGHTING: RÂ² = 0.1113
2025-05-31 22:54:54,970 - MoETrainer - INFO - â HARD ASSIGNMENT WINS!
2025-05-31 22:54:54,978 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:54:54,979 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:54:54,979 - MoETrainer - INFO -   RMSE: $131,774
2025-05-31 22:54:54,979 - MoETrainer - INFO -   MAE: $71,137 (13.2% of mean)
2025-05-31 22:54:54,979 - MoETrainer - INFO -   RÂ²: 0.7727
2025-05-31 22:54:54,980 - MoETrainer - INFO -   MAPE: 11.6%
2025-05-31 22:54:54,980 - MoETrainer - INFO -   MPE: +3.2% (bias: overprediction)
2025-05-31 22:54:54,980 - MoETrainer - INFO -   Median APE: 8.3%
2025-05-31 22:54:54,980 - MoETrainer - INFO -   Within 5%: 29.8% of predictions
2025-05-31 22:54:54,981 - MoETrainer - INFO -   Within 10%: 60.5% of predictions
2025-05-31 22:54:54,981 - MoETrainer - INFO -   Within 15%: 77.5% of predictions
2025-05-31 22:54:54,985 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:54:54,986 - MoETrainer - INFO -   Bin 0: RMSE=$44,409, RÂ²=0.1239, Samples=272
2025-05-31 22:54:54,986 - MoETrainer - INFO -   Bin 1: RMSE=$28,492, RÂ²=0.0200, Samples=281
2025-05-31 22:54:54,987 - MoETrainer - INFO -   Bin 2: RMSE=$40,906, RÂ²=0.1414, Samples=253
2025-05-31 22:54:54,987 - MoETrainer - INFO -   Bin 3: RMSE=$246,537, RÂ²=0.2252, Samples=295
2025-05-31 22:54:54,988 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-05-31 22:54:54,988 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:54:54,989 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:54:54,989 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:54:58,494 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:54:58,495 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-05-31 22:54:58,495 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-05-31 22:54:58,496 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-05-31 22:55:02,279 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:55:02,280 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-05-31 22:55:02,280 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-05-31 22:55:02,280 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-05-31 22:55:06,068 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:55:06,068 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-05-31 22:55:06,069 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-05-31 22:55:06,069 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-05-31 22:55:09,744 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 22:55:09,745 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-05-31 22:55:09,745 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-05-31 22:55:09,745 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-05-31 22:55:13,739 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 22:55:13,739 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-05-31 22:55:13,740 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-05-31 22:55:13,740 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-05-31 22:55:13,740 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:55:13,777 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-05-31 22:55:13,784 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-05-31 22:55:13,818 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-05-31 22:55:13,821 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-05-31 22:55:13,823 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-05-31 22:55:13,823 - MoETrainer - INFO - Training completed: 5 experts trained
2025-05-31 22:55:13,831 - MoETrainer - INFO - BASELINE HARD ASSIGNMENT: RÂ² = 0.8147, RMSE = $118,989
2025-05-31 22:55:13,854 - MoETrainer - INFO - EQUAL WEIGHTING: RÂ² = 0.1094
2025-05-31 22:55:13,854 - MoETrainer - INFO - PERFORMANCE WEIGHTING: RÂ² = 0.0889
2025-05-31 22:55:13,855 - MoETrainer - INFO - â HARD ASSIGNMENT WINS!
2025-05-31 22:55:13,869 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:55:13,869 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:55:13,869 - MoETrainer - INFO -   RMSE: $118,989
2025-05-31 22:55:13,869 - MoETrainer - INFO -   MAE: $60,600 (11.3% of mean)
2025-05-31 22:55:13,870 - MoETrainer - INFO -   RÂ²: 0.8147
2025-05-31 22:55:13,870 - MoETrainer - INFO -   MAPE: 9.6%
2025-05-31 22:55:13,870 - MoETrainer - INFO -   MPE: +2.0% (bias: overprediction)
2025-05-31 22:55:13,870 - MoETrainer - INFO -   Median APE: 6.8%
2025-05-31 22:55:13,871 - MoETrainer - INFO -   Within 5%: 38.1% of predictions
2025-05-31 22:55:13,871 - MoETrainer - INFO -   Within 10%: 69.7% of predictions
2025-05-31 22:55:13,871 - MoETrainer - INFO -   Within 15%: 83.1% of predictions
2025-05-31 22:55:13,873 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:55:13,873 - MoETrainer - INFO -   Bin 0: RMSE=$40,646, RÂ²=0.0942, Samples=223
2025-05-31 22:55:13,873 - MoETrainer - INFO -   Bin 1: RMSE=$19,774, RÂ²=0.0186, Samples=215
2025-05-31 22:55:13,874 - MoETrainer - INFO -   Bin 2: RMSE=$28,331, RÂ²=-0.1027, Samples=233
2025-05-31 22:55:13,874 - MoETrainer - INFO -   Bin 3: RMSE=$45,828, RÂ²=0.0380, Samples=201
2025-05-31 22:55:13,874 - MoETrainer - INFO -   Bin 4: RMSE=$251,865, RÂ²=0.1874, Samples=229
2025-05-31 22:55:13,875 - MoETrainer - INFO -   5 bins: RÂ²=0.8147, RMSE=$118,989
2025-05-31 22:55:13,876 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:55:13,876 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:55:13,876 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:55:16,881 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:55:16,881 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 22:55:16,882 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 22:55:16,882 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 22:55:20,144 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:55:20,144 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 22:55:20,145 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 22:55:20,145 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 22:55:23,872 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:55:23,872 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 22:55:23,873 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 22:55:23,873 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 22:55:27,177 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 22:55:27,177 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 22:55:27,178 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 22:55:27,178 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 22:55:30,419 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 22:55:30,420 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 22:55:30,420 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 22:55:30,421 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 22:55:33,874 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 22:55:33,874 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 22:55:33,874 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 22:55:33,875 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 22:55:33,875 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:55:33,877 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 22:55:33,879 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 22:55:33,881 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 22:55:33,883 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 22:55:33,885 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 22:55:33,888 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 22:55:33,888 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 22:55:33,891 - MoETrainer - INFO - BASELINE HARD ASSIGNMENT: RÂ² = 0.8380, RMSE = $111,248
2025-05-31 22:55:33,900 - MoETrainer - INFO - EQUAL WEIGHTING: RÂ² = 0.0952
2025-05-31 22:55:33,900 - MoETrainer - INFO - PERFORMANCE WEIGHTING: RÂ² = 0.0941
2025-05-31 22:55:33,901 - MoETrainer - INFO - â HARD ASSIGNMENT WINS!
2025-05-31 22:55:33,916 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:55:33,917 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:55:33,918 - MoETrainer - INFO -   RMSE: $111,248
2025-05-31 22:55:33,918 - MoETrainer - INFO -   MAE: $55,539 (10.3% of mean)
2025-05-31 22:55:33,919 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-31 22:55:33,919 - MoETrainer - INFO -   MAPE: 8.7%
2025-05-31 22:55:33,920 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-05-31 22:55:33,920 - MoETrainer - INFO -   Median APE: 6.3%
2025-05-31 22:55:33,920 - MoETrainer - INFO -   Within 5%: 37.4% of predictions
2025-05-31 22:55:33,921 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-05-31 22:55:33,921 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-05-31 22:55:33,921 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:55:33,922 - MoETrainer - INFO -   Bin 0: RMSE=$36,946, RÂ²=0.0641, Samples=178
2025-05-31 22:55:33,922 - MoETrainer - INFO -   Bin 1: RMSE=$21,685, RÂ²=-0.0261, Samples=195
2025-05-31 22:55:33,923 - MoETrainer - INFO -   Bin 2: RMSE=$20,770, RÂ²=0.0171, Samples=180
2025-05-31 22:55:33,923 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-05-31 22:55:33,924 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-05-31 22:55:33,924 - MoETrainer - INFO -   Bin 5: RMSE=$254,108, RÂ²=0.1559, Samples=197
2025-05-31 22:55:33,925 - MoETrainer - INFO -   6 bins: RÂ²=0.8380, RMSE=$111,248
2025-05-31 22:55:33,925 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-05-31 22:55:33,927 - MoETrainer - INFO - Training final model with 6 bins...
2025-05-31 22:55:33,928 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 22:55:33,929 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 22:55:33,929 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 22:55:36,737 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 22:55:36,737 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 22:55:36,737 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 22:55:36,738 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 22:55:41,145 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 22:55:41,145 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 22:55:41,145 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 22:55:41,146 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 22:55:47,070 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 22:55:47,071 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 22:55:47,071 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 22:55:47,072 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 22:55:52,251 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 22:55:52,251 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 22:55:52,251 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 22:55:52,252 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 22:55:56,205 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 22:55:56,205 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 22:55:56,206 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 22:55:56,206 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 22:56:00,516 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 22:56:00,516 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 22:56:00,517 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 22:56:00,517 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 22:56:00,518 - MoETrainer - INFO - Training selected expert models...
2025-05-31 22:56:00,519 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 22:56:00,521 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 22:56:00,523 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 22:56:00,526 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 22:56:00,530 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 22:56:00,533 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 22:56:00,534 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 22:56:00,537 - MoETrainer - INFO - BASELINE HARD ASSIGNMENT: RÂ² = 0.8380, RMSE = $111,248
2025-05-31 22:56:00,550 - MoETrainer - INFO - EQUAL WEIGHTING: RÂ² = 0.0952
2025-05-31 22:56:00,550 - MoETrainer - INFO - PERFORMANCE WEIGHTING: RÂ² = 0.0941
2025-05-31 22:56:00,550 - MoETrainer - INFO - â HARD ASSIGNMENT WINS!
2025-05-31 22:56:00,568 - MoETrainer - INFO - === Model Evaluation Results ===
2025-05-31 22:56:00,569 - MoETrainer - INFO - Overall Performance:
2025-05-31 22:56:00,569 - MoETrainer - INFO -   RMSE: $111,248
2025-05-31 22:56:00,569 - MoETrainer - INFO -   MAE: $55,539 (10.3% of mean)
2025-05-31 22:56:00,570 - MoETrainer - INFO -   RÂ²: 0.8380
2025-05-31 22:56:00,570 - MoETrainer - INFO -   MAPE: 8.7%
2025-05-31 22:56:00,570 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-05-31 22:56:00,570 - MoETrainer - INFO -   Median APE: 6.3%
2025-05-31 22:56:00,571 - MoETrainer - INFO -   Within 5%: 37.4% of predictions
2025-05-31 22:56:00,571 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-05-31 22:56:00,571 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-05-31 22:56:00,571 - MoETrainer - INFO - 
Per-bin Performance:
2025-05-31 22:56:00,572 - MoETrainer - INFO -   Bin 0: RMSE=$36,946, RÂ²=0.0641, Samples=178
2025-05-31 22:56:00,572 - MoETrainer - INFO -   Bin 1: RMSE=$21,685, RÂ²=-0.0261, Samples=195
2025-05-31 22:56:00,572 - MoETrainer - INFO -   Bin 2: RMSE=$20,770, RÂ²=0.0171, Samples=180
2025-05-31 22:56:00,573 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-05-31 22:56:00,573 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-05-31 22:56:00,573 - MoETrainer - INFO -   Bin 5: RMSE=$254,108, RÂ²=0.1559, Samples=197
2025-05-31 23:06:17,777 - MoETrainer - INFO - Loading data...
2025-05-31 23:06:17,778 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:06:18,485 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:06:18,487 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:06:18,490 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:06:18,513 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:06:20,979 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:06:21,005 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:06:21,005 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:06:21,006 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:06:21,006 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:06:21,007 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:06:21,008 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:06:21,017 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:06:21,018 - MoETrainer - INFO - Splitting data...
2025-05-31 23:06:21,022 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:06:21,023 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 23:06:21,024 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 23:06:21,025 - MoETrainer - INFO - Training baseline experts...
2025-05-31 23:06:21,026 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:06:21,026 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:06:21,027 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:06:24,968 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:06:24,968 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 23:06:24,968 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 23:06:24,969 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 23:06:29,214 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:06:29,303 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 23:06:29,316 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 23:06:29,320 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 23:06:33,096 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:06:33,097 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 23:06:33,097 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 23:06:33,097 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 23:06:36,665 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:06:36,665 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 23:06:36,666 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 23:06:36,666 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 23:06:40,226 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:06:40,227 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 23:06:40,227 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 23:06:40,227 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 23:06:43,781 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:06:43,782 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 23:06:43,782 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 23:06:43,783 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 23:06:43,783 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:06:43,785 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 23:06:43,788 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 23:06:43,790 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 23:06:43,793 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 23:06:43,794 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 23:06:43,798 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 23:06:43,798 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:06:43,801 - MoETrainer - INFO - BASELINE HARD ASSIGNMENT: RÂ² = 0.8380, RMSE = $111,248
2025-05-31 23:06:43,809 - MoETrainer - INFO - Training fixed neural gate...
2025-05-31 23:06:43,809 - MoETrainer - INFO - Training FIXED simple neural gate with proper scaling...
2025-05-31 23:06:43,809 - MoETrainer - INFO - Fitting scalers for proper normalization...
2025-05-31 23:08:50,179 - MoETrainer - INFO - Loading data...
2025-05-31 23:08:50,180 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:08:50,981 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:08:50,984 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:08:50,987 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:08:51,007 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:08:53,704 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:08:53,734 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:08:53,735 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:08:53,736 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:08:53,736 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:08:53,736 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:08:53,738 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:08:53,745 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:08:53,746 - MoETrainer - INFO - Splitting data...
2025-05-31 23:08:53,748 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:08:53,748 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 23:08:53,748 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 23:08:53,749 - MoETrainer - INFO - Training baseline experts...
2025-05-31 23:08:53,751 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:08:53,752 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:08:53,752 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:08:57,240 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:08:57,241 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 23:08:57,241 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 23:08:57,241 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 23:09:00,769 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:09:00,770 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 23:09:00,770 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 23:09:00,770 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 23:09:04,434 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:09:04,434 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 23:09:04,434 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 23:09:04,435 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 23:09:08,014 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:09:08,015 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 23:09:08,015 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 23:09:08,016 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 23:09:11,662 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:09:11,663 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 23:09:11,664 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 23:09:11,664 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 23:09:15,389 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:09:15,389 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 23:09:15,390 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 23:09:15,390 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 23:09:15,390 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:09:15,392 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 23:09:15,394 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 23:09:15,396 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 23:09:15,400 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 23:09:15,402 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 23:09:15,405 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 23:09:15,407 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:09:15,410 - MoETrainer - INFO - BASELINE HARD ASSIGNMENT: RÂ² = 0.8380, RMSE = $111,248
2025-05-31 23:09:15,415 - MoETrainer - INFO - Training fixed neural gate...
2025-05-31 23:09:15,417 - MoETrainer - INFO - Training FIXED simple neural gate with proper scaling...
2025-05-31 23:09:15,418 - MoETrainer - INFO - Fitting scalers for proper normalization...
2025-05-31 23:13:15,559 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:13:16,351 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:13:16,353 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:13:16,357 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:13:16,392 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:13:19,037 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:13:19,071 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:13:19,071 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:13:19,072 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:13:19,072 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:13:19,072 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:13:19,074 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:13:19,085 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:13:19,085 - MoETrainer - INFO - Splitting data...
2025-05-31 23:13:19,089 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:13:19,089 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 23:13:19,090 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 23:13:19,095 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:13:19,098 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:13:19,099 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:13:25,877 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:13:25,877 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-05-31 23:13:25,878 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-05-31 23:13:25,878 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-05-31 23:13:31,097 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:13:31,098 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-05-31 23:13:31,098 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-05-31 23:13:31,098 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-05-31 23:13:36,605 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:13:36,605 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-05-31 23:13:36,606 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-05-31 23:13:36,606 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-05-31 23:13:36,606 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:13:36,633 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-05-31 23:13:36,672 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-05-31 23:13:36,703 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-05-31 23:13:36,704 - MoETrainer - INFO - Training completed: 3 experts trained
2025-05-31 23:13:36,727 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:13:36,728 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:13:36,728 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:13:40,048 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:13:40,048 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 23:13:40,049 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 23:13:40,049 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 23:13:43,459 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:13:43,459 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 23:13:43,460 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 23:13:43,460 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 23:13:46,840 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:13:46,841 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 23:13:46,841 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 23:13:46,841 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 23:13:50,242 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:13:50,242 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 23:13:50,243 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 23:13:50,243 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 23:13:53,651 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:13:53,651 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 23:13:53,651 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 23:13:53,652 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 23:13:57,232 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:13:57,232 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 23:13:57,232 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 23:13:57,233 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 23:13:57,233 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:13:57,235 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 23:13:57,237 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 23:13:57,240 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 23:13:57,243 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 23:13:57,246 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 23:13:57,249 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 23:13:57,252 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:13:57,307 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:13:58,034 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:13:58,036 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:13:58,039 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:13:58,060 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:14:00,869 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:14:00,903 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:14:00,904 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:14:00,904 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:14:00,905 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:14:00,905 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:14:00,907 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:14:00,915 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:14:00,916 - MoETrainer - INFO - Splitting data...
2025-05-31 23:14:00,918 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:14:00,919 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 23:14:00,920 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 23:14:00,921 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:14:00,922 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:14:00,922 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:14:04,016 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:14:04,017 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 23:14:04,017 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 23:14:04,018 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 23:14:07,479 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:14:07,480 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 23:14:07,480 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 23:14:07,481 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 23:14:10,845 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:14:10,846 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 23:14:10,846 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 23:14:10,847 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 23:14:14,266 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:14:14,266 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 23:14:14,267 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 23:14:14,267 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 23:14:17,913 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:14:17,914 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 23:14:17,914 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 23:14:17,915 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 23:14:21,649 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:14:21,651 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 23:14:21,652 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 23:14:21,652 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 23:14:21,653 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:14:21,655 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 23:14:21,658 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 23:14:21,662 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 23:14:21,664 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 23:14:21,667 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 23:14:21,671 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 23:14:21,671 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:30:31,849 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:30:32,537 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:30:32,539 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:30:32,543 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:30:32,568 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:30:35,078 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:30:35,111 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:30:35,112 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:30:35,113 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:30:35,113 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:30:35,113 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:30:35,118 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:30:35,127 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:30:35,127 - MoETrainer - INFO - Splitting data...
2025-05-31 23:30:35,134 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:30:35,135 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 23:30:35,135 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 23:30:35,136 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:30:35,137 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:30:35,137 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:30:38,329 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:30:38,329 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 23:30:38,330 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 23:30:38,330 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 23:30:41,563 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:30:41,564 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 23:30:41,564 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 23:30:41,565 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 23:30:44,740 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:30:44,741 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 23:30:44,741 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 23:30:44,742 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 23:30:47,937 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:30:47,938 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 23:30:47,938 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 23:30:47,938 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 23:30:51,401 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:30:51,401 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 23:30:51,402 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 23:30:51,402 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 23:30:54,807 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:30:54,808 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 23:30:54,808 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 23:30:54,809 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 23:30:54,809 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:30:54,812 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 23:30:54,816 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 23:30:54,820 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 23:30:54,822 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 23:30:54,824 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 23:30:54,827 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 23:30:54,828 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:30:54,834 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:30:55,578 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:30:55,579 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:30:55,583 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:30:55,606 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:30:58,019 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:30:58,044 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:30:58,045 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:30:58,045 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:30:58,045 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:30:58,046 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:30:58,048 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:30:58,057 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:30:58,058 - MoETrainer - INFO - Splitting data...
2025-05-31 23:30:58,061 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:30:58,062 - MoETrainer - INFO - Train target: mean=$537,695, std=$271,344
2025-05-31 23:30:58,063 - MoETrainer - INFO - Test target: mean=$543,043, std=$270,120
2025-05-31 23:30:58,064 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:30:58,064 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:30:58,065 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:31:01,133 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:31:01,133 - MoETrainer - INFO -   1. ridge_heavy: MSE=1194594645Â±74410926, RÂ²=0.070 [SELECTED]
2025-05-31 23:31:01,134 - MoETrainer - INFO -   2. ridge_medium: MSE=1200919424Â±76415877, RÂ²=0.065
2025-05-31 23:31:01,135 - MoETrainer - INFO -   3. elastic_light: MSE=1207821099Â±75827382, RÂ²=0.060
2025-05-31 23:31:05,189 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:31:05,190 - MoETrainer - INFO -   1. elastic_balanced: MSE=442103125Â±20736367, RÂ²=-0.005 [SELECTED]
2025-05-31 23:31:05,190 - MoETrainer - INFO -   2. elastic_heavy: MSE=442607680Â±20069516, RÂ²=-0.007
2025-05-31 23:31:05,190 - MoETrainer - INFO -   3. elastic_light: MSE=443031723Â±23986263, RÂ²=-0.007
2025-05-31 23:31:08,439 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:31:08,439 - MoETrainer - INFO -   1. rf_shallow: MSE=427450450Â±27587957, RÂ²=0.032 [SELECTED]
2025-05-31 23:31:08,439 - MoETrainer - INFO -   2. ridge_heavy: MSE=428815115Â±23893871, RÂ²=0.029
2025-05-31 23:31:08,441 - MoETrainer - INFO -   3. elastic_light: MSE=429124533Â±22929375, RÂ²=0.029
2025-05-31 23:31:11,655 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:31:11,655 - MoETrainer - INFO -   1. rf_shallow: MSE=772269005Â±37644001, RÂ²=0.020 [SELECTED]
2025-05-31 23:31:11,656 - MoETrainer - INFO -   2. elastic_balanced: MSE=785484629Â±36791631, RÂ²=0.003
2025-05-31 23:31:11,656 - MoETrainer - INFO -   3. elastic_light: MSE=786136107Â±33889350, RÂ²=0.002
2025-05-31 23:31:14,887 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:31:14,887 - MoETrainer - INFO -   1. elastic_light: MSE=1995494187Â±103748545, RÂ²=0.019 [SELECTED]
2025-05-31 23:31:14,887 - MoETrainer - INFO -   2. ridge_heavy: MSE=1999635029Â±98109761, RÂ²=0.017
2025-05-31 23:31:14,888 - MoETrainer - INFO -   3. elastic_balanced: MSE=2007329067Â±109199282, RÂ²=0.014
2025-05-31 23:31:18,492 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:31:18,492 - MoETrainer - INFO -   1. ridge_medium: MSE=62803724971Â±7654278354, RÂ²=0.213 [SELECTED]
2025-05-31 23:31:18,493 - MoETrainer - INFO -   2. ridge_heavy: MSE=62846765739Â±7780274644, RÂ²=0.213
2025-05-31 23:31:18,493 - MoETrainer - INFO -   3. ridge_light: MSE=62981490005Â±7867502492, RÂ²=0.211
2025-05-31 23:31:18,493 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:31:18,495 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 533 samples
2025-05-31 23:31:18,496 - MoETrainer - INFO - Successfully trained elastic_balanced for bin 1: 652 samples
2025-05-31 23:31:18,649 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 603 samples
2025-05-31 23:31:18,806 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 592 samples
2025-05-31 23:31:18,808 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 577 samples
2025-05-31 23:31:18,810 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 619 samples
2025-05-31 23:31:18,810 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:31:18,825 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:31:19,534 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:31:19,536 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:31:19,539 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:31:19,560 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:31:21,979 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:31:22,006 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:31:22,007 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:31:22,008 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:31:22,008 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:31:22,008 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:31:22,010 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:31:22,016 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:31:22,017 - MoETrainer - INFO - Splitting data...
2025-05-31 23:31:22,022 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:31:22,023 - MoETrainer - INFO - Train target: mean=$539,314, std=$269,051
2025-05-31 23:31:22,023 - MoETrainer - INFO - Test target: mean=$532,597, std=$265,659
2025-05-31 23:31:22,024 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:31:22,025 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:31:22,025 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:31:24,995 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:31:24,995 - MoETrainer - INFO -   1. ridge_heavy: MSE=1137448363Â±77288298, RÂ²=0.015 [SELECTED]
2025-05-31 23:31:24,996 - MoETrainer - INFO -   2. elastic_light: MSE=1140051136Â±86017785, RÂ²=0.014
2025-05-31 23:31:24,996 - MoETrainer - INFO -   3. ridge_medium: MSE=1151862955Â±57294956, RÂ²=0.001
2025-05-31 23:31:28,552 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:31:28,552 - MoETrainer - INFO -   1. elastic_heavy: MSE=436107093Â±20543261, RÂ²=-0.005 [SELECTED]
2025-05-31 23:31:28,552 - MoETrainer - INFO -   2. elastic_balanced: MSE=436309973Â±20391483, RÂ²=-0.006
2025-05-31 23:31:28,553 - MoETrainer - INFO -   3. elastic_light: MSE=438754741Â±19569291, RÂ²=-0.011
2025-05-31 23:31:31,737 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:31:31,738 - MoETrainer - INFO -   1. elastic_light: MSE=464480523Â±40092024, RÂ²=0.004 [SELECTED]
2025-05-31 23:31:31,738 - MoETrainer - INFO -   2. elastic_balanced: MSE=465481301Â±36570645, RÂ²=0.001
2025-05-31 23:31:31,738 - MoETrainer - INFO -   3. elastic_heavy: MSE=466966560Â±36297750, RÂ²=-0.002
2025-05-31 23:31:35,009 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:31:35,009 - MoETrainer - INFO -   1. elastic_balanced: MSE=755354432Â±18661565, RÂ²=0.009 [SELECTED]
2025-05-31 23:31:35,010 - MoETrainer - INFO -   2. elastic_light: MSE=756588245Â±19987364, RÂ²=0.007
2025-05-31 23:31:35,011 - MoETrainer - INFO -   3. elastic_heavy: MSE=758410965Â±17756037, RÂ²=0.005
2025-05-31 23:31:38,439 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:31:38,439 - MoETrainer - INFO -   1. elastic_light: MSE=2631948971Â±85836938, RÂ²=0.028 [SELECTED]
2025-05-31 23:31:38,440 - MoETrainer - INFO -   2. ridge_heavy: MSE=2633040213Â±88620392, RÂ²=0.028
2025-05-31 23:31:38,440 - MoETrainer - INFO -   3. elastic_balanced: MSE=2656267179Â±68053697, RÂ²=0.019
2025-05-31 23:31:41,951 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:31:41,952 - MoETrainer - INFO -   1. elastic_light: MSE=63195440469Â±5505812836, RÂ²=0.156 [SELECTED]
2025-05-31 23:31:41,952 - MoETrainer - INFO -   2. ridge_heavy: MSE=63492201131Â±5181197468, RÂ²=0.151
2025-05-31 23:31:41,953 - MoETrainer - INFO -   3. ridge_medium: MSE=64268192427Â±5004853128, RÂ²=0.141
2025-05-31 23:31:41,953 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:31:41,955 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 537 samples
2025-05-31 23:31:41,957 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 641 samples
2025-05-31 23:31:41,960 - MoETrainer - INFO - Successfully trained elastic_light for bin 2: 610 samples
2025-05-31 23:31:41,963 - MoETrainer - INFO - Successfully trained elastic_balanced for bin 3: 588 samples
2025-05-31 23:31:41,965 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 604 samples
2025-05-31 23:31:41,970 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 596 samples
2025-05-31 23:31:41,971 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:31:41,974 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:31:42,747 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:31:42,749 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:31:42,754 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:31:42,776 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:31:45,358 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:31:45,386 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:31:45,387 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:31:45,387 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:31:45,388 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:31:45,389 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:31:45,390 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:31:45,398 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:31:45,398 - MoETrainer - INFO - Splitting data...
2025-05-31 23:31:45,401 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:31:45,403 - MoETrainer - INFO - Train target: mean=$532,504, std=$268,922
2025-05-31 23:31:45,404 - MoETrainer - INFO - Test target: mean=$547,735, std=$272,440
2025-05-31 23:31:45,405 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:31:45,406 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:31:45,406 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:31:48,423 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:31:48,424 - MoETrainer - INFO -   1. ridge_heavy: MSE=1205086379Â±95374862, RÂ²=0.020 [SELECTED]
2025-05-31 23:31:48,425 - MoETrainer - INFO -   2. elastic_light: MSE=1206302848Â±91083424, RÂ²=0.019
2025-05-31 23:31:48,425 - MoETrainer - INFO -   3. ridge_medium: MSE=1217971797Â±90688472, RÂ²=0.010
2025-05-31 23:31:51,739 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:31:51,741 - MoETrainer - INFO -   1. elastic_light: MSE=423491605Â±24897281, RÂ²=-0.005 [SELECTED]
2025-05-31 23:31:51,741 - MoETrainer - INFO -   2. elastic_balanced: MSE=423530144Â±27865239, RÂ²=-0.005
2025-05-31 23:31:51,741 - MoETrainer - INFO -   3. elastic_heavy: MSE=424232096Â±28305808, RÂ²=-0.006
2025-05-31 23:31:54,620 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:31:54,620 - MoETrainer - INFO -   1. elastic_light: MSE=298198656Â±15918252, RÂ²=0.004 [SELECTED]
2025-05-31 23:31:54,620 - MoETrainer - INFO -   2. elastic_balanced: MSE=298413877Â±13695384, RÂ²=0.003
2025-05-31 23:31:54,621 - MoETrainer - INFO -   3. ridge_heavy: MSE=299034016Â±16950330, RÂ²=0.001
2025-05-31 23:31:58,133 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:31:58,134 - MoETrainer - INFO -   1. xgb_conservative: MSE=833844160Â±31027151, RÂ²=0.059 [SELECTED]
2025-05-31 23:31:58,134 - MoETrainer - INFO -   2. lgb_conservative: MSE=837367498Â±24747165, RÂ²=0.055
2025-05-31 23:31:58,135 - MoETrainer - INFO -   3. rf_shallow: MSE=841267703Â±40119027, RÂ²=0.050
2025-05-31 23:32:01,633 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:32:01,633 - MoETrainer - INFO -   1. elastic_light: MSE=2429060693Â±127865111, RÂ²=0.040 [SELECTED]
2025-05-31 23:32:01,633 - MoETrainer - INFO -   2. ridge_heavy: MSE=2436183552Â±119242365, RÂ²=0.037
2025-05-31 23:32:01,634 - MoETrainer - INFO -   3. elastic_balanced: MSE=2444093781Â±160922363, RÂ²=0.034
2025-05-31 23:32:05,101 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:32:05,101 - MoETrainer - INFO -   1. ridge_heavy: MSE=64896299008Â±10515017990, RÂ²=0.190 [SELECTED]
2025-05-31 23:32:05,102 - MoETrainer - INFO -   2. ridge_medium: MSE=65123401728Â±10856227831, RÂ²=0.188
2025-05-31 23:32:05,102 - MoETrainer - INFO -   3. elastic_light: MSE=65374452395Â±10494079120, RÂ²=0.184
2025-05-31 23:32:05,103 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:32:05,104 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 541 samples
2025-05-31 23:32:05,106 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 644 samples
2025-05-31 23:32:05,109 - MoETrainer - INFO - Successfully trained elastic_light for bin 2: 491 samples
2025-05-31 23:32:05,143 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 3: 676 samples
2025-05-31 23:32:05,146 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 613 samples
2025-05-31 23:32:05,148 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 5: 611 samples
2025-05-31 23:32:05,149 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:32:05,156 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:32:05,864 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:32:05,867 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:32:05,871 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:32:05,894 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:32:08,399 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:32:08,431 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:32:08,432 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:32:08,433 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:32:08,433 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:32:08,434 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:32:08,435 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:32:08,447 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:32:08,447 - MoETrainer - INFO - Splitting data...
2025-05-31 23:32:08,451 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:32:08,451 - MoETrainer - INFO - Train target: mean=$531,831, std=$265,824
2025-05-31 23:32:08,452 - MoETrainer - INFO - Test target: mean=$550,594, std=$277,635
2025-05-31 23:32:08,454 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:32:08,456 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:32:08,456 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:32:11,421 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:32:11,423 - MoETrainer - INFO -   1. ridge_heavy: MSE=1186604373Â±85052479, RÂ²=0.053 [SELECTED]
2025-05-31 23:32:11,424 - MoETrainer - INFO -   2. elastic_light: MSE=1195552768Â±80572367, RÂ²=0.046
2025-05-31 23:32:11,424 - MoETrainer - INFO -   3. ridge_medium: MSE=1210059371Â±103636541, RÂ²=0.035
2025-05-31 23:32:14,757 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:32:14,758 - MoETrainer - INFO -   1. ridge_heavy: MSE=377152309Â±3392327, RÂ²=0.007 [SELECTED]
2025-05-31 23:32:14,759 - MoETrainer - INFO -   2. elastic_light: MSE=377944949Â±1908141, RÂ²=0.005
2025-05-31 23:32:14,760 - MoETrainer - INFO -   3. ridge_medium: MSE=379221504Â±7391423, RÂ²=0.001
2025-05-31 23:32:17,606 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:32:17,606 - MoETrainer - INFO -   1. elastic_heavy: MSE=330833387Â±9103892, RÂ²=-0.015 [SELECTED]
2025-05-31 23:32:17,607 - MoETrainer - INFO -   2. elastic_balanced: MSE=331215275Â±9750644, RÂ²=-0.016
2025-05-31 23:32:17,607 - MoETrainer - INFO -   3. elastic_light: MSE=336279189Â±14043898, RÂ²=-0.032
2025-05-31 23:32:21,041 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:32:21,042 - MoETrainer - INFO -   1. rf_shallow: MSE=820753539Â±9428859, RÂ²=0.054 [SELECTED]
2025-05-31 23:32:21,042 - MoETrainer - INFO -   2. xgb_conservative: MSE=826054016Â±2368302, RÂ²=0.048
2025-05-31 23:32:21,043 - MoETrainer - INFO -   3. lgb_conservative: MSE=833384924Â±12251845, RÂ²=0.040
2025-05-31 23:32:24,503 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:32:24,503 - MoETrainer - INFO -   1. elastic_balanced: MSE=2396887467Â±45163001, RÂ²=0.037 [SELECTED]
2025-05-31 23:32:24,504 - MoETrainer - INFO -   2. elastic_light: MSE=2402901931Â±42836491, RÂ²=0.034
2025-05-31 23:32:24,504 - MoETrainer - INFO -   3. ridge_heavy: MSE=2417392555Â±47477214, RÂ²=0.028
2025-05-31 23:32:28,190 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:32:28,191 - MoETrainer - INFO -   1. ridge_light: MSE=62576850261Â±9455610801, RÂ²=0.190 [SELECTED]
2025-05-31 23:32:28,191 - MoETrainer - INFO -   2. elastic_light: MSE=62657422677Â±8750175585, RÂ²=0.189
2025-05-31 23:32:28,191 - MoETrainer - INFO -   3. ridge_heavy: MSE=62687539200Â±9098351293, RÂ²=0.189
2025-05-31 23:32:28,192 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:32:28,194 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 565 samples
2025-05-31 23:32:28,196 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 1: 606 samples
2025-05-31 23:32:28,198 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 2: 497 samples
2025-05-31 23:32:28,351 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 651 samples
2025-05-31 23:32:28,354 - MoETrainer - INFO - Successfully trained elastic_balanced for bin 4: 646 samples
2025-05-31 23:32:28,356 - MoETrainer - INFO - Successfully trained ridge_light for bin 5: 611 samples
2025-05-31 23:32:28,357 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:32:28,371 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:32:29,106 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:32:29,108 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:32:29,112 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:32:29,142 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:32:31,646 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:32:31,674 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:32:31,675 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:32:31,675 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:32:31,676 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:32:31,676 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:32:31,678 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:32:31,684 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:32:31,685 - MoETrainer - INFO - Splitting data...
2025-05-31 23:32:31,689 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:32:31,689 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 23:32:31,690 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 23:32:31,691 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:32:31,692 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:32:31,693 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:32:34,775 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:32:34,775 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 23:32:34,776 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 23:32:34,776 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 23:32:37,995 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:32:37,995 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 23:32:37,996 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 23:32:37,996 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 23:32:41,177 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:32:41,177 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 23:32:41,179 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 23:32:41,180 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 23:32:44,342 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:32:44,342 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 23:32:44,343 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 23:32:44,343 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 23:32:47,638 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:32:47,639 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 23:32:47,639 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 23:32:47,639 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 23:32:51,064 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:32:51,065 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 23:32:51,065 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 23:32:51,065 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 23:32:51,066 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:32:51,068 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 23:32:51,071 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 23:32:51,074 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 23:32:51,076 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 23:32:51,078 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 23:32:51,081 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 23:32:51,081 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:32:51,109 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:32:51,815 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:32:51,816 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:32:51,821 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:32:51,843 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:32:54,691 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:32:54,730 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:32:54,731 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:32:54,731 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:32:54,732 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:32:54,732 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:32:54,734 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:32:54,745 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:32:54,746 - MoETrainer - INFO - Splitting data...
2025-05-31 23:32:54,749 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:32:54,749 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 23:32:54,750 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 23:32:54,751 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:32:54,752 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:32:54,753 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:32:57,848 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:32:57,848 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 23:32:57,848 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 23:32:57,849 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 23:33:01,052 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:33:01,053 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 23:33:01,053 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 23:33:01,054 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 23:33:04,264 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:33:04,264 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 23:33:04,265 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 23:33:04,265 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 23:33:07,470 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:33:07,471 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 23:33:07,471 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 23:33:07,471 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 23:33:10,934 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:33:10,935 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 23:33:10,936 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 23:33:10,937 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 23:33:14,449 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:33:14,450 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 23:33:14,450 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 23:33:14,450 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 23:33:14,451 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:33:14,453 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 23:33:14,456 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 23:33:14,458 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 23:33:14,461 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 23:33:14,464 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 23:33:14,467 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 23:33:14,467 - MoETrainer - INFO - Training completed: 6 experts trained
2025-05-31 23:33:14,518 - MoETrainer - INFO - Loading data with hybrid processing...
2025-05-31 23:33:15,229 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-05-31 23:33:15,231 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-05-31 23:33:15,234 - MoETrainer - INFO - Removed 1 leakage columns
2025-05-31 23:33:15,254 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-05-31 23:33:17,807 - MoETrainer - INFO - Consolidated to 13 features
2025-05-31 23:33:17,834 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-05-31 23:33:17,835 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-05-31 23:33:17,836 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-05-31 23:33:17,837 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-05-31 23:33:17,837 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-05-31 23:33:17,839 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-05-31 23:33:17,848 - MoETrainer - INFO - Applied robust scaling
2025-05-31 23:33:17,849 - MoETrainer - INFO - Splitting data...
2025-05-31 23:33:17,852 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-05-31 23:33:17,853 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-05-31 23:33:17,853 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-05-31 23:33:17,854 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-05-31 23:33:17,855 - MoETrainer - INFO - XGBoost models added to expert pool
2025-05-31 23:33:17,855 - MoETrainer - INFO - Created expert pool with 13 models
2025-05-31 23:33:20,761 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-05-31 23:33:20,761 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-05-31 23:33:20,762 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-05-31 23:33:20,762 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-05-31 23:33:24,324 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-05-31 23:33:24,324 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-05-31 23:33:24,325 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-05-31 23:33:24,325 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-05-31 23:33:27,687 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-05-31 23:33:27,687 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-05-31 23:33:27,688 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-05-31 23:33:27,688 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-05-31 23:33:30,872 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-05-31 23:33:30,872 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-05-31 23:33:30,873 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-05-31 23:33:30,873 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-05-31 23:33:34,122 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-05-31 23:33:34,123 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-05-31 23:33:34,123 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-05-31 23:33:34,124 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-05-31 23:33:37,625 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-05-31 23:33:37,626 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-05-31 23:33:37,626 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-05-31 23:33:37,626 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-05-31 23:33:37,627 - MoETrainer - INFO - Training selected expert models...
2025-05-31 23:33:37,629 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-05-31 23:33:37,630 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-05-31 23:33:37,633 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-05-31 23:33:37,635 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-05-31 23:33:37,638 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-05-31 23:33:37,643 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-05-31 23:33:37,643 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-01 00:00:58,984 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-01 00:00:58,985 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-01 00:00:58,985 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-01 00:00:59,737 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-06-01 00:00:59,740 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-01 00:00:59,743 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-01 00:00:59,767 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-01 00:01:02,519 - MoETrainer - INFO - Consolidated to 13 features
2025-06-01 00:01:02,580 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-01 00:01:02,581 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-06-01 00:01:02,582 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-06-01 00:01:02,582 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-06-01 00:01:02,583 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-01 00:01:02,584 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-06-01 00:01:02,602 - MoETrainer - INFO - Applied robust scaling
2025-06-01 00:01:02,602 - MoETrainer - INFO - Splitting data...
2025-06-01 00:01:02,609 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-01 00:01:02,610 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-06-01 00:01:02,612 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-06-01 00:01:02,612 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-01 00:01:02,613 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-06-01 00:01:02,614 - MoETrainer - INFO - XGBoost models added to expert pool
2025-06-01 00:01:02,614 - MoETrainer - INFO - Created expert pool with 13 models
2025-06-01 00:01:08,307 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-06-01 00:01:08,308 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-06-01 00:01:08,308 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-06-01 00:01:08,308 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.154
2025-06-01 00:01:14,002 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-06-01 00:01:14,003 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.141 [SELECTED]
2025-06-01 00:01:14,003 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.129
2025-06-01 00:01:14,003 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.124
2025-06-01 00:01:20,508 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-06-01 00:01:20,508 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.295 [SELECTED]
2025-06-01 00:01:20,509 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.277
2025-06-01 00:01:20,509 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.277
2025-06-01 00:01:20,509 - MoETrainer - INFO - Training selected expert models...
2025-06-01 00:01:20,768 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-06-01 00:01:20,820 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-06-01 00:01:20,858 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-06-01 00:01:20,859 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-01 00:01:20,877 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-01 00:01:20,878 - MoETrainer - INFO - Overall Performance:
2025-06-01 00:01:20,878 - MoETrainer - INFO -   RMSE: $141,212
2025-06-01 00:01:20,878 - MoETrainer - INFO -   MAE: $82,758 (15.4% of mean)
2025-06-01 00:01:20,878 - MoETrainer - INFO -   RÂ²: 0.7390
2025-06-01 00:01:20,879 - MoETrainer - INFO -   MAPE: 14.1%
2025-06-01 00:01:20,879 - MoETrainer - INFO -   MPE: +3.5% (bias: overprediction)
2025-06-01 00:01:20,879 - MoETrainer - INFO -   Median APE: 10.7%
2025-06-01 00:01:20,879 - MoETrainer - INFO -   Within 5%: 23.9% of predictions
2025-06-01 00:01:20,880 - MoETrainer - INFO -   Within 10%: 47.2% of predictions
2025-06-01 00:01:20,880 - MoETrainer - INFO -   Within 15%: 67.7% of predictions
2025-06-01 00:01:20,880 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-01 00:01:20,881 - MoETrainer - INFO -   Bin 0: RMSE=$50,405, RÂ²=0.1927, Samples=373
2025-06-01 00:01:20,881 - MoETrainer - INFO -   Bin 1: RMSE=$43,956, RÂ²=0.1187, Samples=359
2025-06-01 00:01:20,881 - MoETrainer - INFO -   Bin 2: RMSE=$234,629, RÂ²=0.2994, Samples=369
2025-06-01 00:01:20,881 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-06-01 00:01:20,882 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-06-01 00:01:20,882 - MoETrainer - INFO - XGBoost models added to expert pool
2025-06-01 00:01:20,883 - MoETrainer - INFO - Created expert pool with 13 models
2025-06-01 00:01:25,448 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-06-01 00:01:25,449 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.136 [SELECTED]
2025-06-01 00:01:25,449 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.133
2025-06-01 00:01:25,450 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.127
2025-06-01 00:01:30,488 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-06-01 00:01:30,489 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-06-01 00:01:30,489 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-06-01 00:01:30,490 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-06-01 00:01:36,625 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-06-01 00:01:36,626 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.033 [SELECTED]
2025-06-01 00:01:36,626 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.024
2025-06-01 00:01:36,627 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.020
2025-06-01 00:01:43,110 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-06-01 00:01:43,110 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.230 [SELECTED]
2025-06-01 00:01:43,111 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.227
2025-06-01 00:01:43,111 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.226
2025-06-01 00:01:43,111 - MoETrainer - INFO - Training selected expert models...
2025-06-01 00:01:43,142 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-06-01 00:01:43,170 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-06-01 00:01:43,402 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-06-01 00:01:43,404 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-06-01 00:01:43,405 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-01 00:01:43,435 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-01 00:01:43,435 - MoETrainer - INFO - Overall Performance:
2025-06-01 00:01:43,435 - MoETrainer - INFO -   RMSE: $131,774
2025-06-01 00:01:43,436 - MoETrainer - INFO -   MAE: $71,137 (13.2% of mean)
2025-06-01 00:01:43,436 - MoETrainer - INFO -   RÂ²: 0.7727
2025-06-01 00:01:43,436 - MoETrainer - INFO -   MAPE: 11.6%
2025-06-01 00:01:43,436 - MoETrainer - INFO -   MPE: +3.2% (bias: overprediction)
2025-06-01 00:01:43,437 - MoETrainer - INFO -   Median APE: 8.3%
2025-06-01 00:01:43,437 - MoETrainer - INFO -   Within 5%: 29.8% of predictions
2025-06-01 00:01:43,437 - MoETrainer - INFO -   Within 10%: 60.5% of predictions
2025-06-01 00:01:43,437 - MoETrainer - INFO -   Within 15%: 77.5% of predictions
2025-06-01 00:01:43,438 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-01 00:01:43,438 - MoETrainer - INFO -   Bin 0: RMSE=$44,409, RÂ²=0.1239, Samples=272
2025-06-01 00:01:43,438 - MoETrainer - INFO -   Bin 1: RMSE=$28,492, RÂ²=0.0200, Samples=281
2025-06-01 00:01:43,445 - MoETrainer - INFO -   Bin 2: RMSE=$40,906, RÂ²=0.1414, Samples=253
2025-06-01 00:01:43,446 - MoETrainer - INFO -   Bin 3: RMSE=$246,537, RÂ²=0.2252, Samples=295
2025-06-01 00:01:43,447 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-06-01 00:01:43,447 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-06-01 00:01:43,448 - MoETrainer - INFO - XGBoost models added to expert pool
2025-06-01 00:01:43,448 - MoETrainer - INFO - Created expert pool with 13 models
2025-06-01 00:01:47,648 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-06-01 00:01:47,648 - MoETrainer - INFO -   1. xgb_conservative: MSE=1320568875Â±96727402, RÂ²=0.078 [SELECTED]
2025-06-01 00:01:47,649 - MoETrainer - INFO -   2. ridge_heavy: MSE=1332850261Â±124763377, RÂ²=0.072
2025-06-01 00:01:47,649 - MoETrainer - INFO -   3. ridge_medium: MSE=1336495573Â±121069386, RÂ²=0.069
2025-06-01 00:01:51,984 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-06-01 00:01:51,985 - MoETrainer - INFO -   1. elastic_light: MSE=448954752Â±15671601, RÂ²=-0.004 [SELECTED]
2025-06-01 00:01:51,985 - MoETrainer - INFO -   2. ridge_heavy: MSE=450191019Â±14130834, RÂ²=-0.007
2025-06-01 00:01:51,986 - MoETrainer - INFO -   3. elastic_balanced: MSE=450565376Â±17122957, RÂ²=-0.008
2025-06-01 00:01:56,404 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-06-01 00:01:56,404 - MoETrainer - INFO -   1. lgb_conservative: MSE=727417946Â±32148951, RÂ²=0.042 [SELECTED]
2025-06-01 00:01:56,404 - MoETrainer - INFO -   2. rf_shallow: MSE=741052988Â±35873082, RÂ²=0.024
2025-06-01 00:01:56,405 - MoETrainer - INFO -   3. xgb_conservative: MSE=741671531Â±30477528, RÂ²=0.023
2025-06-01 00:02:00,842 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-06-01 00:02:00,842 - MoETrainer - INFO -   1. ridge_heavy: MSE=2021165184Â±144458957, RÂ²=0.025 [SELECTED]
2025-06-01 00:02:00,843 - MoETrainer - INFO -   2. xgb_conservative: MSE=2024116565Â±171324877, RÂ²=0.024
2025-06-01 00:02:00,843 - MoETrainer - INFO -   3. elastic_light: MSE=2026890837Â±138470492, RÂ²=0.022
2025-06-01 00:02:05,975 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-06-01 00:02:05,977 - MoETrainer - INFO -   1. elastic_light: MSE=63462360405Â±9325725090, RÂ²=0.196 [SELECTED]
2025-06-01 00:02:05,978 - MoETrainer - INFO -   2. ridge_heavy: MSE=63991573163Â±8458749399, RÂ²=0.188
2025-06-01 00:02:05,978 - MoETrainer - INFO -   3. ridge_medium: MSE=65206614699Â±6919209708, RÂ²=0.169
2025-06-01 00:02:05,979 - MoETrainer - INFO - Training selected expert models...
2025-06-01 00:02:06,022 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-06-01 00:02:06,030 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-06-01 00:02:06,069 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-06-01 00:02:06,070 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 708 samples
2025-06-01 00:02:06,072 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 724 samples
2025-06-01 00:02:06,073 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-01 00:02:06,097 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-01 00:02:06,098 - MoETrainer - INFO - Overall Performance:
2025-06-01 00:02:06,098 - MoETrainer - INFO -   RMSE: $118,989
2025-06-01 00:02:06,099 - MoETrainer - INFO -   MAE: $60,600 (11.3% of mean)
2025-06-01 00:02:06,099 - MoETrainer - INFO -   RÂ²: 0.8147
2025-06-01 00:02:06,099 - MoETrainer - INFO -   MAPE: 9.6%
2025-06-01 00:02:06,099 - MoETrainer - INFO -   MPE: +2.0% (bias: overprediction)
2025-06-01 00:02:06,099 - MoETrainer - INFO -   Median APE: 6.8%
2025-06-01 00:02:06,100 - MoETrainer - INFO -   Within 5%: 38.1% of predictions
2025-06-01 00:02:06,100 - MoETrainer - INFO -   Within 10%: 69.7% of predictions
2025-06-01 00:02:06,100 - MoETrainer - INFO -   Within 15%: 83.1% of predictions
2025-06-01 00:02:06,100 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-01 00:02:06,100 - MoETrainer - INFO -   Bin 0: RMSE=$40,646, RÂ²=0.0942, Samples=223
2025-06-01 00:02:06,101 - MoETrainer - INFO -   Bin 1: RMSE=$19,774, RÂ²=0.0186, Samples=215
2025-06-01 00:02:06,101 - MoETrainer - INFO -   Bin 2: RMSE=$28,331, RÂ²=-0.1027, Samples=233
2025-06-01 00:02:06,101 - MoETrainer - INFO -   Bin 3: RMSE=$45,828, RÂ²=0.0380, Samples=201
2025-06-01 00:02:06,101 - MoETrainer - INFO -   Bin 4: RMSE=$251,865, RÂ²=0.1874, Samples=229
2025-06-01 00:02:06,102 - MoETrainer - INFO -   5 bins: RÂ²=0.8147, RMSE=$118,989
2025-06-01 00:02:06,102 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-06-01 00:02:06,103 - MoETrainer - INFO - XGBoost models added to expert pool
2025-06-01 00:02:06,103 - MoETrainer - INFO - Created expert pool with 13 models
2025-06-01 00:02:09,805 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-06-01 00:02:09,805 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-06-01 00:02:09,805 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-06-01 00:02:09,806 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-06-01 00:02:13,907 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-06-01 00:02:13,907 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-06-01 00:02:13,908 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-06-01 00:02:13,908 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-06-01 00:02:17,653 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-06-01 00:02:17,654 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-06-01 00:02:17,654 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-06-01 00:02:17,655 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-06-01 00:02:21,998 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-06-01 00:02:21,999 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-06-01 00:02:21,999 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-06-01 00:02:21,999 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-06-01 00:02:26,304 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-06-01 00:02:26,305 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-06-01 00:02:26,305 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-06-01 00:02:26,305 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-06-01 00:02:30,622 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-06-01 00:02:30,623 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-06-01 00:02:30,623 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-06-01 00:02:30,623 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-06-01 00:02:30,624 - MoETrainer - INFO - Training selected expert models...
2025-06-01 00:02:30,626 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-06-01 00:02:30,633 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-06-01 00:02:30,638 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-06-01 00:02:30,641 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-01 00:02:30,648 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-01 00:02:30,653 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-06-01 00:02:30,654 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-01 00:02:30,675 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-01 00:02:30,675 - MoETrainer - INFO - Overall Performance:
2025-06-01 00:02:30,675 - MoETrainer - INFO -   RMSE: $111,248
2025-06-01 00:02:30,676 - MoETrainer - INFO -   MAE: $55,539 (10.3% of mean)
2025-06-01 00:02:30,676 - MoETrainer - INFO -   RÂ²: 0.8380
2025-06-01 00:02:30,676 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-01 00:02:30,682 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-01 00:02:30,684 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-01 00:02:30,684 - MoETrainer - INFO -   Within 5%: 37.4% of predictions
2025-06-01 00:02:30,685 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-01 00:02:30,685 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-01 00:02:30,685 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-01 00:02:30,686 - MoETrainer - INFO -   Bin 0: RMSE=$36,946, RÂ²=0.0641, Samples=178
2025-06-01 00:02:30,686 - MoETrainer - INFO -   Bin 1: RMSE=$21,685, RÂ²=-0.0261, Samples=195
2025-06-01 00:02:30,686 - MoETrainer - INFO -   Bin 2: RMSE=$20,770, RÂ²=0.0171, Samples=180
2025-06-01 00:02:30,687 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-01 00:02:30,687 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-01 00:02:30,687 - MoETrainer - INFO -   Bin 5: RMSE=$254,108, RÂ²=0.1559, Samples=197
2025-06-01 00:02:30,688 - MoETrainer - INFO -   6 bins: RÂ²=0.8380, RMSE=$111,248
2025-06-01 00:02:30,688 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-01 00:02:30,688 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-01 00:02:30,689 - MoETrainer - INFO - Selecting optimal experts for each bin...
2025-06-01 00:02:30,690 - MoETrainer - INFO - XGBoost models added to expert pool
2025-06-01 00:02:30,690 - MoETrainer - INFO - Created expert pool with 13 models
2025-06-01 00:02:34,161 - MoETrainer - INFO - Bin 0: Top 3 models (CV results):
2025-06-01 00:02:34,162 - MoETrainer - INFO -   1. ridge_heavy: MSE=1086440064Â±80535014, RÂ²=0.035 [SELECTED]
2025-06-01 00:02:34,162 - MoETrainer - INFO -   2. elastic_light: MSE=1089887936Â±71387334, RÂ²=0.032
2025-06-01 00:02:34,164 - MoETrainer - INFO -   3. lgb_conservative: MSE=1096589848Â±94861941, RÂ²=0.027
2025-06-01 00:02:38,164 - MoETrainer - INFO - Bin 1: Top 3 models (CV results):
2025-06-01 00:02:38,165 - MoETrainer - INFO -   1. elastic_heavy: MSE=435417451Â±13350400, RÂ²=-0.001 [SELECTED]
2025-06-01 00:02:38,165 - MoETrainer - INFO -   2. elastic_balanced: MSE=436418720Â±14013378, RÂ²=-0.004
2025-06-01 00:02:38,168 - MoETrainer - INFO -   3. elastic_light: MSE=441582891Â±16042863, RÂ²=-0.015
2025-06-01 00:02:42,076 - MoETrainer - INFO - Bin 2: Top 3 models (CV results):
2025-06-01 00:02:42,076 - MoETrainer - INFO -   1. ridge_heavy: MSE=433883520Â±7723870, RÂ²=0.028 [SELECTED]
2025-06-01 00:02:42,077 - MoETrainer - INFO -   2. ridge_medium: MSE=435128245Â±6469557, RÂ²=0.026
2025-06-01 00:02:42,077 - MoETrainer - INFO -   3. elastic_light: MSE=436045109Â±9629897, RÂ²=0.024
2025-06-01 00:02:46,061 - MoETrainer - INFO - Bin 3: Top 3 models (CV results):
2025-06-01 00:02:46,061 - MoETrainer - INFO -   1. elastic_light: MSE=778043179Â±40456928, RÂ²=-0.005 [SELECTED]
2025-06-01 00:02:46,061 - MoETrainer - INFO -   2. ridge_heavy: MSE=780244864Â±39512437, RÂ²=-0.008
2025-06-01 00:02:46,062 - MoETrainer - INFO -   3. elastic_balanced: MSE=783547264Â±38236889, RÂ²=-0.012
2025-06-01 00:02:49,924 - MoETrainer - INFO - Bin 4: Top 3 models (CV results):
2025-06-01 00:02:49,924 - MoETrainer - INFO -   1. elastic_light: MSE=2046043136Â±78293423, RÂ²=0.031 [SELECTED]
2025-06-01 00:02:49,925 - MoETrainer - INFO -   2. ridge_heavy: MSE=2056651051Â±77220598, RÂ²=0.026
2025-06-01 00:02:49,925 - MoETrainer - INFO -   3. elastic_balanced: MSE=2059949611Â±67140614, RÂ²=0.024
2025-06-01 00:02:54,419 - MoETrainer - INFO - Bin 5: Top 3 models (CV results):
2025-06-01 00:02:54,419 - MoETrainer - INFO -   1. elastic_light: MSE=65319122261Â±7915126705, RÂ²=0.176 [SELECTED]
2025-06-01 00:02:54,419 - MoETrainer - INFO -   2. ridge_heavy: MSE=65372880896Â±8015875834, RÂ²=0.175
2025-06-01 00:02:54,420 - MoETrainer - INFO -   3. ridge_medium: MSE=65704592725Â±7760703790, RÂ²=0.171
2025-06-01 00:02:54,420 - MoETrainer - INFO - Training selected expert models...
2025-06-01 00:02:54,422 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 0: 531 samples
2025-06-01 00:02:54,424 - MoETrainer - INFO - Successfully trained elastic_heavy for bin 1: 638 samples
2025-06-01 00:02:54,426 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 2: 615 samples
2025-06-01 00:02:54,429 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-01 00:02:54,437 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-01 00:02:54,440 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 597 samples
2025-06-01 00:02:54,440 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-01 00:02:54,470 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-01 00:02:54,471 - MoETrainer - INFO - Overall Performance:
2025-06-01 00:02:54,471 - MoETrainer - INFO -   RMSE: $111,248
2025-06-01 00:02:54,471 - MoETrainer - INFO -   MAE: $55,539 (10.3% of mean)
2025-06-01 00:02:54,472 - MoETrainer - INFO -   RÂ²: 0.8380
2025-06-01 00:02:54,472 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-01 00:02:54,472 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-01 00:02:54,473 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-01 00:02:54,473 - MoETrainer - INFO -   Within 5%: 37.4% of predictions
2025-06-01 00:02:54,473 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-01 00:02:54,474 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-01 00:02:54,474 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-01 00:02:54,475 - MoETrainer - INFO -   Bin 0: RMSE=$36,946, RÂ²=0.0641, Samples=178
2025-06-01 00:02:54,475 - MoETrainer - INFO -   Bin 1: RMSE=$21,685, RÂ²=-0.0261, Samples=195
2025-06-01 00:02:54,476 - MoETrainer - INFO -   Bin 2: RMSE=$20,770, RÂ²=0.0171, Samples=180
2025-06-01 00:02:54,476 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-01 00:02:54,476 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-01 00:02:54,477 - MoETrainer - INFO -   Bin 5: RMSE=$254,108, RÂ²=0.1559, Samples=197
2025-06-01 00:02:54,477 - MoETrainer - INFO - Final Expert Configuration:
2025-06-01 00:02:54,478 - MoETrainer - INFO -   Bin 0: ridge_heavy
2025-06-01 00:02:54,478 - MoETrainer - INFO -   Bin 1: elastic_heavy
2025-06-01 00:02:54,478 - MoETrainer - INFO -   Bin 2: ridge_heavy
2025-06-01 00:02:54,479 - MoETrainer - INFO -   Bin 3: elastic_light
2025-06-01 00:02:54,486 - MoETrainer - INFO -   Bin 4: elastic_light
2025-06-01 00:02:54,487 - MoETrainer - INFO -   Bin 5: elastic_light
2025-06-01 00:02:54,487 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-01 00:02:54,488 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-01 00:02:54,488 - MoETrainer - INFO - Final Performance: RÂ² = 0.8380
2025-06-01 00:02:54,488 - MoETrainer - INFO - Final RMSE: $111,248
2025-06-01 00:02:54,489 - MoETrainer - INFO - Final MAE: $55,539
2025-06-03 03:25:06,056 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-03 03:25:06,058 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-03 03:25:06,058 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-03 03:25:07,049 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-06-03 03:25:07,057 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-03 03:25:07,067 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-03 03:25:07,092 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-03 03:25:11,239 - MoETrainer - INFO - Consolidated to 13 features
2025-06-03 03:25:11,272 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-03 03:25:11,272 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-06-03 03:25:11,274 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-06-03 03:25:11,276 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-06-03 03:25:11,276 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-03 03:25:11,278 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-06-03 03:25:11,286 - MoETrainer - INFO - Applied robust scaling
2025-06-03 03:25:11,286 - MoETrainer - INFO - Splitting data...
2025-06-03 03:25:11,293 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-03 03:25:11,294 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-06-03 03:25:11,294 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-06-03 03:25:11,295 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-03 03:25:11,295 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 03:25:11,296 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 03:25:11,296 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 03:25:11,296 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 03:25:11,297 - MoETrainer - INFO - Bin 0: Large bin (1169), using CV selection
2025-06-03 03:25:18,712 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-03 03:25:18,713 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-06-03 03:25:18,714 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-06-03 03:25:18,716 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.155
2025-06-03 03:25:18,716 - MoETrainer - INFO - Bin 1: Large bin (1214), using CV selection
2025-06-03 03:25:23,003 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-03 03:25:23,049 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.143 [SELECTED]
2025-06-03 03:25:23,100 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.132
2025-06-03 03:25:23,110 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.126
2025-06-03 03:25:23,111 - MoETrainer - INFO - Bin 2: Large bin (1193), using CV selection
2025-06-03 03:25:27,880 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-03 03:25:27,881 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.302 [SELECTED]
2025-06-03 03:25:27,881 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.285
2025-06-03 03:25:27,881 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.285
2025-06-03 03:25:27,882 - MoETrainer - INFO - Training selected expert models...
2025-06-03 03:25:27,931 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-06-03 03:25:27,983 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-06-03 03:25:28,028 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-06-03 03:25:28,029 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-03 03:25:28,044 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 03:25:28,045 - MoETrainer - INFO - Overall Performance:
2025-06-03 03:25:28,045 - MoETrainer - INFO -   RMSE: $141,212
2025-06-03 03:25:28,046 - MoETrainer - INFO -   MAE: $82,758 (15.4% of mean)
2025-06-03 03:25:28,046 - MoETrainer - INFO -   RÂ²: 0.7390
2025-06-03 03:25:28,046 - MoETrainer - INFO -   MAPE: 14.1%
2025-06-03 03:25:28,046 - MoETrainer - INFO -   MPE: +3.5% (bias: overprediction)
2025-06-03 03:25:28,046 - MoETrainer - INFO -   Median APE: 10.7%
2025-06-03 03:25:28,046 - MoETrainer - INFO -   Within 5%: 23.9% of predictions
2025-06-03 03:25:28,047 - MoETrainer - INFO -   Within 10%: 47.2% of predictions
2025-06-03 03:25:28,047 - MoETrainer - INFO -   Within 15%: 67.7% of predictions
2025-06-03 03:25:28,047 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 03:25:28,047 - MoETrainer - INFO -   Bin 0: RMSE=$50,405, RÂ²=0.1927, Samples=373
2025-06-03 03:25:28,047 - MoETrainer - INFO -   Bin 1: RMSE=$43,956, RÂ²=0.1187, Samples=359
2025-06-03 03:25:28,048 - MoETrainer - INFO -   Bin 2: RMSE=$234,629, RÂ²=0.2994, Samples=369
2025-06-03 03:25:28,048 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-06-03 03:25:28,048 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 03:25:28,049 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 03:25:28,049 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 03:25:28,050 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 03:25:28,050 - MoETrainer - INFO - Bin 0: Large bin (886), using CV selection
2025-06-03 03:25:31,616 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-03 03:25:31,616 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.138 [SELECTED]
2025-06-03 03:25:31,616 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.135
2025-06-03 03:25:31,617 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.129
2025-06-03 03:25:31,617 - MoETrainer - INFO - Bin 1: Large bin (898), using CV selection
2025-06-03 03:25:34,774 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-03 03:25:34,775 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-06-03 03:25:34,775 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-06-03 03:25:34,775 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-06-03 03:25:34,776 - MoETrainer - INFO - Bin 2: Large bin (875), using CV selection
2025-06-03 03:25:37,919 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-03 03:25:37,919 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.034 [SELECTED]
2025-06-03 03:25:37,920 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.025
2025-06-03 03:25:37,920 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.021
2025-06-03 03:25:37,921 - MoETrainer - INFO - Bin 3: Large bin (917), using CV selection
2025-06-03 03:25:41,452 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-03 03:25:41,452 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.233 [SELECTED]
2025-06-03 03:25:41,453 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.231
2025-06-03 03:25:41,453 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.229
2025-06-03 03:25:41,454 - MoETrainer - INFO - Training selected expert models...
2025-06-03 03:25:41,475 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-06-03 03:25:41,510 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-06-03 03:25:41,723 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-06-03 03:25:41,725 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-06-03 03:25:41,726 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-03 03:25:41,747 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 03:25:41,747 - MoETrainer - INFO - Overall Performance:
2025-06-03 03:25:41,748 - MoETrainer - INFO -   RMSE: $131,774
2025-06-03 03:25:41,748 - MoETrainer - INFO -   MAE: $71,137 (13.2% of mean)
2025-06-03 03:25:41,749 - MoETrainer - INFO -   RÂ²: 0.7727
2025-06-03 03:25:41,753 - MoETrainer - INFO -   MAPE: 11.6%
2025-06-03 03:25:41,754 - MoETrainer - INFO -   MPE: +3.2% (bias: overprediction)
2025-06-03 03:25:41,754 - MoETrainer - INFO -   Median APE: 8.3%
2025-06-03 03:25:41,754 - MoETrainer - INFO -   Within 5%: 29.8% of predictions
2025-06-03 03:25:41,754 - MoETrainer - INFO -   Within 10%: 60.5% of predictions
2025-06-03 03:25:41,755 - MoETrainer - INFO -   Within 15%: 77.5% of predictions
2025-06-03 03:25:41,755 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 03:25:41,755 - MoETrainer - INFO -   Bin 0: RMSE=$44,409, RÂ²=0.1239, Samples=272
2025-06-03 03:25:41,755 - MoETrainer - INFO -   Bin 1: RMSE=$28,492, RÂ²=0.0200, Samples=281
2025-06-03 03:25:41,756 - MoETrainer - INFO -   Bin 2: RMSE=$40,906, RÂ²=0.1414, Samples=253
2025-06-03 03:25:41,756 - MoETrainer - INFO -   Bin 3: RMSE=$246,537, RÂ²=0.2252, Samples=295
2025-06-03 03:25:41,757 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-06-03 03:25:41,758 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 03:25:41,759 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 03:25:41,759 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 03:25:41,759 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 03:25:41,760 - MoETrainer - INFO - Bin 0: Small bin (701), using rule-based selection
2025-06-03 03:25:42,606 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-03 03:25:42,606 - MoETrainer - INFO -   1. xgb_conservative: Score=1.044, MAE=$28337, RMSE=$35417, RÂ²=0.108 [SELECTED]
2025-06-03 03:25:42,606 - MoETrainer - INFO -   2. lgb_conservative: Score=1.045, MAE=$28352, RMSE=$35447, RÂ²=0.106
2025-06-03 03:25:42,607 - MoETrainer - INFO -   3. rf_medium: Score=1.046, MAE=$27958, RMSE=$35537, RÂ²=0.102
2025-06-03 03:25:42,607 - MoETrainer - INFO - Bin 1: Small bin (722), using rule-based selection
2025-06-03 03:25:43,449 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-03 03:25:43,450 - MoETrainer - INFO -   1. elastic_light: Score=1.083, MAE=$18234, RMSE=$21576, RÂ²=-0.014 [SELECTED]
2025-06-03 03:25:43,454 - MoETrainer - INFO -   2. xgb_conservative: Score=1.119, MAE=$18435, RMSE=$21728, RÂ²=-0.028
2025-06-03 03:25:43,454 - MoETrainer - INFO -   3. rf_shallow: Score=1.120, MAE=$18519, RMSE=$21732, RÂ²=-0.029
2025-06-03 03:25:43,455 - MoETrainer - INFO - Bin 2: Small bin (721), using rule-based selection
2025-06-03 03:25:44,294 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-03 03:25:44,294 - MoETrainer - INFO -   1. lgb_conservative: Score=1.051, MAE=$23577, RMSE=$27642, RÂ²=-0.000 [SELECTED]
2025-06-03 03:25:44,295 - MoETrainer - INFO -   2. xgb_conservative: Score=1.085, MAE=$23821, RMSE=$27822, RÂ²=-0.013
2025-06-03 03:25:44,295 - MoETrainer - INFO -   3. elastic_light: Score=1.138, MAE=$24842, RMSE=$28103, RÂ²=-0.034
2025-06-03 03:25:44,296 - MoETrainer - INFO - Bin 3: Small bin (708), using rule-based selection
2025-06-03 03:25:45,122 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-03 03:25:45,123 - MoETrainer - INFO -   1. rf_shallow: Score=1.062, MAE=$39877, RMSE=$47457, RÂ²=0.013 [SELECTED]
2025-06-03 03:25:45,123 - MoETrainer - INFO -   2. elastic_light: Score=1.063, MAE=$40758, RMSE=$47446, RÂ²=0.013
2025-06-03 03:25:45,123 - MoETrainer - INFO -   3. ridge_medium: Score=1.069, MAE=$40736, RMSE=$47721, RÂ²=0.002
2025-06-03 03:25:45,124 - MoETrainer - INFO - Bin 4: Small bin (724), using rule-based selection
2025-06-03 03:25:46,012 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-03 03:25:46,013 - MoETrainer - INFO -   1. xgb_conservative: Score=1.108, MAE=$197372, RMSE=$267697, RÂ²=0.188 [SELECTED]
2025-06-03 03:25:46,013 - MoETrainer - INFO -   2. ridge_medium: Score=1.122, MAE=$192641, RMSE=$273250, RÂ²=0.154
2025-06-03 03:25:46,014 - MoETrainer - INFO -   3. elastic_light: Score=1.127, MAE=$194859, RMSE=$274024, RÂ²=0.149
2025-06-03 03:25:46,014 - MoETrainer - INFO - Training selected expert models...
2025-06-03 03:25:46,052 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-06-03 03:25:46,057 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-06-03 03:25:46,082 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-06-03 03:25:46,265 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 708 samples
2025-06-03 03:25:46,309 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 724 samples
2025-06-03 03:25:46,309 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-03 03:25:46,335 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 03:25:46,335 - MoETrainer - INFO - Overall Performance:
2025-06-03 03:25:46,335 - MoETrainer - INFO -   RMSE: $117,542
2025-06-03 03:25:46,336 - MoETrainer - INFO -   MAE: $59,657 (11.1% of mean)
2025-06-03 03:25:46,339 - MoETrainer - INFO -   RÂ²: 0.8192
2025-06-03 03:25:46,340 - MoETrainer - INFO -   MAPE: 9.5%
2025-06-03 03:25:46,341 - MoETrainer - INFO -   MPE: +1.8% (bias: overprediction)
2025-06-03 03:25:46,341 - MoETrainer - INFO -   Median APE: 6.6%
2025-06-03 03:25:46,342 - MoETrainer - INFO -   Within 5%: 39.2% of predictions
2025-06-03 03:25:46,343 - MoETrainer - INFO -   Within 10%: 70.4% of predictions
2025-06-03 03:25:46,348 - MoETrainer - INFO -   Within 15%: 82.7% of predictions
2025-06-03 03:25:46,348 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 03:25:46,349 - MoETrainer - INFO -   Bin 0: RMSE=$40,646, RÂ²=0.0942, Samples=223
2025-06-03 03:25:46,349 - MoETrainer - INFO -   Bin 1: RMSE=$19,774, RÂ²=0.0186, Samples=215
2025-06-03 03:25:46,350 - MoETrainer - INFO -   Bin 2: RMSE=$28,331, RÂ²=-0.1027, Samples=233
2025-06-03 03:25:46,350 - MoETrainer - INFO -   Bin 3: RMSE=$45,726, RÂ²=0.0423, Samples=201
2025-06-03 03:25:46,350 - MoETrainer - INFO -   Bin 4: RMSE=$248,593, RÂ²=0.2083, Samples=229
2025-06-03 03:25:46,351 - MoETrainer - INFO -   5 bins: RÂ²=0.8192, RMSE=$117,542
2025-06-03 03:25:46,352 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 03:25:46,357 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 03:25:46,361 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 03:25:46,361 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 03:25:46,362 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-03 03:25:47,141 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-03 03:25:47,142 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-03 03:25:47,142 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-03 03:25:47,142 - MoETrainer - INFO -   3. lgb_conservative: Score=1.089, MAE=$27863, RMSE=$34373, RÂ²=0.027
2025-06-03 03:25:47,143 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-03 03:25:47,911 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-03 03:25:47,911 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-03 03:25:47,912 - MoETrainer - INFO -   2. lgb_conservative: Score=1.153, MAE=$19030, RMSE=$21891, RÂ²=-0.040
2025-06-03 03:25:47,912 - MoETrainer - INFO -   3. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-03 03:25:47,913 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-03 03:25:48,679 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-03 03:25:48,679 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-03 03:25:48,680 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-03 03:25:48,680 - MoETrainer - INFO -   3. lgb_conservative: Score=1.026, MAE=$18364, RMSE=$21040, RÂ²=0.034
2025-06-03 03:25:48,680 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-03 03:25:49,421 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-03 03:25:49,421 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-03 03:25:49,422 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-03 03:25:49,424 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-03 03:25:49,425 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-03 03:25:50,205 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-03 03:25:50,210 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-03 03:25:50,210 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-03 03:25:50,211 - MoETrainer - INFO -   3. lgb_conservative: Score=1.144, MAE=$41057, RMSE=$46819, RÂ²=-0.032
2025-06-03 03:25:50,212 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-03 03:25:51,037 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-03 03:25:51,038 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-03 03:25:51,038 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-03 03:25:51,038 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-03 03:25:51,039 - MoETrainer - INFO - Training selected expert models...
2025-06-03 03:25:51,044 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-03 03:25:51,047 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-03 03:25:51,051 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-03 03:25:51,053 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-03 03:25:51,056 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-03 03:25:51,062 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-03 03:25:51,062 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-03 03:25:51,080 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 03:25:51,081 - MoETrainer - INFO - Overall Performance:
2025-06-03 03:25:51,081 - MoETrainer - INFO -   RMSE: $112,653
2025-06-03 03:25:51,082 - MoETrainer - INFO -   MAE: $55,833 (10.4% of mean)
2025-06-03 03:25:51,082 - MoETrainer - INFO -   RÂ²: 0.8339
2025-06-03 03:25:51,083 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-03 03:25:51,083 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-03 03:25:51,083 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-03 03:25:51,084 - MoETrainer - INFO -   Within 5%: 38.4% of predictions
2025-06-03 03:25:51,084 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-03 03:25:51,084 - MoETrainer - INFO -   Within 15%: 87.0% of predictions
2025-06-03 03:25:51,085 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 03:25:51,085 - MoETrainer - INFO -   Bin 0: RMSE=$36,723, RÂ²=0.0753, Samples=178
2025-06-03 03:25:51,085 - MoETrainer - INFO -   Bin 1: RMSE=$21,618, RÂ²=-0.0197, Samples=195
2025-06-03 03:25:51,086 - MoETrainer - INFO -   Bin 2: RMSE=$20,938, RÂ²=0.0011, Samples=180
2025-06-03 03:25:51,086 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-03 03:25:51,086 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-03 03:25:51,087 - MoETrainer - INFO -   Bin 5: RMSE=$257,565, RÂ²=0.1328, Samples=197
2025-06-03 03:25:51,088 - MoETrainer - INFO -   6 bins: RÂ²=0.8339, RMSE=$112,653
2025-06-03 03:25:51,088 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-03 03:25:51,088 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-03 03:25:51,089 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 03:25:51,089 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 03:25:51,090 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 03:25:51,094 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 03:25:51,094 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-03 03:25:51,773 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-03 03:25:51,773 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-03 03:25:51,774 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-03 03:25:51,776 - MoETrainer - INFO -   3. lgb_conservative: Score=1.089, MAE=$27863, RMSE=$34373, RÂ²=0.027
2025-06-03 03:25:51,777 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-03 03:25:52,772 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-03 03:25:52,772 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-03 03:25:52,773 - MoETrainer - INFO -   2. lgb_conservative: Score=1.153, MAE=$19030, RMSE=$21891, RÂ²=-0.040
2025-06-03 03:25:52,773 - MoETrainer - INFO -   3. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-03 03:25:52,773 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-03 03:25:53,551 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-03 03:25:53,551 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-03 03:25:53,552 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-03 03:25:53,552 - MoETrainer - INFO -   3. lgb_conservative: Score=1.026, MAE=$18364, RMSE=$21040, RÂ²=0.034
2025-06-03 03:25:53,552 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-03 03:25:54,333 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-03 03:25:54,333 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-03 03:25:54,334 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-03 03:25:54,334 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-03 03:25:54,335 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-03 03:25:55,152 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-03 03:25:55,153 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-03 03:25:55,153 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-03 03:25:55,153 - MoETrainer - INFO -   3. lgb_conservative: Score=1.144, MAE=$41057, RMSE=$46819, RÂ²=-0.032
2025-06-03 03:25:55,154 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-03 03:25:55,933 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-03 03:25:55,933 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-03 03:25:55,933 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-03 03:25:55,934 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-03 03:25:55,934 - MoETrainer - INFO - Training selected expert models...
2025-06-03 03:25:55,936 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-03 03:25:55,938 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-03 03:25:55,940 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-03 03:25:55,942 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-03 03:25:55,944 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-03 03:25:55,950 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-03 03:25:55,950 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-03 03:25:55,971 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 03:25:55,972 - MoETrainer - INFO - Overall Performance:
2025-06-03 03:25:55,973 - MoETrainer - INFO -   RMSE: $112,653
2025-06-03 03:25:55,973 - MoETrainer - INFO -   MAE: $55,833 (10.4% of mean)
2025-06-03 03:25:55,974 - MoETrainer - INFO -   RÂ²: 0.8339
2025-06-03 03:25:55,974 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-03 03:25:55,975 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-03 03:25:55,976 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-03 03:25:55,976 - MoETrainer - INFO -   Within 5%: 38.4% of predictions
2025-06-03 03:25:55,977 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-03 03:25:55,984 - MoETrainer - INFO -   Within 15%: 87.0% of predictions
2025-06-03 03:25:55,984 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 03:25:55,985 - MoETrainer - INFO -   Bin 0: RMSE=$36,723, RÂ²=0.0753, Samples=178
2025-06-03 03:25:55,985 - MoETrainer - INFO -   Bin 1: RMSE=$21,618, RÂ²=-0.0197, Samples=195
2025-06-03 03:25:55,986 - MoETrainer - INFO -   Bin 2: RMSE=$20,938, RÂ²=0.0011, Samples=180
2025-06-03 03:25:55,987 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-03 03:25:55,987 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-03 03:25:55,988 - MoETrainer - INFO -   Bin 5: RMSE=$257,565, RÂ²=0.1328, Samples=197
2025-06-03 03:25:55,988 - MoETrainer - INFO - Final Expert Configuration:
2025-06-03 03:25:55,989 - MoETrainer - INFO -   Bin 0: ridge_medium
2025-06-03 03:25:55,989 - MoETrainer - INFO -   Bin 1: elastic_light
2025-06-03 03:25:55,989 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-03 03:25:55,990 - MoETrainer - INFO -   Bin 3: elastic_light
2025-06-03 03:25:55,990 - MoETrainer - INFO -   Bin 4: elastic_light
2025-06-03 03:25:55,990 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-06-03 03:25:55,990 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-03 03:25:55,991 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-03 03:25:55,991 - MoETrainer - INFO - Final Performance: RÂ² = 0.8339
2025-06-03 03:25:55,991 - MoETrainer - INFO - Final RMSE: $112,653
2025-06-03 03:25:55,992 - MoETrainer - INFO - Final MAE: $55,833
2025-06-03 14:25:24,938 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-03 14:25:24,938 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-03 14:25:24,939 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-03 14:25:25,954 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-06-03 14:25:25,959 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-03 14:25:25,971 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-03 14:25:25,998 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-03 14:25:28,797 - MoETrainer - INFO - Consolidated to 13 features
2025-06-03 14:25:28,840 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-03 14:25:28,841 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-06-03 14:25:28,841 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-06-03 14:25:28,841 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-06-03 14:25:28,842 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-03 14:25:28,843 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-06-03 14:25:28,852 - MoETrainer - INFO - Applied robust scaling
2025-06-03 14:25:28,853 - MoETrainer - INFO - Splitting data...
2025-06-03 14:25:28,857 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-03 14:25:28,858 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-06-03 14:25:28,858 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-06-03 14:25:28,859 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-03 14:25:28,863 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 14:25:28,864 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 14:25:28,864 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 14:25:28,865 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 14:25:28,865 - MoETrainer - INFO - Bin 0: Large bin (1169), using CV selection
2025-06-03 14:25:33,243 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-03 14:25:33,244 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-06-03 14:25:33,244 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-06-03 14:25:33,245 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.155
2025-06-03 14:25:33,245 - MoETrainer - INFO - Bin 1: Large bin (1214), using CV selection
2025-06-03 14:25:37,210 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-03 14:25:37,210 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.143 [SELECTED]
2025-06-03 14:25:37,210 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.132
2025-06-03 14:25:37,211 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.126
2025-06-03 14:25:37,211 - MoETrainer - INFO - Bin 2: Large bin (1193), using CV selection
2025-06-03 14:25:41,308 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-03 14:25:41,309 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.302 [SELECTED]
2025-06-03 14:25:41,310 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.285
2025-06-03 14:25:41,310 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.285
2025-06-03 14:25:41,310 - MoETrainer - INFO - Training selected expert models...
2025-06-03 14:25:41,356 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-06-03 14:25:41,408 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-06-03 14:25:41,447 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-06-03 14:25:41,447 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-03 14:25:41,464 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 14:25:41,464 - MoETrainer - INFO - Overall Performance:
2025-06-03 14:25:41,465 - MoETrainer - INFO -   RMSE: $141,212
2025-06-03 14:25:41,465 - MoETrainer - INFO -   MAE: $82,758 (15.4% of mean)
2025-06-03 14:25:41,466 - MoETrainer - INFO -   RÂ²: 0.7390
2025-06-03 14:25:41,466 - MoETrainer - INFO -   MAPE: 14.1%
2025-06-03 14:25:41,466 - MoETrainer - INFO -   MPE: +3.5% (bias: overprediction)
2025-06-03 14:25:41,467 - MoETrainer - INFO -   Median APE: 10.7%
2025-06-03 14:25:41,467 - MoETrainer - INFO -   Within 5%: 23.9% of predictions
2025-06-03 14:25:41,467 - MoETrainer - INFO -   Within 10%: 47.2% of predictions
2025-06-03 14:25:41,467 - MoETrainer - INFO -   Within 15%: 67.7% of predictions
2025-06-03 14:25:41,468 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 14:25:41,468 - MoETrainer - INFO -   Bin 0: RMSE=$50,405, RÂ²=0.1927, Samples=373
2025-06-03 14:25:41,468 - MoETrainer - INFO -   Bin 1: RMSE=$43,956, RÂ²=0.1187, Samples=359
2025-06-03 14:25:41,469 - MoETrainer - INFO -   Bin 2: RMSE=$234,629, RÂ²=0.2994, Samples=369
2025-06-03 14:25:41,469 - MoETrainer - INFO -   3 bins: RÂ²=0.7390, RMSE=$141,212
2025-06-03 14:25:41,470 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 14:25:41,470 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 14:25:41,471 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 14:25:41,472 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 14:25:41,473 - MoETrainer - INFO - Bin 0: Large bin (886), using CV selection
2025-06-03 14:25:45,060 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-03 14:25:45,060 - MoETrainer - INFO -   1. lgb_conservative: MSE=1556788138Â±97571029, RÂ²=0.138 [SELECTED]
2025-06-03 14:25:45,060 - MoETrainer - INFO -   2. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.135
2025-06-03 14:25:45,061 - MoETrainer - INFO -   3. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.129
2025-06-03 14:25:45,062 - MoETrainer - INFO - Bin 1: Large bin (898), using CV selection
2025-06-03 14:25:48,385 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-03 14:25:48,385 - MoETrainer - INFO -   1. lgb_conservative: MSE=759790326Â±46893975, RÂ²=0.060 [SELECTED]
2025-06-03 14:25:48,385 - MoETrainer - INFO -   2. ridge_heavy: MSE=760152363Â±41859653, RÂ²=0.059
2025-06-03 14:25:48,386 - MoETrainer - INFO -   3. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-06-03 14:25:48,386 - MoETrainer - INFO - Bin 2: Large bin (875), using CV selection
2025-06-03 14:25:51,656 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-03 14:25:51,657 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.034 [SELECTED]
2025-06-03 14:25:51,657 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.025
2025-06-03 14:25:51,658 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.021
2025-06-03 14:25:51,658 - MoETrainer - INFO - Bin 3: Large bin (917), using CV selection
2025-06-03 14:25:55,203 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-03 14:25:55,204 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120892587Â±5601852384, RÂ²=0.233 [SELECTED]
2025-06-03 14:25:55,205 - MoETrainer - INFO -   2. ridge_medium: MSE=59261803179Â±5215526521, RÂ²=0.231
2025-06-03 14:25:55,206 - MoETrainer - INFO -   3. elastic_light: MSE=59424124928Â±5623517869, RÂ²=0.229
2025-06-03 14:25:55,206 - MoETrainer - INFO - Training selected expert models...
2025-06-03 14:25:55,262 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 886 samples
2025-06-03 14:25:55,313 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 1: 898 samples
2025-06-03 14:25:55,571 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-06-03 14:25:55,573 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-06-03 14:25:55,574 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-03 14:25:55,595 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 14:25:55,595 - MoETrainer - INFO - Overall Performance:
2025-06-03 14:25:55,595 - MoETrainer - INFO -   RMSE: $131,774
2025-06-03 14:25:55,596 - MoETrainer - INFO -   MAE: $71,137 (13.2% of mean)
2025-06-03 14:25:55,596 - MoETrainer - INFO -   RÂ²: 0.7727
2025-06-03 14:25:55,597 - MoETrainer - INFO -   MAPE: 11.6%
2025-06-03 14:25:55,597 - MoETrainer - INFO -   MPE: +3.2% (bias: overprediction)
2025-06-03 14:25:55,597 - MoETrainer - INFO -   Median APE: 8.3%
2025-06-03 14:25:55,598 - MoETrainer - INFO -   Within 5%: 29.8% of predictions
2025-06-03 14:25:55,598 - MoETrainer - INFO -   Within 10%: 60.5% of predictions
2025-06-03 14:25:55,598 - MoETrainer - INFO -   Within 15%: 77.5% of predictions
2025-06-03 14:25:55,599 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 14:25:55,599 - MoETrainer - INFO -   Bin 0: RMSE=$44,409, RÂ²=0.1239, Samples=272
2025-06-03 14:25:55,600 - MoETrainer - INFO -   Bin 1: RMSE=$28,492, RÂ²=0.0200, Samples=281
2025-06-03 14:25:55,601 - MoETrainer - INFO -   Bin 2: RMSE=$40,906, RÂ²=0.1414, Samples=253
2025-06-03 14:25:55,602 - MoETrainer - INFO -   Bin 3: RMSE=$246,537, RÂ²=0.2252, Samples=295
2025-06-03 14:25:55,602 - MoETrainer - INFO -   4 bins: RÂ²=0.7727, RMSE=$131,774
2025-06-03 14:25:55,603 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 14:25:55,604 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 14:25:55,604 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 14:25:55,604 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 14:25:55,605 - MoETrainer - INFO - Bin 0: Small bin (701), using rule-based selection
2025-06-03 14:25:56,380 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-03 14:25:56,380 - MoETrainer - INFO -   1. xgb_conservative: Score=1.044, MAE=$28337, RMSE=$35417, RÂ²=0.108 [SELECTED]
2025-06-03 14:25:56,381 - MoETrainer - INFO -   2. lgb_conservative: Score=1.045, MAE=$28352, RMSE=$35447, RÂ²=0.106
2025-06-03 14:25:56,381 - MoETrainer - INFO -   3. rf_medium: Score=1.046, MAE=$27958, RMSE=$35537, RÂ²=0.102
2025-06-03 14:25:56,381 - MoETrainer - INFO - Bin 1: Small bin (722), using rule-based selection
2025-06-03 14:25:57,213 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-03 14:25:57,213 - MoETrainer - INFO -   1. elastic_light: Score=1.083, MAE=$18234, RMSE=$21576, RÂ²=-0.014 [SELECTED]
2025-06-03 14:25:57,214 - MoETrainer - INFO -   2. xgb_conservative: Score=1.119, MAE=$18435, RMSE=$21728, RÂ²=-0.028
2025-06-03 14:25:57,214 - MoETrainer - INFO -   3. rf_shallow: Score=1.120, MAE=$18519, RMSE=$21732, RÂ²=-0.029
2025-06-03 14:25:57,215 - MoETrainer - INFO - Bin 2: Small bin (721), using rule-based selection
2025-06-03 14:25:58,049 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-03 14:25:58,049 - MoETrainer - INFO -   1. lgb_conservative: Score=1.051, MAE=$23577, RMSE=$27642, RÂ²=-0.000 [SELECTED]
2025-06-03 14:25:58,050 - MoETrainer - INFO -   2. xgb_conservative: Score=1.085, MAE=$23821, RMSE=$27822, RÂ²=-0.013
2025-06-03 14:25:58,050 - MoETrainer - INFO -   3. elastic_light: Score=1.138, MAE=$24842, RMSE=$28103, RÂ²=-0.034
2025-06-03 14:25:58,051 - MoETrainer - INFO - Bin 3: Small bin (708), using rule-based selection
2025-06-03 14:25:58,902 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-03 14:25:58,902 - MoETrainer - INFO -   1. rf_shallow: Score=1.062, MAE=$39877, RMSE=$47457, RÂ²=0.013 [SELECTED]
2025-06-03 14:25:58,903 - MoETrainer - INFO -   2. elastic_light: Score=1.063, MAE=$40758, RMSE=$47446, RÂ²=0.013
2025-06-03 14:25:58,904 - MoETrainer - INFO -   3. ridge_medium: Score=1.069, MAE=$40736, RMSE=$47721, RÂ²=0.002
2025-06-03 14:25:58,905 - MoETrainer - INFO - Bin 4: Small bin (724), using rule-based selection
2025-06-03 14:26:00,616 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-03 14:26:00,619 - MoETrainer - INFO -   1. xgb_conservative: Score=1.108, MAE=$197372, RMSE=$267697, RÂ²=0.188 [SELECTED]
2025-06-03 14:26:00,619 - MoETrainer - INFO -   2. ridge_medium: Score=1.122, MAE=$192641, RMSE=$273250, RÂ²=0.154
2025-06-03 14:26:00,619 - MoETrainer - INFO -   3. elastic_light: Score=1.127, MAE=$194859, RMSE=$274024, RÂ²=0.149
2025-06-03 14:26:00,619 - MoETrainer - INFO - Training selected expert models...
2025-06-03 14:26:00,662 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-06-03 14:26:00,664 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-06-03 14:26:00,701 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 721 samples
2025-06-03 14:26:00,904 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 708 samples
2025-06-03 14:26:00,957 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 724 samples
2025-06-03 14:26:00,957 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-03 14:26:00,992 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 14:26:00,992 - MoETrainer - INFO - Overall Performance:
2025-06-03 14:26:00,992 - MoETrainer - INFO -   RMSE: $117,542
2025-06-03 14:26:00,992 - MoETrainer - INFO -   MAE: $59,657 (11.1% of mean)
2025-06-03 14:26:00,992 - MoETrainer - INFO -   RÂ²: 0.8192
2025-06-03 14:26:00,992 - MoETrainer - INFO -   MAPE: 9.5%
2025-06-03 14:26:00,993 - MoETrainer - INFO -   MPE: +1.8% (bias: overprediction)
2025-06-03 14:26:00,993 - MoETrainer - INFO -   Median APE: 6.6%
2025-06-03 14:26:00,993 - MoETrainer - INFO -   Within 5%: 39.2% of predictions
2025-06-03 14:26:00,993 - MoETrainer - INFO -   Within 10%: 70.4% of predictions
2025-06-03 14:26:00,993 - MoETrainer - INFO -   Within 15%: 82.7% of predictions
2025-06-03 14:26:00,993 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 14:26:00,993 - MoETrainer - INFO -   Bin 0: RMSE=$40,646, RÂ²=0.0942, Samples=223
2025-06-03 14:26:00,994 - MoETrainer - INFO -   Bin 1: RMSE=$19,774, RÂ²=0.0186, Samples=215
2025-06-03 14:26:00,994 - MoETrainer - INFO -   Bin 2: RMSE=$28,331, RÂ²=-0.1027, Samples=233
2025-06-03 14:26:00,994 - MoETrainer - INFO -   Bin 3: RMSE=$45,726, RÂ²=0.0423, Samples=201
2025-06-03 14:26:00,994 - MoETrainer - INFO -   Bin 4: RMSE=$248,593, RÂ²=0.2083, Samples=229
2025-06-03 14:26:00,996 - MoETrainer - INFO -   5 bins: RÂ²=0.8192, RMSE=$117,542
2025-06-03 14:26:00,998 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 14:26:00,999 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 14:26:00,999 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 14:26:00,999 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 14:26:00,999 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-03 14:26:01,821 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-03 14:26:01,821 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-03 14:26:01,822 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-03 14:26:01,822 - MoETrainer - INFO -   3. lgb_conservative: Score=1.089, MAE=$27863, RMSE=$34373, RÂ²=0.027
2025-06-03 14:26:01,824 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-03 14:26:02,889 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-03 14:26:02,890 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-03 14:26:02,891 - MoETrainer - INFO -   2. lgb_conservative: Score=1.153, MAE=$19030, RMSE=$21891, RÂ²=-0.040
2025-06-03 14:26:02,891 - MoETrainer - INFO -   3. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-03 14:26:02,892 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-03 14:26:03,682 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-03 14:26:03,682 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-03 14:26:03,683 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-03 14:26:03,683 - MoETrainer - INFO -   3. lgb_conservative: Score=1.026, MAE=$18364, RMSE=$21040, RÂ²=0.034
2025-06-03 14:26:03,684 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-03 14:26:04,501 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-03 14:26:04,502 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-03 14:26:04,502 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-03 14:26:04,502 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-03 14:26:04,503 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-03 14:26:05,554 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-03 14:26:05,555 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-03 14:26:05,556 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-03 14:26:05,556 - MoETrainer - INFO -   3. lgb_conservative: Score=1.144, MAE=$41057, RMSE=$46819, RÂ²=-0.032
2025-06-03 14:26:05,557 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-03 14:26:06,424 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-03 14:26:06,425 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-03 14:26:06,425 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-03 14:26:06,429 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-03 14:26:06,431 - MoETrainer - INFO - Training selected expert models...
2025-06-03 14:26:06,434 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-03 14:26:06,436 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-03 14:26:06,441 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-03 14:26:06,445 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-03 14:26:06,450 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-03 14:26:06,453 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-03 14:26:06,454 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-03 14:26:06,482 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 14:26:06,483 - MoETrainer - INFO - Overall Performance:
2025-06-03 14:26:06,483 - MoETrainer - INFO -   RMSE: $112,653
2025-06-03 14:26:06,485 - MoETrainer - INFO -   MAE: $55,833 (10.4% of mean)
2025-06-03 14:26:06,485 - MoETrainer - INFO -   RÂ²: 0.8339
2025-06-03 14:26:06,486 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-03 14:26:06,486 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-03 14:26:06,486 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-03 14:26:06,487 - MoETrainer - INFO -   Within 5%: 38.4% of predictions
2025-06-03 14:26:06,487 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-03 14:26:06,488 - MoETrainer - INFO -   Within 15%: 87.0% of predictions
2025-06-03 14:26:06,488 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 14:26:06,490 - MoETrainer - INFO -   Bin 0: RMSE=$36,723, RÂ²=0.0753, Samples=178
2025-06-03 14:26:06,491 - MoETrainer - INFO -   Bin 1: RMSE=$21,618, RÂ²=-0.0197, Samples=195
2025-06-03 14:26:06,491 - MoETrainer - INFO -   Bin 2: RMSE=$20,938, RÂ²=0.0011, Samples=180
2025-06-03 14:26:06,491 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-03 14:26:06,492 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-03 14:26:06,492 - MoETrainer - INFO -   Bin 5: RMSE=$257,565, RÂ²=0.1328, Samples=197
2025-06-03 14:26:06,494 - MoETrainer - INFO -   6 bins: RÂ²=0.8339, RMSE=$112,653
2025-06-03 14:26:06,495 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-03 14:26:06,496 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-03 14:26:06,497 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 14:26:06,498 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 14:26:06,499 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 14:26:06,499 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 14:26:06,501 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-03 14:26:07,300 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-03 14:26:07,301 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-03 14:26:07,301 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-03 14:26:07,301 - MoETrainer - INFO -   3. lgb_conservative: Score=1.089, MAE=$27863, RMSE=$34373, RÂ²=0.027
2025-06-03 14:26:07,302 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-03 14:26:08,056 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-03 14:26:08,056 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-03 14:26:08,057 - MoETrainer - INFO -   2. lgb_conservative: Score=1.153, MAE=$19030, RMSE=$21891, RÂ²=-0.040
2025-06-03 14:26:08,057 - MoETrainer - INFO -   3. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-03 14:26:08,058 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-03 14:26:09,003 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-03 14:26:09,004 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-03 14:26:09,004 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-03 14:26:09,004 - MoETrainer - INFO -   3. lgb_conservative: Score=1.026, MAE=$18364, RMSE=$21040, RÂ²=0.034
2025-06-03 14:26:09,005 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-03 14:26:10,009 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-03 14:26:10,010 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-03 14:26:10,010 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-03 14:26:10,010 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-03 14:26:10,011 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-03 14:26:10,744 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-03 14:26:10,745 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-03 14:26:10,745 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-03 14:26:10,746 - MoETrainer - INFO -   3. lgb_conservative: Score=1.144, MAE=$41057, RMSE=$46819, RÂ²=-0.032
2025-06-03 14:26:10,746 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-03 14:26:11,688 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-03 14:26:11,689 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-03 14:26:11,689 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-03 14:26:11,689 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-03 14:26:11,690 - MoETrainer - INFO - Training selected expert models...
2025-06-03 14:26:11,692 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-03 14:26:11,694 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-03 14:26:11,696 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-03 14:26:11,700 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-03 14:26:11,702 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-03 14:26:11,706 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-03 14:26:11,707 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-03 14:26:11,728 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-03 14:26:11,729 - MoETrainer - INFO - Overall Performance:
2025-06-03 14:26:11,730 - MoETrainer - INFO -   RMSE: $112,653
2025-06-03 14:26:11,730 - MoETrainer - INFO -   MAE: $55,833 (10.4% of mean)
2025-06-03 14:26:11,732 - MoETrainer - INFO -   RÂ²: 0.8339
2025-06-03 14:26:11,732 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-03 14:26:11,733 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-03 14:26:11,733 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-03 14:26:11,733 - MoETrainer - INFO -   Within 5%: 38.4% of predictions
2025-06-03 14:26:11,734 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-03 14:26:11,734 - MoETrainer - INFO -   Within 15%: 87.0% of predictions
2025-06-03 14:26:11,735 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-03 14:26:11,735 - MoETrainer - INFO -   Bin 0: RMSE=$36,723, RÂ²=0.0753, Samples=178
2025-06-03 14:26:11,736 - MoETrainer - INFO -   Bin 1: RMSE=$21,618, RÂ²=-0.0197, Samples=195
2025-06-03 14:26:11,736 - MoETrainer - INFO -   Bin 2: RMSE=$20,938, RÂ²=0.0011, Samples=180
2025-06-03 14:26:11,740 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-03 14:26:11,741 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-03 14:26:11,742 - MoETrainer - INFO -   Bin 5: RMSE=$257,565, RÂ²=0.1328, Samples=197
2025-06-03 14:26:11,742 - MoETrainer - INFO - Final Expert Configuration:
2025-06-03 14:26:11,742 - MoETrainer - INFO -   Bin 0: ridge_medium
2025-06-03 14:26:11,743 - MoETrainer - INFO -   Bin 1: elastic_light
2025-06-03 14:26:11,743 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-03 14:26:11,743 - MoETrainer - INFO -   Bin 3: elastic_light
2025-06-03 14:26:11,743 - MoETrainer - INFO -   Bin 4: elastic_light
2025-06-03 14:26:11,744 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-06-03 14:26:11,744 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-03 14:26:11,744 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-03 14:26:11,745 - MoETrainer - INFO - Final Performance: RÂ² = 0.8339
2025-06-03 14:26:11,745 - MoETrainer - INFO - Final RMSE: $112,653
2025-06-03 14:26:11,745 - MoETrainer - INFO - Final MAE: $55,833
2025-06-03 14:38:01,956 - MoETrainer - INFO - Loading data...
2025-06-03 14:38:01,956 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-03 14:38:02,707 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-06-03 14:38:02,709 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-03 14:38:02,714 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-03 14:38:02,734 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-03 14:38:05,209 - MoETrainer - INFO - Consolidated to 13 features
2025-06-03 14:38:05,243 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-03 14:38:05,243 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-06-03 14:38:05,244 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-06-03 14:38:05,244 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-06-03 14:38:05,244 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-03 14:38:05,246 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-06-03 14:38:05,255 - MoETrainer - INFO - Applied robust scaling
2025-06-03 14:38:05,256 - MoETrainer - INFO - Splitting data...
2025-06-03 14:38:05,259 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-03 14:38:05,260 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-06-03 14:38:05,260 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-06-03 14:38:05,262 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 14:38:05,263 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 14:38:05,263 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 14:38:05,265 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 14:38:05,265 - MoETrainer - INFO - Bin 0: Large bin (1169), using CV selection
2025-06-03 14:38:09,014 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-03 14:38:09,015 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-06-03 14:38:09,015 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-06-03 14:38:09,016 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.155
2025-06-03 14:38:09,016 - MoETrainer - INFO - Bin 1: Large bin (1214), using CV selection
2025-06-03 14:38:12,581 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-03 14:38:12,582 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.143 [SELECTED]
2025-06-03 14:38:12,582 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.132
2025-06-03 14:38:12,582 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.126
2025-06-03 14:38:12,583 - MoETrainer - INFO - Bin 2: Large bin (1193), using CV selection
2025-06-03 14:38:16,390 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-03 14:38:16,390 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.302 [SELECTED]
2025-06-03 14:38:16,391 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.285
2025-06-03 14:38:16,391 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.285
2025-06-03 14:38:16,392 - MoETrainer - INFO - Training selected expert models...
2025-06-03 14:38:16,432 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-06-03 14:38:16,473 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-06-03 14:38:16,509 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-06-03 14:38:16,509 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-03 14:38:16,564 - MoETrainer - INFO - Training enhanced neural gate with simple strategy...
2025-06-03 14:38:16,571 - MoETrainer - INFO - Expert quality analysis:
2025-06-03 14:38:16,572 - MoETrainer - INFO -   Expert 0: RÂ² = -0.5219, RMSE = $339,096
2025-06-03 14:38:16,575 - MoETrainer - INFO -   Expert 1: RÂ² = 0.0098, RMSE = $273,520
2025-06-03 14:38:16,579 - MoETrainer - INFO -   Expert 2: RÂ² = -0.0236, RMSE = $278,090
2025-06-03 14:38:16,582 - MoETrainer - INFO - Equal weighting RÂ²: 0.2087
2025-06-03 14:38:16,582 - MoETrainer - INFO - Best individual expert RÂ²: 0.0098
2025-06-03 14:38:16,582 - MoETrainer - WARNING - â ï¸  Poor expert quality - consider using fewer bins or better experts
2025-06-03 14:38:21,802 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  247165, Val RMSE=$  258769, Temp=3.00
2025-06-03 14:38:21,803 - MoETrainer - INFO -          Expert weights: [0.334, 0.333, 0.334]
2025-06-03 14:38:21,804 - MoETrainer - INFO -          Expert confidence: [0.502, 0.500, 0.500]
2025-06-03 14:38:22,384 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  243918, Val RMSE=$  258249, Temp=2.67
2025-06-03 14:38:22,969 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  237128, Val RMSE=$  252077, Temp=2.33
2025-06-03 14:38:22,970 - MoETrainer - INFO -          Expert weights: [0.331, 0.327, 0.342]
2025-06-03 14:38:22,970 - MoETrainer - INFO -          Expert confidence: [0.507, 0.503, 0.513]
2025-06-03 14:38:23,550 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  227582, Val RMSE=$  239566, Temp=2.00
2025-06-03 14:38:24,118 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  217934, Val RMSE=$  230675, Temp=1.67
2025-06-03 14:38:24,118 - MoETrainer - INFO -          Expert weights: [0.326, 0.314, 0.360]
2025-06-03 14:38:24,118 - MoETrainer - INFO -          Expert confidence: [0.514, 0.505, 0.521]
2025-06-03 14:38:24,662 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  210735, Val RMSE=$  223819, Temp=1.33
2025-06-03 14:38:25,187 - MoETrainer - INFO - Loaded best model with validation RMSE: $217951
2025-06-03 14:38:25,195 - MoETrainer - INFO - Training enhanced neural gate with enhanced strategy...
2025-06-03 14:38:25,203 - MoETrainer - INFO - Expert quality analysis:
2025-06-03 14:38:25,206 - MoETrainer - INFO -   Expert 0: RÂ² = -0.5219, RMSE = $339,096
2025-06-03 14:38:25,208 - MoETrainer - INFO -   Expert 1: RÂ² = 0.0098, RMSE = $273,520
2025-06-03 14:38:25,210 - MoETrainer - INFO -   Expert 2: RÂ² = -0.0236, RMSE = $278,090
2025-06-03 14:38:25,211 - MoETrainer - INFO - Equal weighting RÂ²: 0.2087
2025-06-03 14:38:25,211 - MoETrainer - INFO - Best individual expert RÂ²: 0.0098
2025-06-03 14:38:25,212 - MoETrainer - WARNING - â ï¸  Poor expert quality - consider using fewer bins or better experts
2025-06-03 14:38:25,267 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  247240, Val RMSE=$  258770, Temp=3.00
2025-06-03 14:38:25,268 - MoETrainer - INFO -          Expert weights: [0.333, 0.333, 0.333]
2025-06-03 14:38:25,268 - MoETrainer - INFO -          Expert confidence: [0.500, 0.500, 0.500]
2025-06-03 14:38:26,144 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  246520, Val RMSE=$  258547, Temp=2.67
2025-06-03 14:38:27,011 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  242085, Val RMSE=$  255263, Temp=2.33
2025-06-03 14:38:27,012 - MoETrainer - INFO -          Expert weights: [0.334, 0.332, 0.334]
2025-06-03 14:38:27,012 - MoETrainer - INFO -          Expert confidence: [0.499, 0.500, 0.506]
2025-06-03 14:38:27,881 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  228376, Val RMSE=$  241246, Temp=2.00
2025-06-03 14:38:28,760 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  210940, Val RMSE=$  224842, Temp=1.67
2025-06-03 14:38:28,761 - MoETrainer - INFO -          Expert weights: [0.345, 0.326, 0.329]
2025-06-03 14:38:28,761 - MoETrainer - INFO -          Expert confidence: [0.504, 0.490, 0.511]
2025-06-03 14:38:29,647 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  198213, Val RMSE=$  213695, Temp=1.33
2025-06-03 14:38:30,491 - MoETrainer - INFO - Loaded best model with validation RMSE: $206662
2025-06-03 14:38:30,497 - MoETrainer - INFO - Training enhanced neural gate with ensemble strategy...
2025-06-03 14:38:30,504 - MoETrainer - INFO - Expert quality analysis:
2025-06-03 14:38:30,506 - MoETrainer - INFO -   Expert 0: RÂ² = -0.5219, RMSE = $339,096
2025-06-03 14:38:30,508 - MoETrainer - INFO -   Expert 1: RÂ² = 0.0098, RMSE = $273,520
2025-06-03 14:38:30,511 - MoETrainer - INFO -   Expert 2: RÂ² = -0.0236, RMSE = $278,090
2025-06-03 14:38:30,513 - MoETrainer - INFO - Equal weighting RÂ²: 0.2087
2025-06-03 14:38:30,513 - MoETrainer - INFO - Best individual expert RÂ²: 0.0098
2025-06-03 14:38:30,513 - MoETrainer - WARNING - â ï¸  Poor expert quality - consider using fewer bins or better experts
2025-06-03 14:38:30,513 - MoETrainer - INFO - Training ensemble of neural gates...
2025-06-03 14:38:30,514 - MoETrainer - INFO - Training gate 1/3...
2025-06-03 14:38:30,637 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  247215, Val RMSE=$  258769, Temp=3.00
2025-06-03 14:38:30,638 - MoETrainer - INFO -          Expert weights: [0.333, 0.333, 0.333]
2025-06-03 14:38:30,638 - MoETrainer - INFO -          Expert confidence: [0.500, 0.500, 0.500]
2025-06-03 14:38:31,540 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  245803, Val RMSE=$  258440, Temp=2.67
2025-06-03 14:38:32,465 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  237130, Val RMSE=$  252077, Temp=2.33
2025-06-03 14:38:32,466 - MoETrainer - INFO -          Expert weights: [0.330, 0.330, 0.341]
2025-06-03 14:38:32,467 - MoETrainer - INFO -          Expert confidence: [0.505, 0.499, 0.510]
2025-06-03 14:38:33,424 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  214466, Val RMSE=$  230204, Temp=2.00
2025-06-03 14:38:34,380 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  193349, Val RMSE=$  209461, Temp=1.67
2025-06-03 14:38:34,381 - MoETrainer - INFO -          Expert weights: [0.319, 0.303, 0.377]
2025-06-03 14:38:34,381 - MoETrainer - INFO -          Expert confidence: [0.517, 0.486, 0.526]
2025-06-03 14:38:35,300 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  183799, Val RMSE=$  199957, Temp=1.33
2025-06-03 14:38:36,122 - MoETrainer - INFO - Loaded best model with validation RMSE: $195427
2025-06-03 14:38:36,122 - MoETrainer - INFO - Training gate 2/3...
2025-06-03 14:38:36,158 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  247210, Val RMSE=$  258770, Temp=3.00
2025-06-03 14:38:36,158 - MoETrainer - INFO -          Expert weights: [0.334, 0.334, 0.332]
2025-06-03 14:38:36,160 - MoETrainer - INFO -          Expert confidence: [0.503, 0.497, 0.502]
2025-06-03 14:38:36,688 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  243591, Val RMSE=$  258306, Temp=2.67
2025-06-03 14:38:37,242 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  236865, Val RMSE=$  252263, Temp=2.33
2025-06-03 14:38:37,243 - MoETrainer - INFO -          Expert weights: [0.332, 0.331, 0.337]
2025-06-03 14:38:37,243 - MoETrainer - INFO -          Expert confidence: [0.507, 0.488, 0.518]
2025-06-03 14:38:37,818 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  227815, Val RMSE=$  239925, Temp=2.00
2025-06-03 14:38:38,412 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  219709, Val RMSE=$  231590, Temp=1.67
2025-06-03 14:38:38,412 - MoETrainer - INFO -          Expert weights: [0.330, 0.329, 0.342]
2025-06-03 14:38:38,413 - MoETrainer - INFO -          Expert confidence: [0.510, 0.475, 0.535]
2025-06-03 14:38:39,039 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  213465, Val RMSE=$  225718, Temp=1.33
2025-06-03 14:38:39,715 - MoETrainer - INFO - Loaded best model with validation RMSE: $220224
2025-06-03 14:38:39,715 - MoETrainer - INFO - Training gate 3/3...
2025-06-03 14:38:39,769 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  247223, Val RMSE=$  258770, Temp=3.00
2025-06-03 14:38:39,770 - MoETrainer - INFO -          Expert weights: [0.333, 0.333, 0.333]
2025-06-03 14:38:39,770 - MoETrainer - INFO -          Expert confidence: [0.500, 0.500, 0.500]
2025-06-03 14:38:40,688 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  246052, Val RMSE=$  258502, Temp=2.67
2025-06-03 14:38:41,577 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  239578, Val RMSE=$  253761, Temp=2.33
2025-06-03 14:38:41,580 - MoETrainer - INFO -          Expert weights: [0.333, 0.327, 0.339]
2025-06-03 14:38:41,581 - MoETrainer - INFO -          Expert confidence: [0.495, 0.505, 0.509]
2025-06-03 14:38:42,422 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  221656, Val RMSE=$  234990, Temp=2.00
2025-06-03 14:38:43,272 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  200663, Val RMSE=$  216167, Temp=1.67
2025-06-03 14:38:43,273 - MoETrainer - INFO -          Expert weights: [0.334, 0.299, 0.367]
2025-06-03 14:38:43,273 - MoETrainer - INFO -          Expert confidence: [0.484, 0.511, 0.521]
2025-06-03 14:38:44,123 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  188628, Val RMSE=$  205787, Temp=1.33
2025-06-03 14:38:44,944 - MoETrainer - INFO - Loaded best model with validation RMSE: $200523
2025-06-03 14:38:44,958 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 14:38:44,959 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 14:38:44,959 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 14:38:44,959 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 14:38:44,960 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-03 14:38:45,643 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-03 14:38:45,644 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-03 14:38:45,644 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-03 14:38:45,644 - MoETrainer - INFO -   3. lgb_conservative: Score=1.089, MAE=$27863, RMSE=$34373, RÂ²=0.027
2025-06-03 14:38:45,645 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-03 14:38:46,477 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-03 14:38:46,528 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-03 14:38:46,541 - MoETrainer - INFO -   2. lgb_conservative: Score=1.153, MAE=$19030, RMSE=$21891, RÂ²=-0.040
2025-06-03 14:38:46,581 - MoETrainer - INFO -   3. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-03 14:38:46,627 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-03 14:38:47,919 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-03 14:38:47,919 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-03 14:38:47,919 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-03 14:38:47,920 - MoETrainer - INFO -   3. lgb_conservative: Score=1.026, MAE=$18364, RMSE=$21040, RÂ²=0.034
2025-06-03 14:38:47,920 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-03 14:38:48,671 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-03 14:38:48,671 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-03 14:38:48,672 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-03 14:38:48,672 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-03 14:38:48,673 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-03 14:38:49,411 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-03 14:38:49,412 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-03 14:38:49,412 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-03 14:38:49,413 - MoETrainer - INFO -   3. lgb_conservative: Score=1.144, MAE=$41057, RMSE=$46819, RÂ²=-0.032
2025-06-03 14:38:49,413 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-03 14:38:50,172 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-03 14:38:50,172 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-03 14:38:50,172 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-03 14:38:50,173 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-03 14:38:50,173 - MoETrainer - INFO - Training selected expert models...
2025-06-03 14:38:50,175 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-03 14:38:50,177 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-03 14:38:50,180 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-03 14:38:50,182 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-03 14:38:50,184 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-03 14:38:50,187 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-03 14:38:50,188 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-03 14:38:50,198 - MoETrainer - INFO - Training enhanced neural gate with simple strategy...
2025-06-03 14:38:50,206 - MoETrainer - INFO - Expert quality analysis:
2025-06-03 14:38:50,208 - MoETrainer - INFO -   Expert 0: RÂ² = -0.7805, RMSE = $366,772
2025-06-03 14:38:50,210 - MoETrainer - INFO -   Expert 1: RÂ² = -0.4319, RMSE = $328,911
2025-06-03 14:38:50,212 - MoETrainer - INFO -   Expert 2: RÂ² = -0.0809, RMSE = $285,777
2025-06-03 14:38:50,213 - MoETrainer - INFO -   Expert 3: RÂ² = 0.0108, RMSE = $273,376
2025-06-03 14:38:50,215 - MoETrainer - INFO -   Expert 4: RÂ² = -0.0284, RMSE = $278,749
2025-06-03 14:38:50,217 - MoETrainer - INFO -   Expert 5: RÂ² = -0.9238, RMSE = $381,249
2025-06-03 14:38:50,219 - MoETrainer - INFO - Equal weighting RÂ²: 0.1437
2025-06-03 14:38:50,219 - MoETrainer - INFO - Best individual expert RÂ²: 0.0108
2025-06-03 14:38:50,220 - MoETrainer - WARNING - â ï¸  Poor expert quality - consider using fewer bins or better experts
2025-06-03 14:38:50,259 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  256515, Val RMSE=$  264024, Temp=3.00
2025-06-03 14:38:50,259 - MoETrainer - INFO -          Expert weights: [0.167, 0.167, 0.167, 0.167, 0.167, 0.166]
2025-06-03 14:38:50,260 - MoETrainer - INFO -          Expert confidence: [0.500, 0.498, 0.500, 0.500, 0.499, 0.501]
2025-06-03 14:38:50,821 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  254359, Val RMSE=$  263644, Temp=2.67
2025-06-03 14:38:51,387 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  249735, Val RMSE=$  259228, Temp=2.33
2025-06-03 14:38:51,388 - MoETrainer - INFO -          Expert weights: [0.169, 0.167, 0.167, 0.164, 0.167, 0.167]
2025-06-03 14:38:51,388 - MoETrainer - INFO -          Expert confidence: [0.490, 0.485, 0.492, 0.502, 0.510, 0.518]
2025-06-03 14:38:51,947 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  243169, Val RMSE=$  249777, Temp=2.00
2025-06-03 14:38:52,591 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  236930, Val RMSE=$  241916, Temp=1.67
2025-06-03 14:38:52,591 - MoETrainer - INFO -          Expert weights: [0.175, 0.170, 0.167, 0.154, 0.166, 0.168]
2025-06-03 14:38:52,592 - MoETrainer - INFO -          Expert confidence: [0.482, 0.473, 0.484, 0.498, 0.521, 0.533]
2025-06-03 14:38:53,234 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  231525, Val RMSE=$  235956, Temp=1.33
2025-06-03 14:38:53,787 - MoETrainer - INFO - Loaded best model with validation RMSE: $230343
2025-06-03 14:38:53,796 - MoETrainer - INFO - Training enhanced neural gate with enhanced strategy...
2025-06-03 14:38:53,802 - MoETrainer - INFO - Expert quality analysis:
2025-06-03 14:38:53,804 - MoETrainer - INFO -   Expert 0: RÂ² = -0.7805, RMSE = $366,772
2025-06-03 14:38:53,807 - MoETrainer - INFO -   Expert 1: RÂ² = -0.4319, RMSE = $328,911
2025-06-03 14:38:53,808 - MoETrainer - INFO -   Expert 2: RÂ² = -0.0809, RMSE = $285,777
2025-06-03 14:38:53,811 - MoETrainer - INFO -   Expert 3: RÂ² = 0.0108, RMSE = $273,376
2025-06-03 14:38:53,814 - MoETrainer - INFO -   Expert 4: RÂ² = -0.0284, RMSE = $278,749
2025-06-03 14:38:53,815 - MoETrainer - INFO -   Expert 5: RÂ² = -0.9238, RMSE = $381,249
2025-06-03 14:38:53,816 - MoETrainer - INFO - Equal weighting RÂ²: 0.1437
2025-06-03 14:38:53,817 - MoETrainer - INFO - Best individual expert RÂ²: 0.0108
2025-06-03 14:38:53,817 - MoETrainer - WARNING - â ï¸  Poor expert quality - consider using fewer bins or better experts
2025-06-03 14:38:53,863 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  256548, Val RMSE=$  264024, Temp=3.00
2025-06-03 14:38:53,863 - MoETrainer - INFO -          Expert weights: [0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
2025-06-03 14:38:53,864 - MoETrainer - INFO -          Expert confidence: [0.500, 0.500, 0.500, 0.500, 0.500, 0.500]
2025-06-03 14:38:54,817 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  255833, Val RMSE=$  263835, Temp=2.67
2025-06-03 14:38:55,720 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  250919, Val RMSE=$  259829, Temp=2.33
2025-06-03 14:38:55,720 - MoETrainer - INFO -          Expert weights: [0.169, 0.168, 0.168, 0.165, 0.165, 0.166]
2025-06-03 14:38:55,721 - MoETrainer - INFO -          Expert confidence: [0.494, 0.493, 0.501, 0.498, 0.504, 0.522]
2025-06-03 14:38:56,594 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  237689, Val RMSE=$  243864, Temp=2.00
2025-06-03 14:38:57,490 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  220384, Val RMSE=$  224550, Temp=1.67
2025-06-03 14:38:57,491 - MoETrainer - INFO -          Expert weights: [0.186, 0.177, 0.177, 0.144, 0.151, 0.165]
2025-06-03 14:38:57,492 - MoETrainer - INFO -          Expert confidence: [0.473, 0.466, 0.473, 0.473, 0.524, 0.568]
2025-06-03 14:38:58,389 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  206486, Val RMSE=$  211042, Temp=1.33
2025-06-03 14:38:59,244 - MoETrainer - INFO - Loaded best model with validation RMSE: $200872
2025-06-03 14:38:59,251 - MoETrainer - INFO - Training enhanced neural gate with ensemble strategy...
2025-06-03 14:38:59,256 - MoETrainer - INFO - Expert quality analysis:
2025-06-03 14:38:59,258 - MoETrainer - INFO -   Expert 0: RÂ² = -0.7805, RMSE = $366,772
2025-06-03 14:38:59,261 - MoETrainer - INFO -   Expert 1: RÂ² = -0.4319, RMSE = $328,911
2025-06-03 14:38:59,263 - MoETrainer - INFO -   Expert 2: RÂ² = -0.0809, RMSE = $285,777
2025-06-03 14:38:59,265 - MoETrainer - INFO -   Expert 3: RÂ² = 0.0108, RMSE = $273,376
2025-06-03 14:38:59,270 - MoETrainer - INFO -   Expert 4: RÂ² = -0.0284, RMSE = $278,749
2025-06-03 14:38:59,271 - MoETrainer - INFO -   Expert 5: RÂ² = -0.9238, RMSE = $381,249
2025-06-03 14:38:59,272 - MoETrainer - INFO - Equal weighting RÂ²: 0.1437
2025-06-03 14:38:59,273 - MoETrainer - INFO - Best individual expert RÂ²: 0.0108
2025-06-03 14:38:59,273 - MoETrainer - WARNING - â ï¸  Poor expert quality - consider using fewer bins or better experts
2025-06-03 14:38:59,274 - MoETrainer - INFO - Training ensemble of neural gates...
2025-06-03 14:38:59,274 - MoETrainer - INFO - Training gate 1/3...
2025-06-03 14:38:59,325 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  256546, Val RMSE=$  264024, Temp=3.00
2025-06-03 14:38:59,325 - MoETrainer - INFO -          Expert weights: [0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
2025-06-03 14:38:59,325 - MoETrainer - INFO -          Expert confidence: [0.500, 0.500, 0.500, 0.500, 0.500, 0.500]
2025-06-03 14:39:00,238 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  255673, Val RMSE=$  263770, Temp=2.67
2025-06-03 14:39:01,129 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  250588, Val RMSE=$  258946, Temp=2.33
2025-06-03 14:39:01,130 - MoETrainer - INFO -          Expert weights: [0.167, 0.167, 0.166, 0.164, 0.167, 0.170]
2025-06-03 14:39:01,130 - MoETrainer - INFO -          Expert confidence: [0.491, 0.490, 0.508, 0.502, 0.510, 0.518]
2025-06-03 14:39:02,021 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  236153, Val RMSE=$  241639, Temp=2.00
2025-06-03 14:39:02,908 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  217045, Val RMSE=$  220900, Temp=1.67
2025-06-03 14:39:02,908 - MoETrainer - INFO -          Expert weights: [0.173, 0.169, 0.165, 0.140, 0.162, 0.190]
2025-06-03 14:39:02,909 - MoETrainer - INFO -          Expert confidence: [0.470, 0.470, 0.514, 0.485, 0.542, 0.555]
2025-06-03 14:39:03,793 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  203756, Val RMSE=$  206682, Temp=1.33
2025-06-03 14:39:05,407 - MoETrainer - INFO - Loaded best model with validation RMSE: $197563
2025-06-03 14:39:05,407 - MoETrainer - INFO - Training gate 2/3...
2025-06-03 14:39:05,438 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  256606, Val RMSE=$  264024, Temp=3.00
2025-06-03 14:39:05,439 - MoETrainer - INFO -          Expert weights: [0.167, 0.167, 0.167, 0.167, 0.166, 0.167]
2025-06-03 14:39:05,440 - MoETrainer - INFO -          Expert confidence: [0.501, 0.503, 0.501, 0.501, 0.500, 0.500]
2025-06-03 14:39:06,007 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  254854, Val RMSE=$  263758, Temp=2.67
2025-06-03 14:39:06,574 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  250421, Val RMSE=$  259713, Temp=2.33
2025-06-03 14:39:06,575 - MoETrainer - INFO -          Expert weights: [0.166, 0.167, 0.165, 0.165, 0.164, 0.172]
2025-06-03 14:39:06,576 - MoETrainer - INFO -          Expert confidence: [0.500, 0.510, 0.508, 0.506, 0.508, 0.509]
2025-06-03 14:39:07,129 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  242983, Val RMSE=$  248634, Temp=2.00
2025-06-03 14:39:07,686 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  234437, Val RMSE=$  238368, Temp=1.67
2025-06-03 14:39:07,687 - MoETrainer - INFO -          Expert weights: [0.164, 0.165, 0.163, 0.159, 0.160, 0.188]
2025-06-03 14:39:07,688 - MoETrainer - INFO -          Expert confidence: [0.504, 0.519, 0.514, 0.510, 0.513, 0.514]
2025-06-03 14:39:08,252 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  227679, Val RMSE=$  230937, Temp=1.33
2025-06-03 14:39:08,817 - MoETrainer - INFO - Loaded best model with validation RMSE: $223552
2025-06-03 14:39:08,818 - MoETrainer - INFO - Training gate 3/3...
2025-06-03 14:39:08,866 - MoETrainer - INFO - Epoch   0: Pred RMSE=$  256546, Val RMSE=$  264025, Temp=3.00
2025-06-03 14:39:08,867 - MoETrainer - INFO -          Expert weights: [0.167, 0.167, 0.167, 0.167, 0.167, 0.167]
2025-06-03 14:39:08,867 - MoETrainer - INFO -          Expert confidence: [0.500, 0.500, 0.500, 0.500, 0.500, 0.500]
2025-06-03 14:39:09,875 - MoETrainer - INFO - Epoch  25: Pred RMSE=$  255825, Val RMSE=$  263820, Temp=2.67
2025-06-03 14:39:10,760 - MoETrainer - INFO - Epoch  50: Pred RMSE=$  251080, Val RMSE=$  259649, Temp=2.33
2025-06-03 14:39:10,761 - MoETrainer - INFO -          Expert weights: [0.168, 0.166, 0.167, 0.164, 0.166, 0.169]
2025-06-03 14:39:10,761 - MoETrainer - INFO -          Expert confidence: [0.490, 0.478, 0.500, 0.496, 0.513, 0.518]
2025-06-03 14:39:11,647 - MoETrainer - INFO - Epoch  75: Pred RMSE=$  236489, Val RMSE=$  243035, Temp=2.00
2025-06-03 14:39:12,516 - MoETrainer - INFO - Epoch 100: Pred RMSE=$  219531, Val RMSE=$  223672, Temp=1.67
2025-06-03 14:39:12,517 - MoETrainer - INFO -          Expert weights: [0.181, 0.164, 0.171, 0.144, 0.159, 0.180]
2025-06-03 14:39:12,517 - MoETrainer - INFO -          Expert confidence: [0.453, 0.417, 0.465, 0.458, 0.562, 0.568]
2025-06-03 14:39:13,410 - MoETrainer - INFO - Epoch 125: Pred RMSE=$  207509, Val RMSE=$  210631, Temp=1.33
2025-06-03 14:39:14,265 - MoETrainer - INFO - Loaded best model with validation RMSE: $201450
2025-06-03 16:38:14,218 - MoETrainer - INFO - Loading data...
2025-06-03 16:38:14,218 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-03 16:38:14,947 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-06-03 16:38:14,949 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-03 16:38:14,953 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-03 16:38:14,976 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-03 16:38:17,589 - MoETrainer - INFO - Consolidated to 13 features
2025-06-03 16:38:17,617 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-03 16:38:17,617 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-06-03 16:38:17,619 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-06-03 16:38:17,620 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-06-03 16:38:17,620 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-03 16:38:17,622 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-06-03 16:38:17,630 - MoETrainer - INFO - Applied robust scaling
2025-06-03 16:38:17,630 - MoETrainer - INFO - Splitting data...
2025-06-03 16:38:17,633 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-03 16:38:17,634 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-06-03 16:38:17,634 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-06-03 16:38:17,637 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-03 16:38:17,638 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-03 16:38:17,638 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-03 16:38:17,639 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-03 16:38:17,639 - MoETrainer - INFO - Bin 0: Large bin (1169), using CV selection
2025-06-03 16:38:21,445 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-03 16:38:21,445 - MoETrainer - INFO -   1. lgb_conservative: MSE=2052613420Â±78511045, RÂ²=0.168 [SELECTED]
2025-06-03 16:38:21,446 - MoETrainer - INFO -   2. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165
2025-06-03 16:38:21,446 - MoETrainer - INFO -   3. lgb_balanced: MSE=2085422408Â±78930143, RÂ²=0.155
2025-06-03 16:38:21,447 - MoETrainer - INFO - Bin 1: Large bin (1214), using CV selection
2025-06-03 16:38:25,173 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-03 16:38:25,173 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.143 [SELECTED]
2025-06-03 16:38:25,173 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.132
2025-06-03 16:38:25,174 - MoETrainer - INFO -   3. lgb_conservative: MSE=2111598641Â±79729867, RÂ²=0.126
2025-06-03 16:38:25,175 - MoETrainer - INFO - Bin 2: Large bin (1193), using CV selection
2025-06-03 16:38:28,953 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-03 16:38:28,954 - MoETrainer - INFO -   1. lgb_conservative: MSE=52469162444Â±6454959610, RÂ²=0.302 [SELECTED]
2025-06-03 16:38:28,954 - MoETrainer - INFO -   2. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.285
2025-06-03 16:38:28,954 - MoETrainer - INFO -   3. ridge_medium: MSE=53753954304Â±6834471535, RÂ²=0.285
2025-06-03 16:38:28,955 - MoETrainer - INFO - Training selected expert models...
2025-06-03 16:38:28,990 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 0: 1169 samples
2025-06-03 16:38:29,035 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-06-03 16:38:29,070 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 2: 1193 samples
2025-06-03 16:38:29,070 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-03 16:38:29,077 - MoETrainer - INFO - Training perfect routing neural gate...
2025-06-03 16:38:29,078 - MoETrainer - INFO - Goal: Learn features â bin assignment (mimic hard routing)
2025-06-03 16:38:29,082 - MoETrainer - INFO - Routing target analysis:
2025-06-03 16:38:29,082 - MoETrainer - INFO -   Bin boundaries: ['$395,000', '$560,000']
2025-06-03 16:38:29,083 - MoETrainer - INFO -   Train bin distribution: [np.int64(1169), np.int64(1214), np.int64(1193)]
2025-06-03 16:38:29,084 - MoETrainer - INFO -   Val bin distribution: [np.int64(269), np.int64(282), np.int64(275)]
2025-06-03 16:38:32,237 - MoETrainer - INFO - Epoch   0: Loss=1.0991, Bin Acc=0.356, RÂ²=0.1176, Temp=2.00
2025-06-03 16:38:32,237 - MoETrainer - INFO -          Predicted bin counts: [np.int64(0), np.int64(810), np.int64(16)]
2025-06-03 16:38:32,817 - MoETrainer - INFO - Epoch  25: Loss=1.0097, Bin Acc=0.607, RÂ²=0.5037, Temp=1.75
2025-06-03 16:38:33,310 - MoETrainer - INFO - Early stopping at epoch 46
2025-06-03 16:38:33,310 - MoETrainer - INFO - Loaded best model: Bin Acc=0.575, RÂ²=0.5358
2025-06-04 19:00:36,122 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 19:00:36,124 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 19:00:36,124 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 19:00:36,848 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-06-04 19:00:36,853 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-04 19:00:36,864 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-04 19:00:36,894 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-04 19:00:39,889 - MoETrainer - INFO - Consolidated to 13 features
2025-06-04 19:00:39,925 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-04 19:00:39,927 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-06-04 19:00:39,927 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-06-04 19:00:39,927 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-06-04 19:00:39,927 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 19:00:39,930 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-06-04 19:00:39,939 - MoETrainer - INFO - Applied robust scaling
2025-06-04 19:00:39,939 - MoETrainer - INFO - Splitting data...
2025-06-04 19:00:39,947 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-04 19:00:39,947 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-06-04 19:00:39,947 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-06-04 19:00:39,947 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 19:00:39,950 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:00:39,951 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:00:39,951 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:00:39,951 - MoETrainer - INFO - Bin 0: Large bin (1169), using CV selection
2025-06-04 19:00:43,192 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:00:43,192 - MoETrainer - INFO -   1. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165 [SELECTED]
2025-06-04 19:00:43,193 - MoETrainer - INFO -   2. rf_shallow: MSE=2098259114Â±77220782, RÂ²=0.149
2025-06-04 19:00:43,193 - MoETrainer - INFO -   3. xgb_balanced: MSE=2125685632Â±27137187, RÂ²=0.138
2025-06-04 19:00:43,194 - MoETrainer - INFO - Bin 1: Large bin (1214), using CV selection
2025-06-04 19:00:46,390 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:00:46,391 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.143 [SELECTED]
2025-06-04 19:00:46,391 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.132
2025-06-04 19:00:46,391 - MoETrainer - INFO -   3. rf_medium: MSE=2112637858Â±65581900, RÂ²=0.126
2025-06-04 19:00:46,392 - MoETrainer - INFO - Bin 2: Large bin (1193), using CV selection
2025-06-04 19:00:50,045 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:00:50,047 - MoETrainer - INFO -   1. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.285 [SELECTED]
2025-06-04 19:00:50,047 - MoETrainer - INFO -   2. ridge_medium: MSE=53753943381Â±6834487807, RÂ²=0.285
2025-06-04 19:00:50,048 - MoETrainer - INFO -   3. ridge_light: MSE=53765068117Â±6752244532, RÂ²=0.284
2025-06-04 19:00:50,048 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:00:50,095 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1169 samples
2025-06-04 19:00:50,143 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-06-04 19:00:50,194 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1193 samples
2025-06-04 19:00:50,195 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 19:00:50,212 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:00:50,213 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:00:50,213 - MoETrainer - INFO -   RMSE: $140,440
2025-06-04 19:00:50,213 - MoETrainer - INFO -   MAE: $82,346 (15.3% of mean)
2025-06-04 19:00:50,214 - MoETrainer - INFO -   RÂ²: 0.7419
2025-06-04 19:00:50,214 - MoETrainer - INFO -   MAPE: 14.1%
2025-06-04 19:00:50,214 - MoETrainer - INFO -   MPE: +3.4% (bias: overprediction)
2025-06-04 19:00:50,215 - MoETrainer - INFO -   Median APE: 10.7%
2025-06-04 19:00:50,215 - MoETrainer - INFO -   Within 5%: 24.3% of predictions
2025-06-04 19:00:50,215 - MoETrainer - INFO -   Within 10%: 47.2% of predictions
2025-06-04 19:00:50,215 - MoETrainer - INFO -   Within 15%: 67.3% of predictions
2025-06-04 19:00:50,217 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:00:50,217 - MoETrainer - INFO -   Bin 0: RMSE=$50,501, RÂ²=0.1896, Samples=373
2025-06-04 19:00:50,218 - MoETrainer - INFO -   Bin 1: RMSE=$43,956, RÂ²=0.1187, Samples=359
2025-06-04 19:00:50,218 - MoETrainer - INFO -   Bin 2: RMSE=$233,220, RÂ²=0.3078, Samples=369
2025-06-04 19:00:50,219 - MoETrainer - INFO -   3 bins: RÂ²=0.7419, RMSE=$140,440
2025-06-04 19:00:50,220 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:00:50,220 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:00:50,221 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:00:50,221 - MoETrainer - INFO - Bin 0: Large bin (886), using CV selection
2025-06-04 19:00:53,077 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:00:53,077 - MoETrainer - INFO -   1. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.135 [SELECTED]
2025-06-04 19:00:53,077 - MoETrainer - INFO -   2. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.129
2025-06-04 19:00:53,077 - MoETrainer - INFO -   3. rf_medium: MSE=1600502834Â±101161837, RÂ²=0.114
2025-06-04 19:00:53,082 - MoETrainer - INFO - Bin 1: Large bin (898), using CV selection
2025-06-04 19:00:55,876 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:00:55,877 - MoETrainer - INFO -   1. ridge_heavy: MSE=760152363Â±41859609, RÂ²=0.059 [SELECTED]
2025-06-04 19:00:55,877 - MoETrainer - INFO -   2. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-06-04 19:00:55,878 - MoETrainer - INFO -   3. elastic_light: MSE=767669035Â±40384572, RÂ²=0.050
2025-06-04 19:00:55,878 - MoETrainer - INFO - Bin 2: Large bin (875), using CV selection
2025-06-04 19:00:58,642 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:00:58,643 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.034 [SELECTED]
2025-06-04 19:00:58,644 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.025
2025-06-04 19:00:58,644 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.021
2025-06-04 19:00:58,645 - MoETrainer - INFO - Bin 3: Large bin (917), using CV selection
2025-06-04 19:01:01,789 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:01:01,789 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120898048Â±5601852790, RÂ²=0.233 [SELECTED]
2025-06-04 19:01:01,789 - MoETrainer - INFO -   2. ridge_medium: MSE=59261804544Â±5215540885, RÂ²=0.231
2025-06-04 19:01:01,789 - MoETrainer - INFO -   3. elastic_light: MSE=59424127659Â±5623519271, RÂ²=0.229
2025-06-04 19:01:01,789 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:01:01,834 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 886 samples
2025-06-04 19:01:01,838 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 1: 898 samples
2025-06-04 19:01:02,072 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-06-04 19:01:02,072 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-06-04 19:01:02,072 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 19:01:02,105 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:01:02,105 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:01:02,105 - MoETrainer - INFO -   RMSE: $131,724
2025-06-04 19:01:02,105 - MoETrainer - INFO -   MAE: $71,092 (13.2% of mean)
2025-06-04 19:01:02,107 - MoETrainer - INFO -   RÂ²: 0.7729
2025-06-04 19:01:02,107 - MoETrainer - INFO -   MAPE: 11.6%
2025-06-04 19:01:02,107 - MoETrainer - INFO -   MPE: +3.2% (bias: overprediction)
2025-06-04 19:01:02,107 - MoETrainer - INFO -   Median APE: 8.3%
2025-06-04 19:01:02,108 - MoETrainer - INFO -   Within 5%: 29.8% of predictions
2025-06-04 19:01:02,108 - MoETrainer - INFO -   Within 10%: 61.2% of predictions
2025-06-04 19:01:02,108 - MoETrainer - INFO -   Within 15%: 77.6% of predictions
2025-06-04 19:01:02,108 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:01:02,108 - MoETrainer - INFO -   Bin 0: RMSE=$44,072, RÂ²=0.1371, Samples=272
2025-06-04 19:01:02,108 - MoETrainer - INFO -   Bin 1: RMSE=$28,098, RÂ²=0.0469, Samples=281
2025-06-04 19:01:02,108 - MoETrainer - INFO -   Bin 2: RMSE=$40,906, RÂ²=0.1414, Samples=253
2025-06-04 19:01:02,108 - MoETrainer - INFO -   Bin 3: RMSE=$246,537, RÂ²=0.2252, Samples=295
2025-06-04 19:01:02,111 - MoETrainer - INFO -   4 bins: RÂ²=0.7729, RMSE=$131,724
2025-06-04 19:01:02,112 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:01:02,114 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:01:02,114 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:01:02,114 - MoETrainer - INFO - Bin 0: Small bin (701), using rule-based selection
2025-06-04 19:01:02,931 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:01:02,932 - MoETrainer - INFO -   1. xgb_conservative: Score=1.044, MAE=$28337, RMSE=$35417, RÂ²=0.108 [SELECTED]
2025-06-04 19:01:02,932 - MoETrainer - INFO -   2. rf_medium: Score=1.046, MAE=$27958, RMSE=$35537, RÂ²=0.102
2025-06-04 19:01:02,933 - MoETrainer - INFO -   3. rf_shallow: Score=1.047, MAE=$28072, RMSE=$35576, RÂ²=0.100
2025-06-04 19:01:02,934 - MoETrainer - INFO - Bin 1: Small bin (722), using rule-based selection
2025-06-04 19:01:03,776 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:01:03,777 - MoETrainer - INFO -   1. elastic_light: Score=1.083, MAE=$18234, RMSE=$21576, RÂ²=-0.014 [SELECTED]
2025-06-04 19:01:03,777 - MoETrainer - INFO -   2. xgb_conservative: Score=1.119, MAE=$18435, RMSE=$21728, RÂ²=-0.028
2025-06-04 19:01:03,778 - MoETrainer - INFO -   3. rf_shallow: Score=1.120, MAE=$18519, RMSE=$21732, RÂ²=-0.029
2025-06-04 19:01:03,778 - MoETrainer - INFO - Bin 2: Small bin (721), using rule-based selection
2025-06-04 19:01:04,624 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:01:04,627 - MoETrainer - INFO -   1. xgb_conservative: Score=1.085, MAE=$23821, RMSE=$27822, RÂ²=-0.013 [SELECTED]
2025-06-04 19:01:04,627 - MoETrainer - INFO -   2. elastic_light: Score=1.138, MAE=$24842, RMSE=$28103, RÂ²=-0.034
2025-06-04 19:01:04,627 - MoETrainer - INFO -   3. rf_shallow: Score=1.161, MAE=$24148, RMSE=$28238, RÂ²=-0.044
2025-06-04 19:01:04,628 - MoETrainer - INFO - Bin 3: Small bin (708), using rule-based selection
2025-06-04 19:01:05,533 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:01:05,533 - MoETrainer - INFO -   1. rf_shallow: Score=1.062, MAE=$39877, RMSE=$47457, RÂ²=0.013 [SELECTED]
2025-06-04 19:01:05,535 - MoETrainer - INFO -   2. elastic_light: Score=1.063, MAE=$40758, RMSE=$47446, RÂ²=0.013
2025-06-04 19:01:05,535 - MoETrainer - INFO -   3. ridge_medium: Score=1.069, MAE=$40736, RMSE=$47721, RÂ²=0.002
2025-06-04 19:01:05,536 - MoETrainer - INFO - Bin 4: Small bin (724), using rule-based selection
2025-06-04 19:01:06,414 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:01:06,415 - MoETrainer - INFO -   1. xgb_conservative: Score=1.108, MAE=$197372, RMSE=$267697, RÂ²=0.188 [SELECTED]
2025-06-04 19:01:06,415 - MoETrainer - INFO -   2. ridge_medium: Score=1.122, MAE=$192641, RMSE=$273250, RÂ²=0.154
2025-06-04 19:01:06,417 - MoETrainer - INFO -   3. elastic_light: Score=1.127, MAE=$194859, RMSE=$274024, RÂ²=0.149
2025-06-04 19:01:06,417 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:01:06,453 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-06-04 19:01:06,457 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-06-04 19:01:06,499 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 721 samples
2025-06-04 19:01:06,711 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 708 samples
2025-06-04 19:01:06,760 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 724 samples
2025-06-04 19:01:06,761 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 19:01:06,793 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:01:06,794 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:01:06,794 - MoETrainer - INFO -   RMSE: $117,507
2025-06-04 19:01:06,794 - MoETrainer - INFO -   MAE: $59,539 (11.1% of mean)
2025-06-04 19:01:06,796 - MoETrainer - INFO -   RÂ²: 0.8193
2025-06-04 19:01:06,796 - MoETrainer - INFO -   MAPE: 9.5%
2025-06-04 19:01:06,796 - MoETrainer - INFO -   MPE: +1.8% (bias: overprediction)
2025-06-04 19:01:06,797 - MoETrainer - INFO -   Median APE: 6.5%
2025-06-04 19:01:06,797 - MoETrainer - INFO -   Within 5%: 39.1% of predictions
2025-06-04 19:01:06,798 - MoETrainer - INFO -   Within 10%: 70.8% of predictions
2025-06-04 19:01:06,798 - MoETrainer - INFO -   Within 15%: 82.7% of predictions
2025-06-04 19:01:06,798 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:01:06,799 - MoETrainer - INFO -   Bin 0: RMSE=$40,646, RÂ²=0.0942, Samples=223
2025-06-04 19:01:06,799 - MoETrainer - INFO -   Bin 1: RMSE=$19,774, RÂ²=0.0186, Samples=215
2025-06-04 19:01:06,800 - MoETrainer - INFO -   Bin 2: RMSE=$27,637, RÂ²=-0.0493, Samples=233
2025-06-04 19:01:06,801 - MoETrainer - INFO -   Bin 3: RMSE=$45,726, RÂ²=0.0423, Samples=201
2025-06-04 19:01:06,801 - MoETrainer - INFO -   Bin 4: RMSE=$248,593, RÂ²=0.2083, Samples=229
2025-06-04 19:01:06,802 - MoETrainer - INFO -   5 bins: RÂ²=0.8193, RMSE=$117,507
2025-06-04 19:01:06,803 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:01:06,803 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:01:06,804 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:01:06,804 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-04 19:01:07,516 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:01:07,516 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-04 19:01:07,517 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-04 19:01:07,518 - MoETrainer - INFO -   3. rf_shallow: Score=1.111, MAE=$28218, RMSE=$34894, RÂ²=-0.003
2025-06-04 19:01:07,518 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-04 19:01:08,283 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:01:08,284 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-04 19:01:08,284 - MoETrainer - INFO -   2. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-04 19:01:08,284 - MoETrainer - INFO -   3. rf_shallow: Score=1.245, MAE=$19392, RMSE=$22275, RÂ²=-0.077
2025-06-04 19:01:08,284 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-04 19:01:09,054 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:01:09,054 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-04 19:01:09,054 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-04 19:01:09,054 - MoETrainer - INFO -   3. elastic_light: Score=1.026, MAE=$18400, RMSE=$21045, RÂ²=0.034
2025-06-04 19:01:09,056 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-04 19:01:09,876 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:01:09,876 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-04 19:01:09,876 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-04 19:01:09,876 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-04 19:01:09,876 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-04 19:01:10,689 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:01:10,689 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-04 19:01:10,690 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-04 19:01:10,690 - MoETrainer - INFO -   3. rf_shallow: Score=1.146, MAE=$41056, RMSE=$46831, RÂ²=-0.032
2025-06-04 19:01:10,691 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-04 19:01:11,574 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:01:11,575 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-04 19:01:11,575 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-04 19:01:11,575 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-04 19:01:11,576 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:01:11,578 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-04 19:01:11,580 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-04 19:01:11,582 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-04 19:01:11,586 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-04 19:01:11,589 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-04 19:01:11,592 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-04 19:01:11,593 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:01:11,611 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:01:11,612 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:01:11,612 - MoETrainer - INFO -   RMSE: $112,653
2025-06-04 19:01:11,613 - MoETrainer - INFO -   MAE: $55,833 (10.4% of mean)
2025-06-04 19:01:11,613 - MoETrainer - INFO -   RÂ²: 0.8339
2025-06-04 19:01:11,613 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-04 19:01:11,613 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-04 19:01:11,614 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-04 19:01:11,614 - MoETrainer - INFO -   Within 5%: 38.4% of predictions
2025-06-04 19:01:11,614 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-04 19:01:11,615 - MoETrainer - INFO -   Within 15%: 87.0% of predictions
2025-06-04 19:01:11,615 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:01:11,615 - MoETrainer - INFO -   Bin 0: RMSE=$36,723, RÂ²=0.0753, Samples=178
2025-06-04 19:01:11,616 - MoETrainer - INFO -   Bin 1: RMSE=$21,618, RÂ²=-0.0197, Samples=195
2025-06-04 19:01:11,616 - MoETrainer - INFO -   Bin 2: RMSE=$20,938, RÂ²=0.0011, Samples=180
2025-06-04 19:01:11,617 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-04 19:01:11,617 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-04 19:01:11,618 - MoETrainer - INFO -   Bin 5: RMSE=$257,565, RÂ²=0.1328, Samples=197
2025-06-04 19:01:11,620 - MoETrainer - INFO -   6 bins: RÂ²=0.8339, RMSE=$112,653
2025-06-04 19:01:11,620 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 19:01:11,621 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 19:01:11,622 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:01:11,622 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:01:11,622 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:01:11,623 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-04 19:01:12,316 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:01:12,316 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-04 19:01:12,316 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-04 19:01:12,316 - MoETrainer - INFO -   3. rf_shallow: Score=1.111, MAE=$28218, RMSE=$34894, RÂ²=-0.003
2025-06-04 19:01:12,331 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-04 19:01:13,091 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:01:13,091 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-04 19:01:13,091 - MoETrainer - INFO -   2. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-04 19:01:13,091 - MoETrainer - INFO -   3. rf_shallow: Score=1.245, MAE=$19392, RMSE=$22275, RÂ²=-0.077
2025-06-04 19:01:13,093 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-04 19:01:13,830 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:01:13,830 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-04 19:01:13,830 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-04 19:01:13,830 - MoETrainer - INFO -   3. elastic_light: Score=1.026, MAE=$18400, RMSE=$21045, RÂ²=0.034
2025-06-04 19:01:13,830 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-04 19:01:14,613 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:01:14,613 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-04 19:01:14,614 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-04 19:01:14,614 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-04 19:01:14,615 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-04 19:01:15,384 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:01:15,384 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-04 19:01:15,385 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-04 19:01:15,385 - MoETrainer - INFO -   3. rf_shallow: Score=1.146, MAE=$41056, RMSE=$46831, RÂ²=-0.032
2025-06-04 19:01:15,386 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-04 19:01:16,182 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:01:16,182 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-04 19:01:16,182 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-04 19:01:16,183 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-04 19:01:16,183 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:01:16,185 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-04 19:01:16,188 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-04 19:01:16,191 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-04 19:01:16,195 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-04 19:01:16,200 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-04 19:01:16,204 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-04 19:01:16,205 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:01:16,227 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:01:16,229 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:01:16,229 - MoETrainer - INFO -   RMSE: $112,653
2025-06-04 19:01:16,230 - MoETrainer - INFO -   MAE: $55,833 (10.4% of mean)
2025-06-04 19:01:16,230 - MoETrainer - INFO -   RÂ²: 0.8339
2025-06-04 19:01:16,230 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-04 19:01:16,231 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-04 19:01:16,231 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-04 19:01:16,231 - MoETrainer - INFO -   Within 5%: 38.4% of predictions
2025-06-04 19:01:16,232 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-04 19:01:16,232 - MoETrainer - INFO -   Within 15%: 87.0% of predictions
2025-06-04 19:01:16,232 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:01:16,233 - MoETrainer - INFO -   Bin 0: RMSE=$36,723, RÂ²=0.0753, Samples=178
2025-06-04 19:01:16,233 - MoETrainer - INFO -   Bin 1: RMSE=$21,618, RÂ²=-0.0197, Samples=195
2025-06-04 19:01:16,233 - MoETrainer - INFO -   Bin 2: RMSE=$20,938, RÂ²=0.0011, Samples=180
2025-06-04 19:01:16,234 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-04 19:01:16,234 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-04 19:01:16,234 - MoETrainer - INFO -   Bin 5: RMSE=$257,565, RÂ²=0.1328, Samples=197
2025-06-04 19:01:16,235 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 19:01:16,235 - MoETrainer - INFO -   Bin 0: ridge_medium
2025-06-04 19:01:16,235 - MoETrainer - INFO -   Bin 1: elastic_light
2025-06-04 19:01:16,235 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-04 19:01:16,237 - MoETrainer - INFO -   Bin 3: elastic_light
2025-06-04 19:01:16,237 - MoETrainer - INFO -   Bin 4: elastic_light
2025-06-04 19:01:16,237 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-06-04 19:01:16,238 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 19:01:16,238 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 19:01:16,239 - MoETrainer - INFO - Final Performance: RÂ² = 0.8339
2025-06-04 19:01:16,239 - MoETrainer - INFO - Final RMSE: $112,653
2025-06-04 19:01:16,240 - MoETrainer - INFO - Final MAE: $55,833
2025-06-04 19:04:03,973 - MoETrainer - INFO - === TRAINING FIXED BASELINE MODEL (NO DATA LEAKAGE) ===
2025-06-04 19:04:03,973 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 19:04:03,974 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 19:04:04,497 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-06-04 19:04:04,500 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-04 19:04:04,505 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-04 19:04:04,528 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-04 19:04:07,378 - MoETrainer - INFO - Consolidated to 13 features
2025-06-04 19:04:07,406 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-04 19:04:07,406 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-06-04 19:04:07,407 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-06-04 19:04:07,407 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-06-04 19:04:07,408 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 19:04:07,409 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-06-04 19:04:07,421 - MoETrainer - INFO - Applied robust scaling
2025-06-04 19:04:07,422 - MoETrainer - INFO - Splitting data...
2025-06-04 19:04:07,427 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-04 19:04:07,427 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-06-04 19:04:07,427 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-06-04 19:04:07,428 - MoETrainer - INFO - Data splits - Train: 3576, Val: 826, Test: 1101
2025-06-04 19:04:07,428 - MoETrainer - INFO - Finding optimal bin configuration using VALIDATION set...
2025-06-04 19:04:07,429 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:04:07,431 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:04:07,431 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:04:07,432 - MoETrainer - INFO - Bin 0: Large bin (1169), using CV selection
2025-06-04 19:04:10,784 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:04:10,784 - MoETrainer - INFO -   1. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165 [SELECTED]
2025-06-04 19:04:10,785 - MoETrainer - INFO -   2. rf_shallow: MSE=2098259114Â±77220782, RÂ²=0.149
2025-06-04 19:04:10,785 - MoETrainer - INFO -   3. xgb_balanced: MSE=2125685632Â±27137187, RÂ²=0.138
2025-06-04 19:04:10,786 - MoETrainer - INFO - Bin 1: Large bin (1214), using CV selection
2025-06-04 19:04:14,150 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:04:14,150 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.143 [SELECTED]
2025-06-04 19:04:14,150 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.132
2025-06-04 19:04:14,153 - MoETrainer - INFO -   3. rf_medium: MSE=2112637858Â±65581900, RÂ²=0.126
2025-06-04 19:04:14,153 - MoETrainer - INFO - Bin 2: Large bin (1193), using CV selection
2025-06-04 19:04:17,826 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:04:17,827 - MoETrainer - INFO -   1. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.285 [SELECTED]
2025-06-04 19:04:17,828 - MoETrainer - INFO -   2. ridge_medium: MSE=53753943381Â±6834487807, RÂ²=0.285
2025-06-04 19:04:17,828 - MoETrainer - INFO -   3. ridge_light: MSE=53765068117Â±6752244532, RÂ²=0.284
2025-06-04 19:04:17,828 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:04:17,875 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1169 samples
2025-06-04 19:04:17,923 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-06-04 19:04:17,975 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1193 samples
2025-06-04 19:04:17,975 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 19:04:17,982 - MoETrainer - INFO -   3 bins: Val RÂ²=0.7721, Val RMSE=$131,225
2025-06-04 19:04:17,983 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:04:17,983 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:04:17,984 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:04:17,984 - MoETrainer - INFO - Bin 0: Large bin (886), using CV selection
2025-06-04 19:04:20,678 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:04:20,679 - MoETrainer - INFO -   1. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.135 [SELECTED]
2025-06-04 19:04:20,679 - MoETrainer - INFO -   2. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.129
2025-06-04 19:04:20,679 - MoETrainer - INFO -   3. rf_medium: MSE=1600502834Â±101161837, RÂ²=0.114
2025-06-04 19:04:20,679 - MoETrainer - INFO - Bin 1: Large bin (898), using CV selection
2025-06-04 19:04:23,476 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:04:23,476 - MoETrainer - INFO -   1. ridge_heavy: MSE=760152363Â±41859609, RÂ²=0.059 [SELECTED]
2025-06-04 19:04:23,476 - MoETrainer - INFO -   2. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-06-04 19:04:23,476 - MoETrainer - INFO -   3. elastic_light: MSE=767669035Â±40384572, RÂ²=0.050
2025-06-04 19:04:23,476 - MoETrainer - INFO - Bin 2: Large bin (875), using CV selection
2025-06-04 19:04:26,294 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:04:26,295 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.034 [SELECTED]
2025-06-04 19:04:26,295 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.025
2025-06-04 19:04:26,296 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.021
2025-06-04 19:04:26,296 - MoETrainer - INFO - Bin 3: Large bin (917), using CV selection
2025-06-04 19:04:29,364 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:04:29,365 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120898048Â±5601852790, RÂ²=0.233 [SELECTED]
2025-06-04 19:04:29,365 - MoETrainer - INFO -   2. ridge_medium: MSE=59261804544Â±5215540885, RÂ²=0.231
2025-06-04 19:04:29,365 - MoETrainer - INFO -   3. elastic_light: MSE=59424127659Â±5623519271, RÂ²=0.229
2025-06-04 19:04:29,366 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:04:29,416 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 886 samples
2025-06-04 19:04:29,420 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 1: 898 samples
2025-06-04 19:04:29,658 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-06-04 19:04:29,661 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-06-04 19:04:29,662 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 19:04:29,678 - MoETrainer - INFO -   4 bins: Val RÂ²=0.7807, Val RMSE=$128,720
2025-06-04 19:04:29,680 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:04:29,680 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:04:29,681 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:04:29,681 - MoETrainer - INFO - Bin 0: Small bin (701), using rule-based selection
2025-06-04 19:04:30,492 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:04:30,492 - MoETrainer - INFO -   1. xgb_conservative: Score=1.044, MAE=$28337, RMSE=$35417, RÂ²=0.108 [SELECTED]
2025-06-04 19:04:30,492 - MoETrainer - INFO -   2. rf_medium: Score=1.046, MAE=$27958, RMSE=$35537, RÂ²=0.102
2025-06-04 19:04:30,492 - MoETrainer - INFO -   3. rf_shallow: Score=1.047, MAE=$28072, RMSE=$35576, RÂ²=0.100
2025-06-04 19:04:30,498 - MoETrainer - INFO - Bin 1: Small bin (722), using rule-based selection
2025-06-04 19:04:31,350 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:04:31,350 - MoETrainer - INFO -   1. elastic_light: Score=1.083, MAE=$18234, RMSE=$21576, RÂ²=-0.014 [SELECTED]
2025-06-04 19:04:31,352 - MoETrainer - INFO -   2. xgb_conservative: Score=1.119, MAE=$18435, RMSE=$21728, RÂ²=-0.028
2025-06-04 19:04:31,352 - MoETrainer - INFO -   3. rf_shallow: Score=1.120, MAE=$18519, RMSE=$21732, RÂ²=-0.029
2025-06-04 19:04:31,352 - MoETrainer - INFO - Bin 2: Small bin (721), using rule-based selection
2025-06-04 19:04:32,223 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:04:32,223 - MoETrainer - INFO -   1. xgb_conservative: Score=1.085, MAE=$23821, RMSE=$27822, RÂ²=-0.013 [SELECTED]
2025-06-04 19:04:32,223 - MoETrainer - INFO -   2. elastic_light: Score=1.138, MAE=$24842, RMSE=$28103, RÂ²=-0.034
2025-06-04 19:04:32,223 - MoETrainer - INFO -   3. rf_shallow: Score=1.161, MAE=$24148, RMSE=$28238, RÂ²=-0.044
2025-06-04 19:04:32,223 - MoETrainer - INFO - Bin 3: Small bin (708), using rule-based selection
2025-06-04 19:04:33,077 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:04:33,077 - MoETrainer - INFO -   1. rf_shallow: Score=1.062, MAE=$39877, RMSE=$47457, RÂ²=0.013 [SELECTED]
2025-06-04 19:04:33,077 - MoETrainer - INFO -   2. elastic_light: Score=1.063, MAE=$40758, RMSE=$47446, RÂ²=0.013
2025-06-04 19:04:33,077 - MoETrainer - INFO -   3. ridge_medium: Score=1.069, MAE=$40736, RMSE=$47721, RÂ²=0.002
2025-06-04 19:04:33,079 - MoETrainer - INFO - Bin 4: Small bin (724), using rule-based selection
2025-06-04 19:04:33,969 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:04:33,969 - MoETrainer - INFO -   1. xgb_conservative: Score=1.108, MAE=$197372, RMSE=$267697, RÂ²=0.188 [SELECTED]
2025-06-04 19:04:33,969 - MoETrainer - INFO -   2. ridge_medium: Score=1.122, MAE=$192641, RMSE=$273250, RÂ²=0.154
2025-06-04 19:04:33,969 - MoETrainer - INFO -   3. elastic_light: Score=1.127, MAE=$194859, RMSE=$274024, RÂ²=0.149
2025-06-04 19:04:33,971 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:04:34,015 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-06-04 19:04:34,015 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-06-04 19:04:34,063 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 721 samples
2025-06-04 19:04:34,270 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 708 samples
2025-06-04 19:04:34,312 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 724 samples
2025-06-04 19:04:34,312 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 19:04:34,329 - MoETrainer - INFO -   5 bins: Val RÂ²=0.8195, Val RMSE=$116,772
2025-06-04 19:04:34,330 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:04:34,331 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:04:34,331 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:04:34,331 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-04 19:04:35,075 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:04:35,076 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-04 19:04:35,076 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-04 19:04:35,076 - MoETrainer - INFO -   3. rf_shallow: Score=1.111, MAE=$28218, RMSE=$34894, RÂ²=-0.003
2025-06-04 19:04:35,077 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-04 19:04:35,890 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:04:35,891 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-04 19:04:35,891 - MoETrainer - INFO -   2. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-04 19:04:35,892 - MoETrainer - INFO -   3. rf_shallow: Score=1.245, MAE=$19392, RMSE=$22275, RÂ²=-0.077
2025-06-04 19:04:35,892 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-04 19:04:36,680 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:04:36,680 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-04 19:04:36,680 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-04 19:04:36,680 - MoETrainer - INFO -   3. elastic_light: Score=1.026, MAE=$18400, RMSE=$21045, RÂ²=0.034
2025-06-04 19:04:36,680 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-04 19:04:37,459 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:04:37,459 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-04 19:04:37,459 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-04 19:04:37,459 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-04 19:04:37,459 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-04 19:04:38,263 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:04:38,264 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-04 19:04:38,264 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-04 19:04:38,264 - MoETrainer - INFO -   3. rf_shallow: Score=1.146, MAE=$41056, RMSE=$46831, RÂ²=-0.032
2025-06-04 19:04:38,265 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-04 19:04:39,086 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:04:39,087 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-04 19:04:39,087 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-04 19:04:39,088 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-04 19:04:39,088 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:04:39,091 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-04 19:04:39,094 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-04 19:04:39,097 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-04 19:04:39,099 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-04 19:04:39,102 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-04 19:04:39,105 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-04 19:04:39,106 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:04:39,110 - MoETrainer - INFO -   6 bins: Val RÂ²=0.8465, Val RMSE=$107,689
2025-06-04 19:04:39,110 - MoETrainer - INFO - â Optimal configuration selected: 6 bins (based on validation)
2025-06-04 19:04:39,111 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 19:04:39,111 - MoETrainer - INFO - ð¯ Final evaluation on TEST set (unbiased)
2025-06-04 19:04:39,113 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:04:39,114 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:04:39,114 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:04:39,115 - MoETrainer - INFO - Bin 0: Small bin (655), using rule-based selection
2025-06-04 19:04:39,910 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:04:39,910 - MoETrainer - INFO -   1. elastic_light: Score=1.074, MAE=$25549, RMSE=$32814, RÂ²=0.040 [SELECTED]
2025-06-04 19:04:39,911 - MoETrainer - INFO -   2. rf_shallow: Score=1.087, MAE=$25140, RMSE=$33310, RÂ²=0.011
2025-06-04 19:04:39,911 - MoETrainer - INFO -   3. xgb_conservative: Score=1.091, MAE=$25523, RMSE=$33392, RÂ²=0.006
2025-06-04 19:04:39,912 - MoETrainer - INFO - Bin 1: Small bin (783), using rule-based selection
2025-06-04 19:04:40,816 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:04:40,817 - MoETrainer - INFO -   1. elastic_light: Score=1.052, MAE=$18898, RMSE=$21527, RÂ²=0.002 [SELECTED]
2025-06-04 19:04:40,817 - MoETrainer - INFO -   2. rf_medium: Score=1.066, MAE=$18828, RMSE=$21604, RÂ²=-0.005
2025-06-04 19:04:40,817 - MoETrainer - INFO -   3. ridge_medium: Score=1.073, MAE=$18892, RMSE=$21632, RÂ²=-0.008
2025-06-04 19:04:40,818 - MoETrainer - INFO - Bin 2: Small bin (755), using rule-based selection
2025-06-04 19:04:41,694 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:04:41,694 - MoETrainer - INFO -   1. ridge_medium: Score=1.025, MAE=$17511, RMSE=$20417, RÂ²=0.033 [SELECTED]
2025-06-04 19:04:41,695 - MoETrainer - INFO -   2. elastic_light: Score=1.033, MAE=$17776, RMSE=$20583, RÂ²=0.017
2025-06-04 19:04:41,695 - MoETrainer - INFO -   3. rf_shallow: Score=1.037, MAE=$17899, RMSE=$20653, RÂ²=0.010
2025-06-04 19:04:41,696 - MoETrainer - INFO - Bin 3: Small bin (741), using rule-based selection
2025-06-04 19:04:42,590 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:04:42,591 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$24691, RMSE=$28092, RÂ²=-0.016 [SELECTED]
2025-06-04 19:04:42,592 - MoETrainer - INFO -   2. ridge_medium: Score=1.116, MAE=$24633, RMSE=$28244, RÂ²=-0.027
2025-06-04 19:04:42,592 - MoETrainer - INFO -   3. rf_shallow: Score=1.185, MAE=$24674, RMSE=$28617, RÂ²=-0.055
2025-06-04 19:04:42,592 - MoETrainer - INFO - Bin 4: Small bin (714), using rule-based selection
2025-06-04 19:04:43,472 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:04:43,474 - MoETrainer - INFO -   1. ridge_medium: Score=1.017, MAE=$39488, RMSE=$44149, RÂ²=0.090 [SELECTED]
2025-06-04 19:04:43,474 - MoETrainer - INFO -   2. elastic_light: Score=1.026, MAE=$40063, RMSE=$44545, RÂ²=0.074
2025-06-04 19:04:43,474 - MoETrainer - INFO -   3. xgb_conservative: Score=1.030, MAE=$39732, RMSE=$44767, RÂ²=0.064
2025-06-04 19:04:43,475 - MoETrainer - INFO - Bin 5: Small bin (754), using rule-based selection
2025-06-04 19:04:44,424 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:04:44,424 - MoETrainer - INFO -   1. ridge_medium: Score=1.088, MAE=$188877, RMSE=$269689, RÂ²=0.181 [SELECTED]
2025-06-04 19:04:44,424 - MoETrainer - INFO -   2. rf_shallow: Score=1.097, MAE=$192203, RMSE=$271322, RÂ²=0.171
2025-06-04 19:04:44,424 - MoETrainer - INFO -   3. elastic_light: Score=1.101, MAE=$191415, RMSE=$272693, RÂ²=0.162
2025-06-04 19:04:44,424 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:04:44,429 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 655 samples
2025-06-04 19:04:44,432 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 783 samples
2025-06-04 19:04:44,436 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 755 samples
2025-06-04 19:04:44,439 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 741 samples
2025-06-04 19:04:44,443 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 714 samples
2025-06-04 19:04:44,447 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 754 samples
2025-06-04 19:04:44,448 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:04:44,461 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:04:44,461 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:04:44,461 - MoETrainer - INFO -   RMSE: $112,184
2025-06-04 19:04:44,461 - MoETrainer - INFO -   MAE: $55,596 (10.3% of mean)
2025-06-04 19:04:44,470 - MoETrainer - INFO -   RÂ²: 0.8353
2025-06-04 19:04:44,470 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-04 19:04:44,470 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-04 19:04:44,470 - MoETrainer - INFO -   Median APE: 6.4%
2025-06-04 19:04:44,470 - MoETrainer - INFO -   Within 5%: 37.2% of predictions
2025-06-04 19:04:44,470 - MoETrainer - INFO -   Within 10%: 77.6% of predictions
2025-06-04 19:04:44,470 - MoETrainer - INFO -   Within 15%: 87.1% of predictions
2025-06-04 19:04:44,470 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:04:44,470 - MoETrainer - INFO -   Bin 0: RMSE=$37,436, RÂ²=0.0391, Samples=178
2025-06-04 19:04:44,474 - MoETrainer - INFO -   Bin 1: RMSE=$21,590, RÂ²=-0.0171, Samples=195
2025-06-04 19:04:44,474 - MoETrainer - INFO -   Bin 2: RMSE=$20,765, RÂ²=0.0176, Samples=180
2025-06-04 19:04:44,474 - MoETrainer - INFO -   Bin 3: RMSE=$28,076, RÂ²=0.0173, Samples=179
2025-06-04 19:04:44,474 - MoETrainer - INFO -   Bin 4: RMSE=$45,611, RÂ²=0.0021, Samples=172
2025-06-04 19:04:44,474 - MoETrainer - INFO -   Bin 5: RMSE=$256,287, RÂ²=0.1414, Samples=197
2025-06-04 19:04:44,474 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 19:04:44,474 - MoETrainer - INFO -   Bin 0: elastic_light
2025-06-04 19:04:44,474 - MoETrainer - INFO -   Bin 1: elastic_light
2025-06-04 19:04:44,474 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-04 19:04:44,478 - MoETrainer - INFO -   Bin 3: elastic_light
2025-06-04 19:04:44,478 - MoETrainer - INFO -   Bin 4: ridge_medium
2025-06-04 19:04:44,478 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-06-04 19:04:44,480 - MoETrainer - INFO - === FIXED BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 19:04:44,480 - MoETrainer - INFO - Final Test Performance: RÂ² = 0.8353
2025-06-04 19:04:44,480 - MoETrainer - INFO - Final Test RMSE: $112,184
2025-06-04 19:04:44,480 - MoETrainer - INFO - Final Test MAE: $55,596
2025-06-04 19:06:48,718 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 19:06:48,718 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 19:06:48,719 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 19:06:49,206 - MoETrainer - INFO - Raw data shape: (5555, 745)
2025-06-04 19:06:49,208 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-04 19:06:49,212 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-04 19:06:49,241 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-04 19:06:52,265 - MoETrainer - INFO - Consolidated to 13 features
2025-06-04 19:06:52,295 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-04 19:06:52,296 - MoETrainer - INFO - Loaded dataset: 5555 samples, 15 features
2025-06-04 19:06:52,298 - MoETrainer - INFO - Target statistics: mean=$558,347, std=$353,728
2025-06-04 19:06:52,298 - MoETrainer - INFO - Target range: [$149,000, $4,700,000]
2025-06-04 19:06:52,298 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 19:06:52,300 - MoETrainer - INFO - Removed 52 outliers (0.9%)
2025-06-04 19:06:52,311 - MoETrainer - INFO - Applied robust scaling
2025-06-04 19:06:52,312 - MoETrainer - INFO - Splitting data...
2025-06-04 19:06:52,315 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-04 19:06:52,316 - MoETrainer - INFO - Train target: mean=$534,900, std=$264,972
2025-06-04 19:06:52,316 - MoETrainer - INFO - Test target: mean=$538,588, std=$276,417
2025-06-04 19:06:52,317 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 19:06:52,318 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:06:52,318 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:06:52,319 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:06:52,320 - MoETrainer - INFO - Bin 0: Large bin (1169), using CV selection
2025-06-04 19:06:55,689 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:06:55,689 - MoETrainer - INFO -   1. xgb_conservative: MSE=2060557227Â±64814194, RÂ²=0.165 [SELECTED]
2025-06-04 19:06:55,690 - MoETrainer - INFO -   2. rf_shallow: MSE=2098259114Â±77220782, RÂ²=0.149
2025-06-04 19:06:55,690 - MoETrainer - INFO -   3. xgb_balanced: MSE=2125685632Â±27137187, RÂ²=0.138
2025-06-04 19:06:55,690 - MoETrainer - INFO - Bin 1: Large bin (1214), using CV selection
2025-06-04 19:06:59,113 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:06:59,116 - MoETrainer - INFO -   1. xgb_conservative: MSE=2071242923Â±70872336, RÂ²=0.143 [SELECTED]
2025-06-04 19:06:59,116 - MoETrainer - INFO -   2. rf_shallow: MSE=2097975982Â±61108602, RÂ²=0.132
2025-06-04 19:06:59,116 - MoETrainer - INFO -   3. rf_medium: MSE=2112637858Â±65581900, RÂ²=0.126
2025-06-04 19:06:59,117 - MoETrainer - INFO - Bin 2: Large bin (1193), using CV selection
2025-06-04 19:07:02,700 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:07:02,701 - MoETrainer - INFO -   1. xgb_conservative: MSE=53693399040Â±6025485836, RÂ²=0.285 [SELECTED]
2025-06-04 19:07:02,701 - MoETrainer - INFO -   2. ridge_medium: MSE=53753943381Â±6834487807, RÂ²=0.285
2025-06-04 19:07:02,701 - MoETrainer - INFO -   3. ridge_light: MSE=53765068117Â±6752244532, RÂ²=0.284
2025-06-04 19:07:02,702 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:07:02,751 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1169 samples
2025-06-04 19:07:02,802 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1214 samples
2025-06-04 19:07:02,857 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1193 samples
2025-06-04 19:07:02,857 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 19:07:02,876 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:07:02,877 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:07:02,877 - MoETrainer - INFO -   RMSE: $140,440
2025-06-04 19:07:02,877 - MoETrainer - INFO -   MAE: $82,346 (15.3% of mean)
2025-06-04 19:07:02,878 - MoETrainer - INFO -   RÂ²: 0.7419
2025-06-04 19:07:02,878 - MoETrainer - INFO -   MAPE: 14.1%
2025-06-04 19:07:02,878 - MoETrainer - INFO -   MPE: +3.4% (bias: overprediction)
2025-06-04 19:07:02,880 - MoETrainer - INFO -   Median APE: 10.7%
2025-06-04 19:07:02,880 - MoETrainer - INFO -   Within 5%: 24.3% of predictions
2025-06-04 19:07:02,881 - MoETrainer - INFO -   Within 10%: 47.2% of predictions
2025-06-04 19:07:02,881 - MoETrainer - INFO -   Within 15%: 67.3% of predictions
2025-06-04 19:07:02,881 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:07:02,881 - MoETrainer - INFO -   Bin 0: RMSE=$50,501, RÂ²=0.1896, Samples=373
2025-06-04 19:07:02,882 - MoETrainer - INFO -   Bin 1: RMSE=$43,956, RÂ²=0.1187, Samples=359
2025-06-04 19:07:02,882 - MoETrainer - INFO -   Bin 2: RMSE=$233,220, RÂ²=0.3078, Samples=369
2025-06-04 19:07:02,882 - MoETrainer - INFO -   3 bins: RÂ²=0.7419, RMSE=$140,440
2025-06-04 19:07:02,884 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:07:02,885 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:07:02,885 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:07:02,886 - MoETrainer - INFO - Bin 0: Large bin (886), using CV selection
2025-06-04 19:07:05,828 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:07:05,829 - MoETrainer - INFO -   1. xgb_conservative: MSE=1561972053Â±87254131, RÂ²=0.135 [SELECTED]
2025-06-04 19:07:05,829 - MoETrainer - INFO -   2. rf_shallow: MSE=1572264014Â±101448323, RÂ²=0.129
2025-06-04 19:07:05,830 - MoETrainer - INFO -   3. rf_medium: MSE=1600502834Â±101161837, RÂ²=0.114
2025-06-04 19:07:05,830 - MoETrainer - INFO - Bin 1: Large bin (898), using CV selection
2025-06-04 19:07:08,702 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:07:08,703 - MoETrainer - INFO -   1. ridge_heavy: MSE=760152363Â±41859609, RÂ²=0.059 [SELECTED]
2025-06-04 19:07:08,703 - MoETrainer - INFO -   2. rf_shallow: MSE=766476325Â±37464676, RÂ²=0.051
2025-06-04 19:07:08,703 - MoETrainer - INFO -   3. elastic_light: MSE=767669035Â±40384572, RÂ²=0.050
2025-06-04 19:07:08,705 - MoETrainer - INFO - Bin 2: Large bin (875), using CV selection
2025-06-04 19:07:11,592 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:07:11,592 - MoETrainer - INFO -   1. rf_shallow: MSE=1877221916Â±72479787, RÂ²=0.034 [SELECTED]
2025-06-04 19:07:11,592 - MoETrainer - INFO -   2. rf_medium: MSE=1894464732Â±82755016, RÂ²=0.025
2025-06-04 19:07:11,592 - MoETrainer - INFO -   3. xgb_conservative: MSE=1902045995Â±87055670, RÂ²=0.021
2025-06-04 19:07:11,592 - MoETrainer - INFO - Bin 3: Large bin (917), using CV selection
2025-06-04 19:07:14,661 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:07:14,662 - MoETrainer - INFO -   1. ridge_heavy: MSE=59120898048Â±5601852790, RÂ²=0.233 [SELECTED]
2025-06-04 19:07:14,662 - MoETrainer - INFO -   2. ridge_medium: MSE=59261804544Â±5215540885, RÂ²=0.231
2025-06-04 19:07:14,662 - MoETrainer - INFO -   3. elastic_light: MSE=59424127659Â±5623519271, RÂ²=0.229
2025-06-04 19:07:14,663 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:07:14,708 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 886 samples
2025-06-04 19:07:14,711 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 1: 898 samples
2025-06-04 19:07:14,947 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 875 samples
2025-06-04 19:07:14,950 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 917 samples
2025-06-04 19:07:14,950 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 19:07:14,979 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:07:14,980 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:07:14,980 - MoETrainer - INFO -   RMSE: $131,724
2025-06-04 19:07:14,980 - MoETrainer - INFO -   MAE: $71,092 (13.2% of mean)
2025-06-04 19:07:14,980 - MoETrainer - INFO -   RÂ²: 0.7729
2025-06-04 19:07:14,981 - MoETrainer - INFO -   MAPE: 11.6%
2025-06-04 19:07:14,981 - MoETrainer - INFO -   MPE: +3.2% (bias: overprediction)
2025-06-04 19:07:14,982 - MoETrainer - INFO -   Median APE: 8.3%
2025-06-04 19:07:14,982 - MoETrainer - INFO -   Within 5%: 29.8% of predictions
2025-06-04 19:07:14,982 - MoETrainer - INFO -   Within 10%: 61.2% of predictions
2025-06-04 19:07:14,982 - MoETrainer - INFO -   Within 15%: 77.6% of predictions
2025-06-04 19:07:14,982 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:07:14,983 - MoETrainer - INFO -   Bin 0: RMSE=$44,072, RÂ²=0.1371, Samples=272
2025-06-04 19:07:14,983 - MoETrainer - INFO -   Bin 1: RMSE=$28,098, RÂ²=0.0469, Samples=281
2025-06-04 19:07:14,983 - MoETrainer - INFO -   Bin 2: RMSE=$40,906, RÂ²=0.1414, Samples=253
2025-06-04 19:07:14,985 - MoETrainer - INFO -   Bin 3: RMSE=$246,537, RÂ²=0.2252, Samples=295
2025-06-04 19:07:14,985 - MoETrainer - INFO -   4 bins: RÂ²=0.7729, RMSE=$131,724
2025-06-04 19:07:14,986 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:07:14,987 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:07:14,987 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:07:14,987 - MoETrainer - INFO - Bin 0: Small bin (701), using rule-based selection
2025-06-04 19:07:15,773 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:07:15,774 - MoETrainer - INFO -   1. xgb_conservative: Score=1.044, MAE=$28337, RMSE=$35417, RÂ²=0.108 [SELECTED]
2025-06-04 19:07:15,774 - MoETrainer - INFO -   2. rf_medium: Score=1.046, MAE=$27958, RMSE=$35537, RÂ²=0.102
2025-06-04 19:07:15,775 - MoETrainer - INFO -   3. rf_shallow: Score=1.047, MAE=$28072, RMSE=$35576, RÂ²=0.100
2025-06-04 19:07:15,776 - MoETrainer - INFO - Bin 1: Small bin (722), using rule-based selection
2025-06-04 19:07:16,585 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:07:16,585 - MoETrainer - INFO -   1. elastic_light: Score=1.083, MAE=$18234, RMSE=$21576, RÂ²=-0.014 [SELECTED]
2025-06-04 19:07:16,585 - MoETrainer - INFO -   2. xgb_conservative: Score=1.119, MAE=$18435, RMSE=$21728, RÂ²=-0.028
2025-06-04 19:07:16,585 - MoETrainer - INFO -   3. rf_shallow: Score=1.120, MAE=$18519, RMSE=$21732, RÂ²=-0.029
2025-06-04 19:07:16,588 - MoETrainer - INFO - Bin 2: Small bin (721), using rule-based selection
2025-06-04 19:07:17,404 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:07:17,404 - MoETrainer - INFO -   1. xgb_conservative: Score=1.085, MAE=$23821, RMSE=$27822, RÂ²=-0.013 [SELECTED]
2025-06-04 19:07:17,406 - MoETrainer - INFO -   2. elastic_light: Score=1.138, MAE=$24842, RMSE=$28103, RÂ²=-0.034
2025-06-04 19:07:17,406 - MoETrainer - INFO -   3. rf_shallow: Score=1.161, MAE=$24148, RMSE=$28238, RÂ²=-0.044
2025-06-04 19:07:17,406 - MoETrainer - INFO - Bin 3: Small bin (708), using rule-based selection
2025-06-04 19:07:18,239 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:07:18,239 - MoETrainer - INFO -   1. rf_shallow: Score=1.062, MAE=$39877, RMSE=$47457, RÂ²=0.013 [SELECTED]
2025-06-04 19:07:18,239 - MoETrainer - INFO -   2. elastic_light: Score=1.063, MAE=$40758, RMSE=$47446, RÂ²=0.013
2025-06-04 19:07:18,241 - MoETrainer - INFO -   3. ridge_medium: Score=1.069, MAE=$40736, RMSE=$47721, RÂ²=0.002
2025-06-04 19:07:18,241 - MoETrainer - INFO - Bin 4: Small bin (724), using rule-based selection
2025-06-04 19:07:19,118 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:07:19,118 - MoETrainer - INFO -   1. xgb_conservative: Score=1.108, MAE=$197372, RMSE=$267697, RÂ²=0.188 [SELECTED]
2025-06-04 19:07:19,119 - MoETrainer - INFO -   2. ridge_medium: Score=1.122, MAE=$192641, RMSE=$273250, RÂ²=0.154
2025-06-04 19:07:19,119 - MoETrainer - INFO -   3. elastic_light: Score=1.127, MAE=$194859, RMSE=$274024, RÂ²=0.149
2025-06-04 19:07:19,119 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:07:19,164 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 701 samples
2025-06-04 19:07:19,168 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 722 samples
2025-06-04 19:07:19,213 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 721 samples
2025-06-04 19:07:19,420 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 708 samples
2025-06-04 19:07:19,467 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 724 samples
2025-06-04 19:07:19,467 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 19:07:19,502 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:07:19,503 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:07:19,503 - MoETrainer - INFO -   RMSE: $117,507
2025-06-04 19:07:19,505 - MoETrainer - INFO -   MAE: $59,539 (11.1% of mean)
2025-06-04 19:07:19,505 - MoETrainer - INFO -   RÂ²: 0.8193
2025-06-04 19:07:19,506 - MoETrainer - INFO -   MAPE: 9.5%
2025-06-04 19:07:19,506 - MoETrainer - INFO -   MPE: +1.8% (bias: overprediction)
2025-06-04 19:07:19,506 - MoETrainer - INFO -   Median APE: 6.5%
2025-06-04 19:07:19,507 - MoETrainer - INFO -   Within 5%: 39.1% of predictions
2025-06-04 19:07:19,507 - MoETrainer - INFO -   Within 10%: 70.8% of predictions
2025-06-04 19:07:19,508 - MoETrainer - INFO -   Within 15%: 82.7% of predictions
2025-06-04 19:07:19,508 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:07:19,508 - MoETrainer - INFO -   Bin 0: RMSE=$40,646, RÂ²=0.0942, Samples=223
2025-06-04 19:07:19,509 - MoETrainer - INFO -   Bin 1: RMSE=$19,774, RÂ²=0.0186, Samples=215
2025-06-04 19:07:19,509 - MoETrainer - INFO -   Bin 2: RMSE=$27,637, RÂ²=-0.0493, Samples=233
2025-06-04 19:07:19,509 - MoETrainer - INFO -   Bin 3: RMSE=$45,726, RÂ²=0.0423, Samples=201
2025-06-04 19:07:19,510 - MoETrainer - INFO -   Bin 4: RMSE=$248,593, RÂ²=0.2083, Samples=229
2025-06-04 19:07:19,510 - MoETrainer - INFO -   5 bins: RÂ²=0.8193, RMSE=$117,507
2025-06-04 19:07:19,512 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:07:19,512 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:07:19,514 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:07:19,514 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-04 19:07:20,262 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:07:20,263 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-04 19:07:20,263 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-04 19:07:20,264 - MoETrainer - INFO -   3. rf_shallow: Score=1.111, MAE=$28218, RMSE=$34894, RÂ²=-0.003
2025-06-04 19:07:20,264 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-04 19:07:21,093 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:07:21,093 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-04 19:07:21,094 - MoETrainer - INFO -   2. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-04 19:07:21,094 - MoETrainer - INFO -   3. rf_shallow: Score=1.245, MAE=$19392, RMSE=$22275, RÂ²=-0.077
2025-06-04 19:07:21,095 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-04 19:07:21,889 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:07:21,890 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-04 19:07:21,890 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-04 19:07:21,890 - MoETrainer - INFO -   3. elastic_light: Score=1.026, MAE=$18400, RMSE=$21045, RÂ²=0.034
2025-06-04 19:07:21,891 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-04 19:07:22,699 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:07:22,699 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-04 19:07:22,700 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-04 19:07:22,700 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-04 19:07:22,701 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-04 19:07:23,535 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:07:23,537 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-04 19:07:23,537 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-04 19:07:23,537 - MoETrainer - INFO -   3. rf_shallow: Score=1.146, MAE=$41056, RMSE=$46831, RÂ²=-0.032
2025-06-04 19:07:23,537 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-04 19:07:24,363 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:07:24,363 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-04 19:07:24,364 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-04 19:07:24,364 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-04 19:07:24,364 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:07:24,367 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-04 19:07:24,371 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-04 19:07:24,376 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-04 19:07:24,380 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-04 19:07:24,383 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-04 19:07:24,385 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-04 19:07:24,385 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:07:24,410 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:07:24,410 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:07:24,411 - MoETrainer - INFO -   RMSE: $112,653
2025-06-04 19:07:24,411 - MoETrainer - INFO -   MAE: $55,833 (10.4% of mean)
2025-06-04 19:07:24,411 - MoETrainer - INFO -   RÂ²: 0.8339
2025-06-04 19:07:24,411 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-04 19:07:24,412 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-04 19:07:24,412 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-04 19:07:24,412 - MoETrainer - INFO -   Within 5%: 38.4% of predictions
2025-06-04 19:07:24,413 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-04 19:07:24,413 - MoETrainer - INFO -   Within 15%: 87.0% of predictions
2025-06-04 19:07:24,413 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:07:24,413 - MoETrainer - INFO -   Bin 0: RMSE=$36,723, RÂ²=0.0753, Samples=178
2025-06-04 19:07:24,414 - MoETrainer - INFO -   Bin 1: RMSE=$21,618, RÂ²=-0.0197, Samples=195
2025-06-04 19:07:24,414 - MoETrainer - INFO -   Bin 2: RMSE=$20,938, RÂ²=0.0011, Samples=180
2025-06-04 19:07:24,414 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-04 19:07:24,415 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-04 19:07:24,415 - MoETrainer - INFO -   Bin 5: RMSE=$257,565, RÂ²=0.1328, Samples=197
2025-06-04 19:07:24,416 - MoETrainer - INFO -   6 bins: RÂ²=0.8339, RMSE=$112,653
2025-06-04 19:07:24,416 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 19:07:24,417 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 19:07:24,418 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:07:24,418 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:07:24,419 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:07:24,420 - MoETrainer - INFO - Bin 0: Small bin (531), using rule-based selection
2025-06-04 19:07:25,181 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:07:25,183 - MoETrainer - INFO -   1. ridge_medium: Score=1.082, MAE=$27537, RMSE=$34161, RÂ²=0.039 [SELECTED]
2025-06-04 19:07:25,185 - MoETrainer - INFO -   2. elastic_light: Score=1.084, MAE=$28120, RMSE=$34165, RÂ²=0.039
2025-06-04 19:07:25,188 - MoETrainer - INFO -   3. rf_shallow: Score=1.111, MAE=$28218, RMSE=$34894, RÂ²=-0.003
2025-06-04 19:07:25,194 - MoETrainer - INFO - Bin 1: Small bin (638), using rule-based selection
2025-06-04 19:07:26,034 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:07:26,034 - MoETrainer - INFO -   1. elastic_light: Score=1.126, MAE=$19154, RMSE=$21776, RÂ²=-0.029 [SELECTED]
2025-06-04 19:07:26,035 - MoETrainer - INFO -   2. ridge_medium: Score=1.190, MAE=$19391, RMSE=$22046, RÂ²=-0.055
2025-06-04 19:07:26,035 - MoETrainer - INFO -   3. rf_shallow: Score=1.245, MAE=$19392, RMSE=$22275, RÂ²=-0.077
2025-06-04 19:07:26,035 - MoETrainer - INFO - Bin 2: Small bin (615), using rule-based selection
2025-06-04 19:07:26,881 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:07:26,882 - MoETrainer - INFO -   1. ridge_medium: Score=1.022, MAE=$18218, RMSE=$20965, RÂ²=0.041 [SELECTED]
2025-06-04 19:07:26,882 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$18482, RMSE=$20977, RÂ²=0.040
2025-06-04 19:07:26,882 - MoETrainer - INFO -   3. elastic_light: Score=1.026, MAE=$18400, RMSE=$21045, RÂ²=0.034
2025-06-04 19:07:26,884 - MoETrainer - INFO - Bin 3: Small bin (599), using rule-based selection
2025-06-04 19:07:27,736 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:07:27,737 - MoETrainer - INFO -   1. elastic_light: Score=1.070, MAE=$23694, RMSE=$27205, RÂ²=-0.010 [SELECTED]
2025-06-04 19:07:27,737 - MoETrainer - INFO -   2. ridge_medium: Score=1.078, MAE=$23595, RMSE=$27249, RÂ²=-0.013
2025-06-04 19:07:27,737 - MoETrainer - INFO -   3. xgb_conservative: Score=1.248, MAE=$23970, RMSE=$28146, RÂ²=-0.081
2025-06-04 19:07:27,738 - MoETrainer - INFO - Bin 4: Small bin (596), using rule-based selection
2025-06-04 19:07:28,574 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:07:28,575 - MoETrainer - INFO -   1. elastic_light: Score=1.081, MAE=$40993, RMSE=$46240, RÂ²=-0.006 [SELECTED]
2025-06-04 19:07:28,575 - MoETrainer - INFO -   2. ridge_medium: Score=1.126, MAE=$41351, RMSE=$46645, RÂ²=-0.024
2025-06-04 19:07:28,576 - MoETrainer - INFO -   3. rf_shallow: Score=1.146, MAE=$41056, RMSE=$46831, RÂ²=-0.032
2025-06-04 19:07:28,576 - MoETrainer - INFO - Bin 5: Small bin (597), using rule-based selection
2025-06-04 19:07:29,395 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:07:29,395 - MoETrainer - INFO -   1. ridge_medium: Score=1.037, MAE=$177132, RMSE=$240343, RÂ²=0.259 [SELECTED]
2025-06-04 19:07:29,396 - MoETrainer - INFO -   2. elastic_light: Score=1.051, MAE=$179451, RMSE=$243619, RÂ²=0.238
2025-06-04 19:07:29,396 - MoETrainer - INFO -   3. rf_shallow: Score=1.076, MAE=$185475, RMSE=$248800, RÂ²=0.205
2025-06-04 19:07:29,397 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:07:29,399 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 531 samples
2025-06-04 19:07:29,402 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 638 samples
2025-06-04 19:07:29,405 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 615 samples
2025-06-04 19:07:29,407 - MoETrainer - INFO - Successfully trained elastic_light for bin 3: 599 samples
2025-06-04 19:07:29,411 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 596 samples
2025-06-04 19:07:29,413 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 597 samples
2025-06-04 19:07:29,414 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:07:29,435 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:07:29,435 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:07:29,435 - MoETrainer - INFO -   RMSE: $112,653
2025-06-04 19:07:29,436 - MoETrainer - INFO -   MAE: $55,833 (10.4% of mean)
2025-06-04 19:07:29,436 - MoETrainer - INFO -   RÂ²: 0.8339
2025-06-04 19:07:29,436 - MoETrainer - INFO -   MAPE: 8.7%
2025-06-04 19:07:29,437 - MoETrainer - INFO -   MPE: +1.7% (bias: overprediction)
2025-06-04 19:07:29,437 - MoETrainer - INFO -   Median APE: 6.3%
2025-06-04 19:07:29,437 - MoETrainer - INFO -   Within 5%: 38.4% of predictions
2025-06-04 19:07:29,438 - MoETrainer - INFO -   Within 10%: 77.7% of predictions
2025-06-04 19:07:29,438 - MoETrainer - INFO -   Within 15%: 87.0% of predictions
2025-06-04 19:07:29,438 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:07:29,439 - MoETrainer - INFO -   Bin 0: RMSE=$36,723, RÂ²=0.0753, Samples=178
2025-06-04 19:07:29,439 - MoETrainer - INFO -   Bin 1: RMSE=$21,618, RÂ²=-0.0197, Samples=195
2025-06-04 19:07:29,439 - MoETrainer - INFO -   Bin 2: RMSE=$20,938, RÂ²=0.0011, Samples=180
2025-06-04 19:07:29,440 - MoETrainer - INFO -   Bin 3: RMSE=$28,082, RÂ²=0.0168, Samples=179
2025-06-04 19:07:29,440 - MoETrainer - INFO -   Bin 4: RMSE=$45,258, RÂ²=0.0175, Samples=172
2025-06-04 19:07:29,440 - MoETrainer - INFO -   Bin 5: RMSE=$257,565, RÂ²=0.1328, Samples=197
2025-06-04 19:07:29,441 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 19:07:29,441 - MoETrainer - INFO -   Bin 0: ridge_medium
2025-06-04 19:07:29,441 - MoETrainer - INFO -   Bin 1: elastic_light
2025-06-04 19:07:29,442 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-04 19:07:29,442 - MoETrainer - INFO -   Bin 3: elastic_light
2025-06-04 19:07:29,442 - MoETrainer - INFO -   Bin 4: elastic_light
2025-06-04 19:07:29,443 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-06-04 19:07:29,443 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 19:07:29,443 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 19:07:29,444 - MoETrainer - INFO - Final Performance: RÂ² = 0.8339
2025-06-04 19:07:29,444 - MoETrainer - INFO - Final RMSE: $112,653
2025-06-04 19:07:29,444 - MoETrainer - INFO - Final MAE: $55,833
2025-06-04 19:17:49,141 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 19:17:49,141 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 19:17:49,141 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 19:17:49,775 - MoETrainer - INFO - Raw data shape: (5525, 745)
2025-06-04 19:17:49,783 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-04 19:17:49,786 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-04 19:17:49,823 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-04 19:17:52,615 - MoETrainer - INFO - Consolidated to 13 features
2025-06-04 19:17:52,650 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-04 19:17:52,650 - MoETrainer - INFO - Loaded dataset: 5525 samples, 15 features
2025-06-04 19:17:52,651 - MoETrainer - INFO - Target statistics: mean=$543,777, std=$289,820
2025-06-04 19:17:52,651 - MoETrainer - INFO - Target range: [$149,000, $2,485,000]
2025-06-04 19:17:52,651 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 19:17:52,654 - MoETrainer - INFO - Removed 22 outliers (0.4%)
2025-06-04 19:17:52,665 - MoETrainer - INFO - Applied robust scaling
2025-06-04 19:17:52,665 - MoETrainer - INFO - Splitting data...
2025-06-04 19:17:52,672 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-04 19:17:52,673 - MoETrainer - INFO - Train target: mean=$535,714, std=$267,185
2025-06-04 19:17:52,674 - MoETrainer - INFO - Test target: mean=$550,320, std=$279,941
2025-06-04 19:17:52,675 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 19:17:52,679 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:17:52,681 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:17:52,682 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:17:52,683 - MoETrainer - INFO - Bin 0: Large bin (1165), using CV selection
2025-06-04 19:17:55,868 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:17:55,868 - MoETrainer - INFO -   1. xgb_conservative: MSE=2248866944Â±151247400, RÂ²=0.147 [SELECTED]
2025-06-04 19:17:55,868 - MoETrainer - INFO -   2. rf_shallow: MSE=2295483764Â±175383637, RÂ²=0.130
2025-06-04 19:17:55,870 - MoETrainer - INFO -   3. xgb_balanced: MSE=2313097899Â±183084443, RÂ²=0.123
2025-06-04 19:17:55,870 - MoETrainer - INFO - Bin 1: Large bin (1217), using CV selection
2025-06-04 19:17:59,299 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:17:59,299 - MoETrainer - INFO -   1. xgb_conservative: MSE=2004258603Â±59239375, RÂ²=0.150 [SELECTED]
2025-06-04 19:17:59,299 - MoETrainer - INFO -   2. rf_shallow: MSE=2021611240Â±74284372, RÂ²=0.142
2025-06-04 19:17:59,299 - MoETrainer - INFO -   3. rf_medium: MSE=2036781232Â±75496684, RÂ²=0.136
2025-06-04 19:17:59,300 - MoETrainer - INFO - Bin 2: Large bin (1194), using CV selection
2025-06-04 19:18:02,890 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:18:02,890 - MoETrainer - INFO -   1. xgb_conservative: MSE=52465810091Â±2914131108, RÂ²=0.314 [SELECTED]
2025-06-04 19:18:02,891 - MoETrainer - INFO -   2. rf_medium: MSE=52517779381Â±3068690025, RÂ²=0.313
2025-06-04 19:18:02,891 - MoETrainer - INFO -   3. xgb_balanced: MSE=53155876864Â±2542668687, RÂ²=0.305
2025-06-04 19:18:02,891 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:18:02,943 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1165 samples
2025-06-04 19:18:02,999 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1217 samples
2025-06-04 19:18:03,052 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1194 samples
2025-06-04 19:18:03,053 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 19:18:03,073 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:18:03,073 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:18:03,073 - MoETrainer - INFO -   RMSE: $145,003
2025-06-04 19:18:03,074 - MoETrainer - INFO -   MAE: $82,260 (14.9% of mean)
2025-06-04 19:18:03,074 - MoETrainer - INFO -   RÂ²: 0.7317
2025-06-04 19:18:03,074 - MoETrainer - INFO -   MAPE: 13.3%
2025-06-04 19:18:03,076 - MoETrainer - INFO -   MPE: +2.5% (bias: overprediction)
2025-06-04 19:18:03,076 - MoETrainer - INFO -   Median APE: 9.9%
2025-06-04 19:18:03,076 - MoETrainer - INFO -   Within 5%: 26.3% of predictions
2025-06-04 19:18:03,076 - MoETrainer - INFO -   Within 10%: 50.2% of predictions
2025-06-04 19:18:03,077 - MoETrainer - INFO -   Within 15%: 67.0% of predictions
2025-06-04 19:18:03,077 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:18:03,077 - MoETrainer - INFO -   Bin 0: RMSE=$45,349, RÂ²=0.2364, Samples=358
2025-06-04 19:18:03,077 - MoETrainer - INFO -   Bin 1: RMSE=$44,496, RÂ²=0.1442, Samples=350
2025-06-04 19:18:03,078 - MoETrainer - INFO -   Bin 2: RMSE=$235,092, RÂ²=0.2973, Samples=393
2025-06-04 19:18:03,078 - MoETrainer - INFO -   3 bins: RÂ²=0.7317, RMSE=$145,003
2025-06-04 19:18:03,079 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:18:03,080 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:18:03,080 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:18:03,080 - MoETrainer - INFO - Bin 0: Large bin (887), using CV selection
2025-06-04 19:18:06,045 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:18:06,045 - MoETrainer - INFO -   1. xgb_conservative: MSE=1699376469Â±112481401, RÂ²=0.135 [SELECTED]
2025-06-04 19:18:06,045 - MoETrainer - INFO -   2. rf_shallow: MSE=1734470679Â±104281772, RÂ²=0.118
2025-06-04 19:18:06,045 - MoETrainer - INFO -   3. rf_medium: MSE=1749125603Â±91301604, RÂ²=0.110
2025-06-04 19:18:06,049 - MoETrainer - INFO - Bin 1: Large bin (899), using CV selection
2025-06-04 19:18:08,951 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:18:08,951 - MoETrainer - INFO -   1. xgb_conservative: MSE=737793707Â±14275717, RÂ²=0.040 [SELECTED]
2025-06-04 19:18:08,951 - MoETrainer - INFO -   2. ridge_heavy: MSE=737826389Â±15099293, RÂ²=0.040
2025-06-04 19:18:08,951 - MoETrainer - INFO -   3. ridge_light: MSE=738881536Â±15267667, RÂ²=0.039
2025-06-04 19:18:08,951 - MoETrainer - INFO - Bin 2: Large bin (869), using CV selection
2025-06-04 19:18:11,758 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:18:11,759 - MoETrainer - INFO -   1. rf_shallow: MSE=1834980134Â±50692358, RÂ²=0.068 [SELECTED]
2025-06-04 19:18:11,760 - MoETrainer - INFO -   2. xgb_conservative: MSE=1863295147Â±70599990, RÂ²=0.053
2025-06-04 19:18:11,760 - MoETrainer - INFO -   3. rf_medium: MSE=1895010255Â±42666115, RÂ²=0.037
2025-06-04 19:18:11,761 - MoETrainer - INFO - Bin 3: Large bin (921), using CV selection
2025-06-04 19:18:14,837 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:18:14,838 - MoETrainer - INFO -   1. ridge_heavy: MSE=58603895467Â±2606958159, RÂ²=0.249 [SELECTED]
2025-06-04 19:18:14,838 - MoETrainer - INFO -   2. ridge_medium: MSE=58691986773Â±2553100480, RÂ²=0.248
2025-06-04 19:18:14,838 - MoETrainer - INFO -   3. ridge_light: MSE=58793007787Â±2644117710, RÂ²=0.247
2025-06-04 19:18:14,839 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:18:14,878 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 887 samples
2025-06-04 19:18:14,917 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 899 samples
2025-06-04 19:18:15,155 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 869 samples
2025-06-04 19:18:15,159 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 921 samples
2025-06-04 19:18:15,160 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 19:18:15,186 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:18:15,186 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:18:15,187 - MoETrainer - INFO -   RMSE: $131,978
2025-06-04 19:18:15,187 - MoETrainer - INFO -   MAE: $71,749 (13.0% of mean)
2025-06-04 19:18:15,188 - MoETrainer - INFO -   RÂ²: 0.7777
2025-06-04 19:18:15,188 - MoETrainer - INFO -   MAPE: 11.3%
2025-06-04 19:18:15,188 - MoETrainer - INFO -   MPE: +2.5% (bias: overprediction)
2025-06-04 19:18:15,188 - MoETrainer - INFO -   Median APE: 8.4%
2025-06-04 19:18:15,189 - MoETrainer - INFO -   Within 5%: 26.7% of predictions
2025-06-04 19:18:15,189 - MoETrainer - INFO -   Within 10%: 61.1% of predictions
2025-06-04 19:18:15,191 - MoETrainer - INFO -   Within 15%: 77.6% of predictions
2025-06-04 19:18:15,191 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:18:15,191 - MoETrainer - INFO -   Bin 0: RMSE=$39,994, RÂ²=0.2190, Samples=271
2025-06-04 19:18:15,192 - MoETrainer - INFO -   Bin 1: RMSE=$28,041, RÂ²=0.0240, Samples=248
2025-06-04 19:18:15,192 - MoETrainer - INFO -   Bin 2: RMSE=$44,628, RÂ²=0.0243, Samples=275
2025-06-04 19:18:15,192 - MoETrainer - INFO -   Bin 3: RMSE=$242,148, RÂ²=0.2574, Samples=307
2025-06-04 19:18:15,193 - MoETrainer - INFO -   4 bins: RÂ²=0.7777, RMSE=$131,978
2025-06-04 19:18:15,194 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:18:15,195 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:18:15,195 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:18:15,195 - MoETrainer - INFO - Bin 0: Small bin (715), using rule-based selection
2025-06-04 19:18:16,057 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:18:16,059 - MoETrainer - INFO -   1. ridge_medium: Score=1.043, MAE=$28340, RMSE=$34390, RÂ²=0.106 [SELECTED]
2025-06-04 19:18:16,059 - MoETrainer - INFO -   2. elastic_light: Score=1.057, MAE=$28865, RMSE=$34815, RÂ²=0.084
2025-06-04 19:18:16,059 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$29041, RMSE=$34831, RÂ²=0.083
2025-06-04 19:18:16,060 - MoETrainer - INFO - Bin 1: Small bin (715), using rule-based selection
2025-06-04 19:18:16,888 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:18:16,891 - MoETrainer - INFO -   1. elastic_light: Score=1.142, MAE=$17523, RMSE=$20565, RÂ²=-0.038 [SELECTED]
2025-06-04 19:18:16,891 - MoETrainer - INFO -   2. rf_shallow: Score=1.156, MAE=$17197, RMSE=$20626, RÂ²=-0.044
2025-06-04 19:18:16,891 - MoETrainer - INFO -   3. rf_medium: Score=1.170, MAE=$17148, RMSE=$20683, RÂ²=-0.050
2025-06-04 19:18:16,892 - MoETrainer - INFO - Bin 2: Small bin (715), using rule-based selection
2025-06-04 19:18:17,749 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:18:17,750 - MoETrainer - INFO -   1. xgb_conservative: Score=1.063, MAE=$22364, RMSE=$26541, RÂ²=-0.006 [SELECTED]
2025-06-04 19:18:17,750 - MoETrainer - INFO -   2. rf_shallow: Score=1.154, MAE=$22867, RMSE=$27008, RÂ²=-0.042
2025-06-04 19:18:17,750 - MoETrainer - INFO -   3. rf_medium: Score=1.158, MAE=$22548, RMSE=$27033, RÂ²=-0.044
2025-06-04 19:18:17,751 - MoETrainer - INFO - Bin 3: Small bin (712), using rule-based selection
2025-06-04 19:18:18,622 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:18:18,623 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$39739, RMSE=$47163, RÂ²=0.023 [SELECTED]
2025-06-04 19:18:18,623 - MoETrainer - INFO -   2. elastic_light: Score=1.058, MAE=$40230, RMSE=$47222, RÂ²=0.020
2025-06-04 19:18:18,623 - MoETrainer - INFO -   3. rf_shallow: Score=1.059, MAE=$39699, RMSE=$47311, RÂ²=0.016
2025-06-04 19:18:18,624 - MoETrainer - INFO - Bin 4: Small bin (719), using rule-based selection
2025-06-04 19:18:19,662 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:18:19,663 - MoETrainer - INFO -   1. elastic_light: Score=1.114, MAE=$198091, RMSE=$277429, RÂ²=0.170 [SELECTED]
2025-06-04 19:18:19,663 - MoETrainer - INFO -   2. ridge_medium: Score=1.120, MAE=$199365, RMSE=$278891, RÂ²=0.161
2025-06-04 19:18:19,664 - MoETrainer - INFO -   3. rf_shallow: Score=1.127, MAE=$198801, RMSE=$281185, RÂ²=0.147
2025-06-04 19:18:19,664 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:18:19,667 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 715 samples
2025-06-04 19:18:19,671 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 715 samples
2025-06-04 19:18:19,709 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 715 samples
2025-06-04 19:18:19,748 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 3: 712 samples
2025-06-04 19:18:19,755 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 719 samples
2025-06-04 19:18:19,756 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 19:18:19,775 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:18:19,776 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:18:19,776 - MoETrainer - INFO -   RMSE: $117,870
2025-06-04 19:18:19,776 - MoETrainer - INFO -   MAE: $61,763 (11.2% of mean)
2025-06-04 19:18:19,777 - MoETrainer - INFO -   RÂ²: 0.8227
2025-06-04 19:18:19,778 - MoETrainer - INFO -   MAPE: 9.5%
2025-06-04 19:18:19,778 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-04 19:18:19,778 - MoETrainer - INFO -   Median APE: 7.0%
2025-06-04 19:18:19,779 - MoETrainer - INFO -   Within 5%: 38.8% of predictions
2025-06-04 19:18:19,779 - MoETrainer - INFO -   Within 10%: 68.8% of predictions
2025-06-04 19:18:19,779 - MoETrainer - INFO -   Within 15%: 84.0% of predictions
2025-06-04 19:18:19,779 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:18:19,780 - MoETrainer - INFO -   Bin 0: RMSE=$38,437, RÂ²=0.1697, Samples=224
2025-06-04 19:18:19,780 - MoETrainer - INFO -   Bin 1: RMSE=$20,271, RÂ²=-0.0011, Samples=203
2025-06-04 19:18:19,780 - MoETrainer - INFO -   Bin 2: RMSE=$26,016, RÂ²=0.0540, Samples=209
2025-06-04 19:18:19,782 - MoETrainer - INFO -   Bin 3: RMSE=$46,606, RÂ²=0.0586, Samples=224
2025-06-04 19:18:19,782 - MoETrainer - INFO -   Bin 4: RMSE=$243,200, RÂ²=0.2468, Samples=241
2025-06-04 19:18:19,782 - MoETrainer - INFO -   5 bins: RÂ²=0.8227, RMSE=$117,870
2025-06-04 19:18:19,784 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:18:19,784 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:18:19,784 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:18:19,785 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-04 19:18:20,498 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:18:20,498 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-04 19:18:20,499 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-04 19:18:20,499 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-04 19:18:20,500 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-04 19:18:21,314 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:18:21,315 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-04 19:18:21,315 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-04 19:18:21,315 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-04 19:18:21,316 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-04 19:18:22,104 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:18:22,105 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-04 19:18:22,105 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-04 19:18:22,105 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-04 19:18:22,105 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-04 19:18:22,892 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:18:22,892 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-04 19:18:22,893 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-04 19:18:22,893 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-04 19:18:22,894 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-04 19:18:23,684 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:18:23,684 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-04 19:18:23,685 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-04 19:18:23,685 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-04 19:18:23,686 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-04 19:18:24,500 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:18:24,500 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-04 19:18:24,501 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-04 19:18:24,501 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-04 19:18:24,501 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:18:24,505 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-04 19:18:24,690 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-04 19:18:24,728 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-04 19:18:24,921 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-04 19:18:24,924 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-04 19:18:24,927 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-04 19:18:24,928 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:18:24,972 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:18:24,972 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:18:24,973 - MoETrainer - INFO -   RMSE: $110,663
2025-06-04 19:18:24,973 - MoETrainer - INFO -   MAE: $56,069 (10.2% of mean)
2025-06-04 19:18:24,973 - MoETrainer - INFO -   RÂ²: 0.8437
2025-06-04 19:18:24,974 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-04 19:18:24,974 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-04 19:18:24,974 - MoETrainer - INFO -   Median APE: 6.0%
2025-06-04 19:18:24,975 - MoETrainer - INFO -   Within 5%: 41.7% of predictions
2025-06-04 19:18:24,975 - MoETrainer - INFO -   Within 10%: 75.7% of predictions
2025-06-04 19:18:24,975 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-04 19:18:24,976 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:18:24,976 - MoETrainer - INFO -   Bin 0: RMSE=$35,762, RÂ²=0.0641, Samples=165
2025-06-04 19:18:24,976 - MoETrainer - INFO -   Bin 1: RMSE=$20,318, RÂ²=-0.0196, Samples=193
2025-06-04 19:18:24,977 - MoETrainer - INFO -   Bin 2: RMSE=$20,547, RÂ²=0.0539, Samples=161
2025-06-04 19:18:24,977 - MoETrainer - INFO -   Bin 3: RMSE=$27,860, RÂ²=-0.0529, Samples=189
2025-06-04 19:18:24,977 - MoETrainer - INFO -   Bin 4: RMSE=$44,882, RÂ²=-0.0086, Samples=185
2025-06-04 19:18:24,979 - MoETrainer - INFO -   Bin 5: RMSE=$246,175, RÂ²=0.2126, Samples=208
2025-06-04 19:18:24,979 - MoETrainer - INFO -   6 bins: RÂ²=0.8437, RMSE=$110,663
2025-06-04 19:18:24,979 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 19:18:24,980 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 19:18:24,981 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:18:24,981 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:18:24,981 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:18:24,982 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-04 19:18:25,753 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:18:25,753 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-04 19:18:25,755 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-04 19:18:25,755 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-04 19:18:25,755 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-04 19:18:26,547 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:18:26,547 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-04 19:18:26,548 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-04 19:18:26,548 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-04 19:18:26,549 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-04 19:18:27,355 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:18:27,355 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-04 19:18:27,356 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-04 19:18:27,356 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-04 19:18:27,356 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-04 19:18:28,151 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:18:28,152 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-04 19:18:28,152 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-04 19:18:28,152 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-04 19:18:28,153 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-04 19:18:28,944 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:18:28,945 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-04 19:18:28,945 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-04 19:18:28,945 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-04 19:18:28,946 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-04 19:18:29,839 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:18:29,840 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-04 19:18:29,840 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-04 19:18:29,840 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-04 19:18:29,841 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:18:29,843 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-04 19:18:30,053 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-04 19:18:30,096 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-04 19:18:30,315 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-04 19:18:30,315 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-04 19:18:30,315 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-04 19:18:30,315 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:18:30,359 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:18:30,359 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:18:30,359 - MoETrainer - INFO -   RMSE: $110,663
2025-06-04 19:18:30,359 - MoETrainer - INFO -   MAE: $56,069 (10.2% of mean)
2025-06-04 19:18:30,359 - MoETrainer - INFO -   RÂ²: 0.8437
2025-06-04 19:18:30,359 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-04 19:18:30,359 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-04 19:18:30,359 - MoETrainer - INFO -   Median APE: 6.0%
2025-06-04 19:18:30,363 - MoETrainer - INFO -   Within 5%: 41.7% of predictions
2025-06-04 19:18:30,363 - MoETrainer - INFO -   Within 10%: 75.7% of predictions
2025-06-04 19:18:30,363 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-04 19:18:30,363 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:18:30,363 - MoETrainer - INFO -   Bin 0: RMSE=$35,762, RÂ²=0.0641, Samples=165
2025-06-04 19:18:30,365 - MoETrainer - INFO -   Bin 1: RMSE=$20,318, RÂ²=-0.0196, Samples=193
2025-06-04 19:18:30,365 - MoETrainer - INFO -   Bin 2: RMSE=$20,547, RÂ²=0.0539, Samples=161
2025-06-04 19:18:30,365 - MoETrainer - INFO -   Bin 3: RMSE=$27,860, RÂ²=-0.0529, Samples=189
2025-06-04 19:18:30,365 - MoETrainer - INFO -   Bin 4: RMSE=$44,882, RÂ²=-0.0086, Samples=185
2025-06-04 19:18:30,366 - MoETrainer - INFO -   Bin 5: RMSE=$246,175, RÂ²=0.2126, Samples=208
2025-06-04 19:18:30,366 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 19:18:30,366 - MoETrainer - INFO -   Bin 0: elastic_light
2025-06-04 19:18:30,366 - MoETrainer - INFO -   Bin 1: rf_shallow
2025-06-04 19:18:30,366 - MoETrainer - INFO -   Bin 2: xgb_conservative
2025-06-04 19:18:30,368 - MoETrainer - INFO -   Bin 3: rf_shallow
2025-06-04 19:18:30,368 - MoETrainer - INFO -   Bin 4: ridge_medium
2025-06-04 19:18:30,368 - MoETrainer - INFO -   Bin 5: elastic_light
2025-06-04 19:18:30,368 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 19:18:30,368 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 19:18:30,368 - MoETrainer - INFO - Final Performance: RÂ² = 0.8437
2025-06-04 19:18:30,368 - MoETrainer - INFO - Final RMSE: $110,663
2025-06-04 19:18:30,368 - MoETrainer - INFO - Final MAE: $56,069
2025-06-04 19:19:21,948 - MoETrainer - INFO - === TRAINING FIXED BASELINE MODEL (NO DATA LEAKAGE) ===
2025-06-04 19:19:21,948 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 19:19:21,949 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 19:19:22,427 - MoETrainer - INFO - Raw data shape: (5525, 745)
2025-06-04 19:19:22,430 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-04 19:19:22,434 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-04 19:19:22,460 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-04 19:19:25,252 - MoETrainer - INFO - Consolidated to 13 features
2025-06-04 19:19:25,281 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-04 19:19:25,282 - MoETrainer - INFO - Loaded dataset: 5525 samples, 15 features
2025-06-04 19:19:25,282 - MoETrainer - INFO - Target statistics: mean=$543,777, std=$289,820
2025-06-04 19:19:25,283 - MoETrainer - INFO - Target range: [$149,000, $2,485,000]
2025-06-04 19:19:25,283 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 19:19:25,285 - MoETrainer - INFO - Removed 22 outliers (0.4%)
2025-06-04 19:19:25,294 - MoETrainer - INFO - Applied robust scaling
2025-06-04 19:19:25,294 - MoETrainer - INFO - Splitting data...
2025-06-04 19:19:25,300 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-04 19:19:25,301 - MoETrainer - INFO - Train target: mean=$535,714, std=$267,185
2025-06-04 19:19:25,301 - MoETrainer - INFO - Test target: mean=$550,320, std=$279,941
2025-06-04 19:19:25,302 - MoETrainer - INFO - Data splits - Train: 3576, Val: 826, Test: 1101
2025-06-04 19:19:25,302 - MoETrainer - INFO - Finding optimal bin configuration using VALIDATION set...
2025-06-04 19:19:25,303 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:19:25,304 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:19:25,305 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:19:25,307 - MoETrainer - INFO - Bin 0: Large bin (1165), using CV selection
2025-06-04 19:19:28,388 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:19:28,388 - MoETrainer - INFO -   1. xgb_conservative: MSE=2248866944Â±151247400, RÂ²=0.147 [SELECTED]
2025-06-04 19:19:28,389 - MoETrainer - INFO -   2. rf_shallow: MSE=2295483764Â±175383637, RÂ²=0.130
2025-06-04 19:19:28,389 - MoETrainer - INFO -   3. xgb_balanced: MSE=2313097899Â±183084443, RÂ²=0.123
2025-06-04 19:19:28,389 - MoETrainer - INFO - Bin 1: Large bin (1217), using CV selection
2025-06-04 19:19:31,694 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:19:31,694 - MoETrainer - INFO -   1. xgb_conservative: MSE=2004258603Â±59239375, RÂ²=0.150 [SELECTED]
2025-06-04 19:19:31,695 - MoETrainer - INFO -   2. rf_shallow: MSE=2021611240Â±74284372, RÂ²=0.142
2025-06-04 19:19:31,695 - MoETrainer - INFO -   3. rf_medium: MSE=2036781232Â±75496684, RÂ²=0.136
2025-06-04 19:19:31,696 - MoETrainer - INFO - Bin 2: Large bin (1194), using CV selection
2025-06-04 19:19:35,218 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:19:35,218 - MoETrainer - INFO -   1. xgb_conservative: MSE=52465810091Â±2914131108, RÂ²=0.314 [SELECTED]
2025-06-04 19:19:35,220 - MoETrainer - INFO -   2. rf_medium: MSE=52517779381Â±3068690025, RÂ²=0.313
2025-06-04 19:19:35,220 - MoETrainer - INFO -   3. xgb_balanced: MSE=53155876864Â±2542668687, RÂ²=0.305
2025-06-04 19:19:35,220 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:19:35,271 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1165 samples
2025-06-04 19:19:35,317 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1217 samples
2025-06-04 19:19:35,369 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1194 samples
2025-06-04 19:19:35,369 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 19:19:35,376 - MoETrainer - INFO -   3 bins: Val RÂ²=0.7523, Val RMSE=$129,289
2025-06-04 19:19:35,376 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:19:35,376 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:19:35,382 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:19:35,382 - MoETrainer - INFO - Bin 0: Large bin (887), using CV selection
2025-06-04 19:19:38,155 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:19:38,156 - MoETrainer - INFO -   1. xgb_conservative: MSE=1699376469Â±112481401, RÂ²=0.135 [SELECTED]
2025-06-04 19:19:38,156 - MoETrainer - INFO -   2. rf_shallow: MSE=1734470679Â±104281772, RÂ²=0.118
2025-06-04 19:19:38,156 - MoETrainer - INFO -   3. rf_medium: MSE=1749125603Â±91301604, RÂ²=0.110
2025-06-04 19:19:38,156 - MoETrainer - INFO - Bin 1: Large bin (899), using CV selection
2025-06-04 19:19:40,898 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:19:40,898 - MoETrainer - INFO -   1. xgb_conservative: MSE=737793707Â±14275717, RÂ²=0.040 [SELECTED]
2025-06-04 19:19:40,899 - MoETrainer - INFO -   2. ridge_heavy: MSE=737826389Â±15099293, RÂ²=0.040
2025-06-04 19:19:40,899 - MoETrainer - INFO -   3. ridge_light: MSE=738881536Â±15267667, RÂ²=0.039
2025-06-04 19:19:40,901 - MoETrainer - INFO - Bin 2: Large bin (869), using CV selection
2025-06-04 19:19:43,671 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:19:43,671 - MoETrainer - INFO -   1. rf_shallow: MSE=1834980134Â±50692358, RÂ²=0.068 [SELECTED]
2025-06-04 19:19:43,671 - MoETrainer - INFO -   2. xgb_conservative: MSE=1863295147Â±70599990, RÂ²=0.053
2025-06-04 19:19:43,673 - MoETrainer - INFO -   3. rf_medium: MSE=1895010255Â±42666115, RÂ²=0.037
2025-06-04 19:19:43,673 - MoETrainer - INFO - Bin 3: Large bin (921), using CV selection
2025-06-04 19:19:46,655 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:19:46,655 - MoETrainer - INFO -   1. ridge_heavy: MSE=58603895467Â±2606958159, RÂ²=0.249 [SELECTED]
2025-06-04 19:19:46,656 - MoETrainer - INFO -   2. ridge_medium: MSE=58691986773Â±2553100480, RÂ²=0.248
2025-06-04 19:19:46,656 - MoETrainer - INFO -   3. ridge_light: MSE=58793007787Â±2644117710, RÂ²=0.247
2025-06-04 19:19:46,656 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:19:46,707 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 887 samples
2025-06-04 19:19:46,751 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 899 samples
2025-06-04 19:19:46,987 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 869 samples
2025-06-04 19:19:46,991 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 921 samples
2025-06-04 19:19:46,995 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 19:19:47,015 - MoETrainer - INFO -   4 bins: Val RÂ²=0.7814, Val RMSE=$121,464
2025-06-04 19:19:47,018 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:19:47,019 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:19:47,020 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:19:47,021 - MoETrainer - INFO - Bin 0: Small bin (715), using rule-based selection
2025-06-04 19:19:47,878 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:19:47,879 - MoETrainer - INFO -   1. ridge_medium: Score=1.043, MAE=$28340, RMSE=$34390, RÂ²=0.106 [SELECTED]
2025-06-04 19:19:47,879 - MoETrainer - INFO -   2. elastic_light: Score=1.057, MAE=$28865, RMSE=$34815, RÂ²=0.084
2025-06-04 19:19:47,880 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$29041, RMSE=$34831, RÂ²=0.083
2025-06-04 19:19:47,880 - MoETrainer - INFO - Bin 1: Small bin (715), using rule-based selection
2025-06-04 19:19:48,732 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:19:48,733 - MoETrainer - INFO -   1. elastic_light: Score=1.142, MAE=$17523, RMSE=$20565, RÂ²=-0.038 [SELECTED]
2025-06-04 19:19:48,734 - MoETrainer - INFO -   2. rf_shallow: Score=1.156, MAE=$17197, RMSE=$20626, RÂ²=-0.044
2025-06-04 19:19:48,734 - MoETrainer - INFO -   3. rf_medium: Score=1.170, MAE=$17148, RMSE=$20683, RÂ²=-0.050
2025-06-04 19:19:48,735 - MoETrainer - INFO - Bin 2: Small bin (715), using rule-based selection
2025-06-04 19:19:49,614 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:19:49,615 - MoETrainer - INFO -   1. xgb_conservative: Score=1.063, MAE=$22364, RMSE=$26541, RÂ²=-0.006 [SELECTED]
2025-06-04 19:19:49,615 - MoETrainer - INFO -   2. rf_shallow: Score=1.154, MAE=$22867, RMSE=$27008, RÂ²=-0.042
2025-06-04 19:19:49,615 - MoETrainer - INFO -   3. rf_medium: Score=1.158, MAE=$22548, RMSE=$27033, RÂ²=-0.044
2025-06-04 19:19:49,616 - MoETrainer - INFO - Bin 3: Small bin (712), using rule-based selection
2025-06-04 19:19:50,500 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:19:50,501 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$39739, RMSE=$47163, RÂ²=0.023 [SELECTED]
2025-06-04 19:19:50,501 - MoETrainer - INFO -   2. elastic_light: Score=1.058, MAE=$40230, RMSE=$47222, RÂ²=0.020
2025-06-04 19:19:50,501 - MoETrainer - INFO -   3. rf_shallow: Score=1.059, MAE=$39699, RMSE=$47311, RÂ²=0.016
2025-06-04 19:19:50,502 - MoETrainer - INFO - Bin 4: Small bin (719), using rule-based selection
2025-06-04 19:19:51,405 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:19:51,405 - MoETrainer - INFO -   1. elastic_light: Score=1.114, MAE=$198091, RMSE=$277429, RÂ²=0.170 [SELECTED]
2025-06-04 19:19:51,406 - MoETrainer - INFO -   2. ridge_medium: Score=1.120, MAE=$199365, RMSE=$278891, RÂ²=0.161
2025-06-04 19:19:51,406 - MoETrainer - INFO -   3. rf_shallow: Score=1.127, MAE=$198801, RMSE=$281185, RÂ²=0.147
2025-06-04 19:19:51,406 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:19:51,409 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 715 samples
2025-06-04 19:19:51,412 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 715 samples
2025-06-04 19:19:51,459 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 715 samples
2025-06-04 19:19:51,505 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 3: 712 samples
2025-06-04 19:19:51,514 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 719 samples
2025-06-04 19:19:51,514 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 19:19:51,522 - MoETrainer - INFO -   5 bins: Val RÂ²=0.8130, Val RMSE=$112,329
2025-06-04 19:19:51,524 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:19:51,524 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:19:51,525 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:19:51,525 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-04 19:19:52,228 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:19:52,228 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-04 19:19:52,229 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-04 19:19:52,229 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-04 19:19:52,229 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-04 19:19:53,008 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:19:53,009 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-04 19:19:53,009 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-04 19:19:53,010 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-04 19:19:53,010 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-04 19:19:53,777 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:19:53,778 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-04 19:19:53,778 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-04 19:19:53,779 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-04 19:19:53,779 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-04 19:19:54,568 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:19:54,569 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-04 19:19:54,569 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-04 19:19:54,570 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-04 19:19:54,570 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-04 19:19:55,354 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 19:19:55,354 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-04 19:19:55,355 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-04 19:19:55,355 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-04 19:19:55,355 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-04 19:19:56,177 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:19:56,177 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-04 19:19:56,178 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-04 19:19:56,178 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-04 19:19:56,178 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:19:56,182 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-04 19:19:56,386 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-04 19:19:56,423 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-04 19:19:56,614 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-04 19:19:56,616 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-04 19:19:56,620 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-04 19:19:56,620 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:19:56,647 - MoETrainer - INFO -   6 bins: Val RÂ²=0.8453, Val RMSE=$102,182
2025-06-04 19:19:56,647 - MoETrainer - INFO - â Optimal configuration selected: 6 bins (based on validation)
2025-06-04 19:19:56,648 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 19:19:56,649 - MoETrainer - INFO - ð¯ Final evaluation on TEST set (unbiased)
2025-06-04 19:19:56,652 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:19:56,654 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:19:56,654 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:19:56,655 - MoETrainer - INFO - Bin 0: Small bin (668), using rule-based selection
2025-06-04 19:19:57,444 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 19:19:57,445 - MoETrainer - INFO -   1. elastic_light: Score=1.075, MAE=$26460, RMSE=$33488, RÂ²=0.044 [SELECTED]
2025-06-04 19:19:57,445 - MoETrainer - INFO -   2. ridge_medium: Score=1.080, MAE=$26432, RMSE=$33638, RÂ²=0.036
2025-06-04 19:19:57,445 - MoETrainer - INFO -   3. rf_shallow: Score=1.092, MAE=$27205, RMSE=$33966, RÂ²=0.017
2025-06-04 19:19:57,446 - MoETrainer - INFO - Bin 1: Small bin (785), using rule-based selection
2025-06-04 19:19:58,328 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 19:19:58,329 - MoETrainer - INFO -   1. elastic_light: Score=1.052, MAE=$18603, RMSE=$21178, RÂ²=0.000 [SELECTED]
2025-06-04 19:19:58,329 - MoETrainer - INFO -   2. ridge_medium: Score=1.092, MAE=$18603, RMSE=$21352, RÂ²=-0.016
2025-06-04 19:19:58,330 - MoETrainer - INFO -   3. xgb_conservative: Score=1.103, MAE=$18599, RMSE=$21398, RÂ²=-0.021
2025-06-04 19:19:58,330 - MoETrainer - INFO - Bin 2: Small bin (746), using rule-based selection
2025-06-04 19:19:59,168 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 19:19:59,169 - MoETrainer - INFO -   1. ridge_medium: Score=1.031, MAE=$17096, RMSE=$19548, RÂ²=0.018 [SELECTED]
2025-06-04 19:19:59,169 - MoETrainer - INFO -   2. rf_shallow: Score=1.033, MAE=$17070, RMSE=$19596, RÂ²=0.013
2025-06-04 19:19:59,169 - MoETrainer - INFO -   3. elastic_light: Score=1.038, MAE=$17180, RMSE=$19688, RÂ²=0.004
2025-06-04 19:19:59,171 - MoETrainer - INFO - Bin 3: Small bin (656), using rule-based selection
2025-06-04 19:19:59,964 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 19:19:59,964 - MoETrainer - INFO -   1. ridge_medium: Score=1.019, MAE=$20734, RMSE=$25003, RÂ²=0.045 [SELECTED]
2025-06-04 19:19:59,965 - MoETrainer - INFO -   2. elastic_light: Score=1.034, MAE=$21113, RMSE=$25385, RÂ²=0.016
2025-06-04 19:19:59,965 - MoETrainer - INFO -   3. rf_shallow: Score=1.042, MAE=$21404, RMSE=$25576, RÂ²=0.001
2025-06-04 19:19:59,966 - MoETrainer - INFO - Bin 4: Large bin (804), using CV selection
2025-06-04 19:20:02,705 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 19:20:02,706 - MoETrainer - INFO -   1. ridge_light: MSE=2395203413Â±22381960, RÂ²=0.064 [SELECTED]
2025-06-04 19:20:02,706 - MoETrainer - INFO -   2. ridge_medium: MSE=2398800981Â±21440244, RÂ²=0.062
2025-06-04 19:20:02,707 - MoETrainer - INFO -   3. ridge_heavy: MSE=2402609237Â±17969971, RÂ²=0.061
2025-06-04 19:20:02,707 - MoETrainer - INFO - Bin 5: Small bin (743), using rule-based selection
2025-06-04 19:20:03,628 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 19:20:03,629 - MoETrainer - INFO -   1. rf_shallow: Score=1.093, MAE=$205584, RMSE=$280870, RÂ²=0.209 [SELECTED]
2025-06-04 19:20:03,629 - MoETrainer - INFO -   2. xgb_conservative: Score=1.103, MAE=$208502, RMSE=$283234, RÂ²=0.196
2025-06-04 19:20:03,630 - MoETrainer - INFO -   3. rf_medium: Score=1.104, MAE=$208235, RMSE=$283555, RÂ²=0.194
2025-06-04 19:20:03,630 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:20:03,634 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 668 samples
2025-06-04 19:20:03,637 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 785 samples
2025-06-04 19:20:03,641 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 746 samples
2025-06-04 19:20:03,643 - MoETrainer - INFO - Successfully trained ridge_medium for bin 3: 656 samples
2025-06-04 19:20:03,646 - MoETrainer - INFO - Successfully trained ridge_light for bin 4: 804 samples
2025-06-04 19:20:03,885 - MoETrainer - INFO - Successfully trained rf_shallow for bin 5: 743 samples
2025-06-04 19:20:03,886 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:20:03,920 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:20:03,921 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:20:03,921 - MoETrainer - INFO -   RMSE: $113,471
2025-06-04 19:20:03,921 - MoETrainer - INFO -   MAE: $56,489 (10.3% of mean)
2025-06-04 19:20:03,921 - MoETrainer - INFO -   RÂ²: 0.8357
2025-06-04 19:20:03,922 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-04 19:20:03,922 - MoETrainer - INFO -   MPE: +1.2% (bias: overprediction)
2025-06-04 19:20:03,922 - MoETrainer - INFO -   Median APE: 5.9%
2025-06-04 19:20:03,923 - MoETrainer - INFO -   Within 5%: 41.0% of predictions
2025-06-04 19:20:03,923 - MoETrainer - INFO -   Within 10%: 75.3% of predictions
2025-06-04 19:20:03,924 - MoETrainer - INFO -   Within 15%: 87.7% of predictions
2025-06-04 19:20:03,924 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:20:03,924 - MoETrainer - INFO -   Bin 0: RMSE=$35,730, RÂ²=0.0658, Samples=165
2025-06-04 19:20:03,925 - MoETrainer - INFO -   Bin 1: RMSE=$20,249, RÂ²=-0.0127, Samples=193
2025-06-04 19:20:03,925 - MoETrainer - INFO -   Bin 2: RMSE=$20,524, RÂ²=0.0255, Samples=158
2025-06-04 19:20:03,925 - MoETrainer - INFO -   Bin 3: RMSE=$23,973, RÂ²=-0.0385, Samples=168
2025-06-04 19:20:03,927 - MoETrainer - INFO -   Bin 4: RMSE=$50,243, RÂ²=-0.0350, Samples=209
2025-06-04 19:20:03,927 - MoETrainer - INFO -   Bin 5: RMSE=$251,873, RÂ²=0.1757, Samples=208
2025-06-04 19:20:03,928 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 19:20:03,928 - MoETrainer - INFO -   Bin 0: elastic_light
2025-06-04 19:20:03,928 - MoETrainer - INFO -   Bin 1: elastic_light
2025-06-04 19:20:03,929 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-04 19:20:03,929 - MoETrainer - INFO -   Bin 3: ridge_medium
2025-06-04 19:20:03,929 - MoETrainer - INFO -   Bin 4: ridge_light
2025-06-04 19:20:03,929 - MoETrainer - INFO -   Bin 5: rf_shallow
2025-06-04 19:20:03,930 - MoETrainer - INFO - === FIXED BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 19:20:03,930 - MoETrainer - INFO - Final Test Performance: RÂ² = 0.8357
2025-06-04 19:20:03,930 - MoETrainer - INFO - Final Test RMSE: $113,471
2025-06-04 19:20:03,930 - MoETrainer - INFO - Final Test MAE: $56,489
2025-06-04 19:24:12,022 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 19:24:12,024 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 19:24:12,024 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 19:24:12,859 - MoETrainer - INFO - Raw data shape: (151630, 26)
2025-06-04 19:24:13,500 - MoETrainer - INFO - Final features: 23 (from 27 after consolidation)
2025-06-04 19:24:13,511 - MoETrainer - INFO - Loaded dataset: 151630 samples, 23 features
2025-06-04 19:24:13,513 - MoETrainer - INFO - Target statistics: mean=$409, std=$249
2025-06-04 19:24:13,513 - MoETrainer - INFO - Target range: [$0, $4,900]
2025-06-04 19:24:13,514 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 19:24:13,549 - MoETrainer - INFO - Removed 453 outliers (0.3%)
2025-06-04 19:24:13,563 - MoETrainer - INFO - Applying smart feature selection from 23 features...
2025-06-04 19:25:08,818 - MoETrainer - INFO - Selected 16 features using hybrid selection
2025-06-04 19:25:08,945 - MoETrainer - INFO - Applied robust scaling
2025-06-04 19:25:08,949 - MoETrainer - INFO - Splitting data...
2025-06-04 19:25:09,002 - MoETrainer - INFO - Data split - Train: 98264, Val: 22677, Test: 30236
2025-06-04 19:25:09,003 - MoETrainer - INFO - Train target: mean=$405, std=$229
2025-06-04 19:25:09,004 - MoETrainer - INFO - Test target: mean=$402, std=$226
2025-06-04 19:25:09,005 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 19:25:09,012 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:25:09,013 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:25:09,014 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:25:09,018 - MoETrainer - INFO - Bin 0: Large bin (32691), using CV selection
2025-06-04 19:26:33,857 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:26:33,858 - MoETrainer - INFO -   1. rf_medium: MSE=6Â±0, RÂ²=0.998 [SELECTED]
2025-06-04 19:26:33,858 - MoETrainer - INFO -   2. xgb_balanced: MSE=14Â±0, RÂ²=0.995
2025-06-04 19:26:33,859 - MoETrainer - INFO -   3. rf_shallow: MSE=202Â±14, RÂ²=0.930
2025-06-04 19:26:33,866 - MoETrainer - INFO - Bin 1: Large bin (32483), using CV selection
2025-06-04 19:27:58,302 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:27:58,302 - MoETrainer - INFO -   1. rf_medium: MSE=19Â±1, RÂ²=0.991 [SELECTED]
2025-06-04 19:27:58,302 - MoETrainer - INFO -   2. xgb_balanced: MSE=23Â±3, RÂ²=0.989
2025-06-04 19:27:58,302 - MoETrainer - INFO -   3. ridge_light: MSE=249Â±19, RÂ²=0.877
2025-06-04 19:27:58,310 - MoETrainer - INFO - Bin 2: Large bin (33090), using CV selection
2025-06-04 19:29:26,129 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:29:26,129 - MoETrainer - INFO -   1. rf_medium: MSE=73Â±19, RÂ²=0.998 [SELECTED]
2025-06-04 19:29:26,130 - MoETrainer - INFO -   2. xgb_balanced: MSE=170Â±15, RÂ²=0.996
2025-06-04 19:29:26,130 - MoETrainer - INFO -   3. ridge_light: MSE=2203Â±86, RÂ²=0.954
2025-06-04 19:29:26,133 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:29:57,396 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 32691 samples
2025-06-04 19:30:29,074 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 32483 samples
2025-06-04 19:31:01,476 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 33090 samples
2025-06-04 19:31:01,476 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 19:31:02,103 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:31:02,103 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:31:02,103 - MoETrainer - INFO -   RMSE: $5
2025-06-04 19:31:02,103 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-04 19:31:02,103 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-04 19:31:02,107 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-04 19:31:02,107 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-04 19:31:02,107 - MoETrainer - INFO -   Median APE: 0.3%
2025-06-04 19:31:02,107 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-04 19:31:02,107 - MoETrainer - INFO -   Within 10%: 99.7% of predictions
2025-06-04 19:31:02,107 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-04 19:31:02,107 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:31:02,107 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9988, Samples=10098
2025-06-04 19:31:02,107 - MoETrainer - INFO -   Bin 1: RMSE=$4, RÂ²=0.9913, Samples=10079
2025-06-04 19:31:02,107 - MoETrainer - INFO -   Bin 2: RMSE=$7, RÂ²=0.9990, Samples=10059
2025-06-04 19:31:02,107 - MoETrainer - INFO -   3 bins: RÂ²=0.9996, RMSE=$5
2025-06-04 19:31:02,118 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:31:02,118 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:31:02,118 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:31:02,123 - MoETrainer - INFO - Bin 0: Large bin (24533), using CV selection
2025-06-04 19:32:03,422 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:32:03,422 - MoETrainer - INFO -   1. rf_medium: MSE=6Â±1, RÂ²=0.997 [SELECTED]
2025-06-04 19:32:03,423 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.995
2025-06-04 19:32:03,423 - MoETrainer - INFO -   3. rf_shallow: MSE=150Â±10, RÂ²=0.930
2025-06-04 19:32:03,428 - MoETrainer - INFO - Bin 1: Large bin (24394), using CV selection
2025-06-04 19:33:08,897 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:33:08,897 - MoETrainer - INFO -   1. xgb_balanced: MSE=12Â±1, RÂ²=0.987 [SELECTED]
2025-06-04 19:33:08,897 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±3, RÂ²=0.978
2025-06-04 19:33:08,897 - MoETrainer - INFO -   3. ridge_light: MSE=172Â±11, RÂ²=0.818
2025-06-04 19:33:08,902 - MoETrainer - INFO - Bin 2: Large bin (24366), using CV selection
2025-06-04 19:34:16,045 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:34:16,045 - MoETrainer - INFO -   1. xgb_balanced: MSE=21Â±4, RÂ²=0.987 [SELECTED]
2025-06-04 19:34:16,046 - MoETrainer - INFO -   2. rf_medium: MSE=85Â±7, RÂ²=0.949
2025-06-04 19:34:16,046 - MoETrainer - INFO -   3. ridge_light: MSE=238Â±18, RÂ²=0.858
2025-06-04 19:34:16,051 - MoETrainer - INFO - Bin 3: Large bin (24971), using CV selection
2025-06-04 19:35:24,570 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:35:24,570 - MoETrainer - INFO -   1. rf_medium: MSE=103Â±26, RÂ²=0.998 [SELECTED]
2025-06-04 19:35:24,571 - MoETrainer - INFO -   2. xgb_balanced: MSE=179Â±17, RÂ²=0.996
2025-06-04 19:35:24,571 - MoETrainer - INFO -   3. ridge_light: MSE=2177Â±40, RÂ²=0.955
2025-06-04 19:35:24,571 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:35:47,661 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 24533 samples
2025-06-04 19:35:48,454 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 24394 samples
2025-06-04 19:35:49,246 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 24366 samples
2025-06-04 19:36:14,615 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 24971 samples
2025-06-04 19:36:14,616 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 19:36:15,012 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:36:15,012 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:36:15,013 - MoETrainer - INFO -   RMSE: $5
2025-06-04 19:36:15,013 - MoETrainer - INFO -   MAE: $3 (0.6% of mean)
2025-06-04 19:36:15,014 - MoETrainer - INFO -   RÂ²: 0.9995
2025-06-04 19:36:15,014 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-04 19:36:15,014 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-04 19:36:15,015 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-04 19:36:15,015 - MoETrainer - INFO -   Within 5%: 99.4% of predictions
2025-06-04 19:36:15,015 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-04 19:36:15,016 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-04 19:36:15,016 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:36:15,017 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9983, Samples=7643
2025-06-04 19:36:15,017 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9888, Samples=7560
2025-06-04 19:36:15,017 - MoETrainer - INFO -   Bin 2: RMSE=$5, RÂ²=0.9871, Samples=7457
2025-06-04 19:36:15,019 - MoETrainer - INFO -   Bin 3: RMSE=$8, RÂ²=0.9987, Samples=7576
2025-06-04 19:36:15,019 - MoETrainer - INFO -   4 bins: RÂ²=0.9995, RMSE=$5
2025-06-04 19:36:15,027 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:36:15,027 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:36:15,028 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:36:15,032 - MoETrainer - INFO - Bin 0: Large bin (19436), using CV selection
2025-06-04 19:37:06,348 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:37:06,348 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±2, RÂ²=0.996 [SELECTED]
2025-06-04 19:37:06,349 - MoETrainer - INFO -   2. xgb_balanced: MSE=11Â±3, RÂ²=0.994
2025-06-04 19:37:06,349 - MoETrainer - INFO -   3. xgb_conservative: MSE=157Â±4, RÂ²=0.910
2025-06-04 19:37:06,354 - MoETrainer - INFO - Bin 1: Large bin (19643), using CV selection
2025-06-04 19:37:58,317 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:37:58,318 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±0, RÂ²=0.982 [SELECTED]
2025-06-04 19:37:58,318 - MoETrainer - INFO -   2. rf_medium: MSE=23Â±2, RÂ²=0.962
2025-06-04 19:37:58,319 - MoETrainer - INFO -   3. ridge_light: MSE=148Â±10, RÂ²=0.752
2025-06-04 19:37:58,325 - MoETrainer - INFO - Bin 2: Large bin (19871), using CV selection
2025-06-04 19:38:54,224 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:38:54,224 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±0, RÂ²=0.981 [SELECTED]
2025-06-04 19:38:54,225 - MoETrainer - INFO -   2. rf_medium: MSE=55Â±1, RÂ²=0.928
2025-06-04 19:38:54,225 - MoETrainer - INFO -   3. ridge_light: MSE=164Â±4, RÂ²=0.785
2025-06-04 19:38:54,234 - MoETrainer - INFO - Bin 3: Large bin (19631), using CV selection
2025-06-04 19:39:48,804 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:39:48,805 - MoETrainer - INFO -   1. xgb_balanced: MSE=26Â±2, RÂ²=0.984 [SELECTED]
2025-06-04 19:39:48,805 - MoETrainer - INFO -   2. rf_medium: MSE=118Â±24, RÂ²=0.929
2025-06-04 19:39:48,806 - MoETrainer - INFO -   3. ridge_light: MSE=252Â±10, RÂ²=0.849
2025-06-04 19:39:48,810 - MoETrainer - INFO - Bin 4: Large bin (19683), using CV selection
2025-06-04 19:40:44,094 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 19:40:44,094 - MoETrainer - INFO -   1. rf_medium: MSE=110Â±14, RÂ²=0.998 [SELECTED]
2025-06-04 19:40:44,095 - MoETrainer - INFO -   2. xgb_balanced: MSE=189Â±15, RÂ²=0.996
2025-06-04 19:40:44,095 - MoETrainer - INFO -   3. ridge_light: MSE=2151Â±85, RÂ²=0.956
2025-06-04 19:40:44,096 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:41:03,355 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 19436 samples
2025-06-04 19:41:04,020 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 19643 samples
2025-06-04 19:41:04,699 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 19871 samples
2025-06-04 19:41:05,387 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 19631 samples
2025-06-04 19:41:25,512 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 19683 samples
2025-06-04 19:41:25,512 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 19:41:25,881 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:41:25,881 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:41:25,881 - MoETrainer - INFO -   RMSE: $5
2025-06-04 19:41:25,881 - MoETrainer - INFO -   MAE: $3 (0.6% of mean)
2025-06-04 19:41:25,883 - MoETrainer - INFO -   RÂ²: 0.9995
2025-06-04 19:41:25,883 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-04 19:41:25,884 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-04 19:41:25,884 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-04 19:41:25,884 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-04 19:41:25,885 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-04 19:41:25,885 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-04 19:41:25,885 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:41:25,886 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=6015
2025-06-04 19:41:25,887 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9867, Samples=6119
2025-06-04 19:41:25,887 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9849, Samples=6123
2025-06-04 19:41:25,888 - MoETrainer - INFO -   Bin 3: RMSE=$5, RÂ²=0.9860, Samples=6087
2025-06-04 19:41:25,888 - MoETrainer - INFO -   Bin 4: RMSE=$9, RÂ²=0.9983, Samples=5892
2025-06-04 19:41:25,894 - MoETrainer - INFO -   5 bins: RÂ²=0.9995, RMSE=$5
2025-06-04 19:41:25,905 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:41:25,906 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:41:25,906 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:41:25,910 - MoETrainer - INFO - Bin 0: Large bin (16200), using CV selection
2025-06-04 19:42:09,861 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:42:09,861 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±1, RÂ²=0.996 [SELECTED]
2025-06-04 19:42:09,861 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.994
2025-06-04 19:42:09,862 - MoETrainer - INFO -   3. xgb_conservative: MSE=141Â±1, RÂ²=0.909
2025-06-04 19:42:09,865 - MoETrainer - INFO - Bin 1: Large bin (16491), using CV selection
2025-06-04 19:42:54,586 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:42:54,587 - MoETrainer - INFO -   1. xgb_balanced: MSE=9Â±0, RÂ²=0.978 [SELECTED]
2025-06-04 19:42:54,587 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±1, RÂ²=0.955
2025-06-04 19:42:54,588 - MoETrainer - INFO -   3. ridge_light: MSE=124Â±13, RÂ²=0.712
2025-06-04 19:42:54,592 - MoETrainer - INFO - Bin 2: Large bin (16236), using CV selection
2025-06-04 19:43:37,658 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:43:37,659 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±1, RÂ²=0.973 [SELECTED]
2025-06-04 19:43:37,659 - MoETrainer - INFO -   2. rf_medium: MSE=45Â±2, RÂ²=0.896
2025-06-04 19:43:37,659 - MoETrainer - INFO -   3. ridge_light: MSE=146Â±17, RÂ²=0.658
2025-06-04 19:43:37,663 - MoETrainer - INFO - Bin 3: Large bin (16247), using CV selection
2025-06-04 19:44:20,420 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:44:20,420 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±1, RÂ²=0.975 [SELECTED]
2025-06-04 19:44:20,420 - MoETrainer - INFO -   2. rf_medium: MSE=53Â±1, RÂ²=0.911
2025-06-04 19:44:20,420 - MoETrainer - INFO -   3. ridge_light: MSE=165Â±10, RÂ²=0.720
2025-06-04 19:44:20,424 - MoETrainer - INFO - Bin 4: Large bin (16704), using CV selection
2025-06-04 19:45:04,303 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 19:45:04,304 - MoETrainer - INFO -   1. xgb_balanced: MSE=28Â±2, RÂ²=0.983 [SELECTED]
2025-06-04 19:45:04,304 - MoETrainer - INFO -   2. rf_medium: MSE=108Â±27, RÂ²=0.935
2025-06-04 19:45:04,304 - MoETrainer - INFO -   3. ridge_light: MSE=267Â±1, RÂ²=0.840
2025-06-04 19:45:04,310 - MoETrainer - INFO - Bin 5: Large bin (16386), using CV selection
2025-06-04 19:45:47,510 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-04 19:45:47,510 - MoETrainer - INFO -   1. rf_medium: MSE=138Â±67, RÂ²=0.997 [SELECTED]
2025-06-04 19:45:47,511 - MoETrainer - INFO -   2. xgb_balanced: MSE=204Â±26, RÂ²=0.996
2025-06-04 19:45:47,511 - MoETrainer - INFO -   3. ridge_light: MSE=2128Â±36, RÂ²=0.957
2025-06-04 19:45:47,512 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:46:02,527 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 16200 samples
2025-06-04 19:46:03,115 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 16491 samples
2025-06-04 19:46:03,708 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 16236 samples
2025-06-04 19:46:04,285 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 16247 samples
2025-06-04 19:46:04,887 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 4: 16704 samples
2025-06-04 19:46:20,870 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 16386 samples
2025-06-04 19:46:20,871 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:46:21,204 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:46:21,204 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:46:21,204 - MoETrainer - INFO -   RMSE: $5
2025-06-04 19:46:21,205 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-04 19:46:21,205 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-04 19:46:21,205 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-04 19:46:21,205 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-04 19:46:21,207 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-04 19:46:21,207 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-04 19:46:21,207 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-04 19:46:21,207 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-04 19:46:21,208 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:46:21,208 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=5079
2025-06-04 19:46:21,208 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9839, Samples=5019
2025-06-04 19:46:21,209 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9794, Samples=5105
2025-06-04 19:46:21,209 - MoETrainer - INFO -   Bin 3: RMSE=$4, RÂ²=0.9787, Samples=4974
2025-06-04 19:46:21,209 - MoETrainer - INFO -   Bin 4: RMSE=$5, RÂ²=0.9844, Samples=5181
2025-06-04 19:46:21,210 - MoETrainer - INFO -   Bin 5: RMSE=$9, RÂ²=0.9984, Samples=4878
2025-06-04 19:46:21,228 - MoETrainer - INFO -   6 bins: RÂ²=0.9996, RMSE=$5
2025-06-04 19:46:21,229 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 19:46:21,229 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 19:46:21,240 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 19:46:21,242 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 19:46:21,243 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 19:46:21,251 - MoETrainer - INFO - Bin 0: Large bin (16200), using CV selection
2025-06-04 19:47:03,692 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 19:47:03,693 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±1, RÂ²=0.996 [SELECTED]
2025-06-04 19:47:03,693 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.994
2025-06-04 19:47:03,693 - MoETrainer - INFO -   3. xgb_conservative: MSE=141Â±1, RÂ²=0.909
2025-06-04 19:47:03,698 - MoETrainer - INFO - Bin 1: Large bin (16491), using CV selection
2025-06-04 19:47:49,299 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 19:47:49,299 - MoETrainer - INFO -   1. xgb_balanced: MSE=9Â±0, RÂ²=0.978 [SELECTED]
2025-06-04 19:47:49,300 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±1, RÂ²=0.955
2025-06-04 19:47:49,300 - MoETrainer - INFO -   3. ridge_light: MSE=124Â±13, RÂ²=0.712
2025-06-04 19:47:49,304 - MoETrainer - INFO - Bin 2: Large bin (16236), using CV selection
2025-06-04 19:48:34,755 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 19:48:34,755 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±1, RÂ²=0.973 [SELECTED]
2025-06-04 19:48:34,756 - MoETrainer - INFO -   2. rf_medium: MSE=45Â±2, RÂ²=0.896
2025-06-04 19:48:34,756 - MoETrainer - INFO -   3. ridge_light: MSE=146Â±17, RÂ²=0.658
2025-06-04 19:48:34,761 - MoETrainer - INFO - Bin 3: Large bin (16247), using CV selection
2025-06-04 19:49:21,720 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 19:49:21,721 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±1, RÂ²=0.975 [SELECTED]
2025-06-04 19:49:21,721 - MoETrainer - INFO -   2. rf_medium: MSE=53Â±1, RÂ²=0.911
2025-06-04 19:49:21,721 - MoETrainer - INFO -   3. ridge_light: MSE=165Â±10, RÂ²=0.720
2025-06-04 19:49:21,729 - MoETrainer - INFO - Bin 4: Large bin (16704), using CV selection
2025-06-04 19:50:07,112 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 19:50:07,112 - MoETrainer - INFO -   1. xgb_balanced: MSE=28Â±2, RÂ²=0.983 [SELECTED]
2025-06-04 19:50:07,113 - MoETrainer - INFO -   2. rf_medium: MSE=108Â±27, RÂ²=0.935
2025-06-04 19:50:07,113 - MoETrainer - INFO -   3. ridge_light: MSE=267Â±1, RÂ²=0.840
2025-06-04 19:50:07,117 - MoETrainer - INFO - Bin 5: Large bin (16386), using CV selection
2025-06-04 19:50:58,441 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-04 19:50:58,442 - MoETrainer - INFO -   1. rf_medium: MSE=138Â±67, RÂ²=0.997 [SELECTED]
2025-06-04 19:50:58,442 - MoETrainer - INFO -   2. xgb_balanced: MSE=204Â±26, RÂ²=0.996
2025-06-04 19:50:58,442 - MoETrainer - INFO -   3. ridge_light: MSE=2128Â±36, RÂ²=0.957
2025-06-04 19:50:58,444 - MoETrainer - INFO - Training selected expert models...
2025-06-04 19:51:15,181 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 16200 samples
2025-06-04 19:51:15,785 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 16491 samples
2025-06-04 19:51:16,390 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 16236 samples
2025-06-04 19:51:16,986 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 16247 samples
2025-06-04 19:51:17,654 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 4: 16704 samples
2025-06-04 19:51:34,596 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 16386 samples
2025-06-04 19:51:34,598 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 19:51:34,941 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 19:51:34,943 - MoETrainer - INFO - Overall Performance:
2025-06-04 19:51:34,943 - MoETrainer - INFO -   RMSE: $5
2025-06-04 19:51:34,943 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-04 19:51:34,943 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-04 19:51:34,943 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-04 19:51:34,945 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-04 19:51:34,945 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-04 19:51:34,945 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-04 19:51:34,945 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-04 19:51:34,945 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-04 19:51:34,947 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 19:51:34,947 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=5079
2025-06-04 19:51:34,947 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9839, Samples=5019
2025-06-04 19:51:34,949 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9794, Samples=5105
2025-06-04 19:51:34,949 - MoETrainer - INFO -   Bin 3: RMSE=$4, RÂ²=0.9787, Samples=4974
2025-06-04 19:51:34,949 - MoETrainer - INFO -   Bin 4: RMSE=$5, RÂ²=0.9844, Samples=5181
2025-06-04 19:51:34,951 - MoETrainer - INFO -   Bin 5: RMSE=$9, RÂ²=0.9984, Samples=4878
2025-06-04 19:51:34,951 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 19:51:34,951 - MoETrainer - INFO -   Bin 0: rf_medium
2025-06-04 19:51:34,951 - MoETrainer - INFO -   Bin 1: xgb_balanced
2025-06-04 19:51:34,951 - MoETrainer - INFO -   Bin 2: xgb_balanced
2025-06-04 19:51:34,951 - MoETrainer - INFO -   Bin 3: xgb_balanced
2025-06-04 19:51:34,953 - MoETrainer - INFO -   Bin 4: xgb_balanced
2025-06-04 19:51:34,953 - MoETrainer - INFO -   Bin 5: rf_medium
2025-06-04 19:51:34,953 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 19:51:34,953 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 19:51:34,953 - MoETrainer - INFO - Final Performance: RÂ² = 0.9996
2025-06-04 19:51:34,955 - MoETrainer - INFO - Final RMSE: $5
2025-06-04 19:51:34,955 - MoETrainer - INFO - Final MAE: $2
2025-06-04 20:13:15,746 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 20:13:15,746 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 20:13:15,747 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 20:13:15,858 - MoETrainer - INFO - Raw data shape: (31552, 8)
2025-06-04 20:13:15,911 - MoETrainer - INFO - Final features: 6 (from 9 after consolidation)
2025-06-04 20:13:15,912 - MoETrainer - INFO - Loaded dataset: 31552 samples, 6 features
2025-06-04 20:13:15,913 - MoETrainer - INFO - Target statistics: mean=$1,591,281, std=$2,257,401
2025-06-04 20:13:15,913 - MoETrainer - INFO - Target range: [$308, $130,000,000]
2025-06-04 20:13:15,914 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 20:13:15,919 - MoETrainer - INFO - Removed 436 outliers (1.4%)
2025-06-04 20:13:15,937 - MoETrainer - INFO - Applied robust scaling
2025-06-04 20:13:15,937 - MoETrainer - INFO - Splitting data...
2025-06-04 20:13:15,948 - MoETrainer - INFO - Data split - Train: 20224, Val: 4668, Test: 6224
2025-06-04 20:13:15,949 - MoETrainer - INFO - Train target: mean=$1,414,128, std=$1,409,259
2025-06-04 20:13:15,950 - MoETrainer - INFO - Test target: mean=$1,414,206, std=$1,385,573
2025-06-04 20:13:15,951 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 20:13:15,953 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:13:15,954 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:13:15,954 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:13:15,956 - MoETrainer - INFO - Bin 0: Large bin (6736), using CV selection
2025-06-04 20:13:19,904 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:13:19,904 - MoETrainer - INFO -   1. rf_medium: MSE=10374151053Â±516409817, RÂ²=0.333 [SELECTED]
2025-06-04 20:13:19,904 - MoETrainer - INFO -   2. xgb_balanced: MSE=10587052373Â±454014317, RÂ²=0.319
2025-06-04 20:13:19,904 - MoETrainer - INFO -   3. xgb_conservative: MSE=11232668672Â±449491875, RÂ²=0.278
2025-06-04 20:13:19,906 - MoETrainer - INFO - Bin 1: Large bin (6720), using CV selection
2025-06-04 20:13:24,581 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:13:24,582 - MoETrainer - INFO -   1. rf_medium: MSE=24616029701Â±791319876, RÂ²=0.400 [SELECTED]
2025-06-04 20:13:24,582 - MoETrainer - INFO -   2. xgb_balanced: MSE=25374149973Â±688351770, RÂ²=0.382
2025-06-04 20:13:24,582 - MoETrainer - INFO -   3. rf_shallow: MSE=29307866992Â±577344395, RÂ²=0.286
2025-06-04 20:13:24,584 - MoETrainer - INFO - Bin 2: Large bin (6768), using CV selection
2025-06-04 20:13:30,125 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:13:30,125 - MoETrainer - INFO -   1. rf_medium: MSE=941147748385Â±49287490561, RÂ²=0.652 [SELECTED]
2025-06-04 20:13:30,126 - MoETrainer - INFO -   2. xgb_balanced: MSE=993220711765Â±45340632104, RÂ²=0.633
2025-06-04 20:13:30,126 - MoETrainer - INFO -   3. rf_shallow: MSE=1119114486419Â±48144685695, RÂ²=0.586
2025-06-04 20:13:30,126 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:13:31,035 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 6736 samples
2025-06-04 20:13:32,187 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 6720 samples
2025-06-04 20:13:33,669 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 6768 samples
2025-06-04 20:13:33,670 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 20:13:33,810 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:13:33,811 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:13:33,811 - MoETrainer - INFO -   RMSE: $581,160
2025-06-04 20:13:33,811 - MoETrainer - INFO -   MAE: $278,471 (19.7% of mean)
2025-06-04 20:13:33,812 - MoETrainer - INFO -   RÂ²: 0.8241
2025-06-04 20:13:33,812 - MoETrainer - INFO -   MAPE: 161.8%
2025-06-04 20:13:33,812 - MoETrainer - INFO -   MPE: +150.0% (bias: overprediction)
2025-06-04 20:13:33,812 - MoETrainer - INFO -   Median APE: 12.2%
2025-06-04 20:13:33,814 - MoETrainer - INFO -   Within 5%: 22.8% of predictions
2025-06-04 20:13:33,814 - MoETrainer - INFO -   Within 10%: 42.4% of predictions
2025-06-04 20:13:33,814 - MoETrainer - INFO -   Within 15%: 58.3% of predictions
2025-06-04 20:13:33,815 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:13:33,815 - MoETrainer - INFO -   Bin 0: RMSE=$98,059, RÂ²=0.3894, Samples=2016
2025-06-04 20:13:33,815 - MoETrainer - INFO -   Bin 1: RMSE=$153,090, RÂ²=0.4247, Samples=2084
2025-06-04 20:13:33,816 - MoETrainer - INFO -   Bin 2: RMSE=$978,563, RÂ²=0.6210, Samples=2124
2025-06-04 20:13:33,816 - MoETrainer - INFO -   3 bins: RÂ²=0.8241, RMSE=$581,160
2025-06-04 20:13:33,818 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:13:33,820 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:13:33,820 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:13:33,823 - MoETrainer - INFO - Bin 0: Large bin (5051), using CV selection
2025-06-04 20:13:36,703 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:13:36,704 - MoETrainer - INFO -   1. xgb_balanced: MSE=8116492971Â±890160103, RÂ²=0.318 [SELECTED]
2025-06-04 20:13:36,704 - MoETrainer - INFO -   2. rf_medium: MSE=8232837095Â±930142809, RÂ²=0.308
2025-06-04 20:13:36,704 - MoETrainer - INFO -   3. xgb_conservative: MSE=8894861312Â±838153712, RÂ²=0.253
2025-06-04 20:13:36,705 - MoETrainer - INFO - Bin 1: Large bin (5057), using CV selection
2025-06-04 20:13:39,879 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:13:39,880 - MoETrainer - INFO -   1. rf_medium: MSE=6374853222Â±67720440, RÂ²=0.278 [SELECTED]
2025-06-04 20:13:39,880 - MoETrainer - INFO -   2. xgb_balanced: MSE=6580055040Â±42758768, RÂ²=0.255
2025-06-04 20:13:39,881 - MoETrainer - INFO -   3. rf_shallow: MSE=7505239010Â±37473169, RÂ²=0.150
2025-06-04 20:13:39,882 - MoETrainer - INFO - Bin 2: Large bin (5056), using CV selection
2025-06-04 20:13:43,370 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:13:43,371 - MoETrainer - INFO -   1. rf_medium: MSE=30856532800Â±558245789, RÂ²=0.344 [SELECTED]
2025-06-04 20:13:43,371 - MoETrainer - INFO -   2. xgb_balanced: MSE=31065001301Â±1030184500, RÂ²=0.339
2025-06-04 20:13:43,371 - MoETrainer - INFO -   3. rf_shallow: MSE=36881983131Â±754456188, RÂ²=0.216
2025-06-04 20:13:43,372 - MoETrainer - INFO - Bin 3: Large bin (5060), using CV selection
2025-06-04 20:13:47,500 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:13:47,500 - MoETrainer - INFO -   1. rf_medium: MSE=1071426447210Â±24225210246, RÂ²=0.615 [SELECTED]
2025-06-04 20:13:47,500 - MoETrainer - INFO -   2. xgb_balanced: MSE=1126234324992Â±27289550808, RÂ²=0.595
2025-06-04 20:13:47,500 - MoETrainer - INFO -   3. rf_shallow: MSE=1286762025719Â±32479737133, RÂ²=0.538
2025-06-04 20:13:47,501 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:13:47,640 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 0: 5051 samples
2025-06-04 20:13:48,462 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 5057 samples
2025-06-04 20:13:49,409 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 5056 samples
2025-06-04 20:13:50,585 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 5060 samples
2025-06-04 20:13:50,585 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 20:13:50,729 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:13:50,729 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:13:50,729 - MoETrainer - INFO -   RMSE: $540,531
2025-06-04 20:13:50,729 - MoETrainer - INFO -   MAE: $242,178 (17.1% of mean)
2025-06-04 20:13:50,729 - MoETrainer - INFO -   RÂ²: 0.8478
2025-06-04 20:13:50,729 - MoETrainer - INFO -   MAPE: 141.6%
2025-06-04 20:13:50,729 - MoETrainer - INFO -   MPE: +130.7% (bias: overprediction)
2025-06-04 20:13:50,729 - MoETrainer - INFO -   Median APE: 10.0%
2025-06-04 20:13:50,729 - MoETrainer - INFO -   Within 5%: 27.2% of predictions
2025-06-04 20:13:50,732 - MoETrainer - INFO -   Within 10%: 50.2% of predictions
2025-06-04 20:13:50,732 - MoETrainer - INFO -   Within 15%: 67.6% of predictions
2025-06-04 20:13:50,732 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:13:50,732 - MoETrainer - INFO -   Bin 0: RMSE=$90,693, RÂ²=0.3250, Samples=1537
2025-06-04 20:13:50,732 - MoETrainer - INFO -   Bin 1: RMSE=$78,816, RÂ²=0.3097, Samples=1560
2025-06-04 20:13:50,732 - MoETrainer - INFO -   Bin 2: RMSE=$175,196, RÂ²=0.3528, Samples=1554
2025-06-04 20:13:50,732 - MoETrainer - INFO -   Bin 3: RMSE=$1,054,299, RÂ²=0.5699, Samples=1573
2025-06-04 20:13:50,736 - MoETrainer - INFO -   4 bins: RÂ²=0.8478, RMSE=$540,531
2025-06-04 20:13:50,741 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:13:50,741 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:13:50,741 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:13:50,743 - MoETrainer - INFO - Bin 0: Large bin (4041), using CV selection
2025-06-04 20:13:53,364 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:13:53,364 - MoETrainer - INFO -   1. rf_medium: MSE=7683551813Â±361725411, RÂ²=0.277 [SELECTED]
2025-06-04 20:13:53,364 - MoETrainer - INFO -   2. xgb_balanced: MSE=7891588608Â±338824327, RÂ²=0.257
2025-06-04 20:13:53,365 - MoETrainer - INFO -   3. xgb_conservative: MSE=8108096512Â±195216289, RÂ²=0.237
2025-06-04 20:13:53,365 - MoETrainer - INFO - Bin 1: Large bin (4048), using CV selection
2025-06-04 20:13:56,098 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:13:56,098 - MoETrainer - INFO -   1. rf_medium: MSE=2701374526Â±118006830, RÂ²=0.251 [SELECTED]
2025-06-04 20:13:56,098 - MoETrainer - INFO -   2. xgb_balanced: MSE=2753670997Â±97783122, RÂ²=0.237
2025-06-04 20:13:56,098 - MoETrainer - INFO -   3. rf_shallow: MSE=3064693663Â±79924169, RÂ²=0.150
2025-06-04 20:13:56,100 - MoETrainer - INFO - Bin 2: Large bin (3939), using CV selection
2025-06-04 20:13:58,968 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:13:58,969 - MoETrainer - INFO -   1. rf_medium: MSE=9501520778Â±285984463, RÂ²=0.322 [SELECTED]
2025-06-04 20:13:58,969 - MoETrainer - INFO -   2. xgb_balanced: MSE=9648234837Â±394451175, RÂ²=0.311
2025-06-04 20:13:58,969 - MoETrainer - INFO -   3. rf_shallow: MSE=10868224596Â±414658601, RÂ²=0.224
2025-06-04 20:13:58,970 - MoETrainer - INFO - Bin 3: Large bin (4146), using CV selection
2025-06-04 20:14:02,134 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:14:02,135 - MoETrainer - INFO -   1. rf_medium: MSE=37605444382Â±2155527852, RÂ²=0.318 [SELECTED]
2025-06-04 20:14:02,135 - MoETrainer - INFO -   2. xgb_balanced: MSE=38224938325Â±2518902700, RÂ²=0.307
2025-06-04 20:14:02,135 - MoETrainer - INFO -   3. rf_shallow: MSE=44252660086Â±1575674120, RÂ²=0.198
2025-06-04 20:14:02,136 - MoETrainer - INFO - Bin 4: Large bin (4050), using CV selection
2025-06-04 20:14:05,745 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:14:05,746 - MoETrainer - INFO -   1. rf_medium: MSE=1230837544886Â±45138929096, RÂ²=0.558 [SELECTED]
2025-06-04 20:14:05,746 - MoETrainer - INFO -   2. xgb_balanced: MSE=1272225595392Â±16750103505, RÂ²=0.544
2025-06-04 20:14:05,746 - MoETrainer - INFO -   3. rf_shallow: MSE=1408481592623Â±26038616520, RÂ²=0.495
2025-06-04 20:14:05,748 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:14:06,365 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 4041 samples
2025-06-04 20:14:07,047 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 4048 samples
2025-06-04 20:14:07,780 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 3939 samples
2025-06-04 20:14:08,648 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 4146 samples
2025-06-04 20:14:09,653 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 4050 samples
2025-06-04 20:14:09,653 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 20:14:09,849 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:14:09,850 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:14:09,850 - MoETrainer - INFO -   RMSE: $506,818
2025-06-04 20:14:09,850 - MoETrainer - INFO -   MAE: $214,679 (15.2% of mean)
2025-06-04 20:14:09,851 - MoETrainer - INFO -   RÂ²: 0.8662
2025-06-04 20:14:09,851 - MoETrainer - INFO -   MAPE: 126.9%
2025-06-04 20:14:09,851 - MoETrainer - INFO -   MPE: +117.6% (bias: overprediction)
2025-06-04 20:14:09,851 - MoETrainer - INFO -   Median APE: 8.2%
2025-06-04 20:14:09,853 - MoETrainer - INFO -   Within 5%: 32.2% of predictions
2025-06-04 20:14:09,853 - MoETrainer - INFO -   Within 10%: 58.1% of predictions
2025-06-04 20:14:09,853 - MoETrainer - INFO -   Within 15%: 75.5% of predictions
2025-06-04 20:14:09,854 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:14:09,854 - MoETrainer - INFO -   Bin 0: RMSE=$84,026, RÂ²=0.3474, Samples=1242
2025-06-04 20:14:09,854 - MoETrainer - INFO -   Bin 1: RMSE=$53,047, RÂ²=0.2492, Samples=1224
2025-06-04 20:14:09,854 - MoETrainer - INFO -   Bin 2: RMSE=$96,864, RÂ²=0.3525, Samples=1230
2025-06-04 20:14:09,855 - MoETrainer - INFO -   Bin 3: RMSE=$184,671, RÂ²=0.3641, Samples=1274
2025-06-04 20:14:09,855 - MoETrainer - INFO -   Bin 4: RMSE=$1,105,128, RÂ²=0.5233, Samples=1254
2025-06-04 20:14:09,859 - MoETrainer - INFO -   5 bins: RÂ²=0.8662, RMSE=$506,818
2025-06-04 20:14:09,861 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:14:09,862 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:14:09,863 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:14:09,864 - MoETrainer - INFO - Bin 0: Large bin (3324), using CV selection
2025-06-04 20:14:12,166 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:14:12,166 - MoETrainer - INFO -   1. rf_medium: MSE=7652600285Â±184920724, RÂ²=0.238 [SELECTED]
2025-06-04 20:14:12,166 - MoETrainer - INFO -   2. rf_shallow: MSE=7712457050Â±117694456, RÂ²=0.232
2025-06-04 20:14:12,166 - MoETrainer - INFO -   3. xgb_conservative: MSE=7712822443Â±128952854, RÂ²=0.232
2025-06-04 20:14:12,168 - MoETrainer - INFO - Bin 1: Large bin (3412), using CV selection
2025-06-04 20:14:14,643 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:14:14,644 - MoETrainer - INFO -   1. xgb_balanced: MSE=1846001365Â±36386989, RÂ²=0.248 [SELECTED]
2025-06-04 20:14:14,644 - MoETrainer - INFO -   2. rf_medium: MSE=1853432966Â±55438241, RÂ²=0.245
2025-06-04 20:14:14,644 - MoETrainer - INFO -   3. rf_shallow: MSE=2110198662Â±59337240, RÂ²=0.140
2025-06-04 20:14:14,645 - MoETrainer - INFO - Bin 2: Large bin (3372), using CV selection
2025-06-04 20:14:17,368 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:14:17,368 - MoETrainer - INFO -   1. rf_medium: MSE=4223668656Â±50119580, RÂ²=0.206 [SELECTED]
2025-06-04 20:14:17,368 - MoETrainer - INFO -   2. xgb_balanced: MSE=4327031467Â±27741469, RÂ²=0.187
2025-06-04 20:14:17,368 - MoETrainer - INFO -   3. rf_shallow: MSE=4741053661Â±121242223, RÂ²=0.109
2025-06-04 20:14:17,368 - MoETrainer - INFO - Bin 3: Large bin (3348), using CV selection
2025-06-04 20:14:20,118 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:14:20,118 - MoETrainer - INFO -   1. rf_medium: MSE=12421740679Â±214440548, RÂ²=0.238 [SELECTED]
2025-06-04 20:14:20,118 - MoETrainer - INFO -   2. xgb_balanced: MSE=12720834560Â±415569745, RÂ²=0.219
2025-06-04 20:14:20,118 - MoETrainer - INFO -   3. rf_shallow: MSE=13794579524Â±202356809, RÂ²=0.153
2025-06-04 20:14:20,118 - MoETrainer - INFO - Bin 4: Large bin (3397), using CV selection
2025-06-04 20:14:23,152 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:14:23,152 - MoETrainer - INFO -   1. rf_medium: MSE=50349861901Â±778558832, RÂ²=0.301 [SELECTED]
2025-06-04 20:14:23,154 - MoETrainer - INFO -   2. xgb_balanced: MSE=51196207104Â±295456487, RÂ²=0.290
2025-06-04 20:14:23,154 - MoETrainer - INFO -   3. rf_shallow: MSE=58437001087Â±973428653, RÂ²=0.189
2025-06-04 20:14:23,155 - MoETrainer - INFO - Bin 5: Large bin (3371), using CV selection
2025-06-04 20:14:26,723 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-04 20:14:26,723 - MoETrainer - INFO -   1. rf_medium: MSE=1306169690780Â±31411817821, RÂ²=0.529 [SELECTED]
2025-06-04 20:14:26,723 - MoETrainer - INFO -   2. xgb_balanced: MSE=1370505609216Â±2666661209, RÂ²=0.506
2025-06-04 20:14:26,723 - MoETrainer - INFO -   3. rf_shallow: MSE=1500258610442Â±23145569667, RÂ²=0.459
2025-06-04 20:14:26,723 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:14:27,285 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 3324 samples
2025-06-04 20:14:27,400 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 3412 samples
2025-06-04 20:14:28,208 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 3372 samples
2025-06-04 20:14:28,936 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 3348 samples
2025-06-04 20:14:29,713 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 3397 samples
2025-06-04 20:14:30,596 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 3371 samples
2025-06-04 20:14:30,596 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 20:14:30,778 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:14:30,778 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:14:30,778 - MoETrainer - INFO -   RMSE: $480,683
2025-06-04 20:14:30,778 - MoETrainer - INFO -   MAE: $198,593 (14.0% of mean)
2025-06-04 20:14:30,778 - MoETrainer - INFO -   RÂ²: 0.8796
2025-06-04 20:14:30,778 - MoETrainer - INFO -   MAPE: 117.4%
2025-06-04 20:14:30,780 - MoETrainer - INFO -   MPE: +108.9% (bias: overprediction)
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Median APE: 7.7%
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Within 5%: 34.5% of predictions
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Within 10%: 61.6% of predictions
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Within 15%: 79.5% of predictions
2025-06-04 20:14:30,780 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Bin 0: RMSE=$80,561, RÂ²=0.3623, Samples=1035
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Bin 1: RMSE=$42,646, RÂ²=0.2141, Samples=981
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Bin 2: RMSE=$63,579, RÂ²=0.2623, Samples=1081
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Bin 3: RMSE=$110,591, RÂ²=0.2293, Samples=1003
2025-06-04 20:14:30,780 - MoETrainer - INFO -   Bin 4: RMSE=$221,222, RÂ²=0.3144, Samples=1071
2025-06-04 20:14:30,784 - MoETrainer - INFO -   Bin 5: RMSE=$1,136,690, RÂ²=0.4899, Samples=1053
2025-06-04 20:14:30,788 - MoETrainer - INFO -   6 bins: RÂ²=0.8796, RMSE=$480,683
2025-06-04 20:14:30,789 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 20:14:30,789 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 20:14:30,792 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:14:30,794 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:14:30,794 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:14:30,795 - MoETrainer - INFO - Bin 0: Large bin (3324), using CV selection
2025-06-04 20:14:33,126 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:14:33,126 - MoETrainer - INFO -   1. rf_medium: MSE=7652600285Â±184920724, RÂ²=0.238 [SELECTED]
2025-06-04 20:14:33,127 - MoETrainer - INFO -   2. rf_shallow: MSE=7712457050Â±117694456, RÂ²=0.232
2025-06-04 20:14:33,127 - MoETrainer - INFO -   3. xgb_conservative: MSE=7712822443Â±128952854, RÂ²=0.232
2025-06-04 20:14:33,128 - MoETrainer - INFO - Bin 1: Large bin (3412), using CV selection
2025-06-04 20:14:35,572 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:14:35,572 - MoETrainer - INFO -   1. xgb_balanced: MSE=1846001365Â±36386989, RÂ²=0.248 [SELECTED]
2025-06-04 20:14:35,573 - MoETrainer - INFO -   2. rf_medium: MSE=1853432966Â±55438241, RÂ²=0.245
2025-06-04 20:14:35,573 - MoETrainer - INFO -   3. rf_shallow: MSE=2110198662Â±59337240, RÂ²=0.140
2025-06-04 20:14:35,575 - MoETrainer - INFO - Bin 2: Large bin (3372), using CV selection
2025-06-04 20:14:38,097 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:14:38,098 - MoETrainer - INFO -   1. rf_medium: MSE=4223668656Â±50119580, RÂ²=0.206 [SELECTED]
2025-06-04 20:14:38,098 - MoETrainer - INFO -   2. xgb_balanced: MSE=4327031467Â±27741469, RÂ²=0.187
2025-06-04 20:14:38,098 - MoETrainer - INFO -   3. rf_shallow: MSE=4741053661Â±121242223, RÂ²=0.109
2025-06-04 20:14:38,099 - MoETrainer - INFO - Bin 3: Large bin (3348), using CV selection
2025-06-04 20:14:40,762 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:14:40,762 - MoETrainer - INFO -   1. rf_medium: MSE=12421740679Â±214440548, RÂ²=0.238 [SELECTED]
2025-06-04 20:14:40,763 - MoETrainer - INFO -   2. xgb_balanced: MSE=12720834560Â±415569745, RÂ²=0.219
2025-06-04 20:14:40,764 - MoETrainer - INFO -   3. rf_shallow: MSE=13794579524Â±202356809, RÂ²=0.153
2025-06-04 20:14:40,764 - MoETrainer - INFO - Bin 4: Large bin (3397), using CV selection
2025-06-04 20:14:43,581 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:14:43,582 - MoETrainer - INFO -   1. rf_medium: MSE=50349861901Â±778558832, RÂ²=0.301 [SELECTED]
2025-06-04 20:14:43,582 - MoETrainer - INFO -   2. xgb_balanced: MSE=51196207104Â±295456487, RÂ²=0.290
2025-06-04 20:14:43,582 - MoETrainer - INFO -   3. rf_shallow: MSE=58437001087Â±973428653, RÂ²=0.189
2025-06-04 20:14:43,583 - MoETrainer - INFO - Bin 5: Large bin (3371), using CV selection
2025-06-04 20:14:46,806 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-04 20:14:46,806 - MoETrainer - INFO -   1. rf_medium: MSE=1306169690780Â±31411817821, RÂ²=0.529 [SELECTED]
2025-06-04 20:14:46,807 - MoETrainer - INFO -   2. xgb_balanced: MSE=1370505609216Â±2666661209, RÂ²=0.506
2025-06-04 20:14:46,807 - MoETrainer - INFO -   3. rf_shallow: MSE=1500258610442Â±23145569667, RÂ²=0.459
2025-06-04 20:14:46,807 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:14:47,343 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 3324 samples
2025-06-04 20:14:47,446 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 3412 samples
2025-06-04 20:14:48,065 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 3372 samples
2025-06-04 20:14:48,741 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 3348 samples
2025-06-04 20:14:49,461 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 3397 samples
2025-06-04 20:14:50,317 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 3371 samples
2025-06-04 20:14:50,317 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 20:14:50,498 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:14:50,499 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:14:50,499 - MoETrainer - INFO -   RMSE: $480,683
2025-06-04 20:14:50,500 - MoETrainer - INFO -   MAE: $198,593 (14.0% of mean)
2025-06-04 20:14:50,500 - MoETrainer - INFO -   RÂ²: 0.8796
2025-06-04 20:14:50,500 - MoETrainer - INFO -   MAPE: 117.4%
2025-06-04 20:14:50,501 - MoETrainer - INFO -   MPE: +108.9% (bias: overprediction)
2025-06-04 20:14:50,501 - MoETrainer - INFO -   Median APE: 7.7%
2025-06-04 20:14:50,502 - MoETrainer - INFO -   Within 5%: 34.5% of predictions
2025-06-04 20:14:50,502 - MoETrainer - INFO -   Within 10%: 61.6% of predictions
2025-06-04 20:14:50,502 - MoETrainer - INFO -   Within 15%: 79.5% of predictions
2025-06-04 20:14:50,502 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:14:50,503 - MoETrainer - INFO -   Bin 0: RMSE=$80,561, RÂ²=0.3623, Samples=1035
2025-06-04 20:14:50,503 - MoETrainer - INFO -   Bin 1: RMSE=$42,646, RÂ²=0.2141, Samples=981
2025-06-04 20:14:50,503 - MoETrainer - INFO -   Bin 2: RMSE=$63,579, RÂ²=0.2623, Samples=1081
2025-06-04 20:14:50,504 - MoETrainer - INFO -   Bin 3: RMSE=$110,591, RÂ²=0.2293, Samples=1003
2025-06-04 20:14:50,504 - MoETrainer - INFO -   Bin 4: RMSE=$221,222, RÂ²=0.3144, Samples=1071
2025-06-04 20:14:50,505 - MoETrainer - INFO -   Bin 5: RMSE=$1,136,690, RÂ²=0.4899, Samples=1053
2025-06-04 20:14:50,505 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 20:14:50,505 - MoETrainer - INFO -   Bin 0: rf_medium
2025-06-04 20:14:50,505 - MoETrainer - INFO -   Bin 1: xgb_balanced
2025-06-04 20:14:50,507 - MoETrainer - INFO -   Bin 2: rf_medium
2025-06-04 20:14:50,507 - MoETrainer - INFO -   Bin 3: rf_medium
2025-06-04 20:14:50,507 - MoETrainer - INFO -   Bin 4: rf_medium
2025-06-04 20:14:50,508 - MoETrainer - INFO -   Bin 5: rf_medium
2025-06-04 20:14:50,508 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 20:14:50,509 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 20:14:50,509 - MoETrainer - INFO - Final Performance: RÂ² = 0.8796
2025-06-04 20:14:50,509 - MoETrainer - INFO - Final RMSE: $480,683
2025-06-04 20:14:50,510 - MoETrainer - INFO - Final MAE: $198,593
2025-06-04 20:18:44,737 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 20:18:44,738 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 20:18:44,738 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 20:18:44,779 - MoETrainer - INFO - Raw data shape: (31513, 5)
2025-06-04 20:18:44,804 - MoETrainer - INFO - Final features: 6 (from 6 after consolidation)
2025-06-04 20:18:44,807 - MoETrainer - INFO - Loaded dataset: 31513 samples, 6 features
2025-06-04 20:18:44,810 - MoETrainer - INFO - Target statistics: mean=$1,591,437, std=$2,258,463
2025-06-04 20:18:44,811 - MoETrainer - INFO - Target range: [$308, $130,000,000]
2025-06-04 20:18:44,811 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 20:18:44,815 - MoETrainer - INFO - Removed 436 outliers (1.4%)
2025-06-04 20:18:44,832 - MoETrainer - INFO - Applied robust scaling
2025-06-04 20:18:44,839 - MoETrainer - INFO - Splitting data...
2025-06-04 20:18:44,851 - MoETrainer - INFO - Data split - Train: 20199, Val: 4662, Test: 6216
2025-06-04 20:18:44,852 - MoETrainer - INFO - Train target: mean=$1,417,919, std=$1,398,547
2025-06-04 20:18:44,858 - MoETrainer - INFO - Test target: mean=$1,405,214, std=$1,394,312
2025-06-04 20:18:44,860 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 20:18:44,865 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:18:44,865 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:18:44,866 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:18:44,867 - MoETrainer - INFO - Bin 0: Large bin (6664), using CV selection
2025-06-04 20:18:49,381 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:18:49,382 - MoETrainer - INFO -   1. rf_medium: MSE=10207313100Â±648841232, RÂ²=0.344 [SELECTED]
2025-06-04 20:18:49,382 - MoETrainer - INFO -   2. xgb_balanced: MSE=10248993109Â±628479391, RÂ²=0.341
2025-06-04 20:18:49,383 - MoETrainer - INFO -   3. xgb_conservative: MSE=11234123435Â±642700118, RÂ²=0.278
2025-06-04 20:18:49,384 - MoETrainer - INFO - Bin 1: Large bin (6699), using CV selection
2025-06-04 20:18:53,762 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:18:53,763 - MoETrainer - INFO -   1. rf_medium: MSE=25110139024Â±373735643, RÂ²=0.398 [SELECTED]
2025-06-04 20:18:53,763 - MoETrainer - INFO -   2. xgb_balanced: MSE=25817161045Â±460558125, RÂ²=0.381
2025-06-04 20:18:53,764 - MoETrainer - INFO -   3. xgb_conservative: MSE=29777381376Â±55537934, RÂ²=0.286
2025-06-04 20:18:53,765 - MoETrainer - INFO - Bin 2: Large bin (6836), using CV selection
2025-06-04 20:18:58,803 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:18:58,805 - MoETrainer - INFO -   1. rf_medium: MSE=946351248963Â±29933152977, RÂ²=0.637 [SELECTED]
2025-06-04 20:18:58,806 - MoETrainer - INFO -   2. xgb_balanced: MSE=1012577949013Â±26023178347, RÂ²=0.612
2025-06-04 20:18:58,806 - MoETrainer - INFO -   3. rf_shallow: MSE=1111457662345Â±19939514013, RÂ²=0.574
2025-06-04 20:18:58,806 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:18:59,665 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 6664 samples
2025-06-04 20:19:00,773 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 6699 samples
2025-06-04 20:19:02,197 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 6836 samples
2025-06-04 20:19:02,198 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 20:19:02,343 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:19:02,344 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:19:02,344 - MoETrainer - INFO -   RMSE: $541,267
2025-06-04 20:19:02,345 - MoETrainer - INFO -   MAE: $261,988 (18.6% of mean)
2025-06-04 20:19:02,345 - MoETrainer - INFO -   RÂ²: 0.8493
2025-06-04 20:19:02,347 - MoETrainer - INFO -   MAPE: 133.7%
2025-06-04 20:19:02,347 - MoETrainer - INFO -   MPE: +121.6% (bias: overprediction)
2025-06-04 20:19:02,347 - MoETrainer - INFO -   Median APE: 11.8%
2025-06-04 20:19:02,348 - MoETrainer - INFO -   Within 5%: 23.6% of predictions
2025-06-04 20:19:02,348 - MoETrainer - INFO -   Within 10%: 43.6% of predictions
2025-06-04 20:19:02,348 - MoETrainer - INFO -   Within 15%: 60.1% of predictions
2025-06-04 20:19:02,348 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:19:02,349 - MoETrainer - INFO -   Bin 0: RMSE=$97,973, RÂ²=0.3873, Samples=2027
2025-06-04 20:19:02,349 - MoETrainer - INFO -   Bin 1: RMSE=$155,424, RÂ²=0.4222, Samples=2138
2025-06-04 20:19:02,349 - MoETrainer - INFO -   Bin 2: RMSE=$923,711, RÂ²=0.6833, Samples=2051
2025-06-04 20:19:02,350 - MoETrainer - INFO -   3 bins: RÂ²=0.8493, RMSE=$541,267
2025-06-04 20:19:02,353 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:19:02,353 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:19:02,353 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:19:02,354 - MoETrainer - INFO - Bin 0: Large bin (5010), using CV selection
2025-06-04 20:19:05,212 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:19:05,213 - MoETrainer - INFO -   1. rf_medium: MSE=8235579596Â±1160320098, RÂ²=0.310 [SELECTED]
2025-06-04 20:19:05,213 - MoETrainer - INFO -   2. xgb_balanced: MSE=8390536192Â±1182185668, RÂ²=0.297
2025-06-04 20:19:05,213 - MoETrainer - INFO -   3. xgb_conservative: MSE=9008940373Â±1012787761, RÂ²=0.246
2025-06-04 20:19:05,214 - MoETrainer - INFO - Bin 1: Large bin (5050), using CV selection
2025-06-04 20:19:08,301 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:19:08,302 - MoETrainer - INFO -   1. rf_medium: MSE=6341383760Â±161907376, RÂ²=0.296 [SELECTED]
2025-06-04 20:19:08,302 - MoETrainer - INFO -   2. xgb_balanced: MSE=6548015787Â±119053608, RÂ²=0.274
2025-06-04 20:19:08,302 - MoETrainer - INFO -   3. rf_shallow: MSE=7586356396Â±76273955, RÂ²=0.158
2025-06-04 20:19:08,303 - MoETrainer - INFO - Bin 2: Large bin (5047), using CV selection
2025-06-04 20:19:11,764 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:19:11,764 - MoETrainer - INFO -   1. rf_medium: MSE=30744914798Â±1007070096, RÂ²=0.355 [SELECTED]
2025-06-04 20:19:11,764 - MoETrainer - INFO -   2. xgb_balanced: MSE=31027907925Â±1291711444, RÂ²=0.350
2025-06-04 20:19:11,764 - MoETrainer - INFO -   3. rf_shallow: MSE=37204829563Â±1201785762, RÂ²=0.220
2025-06-04 20:19:11,767 - MoETrainer - INFO - Bin 3: Large bin (5092), using CV selection
2025-06-04 20:19:15,868 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:19:15,868 - MoETrainer - INFO -   1. rf_medium: MSE=1115451928138Â±39182072813, RÂ²=0.583 [SELECTED]
2025-06-04 20:19:15,868 - MoETrainer - INFO -   2. xgb_balanced: MSE=1174696624128Â±42216256181, RÂ²=0.561
2025-06-04 20:19:15,868 - MoETrainer - INFO -   3. rf_shallow: MSE=1317679092897Â±27106910691, RÂ²=0.507
2025-06-04 20:19:15,869 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:19:16,582 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 5010 samples
2025-06-04 20:19:17,365 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 5050 samples
2025-06-04 20:19:18,304 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 5047 samples
2025-06-04 20:19:19,436 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 5092 samples
2025-06-04 20:19:19,436 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 20:19:19,607 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:19:19,607 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:19:19,609 - MoETrainer - INFO -   RMSE: $517,300
2025-06-04 20:19:19,609 - MoETrainer - INFO -   MAE: $234,212 (16.7% of mean)
2025-06-04 20:19:19,609 - MoETrainer - INFO -   RÂ²: 0.8624
2025-06-04 20:19:19,609 - MoETrainer - INFO -   MAPE: 117.3%
2025-06-04 20:19:19,609 - MoETrainer - INFO -   MPE: +106.9% (bias: overprediction)
2025-06-04 20:19:19,609 - MoETrainer - INFO -   Median APE: 10.1%
2025-06-04 20:19:19,609 - MoETrainer - INFO -   Within 5%: 27.5% of predictions
2025-06-04 20:19:19,609 - MoETrainer - INFO -   Within 10%: 49.5% of predictions
2025-06-04 20:19:19,609 - MoETrainer - INFO -   Within 15%: 67.3% of predictions
2025-06-04 20:19:19,609 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:19:19,609 - MoETrainer - INFO -   Bin 0: RMSE=$87,584, RÂ²=0.3636, Samples=1508
2025-06-04 20:19:19,609 - MoETrainer - INFO -   Bin 1: RMSE=$78,568, RÂ²=0.3149, Samples=1576
2025-06-04 20:19:19,609 - MoETrainer - INFO -   Bin 2: RMSE=$177,645, RÂ²=0.3263, Samples=1588
2025-06-04 20:19:19,609 - MoETrainer - INFO -   Bin 3: RMSE=$1,015,421, RÂ²=0.6312, Samples=1544
2025-06-04 20:19:19,618 - MoETrainer - INFO -   4 bins: RÂ²=0.8624, RMSE=$517,300
2025-06-04 20:19:19,625 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:19:19,625 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:19:19,625 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:19:19,628 - MoETrainer - INFO - Bin 0: Large bin (4024), using CV selection
2025-06-04 20:19:22,159 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:19:22,159 - MoETrainer - INFO -   1. xgb_balanced: MSE=7465524736Â±511716001, RÂ²=0.300 [SELECTED]
2025-06-04 20:19:22,160 - MoETrainer - INFO -   2. rf_medium: MSE=7490639147Â±375535796, RÂ²=0.297
2025-06-04 20:19:22,161 - MoETrainer - INFO -   3. xgb_conservative: MSE=7923123883Â±580924750, RÂ²=0.257
2025-06-04 20:19:22,161 - MoETrainer - INFO - Bin 1: Large bin (4054), using CV selection
2025-06-04 20:19:24,951 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:19:24,951 - MoETrainer - INFO -   1. rf_medium: MSE=2829781083Â±61548755, RÂ²=0.242 [SELECTED]
2025-06-04 20:19:24,952 - MoETrainer - INFO -   2. xgb_balanced: MSE=2840370432Â±88722210, RÂ²=0.239
2025-06-04 20:19:24,952 - MoETrainer - INFO -   3. rf_shallow: MSE=3207070822Â±89063135, RÂ²=0.141
2025-06-04 20:19:24,953 - MoETrainer - INFO - Bin 2: Large bin (4041), using CV selection
2025-06-04 20:19:27,928 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:19:27,929 - MoETrainer - INFO -   1. xgb_balanced: MSE=10831370240Â±187572754, RÂ²=0.317 [SELECTED]
2025-06-04 20:19:27,929 - MoETrainer - INFO -   2. rf_medium: MSE=10862067870Â±207720408, RÂ²=0.315
2025-06-04 20:19:27,929 - MoETrainer - INFO -   3. rf_shallow: MSE=12399843972Â±130185664, RÂ²=0.218
2025-06-04 20:19:27,931 - MoETrainer - INFO - Bin 3: Large bin (4026), using CV selection
2025-06-04 20:19:31,013 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:19:31,013 - MoETrainer - INFO -   1. rf_medium: MSE=36507555728Â±181966997, RÂ²=0.315 [SELECTED]
2025-06-04 20:19:31,013 - MoETrainer - INFO -   2. xgb_balanced: MSE=37483268779Â±390661989, RÂ²=0.297
2025-06-04 20:19:31,013 - MoETrainer - INFO -   3. rf_shallow: MSE=43583740040Â±214374463, RÂ²=0.182
2025-06-04 20:19:31,016 - MoETrainer - INFO - Bin 4: Large bin (4054), using CV selection
2025-06-04 20:19:34,553 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:19:34,553 - MoETrainer - INFO -   1. rf_medium: MSE=1217399920323Â±84598131537, RÂ²=0.543 [SELECTED]
2025-06-04 20:19:34,553 - MoETrainer - INFO -   2. xgb_balanced: MSE=1258326502059Â±90424870313, RÂ²=0.528
2025-06-04 20:19:34,553 - MoETrainer - INFO -   3. rf_shallow: MSE=1400213106285Â±140695896626, RÂ²=0.475
2025-06-04 20:19:34,553 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:19:34,669 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 0: 4024 samples
2025-06-04 20:19:35,327 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 4054 samples
2025-06-04 20:19:35,453 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 4041 samples
2025-06-04 20:19:36,229 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 4026 samples
2025-06-04 20:19:37,245 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 4054 samples
2025-06-04 20:19:37,246 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 20:19:37,379 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:19:37,380 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:19:37,380 - MoETrainer - INFO -   RMSE: $479,730
2025-06-04 20:19:37,380 - MoETrainer - INFO -   MAE: $205,880 (14.7% of mean)
2025-06-04 20:19:37,380 - MoETrainer - INFO -   RÂ²: 0.8816
2025-06-04 20:19:37,382 - MoETrainer - INFO -   MAPE: 107.5%
2025-06-04 20:19:37,382 - MoETrainer - INFO -   MPE: +97.4% (bias: overprediction)
2025-06-04 20:19:37,382 - MoETrainer - INFO -   Median APE: 8.6%
2025-06-04 20:19:37,383 - MoETrainer - INFO -   Within 5%: 31.8% of predictions
2025-06-04 20:19:37,383 - MoETrainer - INFO -   Within 10%: 56.8% of predictions
2025-06-04 20:19:37,383 - MoETrainer - INFO -   Within 15%: 75.5% of predictions
2025-06-04 20:19:37,383 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:19:37,384 - MoETrainer - INFO -   Bin 0: RMSE=$84,353, RÂ²=0.3385, Samples=1202
2025-06-04 20:19:37,384 - MoETrainer - INFO -   Bin 1: RMSE=$50,627, RÂ²=0.2783, Samples=1256
2025-06-04 20:19:37,384 - MoETrainer - INFO -   Bin 2: RMSE=$101,094, RÂ²=0.3517, Samples=1304
2025-06-04 20:19:37,384 - MoETrainer - INFO -   Bin 3: RMSE=$187,686, RÂ²=0.3668, Samples=1258
2025-06-04 20:19:37,385 - MoETrainer - INFO -   Bin 4: RMSE=$1,066,807, RÂ²=0.5963, Samples=1196
2025-06-04 20:19:37,389 - MoETrainer - INFO -   5 bins: RÂ²=0.8816, RMSE=$479,730
2025-06-04 20:19:37,393 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:19:37,394 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:19:37,394 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:19:37,395 - MoETrainer - INFO - Bin 0: Large bin (3322), using CV selection
2025-06-04 20:19:39,667 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:19:39,667 - MoETrainer - INFO -   1. rf_medium: MSE=7272957173Â±375816491, RÂ²=0.278 [SELECTED]
2025-06-04 20:19:39,667 - MoETrainer - INFO -   2. xgb_balanced: MSE=7510788608Â±575473161, RÂ²=0.255
2025-06-04 20:19:39,669 - MoETrainer - INFO -   3. xgb_conservative: MSE=7517993984Â±350563592, RÂ²=0.254
2025-06-04 20:19:39,669 - MoETrainer - INFO - Bin 1: Large bin (3342), using CV selection
2025-06-04 20:19:42,049 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:19:42,050 - MoETrainer - INFO -   1. rf_medium: MSE=1870237088Â±25896056, RÂ²=0.224 [SELECTED]
2025-06-04 20:19:42,050 - MoETrainer - INFO -   2. xgb_balanced: MSE=1871405227Â±48036433, RÂ²=0.223
2025-06-04 20:19:42,050 - MoETrainer - INFO -   3. xgb_conservative: MSE=2092526720Â±12448104, RÂ²=0.131
2025-06-04 20:19:42,051 - MoETrainer - INFO - Bin 2: Large bin (3396), using CV selection
2025-06-04 20:19:44,618 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:19:44,618 - MoETrainer - INFO -   1. rf_medium: MSE=4350375201Â±47805407, RÂ²=0.204 [SELECTED]
2025-06-04 20:19:44,619 - MoETrainer - INFO -   2. xgb_balanced: MSE=4430821547Â±111342877, RÂ²=0.189
2025-06-04 20:19:44,619 - MoETrainer - INFO -   3. rf_shallow: MSE=4873390920Â±65382475, RÂ²=0.108
2025-06-04 20:19:44,620 - MoETrainer - INFO - Bin 3: Large bin (3303), using CV selection
2025-06-04 20:19:47,249 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:19:47,249 - MoETrainer - INFO -   1. rf_medium: MSE=12947026747Â±322531734, RÂ²=0.216 [SELECTED]
2025-06-04 20:19:47,250 - MoETrainer - INFO -   2. xgb_balanced: MSE=13304116565Â±137394894, RÂ²=0.195
2025-06-04 20:19:47,250 - MoETrainer - INFO -   3. rf_shallow: MSE=14216987645Â±173971569, RÂ²=0.140
2025-06-04 20:19:47,251 - MoETrainer - INFO - Bin 4: Large bin (3404), using CV selection
2025-06-04 20:19:50,296 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:19:50,296 - MoETrainer - INFO -   1. rf_medium: MSE=49438887155Â±2138094341, RÂ²=0.294 [SELECTED]
2025-06-04 20:19:50,297 - MoETrainer - INFO -   2. xgb_balanced: MSE=49873786197Â±1683976687, RÂ²=0.288
2025-06-04 20:19:50,297 - MoETrainer - INFO -   3. xgb_conservative: MSE=58328787627Â±1551360995, RÂ²=0.167
2025-06-04 20:19:50,297 - MoETrainer - INFO - Bin 5: Large bin (3432), using CV selection
2025-06-04 20:19:53,603 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-04 20:19:53,604 - MoETrainer - INFO -   1. rf_medium: MSE=1293225347759Â±17661982472, RÂ²=0.512 [SELECTED]
2025-06-04 20:19:53,604 - MoETrainer - INFO -   2. xgb_balanced: MSE=1330460535467Â±30182211531, RÂ²=0.498
2025-06-04 20:19:53,605 - MoETrainer - INFO -   3. rf_shallow: MSE=1469616567157Â±47436051487, RÂ²=0.445
2025-06-04 20:19:53,605 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:19:54,164 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 3322 samples
2025-06-04 20:19:54,732 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 3342 samples
2025-06-04 20:19:55,349 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 3396 samples
2025-06-04 20:19:56,036 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 3303 samples
2025-06-04 20:19:56,779 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 3404 samples
2025-06-04 20:19:57,648 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 3432 samples
2025-06-04 20:19:57,648 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 20:19:57,857 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:19:57,858 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:19:57,858 - MoETrainer - INFO -   RMSE: $449,128
2025-06-04 20:19:57,859 - MoETrainer - INFO -   MAE: $188,113 (13.4% of mean)
2025-06-04 20:19:57,859 - MoETrainer - INFO -   RÂ²: 0.8962
2025-06-04 20:19:57,860 - MoETrainer - INFO -   MAPE: 100.5%
2025-06-04 20:19:57,860 - MoETrainer - INFO -   MPE: +91.6% (bias: overprediction)
2025-06-04 20:19:57,860 - MoETrainer - INFO -   Median APE: 7.6%
2025-06-04 20:19:57,861 - MoETrainer - INFO -   Within 5%: 33.9% of predictions
2025-06-04 20:19:57,861 - MoETrainer - INFO -   Within 10%: 61.3% of predictions
2025-06-04 20:19:57,861 - MoETrainer - INFO -   Within 15%: 80.3% of predictions
2025-06-04 20:19:57,862 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:19:57,862 - MoETrainer - INFO -   Bin 0: RMSE=$83,625, RÂ²=0.3149, Samples=998
2025-06-04 20:19:57,862 - MoETrainer - INFO -   Bin 1: RMSE=$42,430, RÂ²=0.2452, Samples=1029
2025-06-04 20:19:57,863 - MoETrainer - INFO -   Bin 2: RMSE=$63,840, RÂ²=0.2629, Samples=1057
2025-06-04 20:19:57,863 - MoETrainer - INFO -   Bin 3: RMSE=$111,018, RÂ²=0.2593, Samples=1081
2025-06-04 20:19:57,863 - MoETrainer - INFO -   Bin 4: RMSE=$215,043, RÂ²=0.3583, Samples=1067
2025-06-04 20:19:57,864 - MoETrainer - INFO -   Bin 5: RMSE=$1,094,174, RÂ²=0.5721, Samples=984
2025-06-04 20:19:57,873 - MoETrainer - INFO -   6 bins: RÂ²=0.8962, RMSE=$449,128
2025-06-04 20:19:57,873 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 20:19:57,873 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 20:19:57,877 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:19:57,877 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:19:57,879 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:19:57,879 - MoETrainer - INFO - Bin 0: Large bin (3322), using CV selection
2025-06-04 20:20:00,194 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:20:00,195 - MoETrainer - INFO -   1. rf_medium: MSE=7272957173Â±375816491, RÂ²=0.278 [SELECTED]
2025-06-04 20:20:00,195 - MoETrainer - INFO -   2. xgb_balanced: MSE=7510788608Â±575473161, RÂ²=0.255
2025-06-04 20:20:00,195 - MoETrainer - INFO -   3. xgb_conservative: MSE=7517993984Â±350563592, RÂ²=0.254
2025-06-04 20:20:00,197 - MoETrainer - INFO - Bin 1: Large bin (3342), using CV selection
2025-06-04 20:20:02,682 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:20:02,683 - MoETrainer - INFO -   1. rf_medium: MSE=1870237088Â±25896056, RÂ²=0.224 [SELECTED]
2025-06-04 20:20:02,683 - MoETrainer - INFO -   2. xgb_balanced: MSE=1871405227Â±48036433, RÂ²=0.223
2025-06-04 20:20:02,683 - MoETrainer - INFO -   3. xgb_conservative: MSE=2092526720Â±12448104, RÂ²=0.131
2025-06-04 20:20:02,684 - MoETrainer - INFO - Bin 2: Large bin (3396), using CV selection
2025-06-04 20:20:05,223 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:20:05,224 - MoETrainer - INFO -   1. rf_medium: MSE=4350375201Â±47805407, RÂ²=0.204 [SELECTED]
2025-06-04 20:20:05,224 - MoETrainer - INFO -   2. xgb_balanced: MSE=4430821547Â±111342877, RÂ²=0.189
2025-06-04 20:20:05,224 - MoETrainer - INFO -   3. rf_shallow: MSE=4873390920Â±65382475, RÂ²=0.108
2025-06-04 20:20:05,225 - MoETrainer - INFO - Bin 3: Large bin (3303), using CV selection
2025-06-04 20:20:07,883 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:20:07,883 - MoETrainer - INFO -   1. rf_medium: MSE=12947026747Â±322531734, RÂ²=0.216 [SELECTED]
2025-06-04 20:20:07,884 - MoETrainer - INFO -   2. xgb_balanced: MSE=13304116565Â±137394894, RÂ²=0.195
2025-06-04 20:20:07,884 - MoETrainer - INFO -   3. rf_shallow: MSE=14216987645Â±173971569, RÂ²=0.140
2025-06-04 20:20:07,885 - MoETrainer - INFO - Bin 4: Large bin (3404), using CV selection
2025-06-04 20:20:10,794 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:20:10,794 - MoETrainer - INFO -   1. rf_medium: MSE=49438887155Â±2138094341, RÂ²=0.294 [SELECTED]
2025-06-04 20:20:10,794 - MoETrainer - INFO -   2. xgb_balanced: MSE=49873786197Â±1683976687, RÂ²=0.288
2025-06-04 20:20:10,794 - MoETrainer - INFO -   3. xgb_conservative: MSE=58328787627Â±1551360995, RÂ²=0.167
2025-06-04 20:20:10,796 - MoETrainer - INFO - Bin 5: Large bin (3432), using CV selection
2025-06-04 20:20:14,231 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-04 20:20:14,231 - MoETrainer - INFO -   1. rf_medium: MSE=1293225347759Â±17661982472, RÂ²=0.512 [SELECTED]
2025-06-04 20:20:14,231 - MoETrainer - INFO -   2. xgb_balanced: MSE=1330460535467Â±30182211531, RÂ²=0.498
2025-06-04 20:20:14,231 - MoETrainer - INFO -   3. rf_shallow: MSE=1469616567157Â±47436051487, RÂ²=0.445
2025-06-04 20:20:14,231 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:20:14,778 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 3322 samples
2025-06-04 20:20:15,351 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 3342 samples
2025-06-04 20:20:15,995 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 3396 samples
2025-06-04 20:20:16,690 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 3303 samples
2025-06-04 20:20:17,423 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 3404 samples
2025-06-04 20:20:18,304 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 3432 samples
2025-06-04 20:20:18,304 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 20:20:18,494 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:20:18,494 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:20:18,494 - MoETrainer - INFO -   RMSE: $449,128
2025-06-04 20:20:18,494 - MoETrainer - INFO -   MAE: $188,113 (13.4% of mean)
2025-06-04 20:20:18,494 - MoETrainer - INFO -   RÂ²: 0.8962
2025-06-04 20:20:18,494 - MoETrainer - INFO -   MAPE: 100.5%
2025-06-04 20:20:18,494 - MoETrainer - INFO -   MPE: +91.6% (bias: overprediction)
2025-06-04 20:20:18,505 - MoETrainer - INFO -   Median APE: 7.6%
2025-06-04 20:20:18,505 - MoETrainer - INFO -   Within 5%: 33.9% of predictions
2025-06-04 20:20:18,505 - MoETrainer - INFO -   Within 10%: 61.3% of predictions
2025-06-04 20:20:18,505 - MoETrainer - INFO -   Within 15%: 80.3% of predictions
2025-06-04 20:20:18,505 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:20:18,505 - MoETrainer - INFO -   Bin 0: RMSE=$83,625, RÂ²=0.3149, Samples=998
2025-06-04 20:20:18,505 - MoETrainer - INFO -   Bin 1: RMSE=$42,430, RÂ²=0.2452, Samples=1029
2025-06-04 20:20:18,505 - MoETrainer - INFO -   Bin 2: RMSE=$63,840, RÂ²=0.2629, Samples=1057
2025-06-04 20:20:18,508 - MoETrainer - INFO -   Bin 3: RMSE=$111,018, RÂ²=0.2593, Samples=1081
2025-06-04 20:20:18,508 - MoETrainer - INFO -   Bin 4: RMSE=$215,043, RÂ²=0.3583, Samples=1067
2025-06-04 20:20:18,508 - MoETrainer - INFO -   Bin 5: RMSE=$1,094,174, RÂ²=0.5721, Samples=984
2025-06-04 20:20:18,509 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 20:20:18,509 - MoETrainer - INFO -   Bin 0: rf_medium
2025-06-04 20:20:18,509 - MoETrainer - INFO -   Bin 1: rf_medium
2025-06-04 20:20:18,509 - MoETrainer - INFO -   Bin 2: rf_medium
2025-06-04 20:20:18,509 - MoETrainer - INFO -   Bin 3: rf_medium
2025-06-04 20:20:18,511 - MoETrainer - INFO -   Bin 4: rf_medium
2025-06-04 20:20:18,511 - MoETrainer - INFO -   Bin 5: rf_medium
2025-06-04 20:20:18,512 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 20:20:18,512 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 20:20:18,512 - MoETrainer - INFO - Final Performance: RÂ² = 0.8962
2025-06-04 20:20:18,513 - MoETrainer - INFO - Final RMSE: $449,128
2025-06-04 20:20:18,513 - MoETrainer - INFO - Final MAE: $188,113
2025-06-04 20:23:11,289 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 20:23:11,290 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 20:23:11,290 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 20:23:11,337 - MoETrainer - INFO - Raw data shape: (31513, 6)
2025-06-04 20:23:11,361 - MoETrainer - INFO - Final features: 7 (from 7 after consolidation)
2025-06-04 20:23:11,362 - MoETrainer - INFO - Loaded dataset: 31513 samples, 7 features
2025-06-04 20:23:11,363 - MoETrainer - INFO - Target statistics: mean=$1,591,437, std=$2,258,463
2025-06-04 20:23:11,364 - MoETrainer - INFO - Target range: [$308, $130,000,000]
2025-06-04 20:23:11,364 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 20:23:11,368 - MoETrainer - INFO - Removed 436 outliers (1.4%)
2025-06-04 20:23:11,388 - MoETrainer - INFO - Applied robust scaling
2025-06-04 20:23:11,389 - MoETrainer - INFO - Splitting data...
2025-06-04 20:23:11,402 - MoETrainer - INFO - Data split - Train: 20199, Val: 4662, Test: 6216
2025-06-04 20:23:11,403 - MoETrainer - INFO - Train target: mean=$1,417,919, std=$1,398,547
2025-06-04 20:23:11,404 - MoETrainer - INFO - Test target: mean=$1,405,214, std=$1,394,312
2025-06-04 20:23:11,404 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 20:23:11,406 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:23:11,407 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:23:11,407 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:23:11,410 - MoETrainer - INFO - Bin 0: Large bin (6664), using CV selection
2025-06-04 20:23:17,076 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:23:17,078 - MoETrainer - INFO -   1. rf_medium: MSE=822001Â±713134, RÂ²=1.000 [SELECTED]
2025-06-04 20:23:17,078 - MoETrainer - INFO -   2. xgb_balanced: MSE=6052311Â±3005910, RÂ²=1.000
2025-06-04 20:23:17,078 - MoETrainer - INFO -   3. rf_shallow: MSE=14261183Â±2615524, RÂ²=0.999
2025-06-04 20:23:17,079 - MoETrainer - INFO - Bin 1: Large bin (6699), using CV selection
2025-06-04 20:23:23,339 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:23:23,339 - MoETrainer - INFO -   1. rf_medium: MSE=134939Â±17875, RÂ²=1.000 [SELECTED]
2025-06-04 20:23:23,340 - MoETrainer - INFO -   2. xgb_balanced: MSE=3206457Â±197953, RÂ²=1.000
2025-06-04 20:23:23,340 - MoETrainer - INFO -   3. rf_shallow: MSE=20902348Â±175003, RÂ²=0.999
2025-06-04 20:23:23,341 - MoETrainer - INFO - Bin 2: Large bin (6836), using CV selection
2025-06-04 20:23:31,084 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:23:31,085 - MoETrainer - INFO -   1. rf_medium: MSE=18751327Â±7791635, RÂ²=1.000 [SELECTED]
2025-06-04 20:23:31,085 - MoETrainer - INFO -   2. xgb_balanced: MSE=599221035Â±29503933, RÂ²=1.000
2025-06-04 20:23:31,085 - MoETrainer - INFO -   3. rf_shallow: MSE=877607465Â±60961303, RÂ²=1.000
2025-06-04 20:23:31,086 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:23:32,660 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 6664 samples
2025-06-04 20:23:34,507 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 6699 samples
2025-06-04 20:23:36,943 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 6836 samples
2025-06-04 20:23:36,944 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 20:23:37,118 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:23:37,119 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:23:37,119 - MoETrainer - INFO -   RMSE: $1,528
2025-06-04 20:23:37,120 - MoETrainer - INFO -   MAE: $295 (0.0% of mean)
2025-06-04 20:23:37,120 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:23:37,120 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:23:37,121 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:23:37,121 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:23:37,121 - MoETrainer - INFO -   Within 5%: 99.9% of predictions
2025-06-04 20:23:37,122 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:23:37,122 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:23:37,122 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:23:37,123 - MoETrainer - INFO -   Bin 0: RMSE=$380, RÂ²=1.0000, Samples=2027
2025-06-04 20:23:37,123 - MoETrainer - INFO -   Bin 1: RMSE=$291, RÂ²=1.0000, Samples=2138
2025-06-04 20:23:37,123 - MoETrainer - INFO -   Bin 2: RMSE=$2,616, RÂ²=1.0000, Samples=2051
2025-06-04 20:23:37,124 - MoETrainer - INFO -   3 bins: RÂ²=1.0000, RMSE=$1,528
2025-06-04 20:23:37,126 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:23:37,127 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:23:37,127 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:23:37,128 - MoETrainer - INFO - Bin 0: Large bin (5010), using CV selection
2025-06-04 20:23:41,889 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:23:41,890 - MoETrainer - INFO -   1. rf_medium: MSE=575431Â±535680, RÂ²=1.000 [SELECTED]
2025-06-04 20:23:41,890 - MoETrainer - INFO -   2. xgb_balanced: MSE=3459189Â±1398846, RÂ²=1.000
2025-06-04 20:23:41,891 - MoETrainer - INFO -   3. rf_shallow: MSE=4097527Â±485916, RÂ²=1.000
2025-06-04 20:23:41,892 - MoETrainer - INFO - Bin 1: Large bin (5050), using CV selection
2025-06-04 20:23:46,552 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:23:46,553 - MoETrainer - INFO -   1. rf_medium: MSE=40507Â±2326, RÂ²=1.000 [SELECTED]
2025-06-04 20:23:46,553 - MoETrainer - INFO -   2. xgb_balanced: MSE=721457Â±125091, RÂ²=1.000
2025-06-04 20:23:46,553 - MoETrainer - INFO -   3. rf_shallow: MSE=2273893Â±183552, RÂ²=1.000
2025-06-04 20:23:46,554 - MoETrainer - INFO - Bin 2: Large bin (5047), using CV selection
2025-06-04 20:23:51,721 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:23:51,721 - MoETrainer - INFO -   1. rf_medium: MSE=252930Â±6749, RÂ²=1.000 [SELECTED]
2025-06-04 20:23:51,721 - MoETrainer - INFO -   2. xgb_balanced: MSE=5437874Â±578278, RÂ²=1.000
2025-06-04 20:23:51,722 - MoETrainer - INFO -   3. rf_shallow: MSE=13343452Â±961934, RÂ²=1.000
2025-06-04 20:23:51,724 - MoETrainer - INFO - Bin 3: Large bin (5092), using CV selection
2025-06-04 20:23:58,137 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:23:58,137 - MoETrainer - INFO -   1. rf_medium: MSE=19949538Â±4232411, RÂ²=1.000 [SELECTED]
2025-06-04 20:23:58,137 - MoETrainer - INFO -   2. xgb_balanced: MSE=600330112Â±43140275, RÂ²=1.000
2025-06-04 20:23:58,137 - MoETrainer - INFO -   3. rf_shallow: MSE=751211611Â±115265399, RÂ²=1.000
2025-06-04 20:23:58,137 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:23:59,381 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 5010 samples
2025-06-04 20:24:00,653 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 5050 samples
2025-06-04 20:24:02,049 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 5047 samples
2025-06-04 20:24:03,948 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 5092 samples
2025-06-04 20:24:03,949 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 20:24:04,136 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:24:04,137 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:24:04,138 - MoETrainer - INFO -   RMSE: $1,569
2025-06-04 20:24:04,138 - MoETrainer - INFO -   MAE: $311 (0.0% of mean)
2025-06-04 20:24:04,138 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:24:04,139 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:24:04,139 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:24:04,139 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:24:04,140 - MoETrainer - INFO -   Within 5%: 99.9% of predictions
2025-06-04 20:24:04,140 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:24:04,140 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:24:04,142 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:24:04,142 - MoETrainer - INFO -   Bin 0: RMSE=$513, RÂ²=1.0000, Samples=1508
2025-06-04 20:24:04,143 - MoETrainer - INFO -   Bin 1: RMSE=$150, RÂ²=1.0000, Samples=1576
2025-06-04 20:24:04,143 - MoETrainer - INFO -   Bin 2: RMSE=$358, RÂ²=1.0000, Samples=1588
2025-06-04 20:24:04,144 - MoETrainer - INFO -   Bin 3: RMSE=$3,081, RÂ²=1.0000, Samples=1544
2025-06-04 20:24:04,145 - MoETrainer - INFO -   4 bins: RÂ²=1.0000, RMSE=$1,569
2025-06-04 20:24:04,147 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:24:04,147 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:24:04,148 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:24:04,149 - MoETrainer - INFO - Bin 0: Large bin (4024), using CV selection
2025-06-04 20:24:08,309 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:24:08,310 - MoETrainer - INFO -   1. rf_medium: MSE=708525Â±659731, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:08,310 - MoETrainer - INFO -   2. rf_shallow: MSE=5367798Â±1596798, RÂ²=0.999
2025-06-04 20:24:08,311 - MoETrainer - INFO -   3. xgb_balanced: MSE=7170270Â±4207615, RÂ²=0.999
2025-06-04 20:24:08,311 - MoETrainer - INFO - Bin 1: Large bin (4054), using CV selection
2025-06-04 20:24:12,171 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:24:12,171 - MoETrainer - INFO -   1. rf_medium: MSE=29002Â±10600, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:12,173 - MoETrainer - INFO -   2. xgb_balanced: MSE=120917Â±21454, RÂ²=1.000
2025-06-04 20:24:12,173 - MoETrainer - INFO -   3. rf_shallow: MSE=1203802Â±61382, RÂ²=1.000
2025-06-04 20:24:12,173 - MoETrainer - INFO - Bin 2: Large bin (4041), using CV selection
2025-06-04 20:24:16,397 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:24:16,398 - MoETrainer - INFO -   1. rf_medium: MSE=122835Â±15053, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:16,398 - MoETrainer - INFO -   2. xgb_balanced: MSE=2171389Â±535102, RÂ²=1.000
2025-06-04 20:24:16,398 - MoETrainer - INFO -   3. rf_shallow: MSE=5808583Â±286052, RÂ²=1.000
2025-06-04 20:24:16,399 - MoETrainer - INFO - Bin 3: Large bin (4026), using CV selection
2025-06-04 20:24:20,784 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:24:20,785 - MoETrainer - INFO -   1. rf_medium: MSE=394261Â±96925, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:20,786 - MoETrainer - INFO -   2. xgb_balanced: MSE=6618145Â±1313755, RÂ²=1.000
2025-06-04 20:24:20,786 - MoETrainer - INFO -   3. rf_shallow: MSE=26374940Â±3531622, RÂ²=1.000
2025-06-04 20:24:20,788 - MoETrainer - INFO - Bin 4: Large bin (4054), using CV selection
2025-06-04 20:24:26,253 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:24:26,254 - MoETrainer - INFO -   1. rf_medium: MSE=26735738Â±13892189, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:26,254 - MoETrainer - INFO -   2. xgb_balanced: MSE=509617291Â±181199254, RÂ²=1.000
2025-06-04 20:24:26,255 - MoETrainer - INFO -   3. rf_shallow: MSE=1078816363Â±270705846, RÂ²=1.000
2025-06-04 20:24:26,255 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:24:27,291 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 4024 samples
2025-06-04 20:24:28,215 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 4054 samples
2025-06-04 20:24:29,315 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 4041 samples
2025-06-04 20:24:30,535 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 4026 samples
2025-06-04 20:24:32,027 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 4054 samples
2025-06-04 20:24:32,028 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 20:24:32,210 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:24:32,210 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:24:32,211 - MoETrainer - INFO -   RMSE: $1,512
2025-06-04 20:24:32,211 - MoETrainer - INFO -   MAE: $310 (0.0% of mean)
2025-06-04 20:24:32,211 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:24:32,211 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:24:32,212 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:24:32,212 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:24:32,212 - MoETrainer - INFO -   Within 5%: 99.9% of predictions
2025-06-04 20:24:32,212 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:24:32,213 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:24:32,213 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:24:32,213 - MoETrainer - INFO -   Bin 0: RMSE=$388, RÂ²=1.0000, Samples=1202
2025-06-04 20:24:32,215 - MoETrainer - INFO -   Bin 1: RMSE=$146, RÂ²=1.0000, Samples=1256
2025-06-04 20:24:32,215 - MoETrainer - INFO -   Bin 2: RMSE=$289, RÂ²=1.0000, Samples=1304
2025-06-04 20:24:32,215 - MoETrainer - INFO -   Bin 3: RMSE=$446, RÂ²=1.0000, Samples=1258
2025-06-04 20:24:32,215 - MoETrainer - INFO -   Bin 4: RMSE=$3,377, RÂ²=1.0000, Samples=1196
2025-06-04 20:24:32,232 - MoETrainer - INFO -   5 bins: RÂ²=1.0000, RMSE=$1,512
2025-06-04 20:24:32,236 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:24:32,236 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:24:32,237 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:24:32,238 - MoETrainer - INFO - Bin 0: Large bin (3322), using CV selection
2025-06-04 20:24:35,770 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:24:35,771 - MoETrainer - INFO -   1. rf_medium: MSE=1689269Â±1226822, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:35,771 - MoETrainer - INFO -   2. xgb_balanced: MSE=2312478Â±1578077, RÂ²=1.000
2025-06-04 20:24:35,772 - MoETrainer - INFO -   3. rf_shallow: MSE=7211578Â±1354020, RÂ²=0.999
2025-06-04 20:24:35,772 - MoETrainer - INFO - Bin 1: Large bin (3342), using CV selection
2025-06-04 20:24:39,043 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:24:39,044 - MoETrainer - INFO -   1. rf_medium: MSE=26872Â±12783, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:39,044 - MoETrainer - INFO -   2. xgb_balanced: MSE=64658Â±21458, RÂ²=1.000
2025-06-04 20:24:39,044 - MoETrainer - INFO -   3. rf_shallow: MSE=694018Â±81036, RÂ²=1.000
2025-06-04 20:24:39,045 - MoETrainer - INFO - Bin 2: Large bin (3396), using CV selection
2025-06-04 20:24:42,575 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:24:42,575 - MoETrainer - INFO -   1. rf_medium: MSE=40006Â±4473, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:42,575 - MoETrainer - INFO -   2. xgb_balanced: MSE=112704Â±33620, RÂ²=1.000
2025-06-04 20:24:42,575 - MoETrainer - INFO -   3. rf_shallow: MSE=1154787Â±127509, RÂ²=1.000
2025-06-04 20:24:42,576 - MoETrainer - INFO - Bin 3: Large bin (3303), using CV selection
2025-06-04 20:24:46,108 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:24:46,108 - MoETrainer - INFO -   1. rf_medium: MSE=213194Â±49800, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:46,109 - MoETrainer - INFO -   2. xgb_balanced: MSE=617303Â±94019, RÂ²=1.000
2025-06-04 20:24:46,109 - MoETrainer - INFO -   3. rf_shallow: MSE=4277727Â±46647, RÂ²=1.000
2025-06-04 20:24:46,110 - MoETrainer - INFO - Bin 4: Large bin (3404), using CV selection
2025-06-04 20:24:50,138 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:24:50,138 - MoETrainer - INFO -   1. rf_medium: MSE=683539Â±78603, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:50,138 - MoETrainer - INFO -   2. xgb_balanced: MSE=8061297Â±1349776, RÂ²=1.000
2025-06-04 20:24:50,139 - MoETrainer - INFO -   3. rf_shallow: MSE=22996490Â±3692678, RÂ²=1.000
2025-06-04 20:24:50,140 - MoETrainer - INFO - Bin 5: Large bin (3432), using CV selection
2025-06-04 20:24:55,074 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-04 20:24:55,074 - MoETrainer - INFO -   1. rf_medium: MSE=33401822Â±3402256, RÂ²=1.000 [SELECTED]
2025-06-04 20:24:55,075 - MoETrainer - INFO -   2. xgb_balanced: MSE=558368683Â±67833328, RÂ²=1.000
2025-06-04 20:24:55,075 - MoETrainer - INFO -   3. rf_shallow: MSE=788057430Â±82833745, RÂ²=1.000
2025-06-04 20:24:55,076 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:24:55,932 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 3322 samples
2025-06-04 20:24:56,706 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 3342 samples
2025-06-04 20:24:57,605 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 3396 samples
2025-06-04 20:24:58,513 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 3303 samples
2025-06-04 20:24:59,573 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 3404 samples
2025-06-04 20:25:00,927 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 3432 samples
2025-06-04 20:25:00,927 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 20:25:01,123 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:25:01,124 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:25:01,124 - MoETrainer - INFO -   RMSE: $1,391
2025-06-04 20:25:01,124 - MoETrainer - INFO -   MAE: $293 (0.0% of mean)
2025-06-04 20:25:01,125 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:25:01,125 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:25:01,126 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:25:01,126 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:25:01,127 - MoETrainer - INFO -   Within 5%: 99.9% of predictions
2025-06-04 20:25:01,127 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:25:01,127 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:25:01,128 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:25:01,128 - MoETrainer - INFO -   Bin 0: RMSE=$699, RÂ²=1.0000, Samples=998
2025-06-04 20:25:01,129 - MoETrainer - INFO -   Bin 1: RMSE=$153, RÂ²=1.0000, Samples=1029
2025-06-04 20:25:01,129 - MoETrainer - INFO -   Bin 2: RMSE=$159, RÂ²=1.0000, Samples=1057
2025-06-04 20:25:01,130 - MoETrainer - INFO -   Bin 3: RMSE=$400, RÂ²=1.0000, Samples=1081
2025-06-04 20:25:01,130 - MoETrainer - INFO -   Bin 4: RMSE=$618, RÂ²=1.0000, Samples=1067
2025-06-04 20:25:01,130 - MoETrainer - INFO -   Bin 5: RMSE=$3,329, RÂ²=1.0000, Samples=984
2025-06-04 20:25:01,137 - MoETrainer - INFO -   6 bins: RÂ²=1.0000, RMSE=$1,391
2025-06-04 20:25:01,138 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 20:25:01,139 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 20:25:01,142 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:25:01,142 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:25:01,142 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:25:01,144 - MoETrainer - INFO - Bin 0: Large bin (3322), using CV selection
2025-06-04 20:25:04,561 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:25:04,561 - MoETrainer - INFO -   1. rf_medium: MSE=1689269Â±1226822, RÂ²=1.000 [SELECTED]
2025-06-04 20:25:04,561 - MoETrainer - INFO -   2. xgb_balanced: MSE=2312478Â±1578077, RÂ²=1.000
2025-06-04 20:25:04,561 - MoETrainer - INFO -   3. rf_shallow: MSE=7211578Â±1354020, RÂ²=0.999
2025-06-04 20:25:04,561 - MoETrainer - INFO - Bin 1: Large bin (3342), using CV selection
2025-06-04 20:25:07,653 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:25:07,654 - MoETrainer - INFO -   1. rf_medium: MSE=26872Â±12783, RÂ²=1.000 [SELECTED]
2025-06-04 20:25:07,654 - MoETrainer - INFO -   2. xgb_balanced: MSE=64658Â±21458, RÂ²=1.000
2025-06-04 20:25:07,654 - MoETrainer - INFO -   3. rf_shallow: MSE=694018Â±81036, RÂ²=1.000
2025-06-04 20:25:07,656 - MoETrainer - INFO - Bin 2: Large bin (3396), using CV selection
2025-06-04 20:25:11,209 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:25:11,210 - MoETrainer - INFO -   1. rf_medium: MSE=40006Â±4473, RÂ²=1.000 [SELECTED]
2025-06-04 20:25:11,210 - MoETrainer - INFO -   2. xgb_balanced: MSE=112704Â±33620, RÂ²=1.000
2025-06-04 20:25:11,210 - MoETrainer - INFO -   3. rf_shallow: MSE=1154787Â±127509, RÂ²=1.000
2025-06-04 20:25:11,212 - MoETrainer - INFO - Bin 3: Large bin (3303), using CV selection
2025-06-04 20:25:14,691 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:25:14,691 - MoETrainer - INFO -   1. rf_medium: MSE=213194Â±49800, RÂ²=1.000 [SELECTED]
2025-06-04 20:25:14,691 - MoETrainer - INFO -   2. xgb_balanced: MSE=617303Â±94019, RÂ²=1.000
2025-06-04 20:25:14,691 - MoETrainer - INFO -   3. rf_shallow: MSE=4277727Â±46647, RÂ²=1.000
2025-06-04 20:25:14,691 - MoETrainer - INFO - Bin 4: Large bin (3404), using CV selection
2025-06-04 20:25:18,572 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-04 20:25:18,572 - MoETrainer - INFO -   1. rf_medium: MSE=683539Â±78603, RÂ²=1.000 [SELECTED]
2025-06-04 20:25:18,572 - MoETrainer - INFO -   2. xgb_balanced: MSE=8061297Â±1349776, RÂ²=1.000
2025-06-04 20:25:18,572 - MoETrainer - INFO -   3. rf_shallow: MSE=22996490Â±3692678, RÂ²=1.000
2025-06-04 20:25:18,574 - MoETrainer - INFO - Bin 5: Large bin (3432), using CV selection
2025-06-04 20:25:23,255 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-04 20:25:23,256 - MoETrainer - INFO -   1. rf_medium: MSE=33401822Â±3402256, RÂ²=1.000 [SELECTED]
2025-06-04 20:25:23,256 - MoETrainer - INFO -   2. xgb_balanced: MSE=558368683Â±67833328, RÂ²=1.000
2025-06-04 20:25:23,256 - MoETrainer - INFO -   3. rf_shallow: MSE=788057430Â±82833745, RÂ²=1.000
2025-06-04 20:25:23,256 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:25:24,098 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 3322 samples
2025-06-04 20:25:24,861 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 3342 samples
2025-06-04 20:25:25,786 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 3396 samples
2025-06-04 20:25:26,677 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 3303 samples
2025-06-04 20:25:27,728 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 3404 samples
2025-06-04 20:25:29,079 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 3432 samples
2025-06-04 20:25:29,080 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 20:25:29,285 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:25:29,285 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:25:29,286 - MoETrainer - INFO -   RMSE: $1,391
2025-06-04 20:25:29,286 - MoETrainer - INFO -   MAE: $293 (0.0% of mean)
2025-06-04 20:25:29,286 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:25:29,287 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:25:29,287 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:25:29,287 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:25:29,288 - MoETrainer - INFO -   Within 5%: 99.9% of predictions
2025-06-04 20:25:29,288 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:25:29,288 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:25:29,289 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:25:29,289 - MoETrainer - INFO -   Bin 0: RMSE=$699, RÂ²=1.0000, Samples=998
2025-06-04 20:25:29,290 - MoETrainer - INFO -   Bin 1: RMSE=$153, RÂ²=1.0000, Samples=1029
2025-06-04 20:25:29,290 - MoETrainer - INFO -   Bin 2: RMSE=$159, RÂ²=1.0000, Samples=1057
2025-06-04 20:25:29,290 - MoETrainer - INFO -   Bin 3: RMSE=$400, RÂ²=1.0000, Samples=1081
2025-06-04 20:25:29,290 - MoETrainer - INFO -   Bin 4: RMSE=$618, RÂ²=1.0000, Samples=1067
2025-06-04 20:25:29,292 - MoETrainer - INFO -   Bin 5: RMSE=$3,329, RÂ²=1.0000, Samples=984
2025-06-04 20:25:29,292 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 20:25:29,292 - MoETrainer - INFO -   Bin 0: rf_medium
2025-06-04 20:25:29,293 - MoETrainer - INFO -   Bin 1: rf_medium
2025-06-04 20:25:29,293 - MoETrainer - INFO -   Bin 2: rf_medium
2025-06-04 20:25:29,293 - MoETrainer - INFO -   Bin 3: rf_medium
2025-06-04 20:25:29,294 - MoETrainer - INFO -   Bin 4: rf_medium
2025-06-04 20:25:29,294 - MoETrainer - INFO -   Bin 5: rf_medium
2025-06-04 20:25:29,294 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 20:25:29,294 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 20:25:29,295 - MoETrainer - INFO - Final Performance: RÂ² = 1.0000
2025-06-04 20:25:29,295 - MoETrainer - INFO - Final RMSE: $1,391
2025-06-04 20:25:29,295 - MoETrainer - INFO - Final MAE: $293
2025-06-04 20:37:20,449 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 20:37:20,449 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 20:37:20,449 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 20:37:21,019 - MoETrainer - INFO - Raw data shape: (5525, 746)
2025-06-04 20:37:21,022 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-04 20:37:21,027 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-04 20:37:21,051 - MoETrainer - INFO - Consolidating 744 features using original approach...
2025-06-04 20:37:24,002 - MoETrainer - INFO - Consolidated to 14 features
2025-06-04 20:37:24,059 - MoETrainer - INFO - Final features: 16 (from 16 after consolidation)
2025-06-04 20:37:24,059 - MoETrainer - INFO - Loaded dataset: 5525 samples, 16 features
2025-06-04 20:37:24,060 - MoETrainer - INFO - Target statistics: mean=$543,777, std=$289,820
2025-06-04 20:37:24,060 - MoETrainer - INFO - Target range: [$149,000, $2,485,000]
2025-06-04 20:37:24,061 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 20:37:24,062 - MoETrainer - INFO - Removed 22 outliers (0.4%)
2025-06-04 20:37:24,072 - MoETrainer - INFO - Applied robust scaling
2025-06-04 20:37:24,072 - MoETrainer - INFO - Splitting data...
2025-06-04 20:37:24,076 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-04 20:37:24,077 - MoETrainer - INFO - Train target: mean=$535,714, std=$267,185
2025-06-04 20:37:24,077 - MoETrainer - INFO - Test target: mean=$550,320, std=$279,941
2025-06-04 20:37:24,078 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 20:37:24,079 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:37:24,079 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:37:24,080 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:37:24,080 - MoETrainer - INFO - Bin 0: Large bin (1165), using CV selection
2025-06-04 20:37:27,205 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:37:27,206 - MoETrainer - INFO -   1. rf_medium: MSE=866214Â±586446, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:27,206 - MoETrainer - INFO -   2. rf_shallow: MSE=2354570Â±1344506, RÂ²=0.999
2025-06-04 20:37:27,206 - MoETrainer - INFO -   3. xgb_balanced: MSE=4101020Â±837851, RÂ²=0.998
2025-06-04 20:37:27,207 - MoETrainer - INFO - Bin 1: Large bin (1217), using CV selection
2025-06-04 20:37:30,649 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:37:30,650 - MoETrainer - INFO -   1. rf_medium: MSE=226311Â±154881, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:30,650 - MoETrainer - INFO -   2. rf_shallow: MSE=481538Â±183451, RÂ²=1.000
2025-06-04 20:37:30,650 - MoETrainer - INFO -   3. xgb_balanced: MSE=2714689Â±187804, RÂ²=0.999
2025-06-04 20:37:30,651 - MoETrainer - INFO - Bin 2: Large bin (1194), using CV selection
2025-06-04 20:37:34,178 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:37:34,178 - MoETrainer - INFO -   1. rf_medium: MSE=36656496Â±4591617, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:34,179 - MoETrainer - INFO -   2. rf_shallow: MSE=78839520Â±29892845, RÂ²=0.999
2025-06-04 20:37:34,179 - MoETrainer - INFO -   3. xgb_balanced: MSE=154134997Â±16876932, RÂ²=0.998
2025-06-04 20:37:34,179 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:37:34,951 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 1165 samples
2025-06-04 20:37:35,726 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 1217 samples
2025-06-04 20:37:36,639 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 1194 samples
2025-06-04 20:37:36,640 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 20:37:36,720 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:37:36,721 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:37:36,721 - MoETrainer - INFO -   RMSE: $1,265
2025-06-04 20:37:36,721 - MoETrainer - INFO -   MAE: $339 (0.1% of mean)
2025-06-04 20:37:36,721 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:37:36,722 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:37:36,722 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:37:36,722 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:37:36,722 - MoETrainer - INFO -   Within 5%: 100.0% of predictions
2025-06-04 20:37:36,723 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:37:36,723 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:37:36,723 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:37:36,725 - MoETrainer - INFO -   Bin 0: RMSE=$390, RÂ²=0.9999, Samples=358
2025-06-04 20:37:36,725 - MoETrainer - INFO -   Bin 1: RMSE=$391, RÂ²=0.9999, Samples=350
2025-06-04 20:37:36,725 - MoETrainer - INFO -   Bin 2: RMSE=$2,052, RÂ²=0.9999, Samples=393
2025-06-04 20:37:36,725 - MoETrainer - INFO -   3 bins: RÂ²=1.0000, RMSE=$1,265
2025-06-04 20:37:36,726 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:37:36,727 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:37:36,727 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:37:36,728 - MoETrainer - INFO - Bin 0: Large bin (887), using CV selection
2025-06-04 20:37:39,321 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 20:37:39,321 - MoETrainer - INFO -   1. rf_medium: MSE=943880Â±599699, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:39,321 - MoETrainer - INFO -   2. rf_shallow: MSE=2636849Â±1333372, RÂ²=0.999
2025-06-04 20:37:39,321 - MoETrainer - INFO -   3. xgb_balanced: MSE=3840942Â±919508, RÂ²=0.998
2025-06-04 20:37:39,321 - MoETrainer - INFO - Bin 1: Large bin (899), using CV selection
2025-06-04 20:37:41,784 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 20:37:41,784 - MoETrainer - INFO -   1. rf_medium: MSE=108670Â±34841, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:41,784 - MoETrainer - INFO -   2. rf_shallow: MSE=291933Â±131851, RÂ²=1.000
2025-06-04 20:37:41,784 - MoETrainer - INFO -   3. xgb_balanced: MSE=996994Â±78913, RÂ²=0.999
2025-06-04 20:37:41,784 - MoETrainer - INFO - Bin 2: Large bin (869), using CV selection
2025-06-04 20:37:44,466 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 20:37:44,466 - MoETrainer - INFO -   1. rf_medium: MSE=250347Â±151447, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:44,466 - MoETrainer - INFO -   2. rf_shallow: MSE=1049255Â±306947, RÂ²=0.999
2025-06-04 20:37:44,466 - MoETrainer - INFO -   3. xgb_balanced: MSE=4115288Â±573854, RÂ²=0.998
2025-06-04 20:37:44,468 - MoETrainer - INFO - Bin 3: Large bin (921), using CV selection
2025-06-04 20:37:47,373 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 20:37:47,373 - MoETrainer - INFO -   1. rf_medium: MSE=29123514Â±13309014, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:47,374 - MoETrainer - INFO -   2. rf_shallow: MSE=82676315Â±4930574, RÂ²=0.999
2025-06-04 20:37:47,374 - MoETrainer - INFO -   3. xgb_balanced: MSE=233316123Â±21281559, RÂ²=0.997
2025-06-04 20:37:47,374 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:37:47,984 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 887 samples
2025-06-04 20:37:48,528 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 899 samples
2025-06-04 20:37:49,105 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 869 samples
2025-06-04 20:37:49,833 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 921 samples
2025-06-04 20:37:49,834 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 20:37:49,918 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:37:49,919 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:37:49,919 - MoETrainer - INFO -   RMSE: $1,393
2025-06-04 20:37:49,920 - MoETrainer - INFO -   MAE: $318 (0.1% of mean)
2025-06-04 20:37:49,920 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:37:49,920 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:37:49,921 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:37:49,921 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:37:49,921 - MoETrainer - INFO -   Within 5%: 100.0% of predictions
2025-06-04 20:37:49,922 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:37:49,922 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:37:49,922 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:37:49,923 - MoETrainer - INFO -   Bin 0: RMSE=$360, RÂ²=0.9999, Samples=271
2025-06-04 20:37:49,923 - MoETrainer - INFO -   Bin 1: RMSE=$298, RÂ²=0.9999, Samples=248
2025-06-04 20:37:49,923 - MoETrainer - INFO -   Bin 2: RMSE=$370, RÂ²=0.9999, Samples=275
2025-06-04 20:37:49,924 - MoETrainer - INFO -   Bin 3: RMSE=$2,580, RÂ²=0.9999, Samples=307
2025-06-04 20:37:49,924 - MoETrainer - INFO -   4 bins: RÂ²=1.0000, RMSE=$1,393
2025-06-04 20:37:49,925 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:37:49,926 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:37:49,926 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:37:49,927 - MoETrainer - INFO - Bin 0: Small bin (715), using rule-based selection
2025-06-04 20:37:50,723 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 20:37:50,724 - MoETrainer - INFO -   1. rf_medium: Score=0.012, MAE=$167, RMSE=$400, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:50,724 - MoETrainer - INFO -   2. rf_shallow: Score=0.023, MAE=$416, RMSE=$766, RÂ²=1.000
2025-06-04 20:37:50,724 - MoETrainer - INFO -   3. xgb_balanced: Score=0.053, MAE=$1160, RMSE=$1769, RÂ²=0.998
2025-06-04 20:37:50,724 - MoETrainer - INFO - Bin 1: Small bin (715), using rule-based selection
2025-06-04 20:37:51,465 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 20:37:51,466 - MoETrainer - INFO -   1. rf_medium: Score=0.014, MAE=$89, RMSE=$283, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:51,466 - MoETrainer - INFO -   2. rf_shallow: Score=0.026, MAE=$178, RMSE=$509, RÂ²=0.999
2025-06-04 20:37:51,466 - MoETrainer - INFO -   3. xgb_balanced: Score=0.043, MAE=$599, RMSE=$832, RÂ²=0.998
2025-06-04 20:37:51,467 - MoETrainer - INFO - Bin 2: Small bin (715), using rule-based selection
2025-06-04 20:37:52,231 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 20:37:52,232 - MoETrainer - INFO -   1. rf_medium: Score=0.026, MAE=$183, RMSE=$689, RÂ²=0.999 [SELECTED]
2025-06-04 20:37:52,232 - MoETrainer - INFO -   2. rf_shallow: Score=0.034, MAE=$329, RMSE=$879, RÂ²=0.999
2025-06-04 20:37:52,233 - MoETrainer - INFO -   3. xgb_balanced: Score=0.061, MAE=$923, RMSE=$1551, RÂ²=0.997
2025-06-04 20:37:52,233 - MoETrainer - INFO - Bin 3: Small bin (712), using rule-based selection
2025-06-04 20:37:53,045 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 20:37:53,046 - MoETrainer - INFO -   1. rf_medium: Score=0.010, MAE=$165, RMSE=$471, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:53,046 - MoETrainer - INFO -   2. rf_shallow: Score=0.031, MAE=$611, RMSE=$1440, RÂ²=0.999
2025-06-04 20:37:53,046 - MoETrainer - INFO -   3. xgb_balanced: Score=0.045, MAE=$1557, RMSE=$2020, RÂ²=0.998
2025-06-04 20:37:53,047 - MoETrainer - INFO - Bin 4: Small bin (719), using rule-based selection
2025-06-04 20:37:53,909 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 20:37:53,911 - MoETrainer - INFO -   1. rf_medium: Score=0.025, MAE=$2629, RMSE=$6809, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:53,911 - MoETrainer - INFO -   2. rf_shallow: Score=0.047, MAE=$5286, RMSE=$12607, RÂ²=0.998
2025-06-04 20:37:53,912 - MoETrainer - INFO -   3. xgb_balanced: Score=0.062, MAE=$9948, RMSE=$15681, RÂ²=0.997
2025-06-04 20:37:53,912 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:37:54,418 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 715 samples
2025-06-04 20:37:54,860 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 715 samples
2025-06-04 20:37:55,338 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 715 samples
2025-06-04 20:37:55,844 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 712 samples
2025-06-04 20:37:56,439 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 719 samples
2025-06-04 20:37:56,440 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 20:37:56,543 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:37:56,544 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:37:56,544 - MoETrainer - INFO -   RMSE: $1,253
2025-06-04 20:37:56,545 - MoETrainer - INFO -   MAE: $345 (0.1% of mean)
2025-06-04 20:37:56,545 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:37:56,545 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:37:56,546 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:37:56,546 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:37:56,546 - MoETrainer - INFO -   Within 5%: 100.0% of predictions
2025-06-04 20:37:56,546 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:37:56,548 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:37:56,548 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:37:56,548 - MoETrainer - INFO -   Bin 0: RMSE=$467, RÂ²=0.9999, Samples=224
2025-06-04 20:37:56,548 - MoETrainer - INFO -   Bin 1: RMSE=$229, RÂ²=0.9999, Samples=203
2025-06-04 20:37:56,548 - MoETrainer - INFO -   Bin 2: RMSE=$332, RÂ²=0.9998, Samples=209
2025-06-04 20:37:56,548 - MoETrainer - INFO -   Bin 3: RMSE=$601, RÂ²=0.9998, Samples=224
2025-06-04 20:37:56,549 - MoETrainer - INFO -   Bin 4: RMSE=$2,548, RÂ²=0.9999, Samples=241
2025-06-04 20:37:56,552 - MoETrainer - INFO -   5 bins: RÂ²=1.0000, RMSE=$1,253
2025-06-04 20:37:56,553 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:37:56,553 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:37:56,553 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:37:56,555 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-04 20:37:57,239 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 20:37:57,240 - MoETrainer - INFO -   1. rf_medium: Score=0.025, MAE=$313, RMSE=$851, RÂ²=0.999 [SELECTED]
2025-06-04 20:37:57,240 - MoETrainer - INFO -   2. rf_shallow: Score=0.047, MAE=$696, RMSE=$1576, RÂ²=0.998
2025-06-04 20:37:57,241 - MoETrainer - INFO -   3. xgb_balanced: Score=0.052, MAE=$1186, RMSE=$1673, RÂ²=0.998
2025-06-04 20:37:57,241 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-04 20:37:57,979 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 20:37:57,979 - MoETrainer - INFO -   1. rf_medium: Score=0.014, MAE=$98, RMSE=$306, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:57,980 - MoETrainer - INFO -   2. rf_shallow: Score=0.026, MAE=$216, RMSE=$552, RÂ²=0.999
2025-06-04 20:37:57,980 - MoETrainer - INFO -   3. xgb_balanced: Score=0.040, MAE=$561, RMSE=$837, RÂ²=0.999
2025-06-04 20:37:57,981 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-04 20:37:58,668 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 20:37:58,669 - MoETrainer - INFO -   1. rf_medium: Score=0.024, MAE=$163, RMSE=$481, RÂ²=0.999 [SELECTED]
2025-06-04 20:37:58,669 - MoETrainer - INFO -   2. rf_shallow: Score=0.025, MAE=$238, RMSE=$494, RÂ²=0.999
2025-06-04 20:37:58,669 - MoETrainer - INFO -   3. xgb_balanced: Score=0.040, MAE=$530, RMSE=$798, RÂ²=0.998
2025-06-04 20:37:58,670 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-04 20:37:59,365 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 20:37:59,365 - MoETrainer - INFO -   1. rf_medium: Score=0.014, MAE=$134, RMSE=$386, RÂ²=1.000 [SELECTED]
2025-06-04 20:37:59,366 - MoETrainer - INFO -   2. rf_shallow: Score=0.033, MAE=$373, RMSE=$896, RÂ²=0.999
2025-06-04 20:37:59,366 - MoETrainer - INFO -   3. xgb_balanced: Score=0.050, MAE=$989, RMSE=$1347, RÂ²=0.998
2025-06-04 20:37:59,368 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-04 20:38:00,079 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 20:38:00,079 - MoETrainer - INFO -   1. rf_medium: Score=0.018, MAE=$356, RMSE=$792, RÂ²=1.000 [SELECTED]
2025-06-04 20:38:00,080 - MoETrainer - INFO -   2. rf_shallow: Score=0.044, MAE=$1062, RMSE=$1924, RÂ²=0.998
2025-06-04 20:38:00,080 - MoETrainer - INFO -   3. xgb_balanced: Score=0.047, MAE=$1245, RMSE=$2010, RÂ²=0.998
2025-06-04 20:38:00,080 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-04 20:38:00,852 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 20:38:00,859 - MoETrainer - INFO -   1. rf_medium: Score=0.026, MAE=$2411, RMSE=$6573, RÂ²=0.999 [SELECTED]
2025-06-04 20:38:00,860 - MoETrainer - INFO -   2. rf_shallow: Score=0.037, MAE=$4046, RMSE=$9359, RÂ²=0.999
2025-06-04 20:38:00,860 - MoETrainer - INFO -   3. xgb_balanced: Score=0.071, MAE=$10767, RMSE=$16873, RÂ²=0.996
2025-06-04 20:38:00,861 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:38:01,293 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 533 samples
2025-06-04 20:38:01,689 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 632 samples
2025-06-04 20:38:02,102 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 621 samples
2025-06-04 20:38:02,527 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 596 samples
2025-06-04 20:38:02,978 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 584 samples
2025-06-04 20:38:03,513 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 610 samples
2025-06-04 20:38:03,514 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 20:38:03,626 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:38:03,627 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:38:03,627 - MoETrainer - INFO -   RMSE: $1,202
2025-06-04 20:38:03,627 - MoETrainer - INFO -   MAE: $337 (0.1% of mean)
2025-06-04 20:38:03,627 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:38:03,628 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:38:03,628 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:38:03,628 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:38:03,629 - MoETrainer - INFO -   Within 5%: 100.0% of predictions
2025-06-04 20:38:03,629 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:38:03,629 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:38:03,630 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:38:03,630 - MoETrainer - INFO -   Bin 0: RMSE=$521, RÂ²=0.9998, Samples=165
2025-06-04 20:38:03,630 - MoETrainer - INFO -   Bin 1: RMSE=$315, RÂ²=0.9998, Samples=193
2025-06-04 20:38:03,631 - MoETrainer - INFO -   Bin 2: RMSE=$319, RÂ²=0.9998, Samples=161
2025-06-04 20:38:03,631 - MoETrainer - INFO -   Bin 3: RMSE=$347, RÂ²=0.9998, Samples=189
2025-06-04 20:38:03,632 - MoETrainer - INFO -   Bin 4: RMSE=$558, RÂ²=0.9998, Samples=185
2025-06-04 20:38:03,632 - MoETrainer - INFO -   Bin 5: RMSE=$2,621, RÂ²=0.9999, Samples=208
2025-06-04 20:38:03,634 - MoETrainer - INFO -   6 bins: RÂ²=1.0000, RMSE=$1,202
2025-06-04 20:38:03,635 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 20:38:03,635 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 20:38:03,637 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 20:38:03,637 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 20:38:03,639 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 20:38:03,641 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-04 20:38:04,338 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 20:38:04,340 - MoETrainer - INFO -   1. rf_medium: Score=0.025, MAE=$313, RMSE=$851, RÂ²=0.999 [SELECTED]
2025-06-04 20:38:04,344 - MoETrainer - INFO -   2. rf_shallow: Score=0.047, MAE=$696, RMSE=$1576, RÂ²=0.998
2025-06-04 20:38:04,348 - MoETrainer - INFO -   3. xgb_balanced: Score=0.052, MAE=$1186, RMSE=$1673, RÂ²=0.998
2025-06-04 20:38:04,357 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-04 20:38:05,072 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 20:38:05,073 - MoETrainer - INFO -   1. rf_medium: Score=0.014, MAE=$98, RMSE=$306, RÂ²=1.000 [SELECTED]
2025-06-04 20:38:05,073 - MoETrainer - INFO -   2. rf_shallow: Score=0.026, MAE=$216, RMSE=$552, RÂ²=0.999
2025-06-04 20:38:05,074 - MoETrainer - INFO -   3. xgb_balanced: Score=0.040, MAE=$561, RMSE=$837, RÂ²=0.999
2025-06-04 20:38:05,074 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-04 20:38:05,753 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 20:38:05,754 - MoETrainer - INFO -   1. rf_medium: Score=0.024, MAE=$163, RMSE=$481, RÂ²=0.999 [SELECTED]
2025-06-04 20:38:05,754 - MoETrainer - INFO -   2. rf_shallow: Score=0.025, MAE=$238, RMSE=$494, RÂ²=0.999
2025-06-04 20:38:05,755 - MoETrainer - INFO -   3. xgb_balanced: Score=0.040, MAE=$530, RMSE=$798, RÂ²=0.998
2025-06-04 20:38:05,755 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-04 20:38:06,460 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 20:38:06,460 - MoETrainer - INFO -   1. rf_medium: Score=0.014, MAE=$134, RMSE=$386, RÂ²=1.000 [SELECTED]
2025-06-04 20:38:06,460 - MoETrainer - INFO -   2. rf_shallow: Score=0.033, MAE=$373, RMSE=$896, RÂ²=0.999
2025-06-04 20:38:06,460 - MoETrainer - INFO -   3. xgb_balanced: Score=0.050, MAE=$989, RMSE=$1347, RÂ²=0.998
2025-06-04 20:38:06,460 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-04 20:38:07,150 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 20:38:07,150 - MoETrainer - INFO -   1. rf_medium: Score=0.018, MAE=$356, RMSE=$792, RÂ²=1.000 [SELECTED]
2025-06-04 20:38:07,150 - MoETrainer - INFO -   2. rf_shallow: Score=0.044, MAE=$1062, RMSE=$1924, RÂ²=0.998
2025-06-04 20:38:07,150 - MoETrainer - INFO -   3. xgb_balanced: Score=0.047, MAE=$1245, RMSE=$2010, RÂ²=0.998
2025-06-04 20:38:07,150 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-04 20:38:07,930 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 20:38:07,930 - MoETrainer - INFO -   1. rf_medium: Score=0.026, MAE=$2411, RMSE=$6573, RÂ²=0.999 [SELECTED]
2025-06-04 20:38:07,930 - MoETrainer - INFO -   2. rf_shallow: Score=0.037, MAE=$4046, RMSE=$9359, RÂ²=0.999
2025-06-04 20:38:07,930 - MoETrainer - INFO -   3. xgb_balanced: Score=0.071, MAE=$10767, RMSE=$16873, RÂ²=0.996
2025-06-04 20:38:07,930 - MoETrainer - INFO - Training selected expert models...
2025-06-04 20:38:08,364 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 533 samples
2025-06-04 20:38:08,757 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 632 samples
2025-06-04 20:38:09,178 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 621 samples
2025-06-04 20:38:09,594 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 596 samples
2025-06-04 20:38:10,022 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 584 samples
2025-06-04 20:38:10,548 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 610 samples
2025-06-04 20:38:10,550 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 20:38:10,662 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 20:38:10,662 - MoETrainer - INFO - Overall Performance:
2025-06-04 20:38:10,662 - MoETrainer - INFO -   RMSE: $1,202
2025-06-04 20:38:10,663 - MoETrainer - INFO -   MAE: $337 (0.1% of mean)
2025-06-04 20:38:10,663 - MoETrainer - INFO -   RÂ²: 1.0000
2025-06-04 20:38:10,664 - MoETrainer - INFO -   MAPE: 0.0%
2025-06-04 20:38:10,664 - MoETrainer - INFO -   MPE: +0.0% (bias: overprediction)
2025-06-04 20:38:10,664 - MoETrainer - INFO -   Median APE: 0.0%
2025-06-04 20:38:10,664 - MoETrainer - INFO -   Within 5%: 100.0% of predictions
2025-06-04 20:38:10,664 - MoETrainer - INFO -   Within 10%: 100.0% of predictions
2025-06-04 20:38:10,665 - MoETrainer - INFO -   Within 15%: 100.0% of predictions
2025-06-04 20:38:10,665 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 20:38:10,665 - MoETrainer - INFO -   Bin 0: RMSE=$521, RÂ²=0.9998, Samples=165
2025-06-04 20:38:10,666 - MoETrainer - INFO -   Bin 1: RMSE=$315, RÂ²=0.9998, Samples=193
2025-06-04 20:38:10,666 - MoETrainer - INFO -   Bin 2: RMSE=$319, RÂ²=0.9998, Samples=161
2025-06-04 20:38:10,666 - MoETrainer - INFO -   Bin 3: RMSE=$347, RÂ²=0.9998, Samples=189
2025-06-04 20:38:10,667 - MoETrainer - INFO -   Bin 4: RMSE=$558, RÂ²=0.9998, Samples=185
2025-06-04 20:38:10,667 - MoETrainer - INFO -   Bin 5: RMSE=$2,621, RÂ²=0.9999, Samples=208
2025-06-04 20:38:10,667 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 20:38:10,668 - MoETrainer - INFO -   Bin 0: rf_medium
2025-06-04 20:38:10,668 - MoETrainer - INFO -   Bin 1: rf_medium
2025-06-04 20:38:10,669 - MoETrainer - INFO -   Bin 2: rf_medium
2025-06-04 20:38:10,669 - MoETrainer - INFO -   Bin 3: rf_medium
2025-06-04 20:38:10,669 - MoETrainer - INFO -   Bin 4: rf_medium
2025-06-04 20:38:10,670 - MoETrainer - INFO -   Bin 5: rf_medium
2025-06-04 20:38:10,670 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 20:38:10,670 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 20:38:10,671 - MoETrainer - INFO - Final Performance: RÂ² = 1.0000
2025-06-04 20:38:10,672 - MoETrainer - INFO - Final RMSE: $1,202
2025-06-04 20:38:10,675 - MoETrainer - INFO - Final MAE: $337
2025-06-04 22:02:07,928 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-04 22:02:07,928 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-04 22:02:07,928 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-04 22:02:08,442 - MoETrainer - INFO - Raw data shape: (5525, 745)
2025-06-04 22:02:08,445 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-04 22:02:08,449 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-04 22:02:08,476 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-04 22:02:11,290 - MoETrainer - INFO - Consolidated to 13 features
2025-06-04 22:02:11,326 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-04 22:02:11,326 - MoETrainer - INFO - Loaded dataset: 5525 samples, 15 features
2025-06-04 22:02:11,327 - MoETrainer - INFO - Target statistics: mean=$543,777, std=$289,820
2025-06-04 22:02:11,328 - MoETrainer - INFO - Target range: [$149,000, $2,485,000]
2025-06-04 22:02:11,328 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-04 22:02:11,330 - MoETrainer - INFO - Removed 22 outliers (0.4%)
2025-06-04 22:02:11,342 - MoETrainer - INFO - Applied robust scaling
2025-06-04 22:02:11,343 - MoETrainer - INFO - Splitting data...
2025-06-04 22:02:11,347 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-04 22:02:11,348 - MoETrainer - INFO - Train target: mean=$535,714, std=$267,185
2025-06-04 22:02:11,348 - MoETrainer - INFO - Test target: mean=$550,320, std=$279,941
2025-06-04 22:02:11,349 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-04 22:02:11,350 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 22:02:11,351 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 22:02:11,351 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 22:02:11,352 - MoETrainer - INFO - Bin 0: Large bin (1165), using CV selection
2025-06-04 22:02:14,440 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 22:02:14,441 - MoETrainer - INFO -   1. xgb_conservative: MSE=2248866944Â±151247400, RÂ²=0.147 [SELECTED]
2025-06-04 22:02:14,441 - MoETrainer - INFO -   2. rf_shallow: MSE=2295483764Â±175383637, RÂ²=0.130
2025-06-04 22:02:14,441 - MoETrainer - INFO -   3. xgb_balanced: MSE=2313097899Â±183084443, RÂ²=0.123
2025-06-04 22:02:14,442 - MoETrainer - INFO - Bin 1: Large bin (1217), using CV selection
2025-06-04 22:02:17,745 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 22:02:17,745 - MoETrainer - INFO -   1. xgb_conservative: MSE=2004258603Â±59239375, RÂ²=0.150 [SELECTED]
2025-06-04 22:02:17,745 - MoETrainer - INFO -   2. rf_shallow: MSE=2021611240Â±74284372, RÂ²=0.142
2025-06-04 22:02:17,746 - MoETrainer - INFO -   3. rf_medium: MSE=2036781232Â±75496684, RÂ²=0.136
2025-06-04 22:02:17,746 - MoETrainer - INFO - Bin 2: Large bin (1194), using CV selection
2025-06-04 22:02:21,280 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 22:02:21,281 - MoETrainer - INFO -   1. xgb_conservative: MSE=52465810091Â±2914131108, RÂ²=0.314 [SELECTED]
2025-06-04 22:02:21,281 - MoETrainer - INFO -   2. rf_medium: MSE=52517779381Â±3068690025, RÂ²=0.313
2025-06-04 22:02:21,281 - MoETrainer - INFO -   3. xgb_balanced: MSE=53155876864Â±2542668687, RÂ²=0.305
2025-06-04 22:02:21,283 - MoETrainer - INFO - Training selected expert models...
2025-06-04 22:02:21,335 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1165 samples
2025-06-04 22:02:21,387 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1217 samples
2025-06-04 22:02:21,440 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1194 samples
2025-06-04 22:02:21,441 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-04 22:02:21,459 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 22:02:21,459 - MoETrainer - INFO - Overall Performance:
2025-06-04 22:02:21,460 - MoETrainer - INFO -   RMSE: $145,003
2025-06-04 22:02:21,460 - MoETrainer - INFO -   MAE: $82,260 (14.9% of mean)
2025-06-04 22:02:21,460 - MoETrainer - INFO -   RÂ²: 0.7317
2025-06-04 22:02:21,461 - MoETrainer - INFO -   MAPE: 13.3%
2025-06-04 22:02:21,461 - MoETrainer - INFO -   MPE: +2.5% (bias: overprediction)
2025-06-04 22:02:21,461 - MoETrainer - INFO -   Median APE: 9.9%
2025-06-04 22:02:21,462 - MoETrainer - INFO -   Within 5%: 26.3% of predictions
2025-06-04 22:02:21,462 - MoETrainer - INFO -   Within 10%: 50.2% of predictions
2025-06-04 22:02:21,462 - MoETrainer - INFO -   Within 15%: 67.0% of predictions
2025-06-04 22:02:21,463 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 22:02:21,463 - MoETrainer - INFO -   Bin 0: RMSE=$45,349, RÂ²=0.2364, Samples=358
2025-06-04 22:02:21,464 - MoETrainer - INFO -   Bin 1: RMSE=$44,496, RÂ²=0.1442, Samples=350
2025-06-04 22:02:21,464 - MoETrainer - INFO -   Bin 2: RMSE=$235,092, RÂ²=0.2973, Samples=393
2025-06-04 22:02:21,465 - MoETrainer - INFO -   3 bins: RÂ²=0.7317, RMSE=$145,003
2025-06-04 22:02:21,466 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 22:02:21,467 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 22:02:21,468 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 22:02:21,469 - MoETrainer - INFO - Bin 0: Large bin (887), using CV selection
2025-06-04 22:02:24,118 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-04 22:02:24,118 - MoETrainer - INFO -   1. xgb_conservative: MSE=1699376469Â±112481401, RÂ²=0.135 [SELECTED]
2025-06-04 22:02:24,119 - MoETrainer - INFO -   2. rf_shallow: MSE=1734470679Â±104281772, RÂ²=0.118
2025-06-04 22:02:24,119 - MoETrainer - INFO -   3. rf_medium: MSE=1749125603Â±91301604, RÂ²=0.110
2025-06-04 22:02:24,119 - MoETrainer - INFO - Bin 1: Large bin (899), using CV selection
2025-06-04 22:02:26,793 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-04 22:02:26,794 - MoETrainer - INFO -   1. xgb_conservative: MSE=737793707Â±14275717, RÂ²=0.040 [SELECTED]
2025-06-04 22:02:26,794 - MoETrainer - INFO -   2. ridge_heavy: MSE=737826389Â±15099293, RÂ²=0.040
2025-06-04 22:02:26,795 - MoETrainer - INFO -   3. ridge_light: MSE=738881536Â±15267667, RÂ²=0.039
2025-06-04 22:02:26,796 - MoETrainer - INFO - Bin 2: Large bin (869), using CV selection
2025-06-04 22:02:29,482 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-04 22:02:29,482 - MoETrainer - INFO -   1. rf_shallow: MSE=1834980134Â±50692358, RÂ²=0.068 [SELECTED]
2025-06-04 22:02:29,482 - MoETrainer - INFO -   2. xgb_conservative: MSE=1863295147Â±70599990, RÂ²=0.053
2025-06-04 22:02:29,482 - MoETrainer - INFO -   3. rf_medium: MSE=1895010255Â±42666115, RÂ²=0.037
2025-06-04 22:02:29,483 - MoETrainer - INFO - Bin 3: Large bin (921), using CV selection
2025-06-04 22:02:32,382 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-04 22:02:32,382 - MoETrainer - INFO -   1. ridge_heavy: MSE=58603895467Â±2606958159, RÂ²=0.249 [SELECTED]
2025-06-04 22:02:32,383 - MoETrainer - INFO -   2. ridge_medium: MSE=58691986773Â±2553100480, RÂ²=0.248
2025-06-04 22:02:32,383 - MoETrainer - INFO -   3. ridge_light: MSE=58793007787Â±2644117710, RÂ²=0.247
2025-06-04 22:02:32,383 - MoETrainer - INFO - Training selected expert models...
2025-06-04 22:02:32,428 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 887 samples
2025-06-04 22:02:32,470 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 899 samples
2025-06-04 22:02:32,703 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 869 samples
2025-06-04 22:02:32,706 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 921 samples
2025-06-04 22:02:32,707 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-04 22:02:32,735 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 22:02:32,735 - MoETrainer - INFO - Overall Performance:
2025-06-04 22:02:32,736 - MoETrainer - INFO -   RMSE: $131,978
2025-06-04 22:02:32,736 - MoETrainer - INFO -   MAE: $71,749 (13.0% of mean)
2025-06-04 22:02:32,736 - MoETrainer - INFO -   RÂ²: 0.7777
2025-06-04 22:02:32,737 - MoETrainer - INFO -   MAPE: 11.3%
2025-06-04 22:02:32,737 - MoETrainer - INFO -   MPE: +2.5% (bias: overprediction)
2025-06-04 22:02:32,737 - MoETrainer - INFO -   Median APE: 8.4%
2025-06-04 22:02:32,738 - MoETrainer - INFO -   Within 5%: 26.7% of predictions
2025-06-04 22:02:32,738 - MoETrainer - INFO -   Within 10%: 61.1% of predictions
2025-06-04 22:02:32,739 - MoETrainer - INFO -   Within 15%: 77.6% of predictions
2025-06-04 22:02:32,739 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 22:02:32,739 - MoETrainer - INFO -   Bin 0: RMSE=$39,994, RÂ²=0.2190, Samples=271
2025-06-04 22:02:32,739 - MoETrainer - INFO -   Bin 1: RMSE=$28,041, RÂ²=0.0240, Samples=248
2025-06-04 22:02:32,741 - MoETrainer - INFO -   Bin 2: RMSE=$44,628, RÂ²=0.0243, Samples=275
2025-06-04 22:02:32,741 - MoETrainer - INFO -   Bin 3: RMSE=$242,148, RÂ²=0.2574, Samples=307
2025-06-04 22:02:32,742 - MoETrainer - INFO -   4 bins: RÂ²=0.7777, RMSE=$131,978
2025-06-04 22:02:32,743 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 22:02:32,744 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 22:02:32,744 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 22:02:32,745 - MoETrainer - INFO - Bin 0: Small bin (715), using rule-based selection
2025-06-04 22:02:33,553 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 22:02:33,553 - MoETrainer - INFO -   1. ridge_medium: Score=1.043, MAE=$28340, RMSE=$34390, RÂ²=0.106 [SELECTED]
2025-06-04 22:02:33,554 - MoETrainer - INFO -   2. elastic_light: Score=1.057, MAE=$28865, RMSE=$34815, RÂ²=0.084
2025-06-04 22:02:33,555 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$29041, RMSE=$34831, RÂ²=0.083
2025-06-04 22:02:33,555 - MoETrainer - INFO - Bin 1: Small bin (715), using rule-based selection
2025-06-04 22:02:34,359 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 22:02:34,359 - MoETrainer - INFO -   1. elastic_light: Score=1.142, MAE=$17523, RMSE=$20565, RÂ²=-0.038 [SELECTED]
2025-06-04 22:02:34,359 - MoETrainer - INFO -   2. rf_shallow: Score=1.156, MAE=$17197, RMSE=$20626, RÂ²=-0.044
2025-06-04 22:02:34,359 - MoETrainer - INFO -   3. rf_medium: Score=1.170, MAE=$17148, RMSE=$20683, RÂ²=-0.050
2025-06-04 22:02:34,359 - MoETrainer - INFO - Bin 2: Small bin (715), using rule-based selection
2025-06-04 22:02:35,188 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 22:02:35,188 - MoETrainer - INFO -   1. xgb_conservative: Score=1.063, MAE=$22364, RMSE=$26541, RÂ²=-0.006 [SELECTED]
2025-06-04 22:02:35,188 - MoETrainer - INFO -   2. rf_shallow: Score=1.154, MAE=$22867, RMSE=$27008, RÂ²=-0.042
2025-06-04 22:02:35,188 - MoETrainer - INFO -   3. rf_medium: Score=1.158, MAE=$22548, RMSE=$27033, RÂ²=-0.044
2025-06-04 22:02:35,188 - MoETrainer - INFO - Bin 3: Small bin (712), using rule-based selection
2025-06-04 22:02:36,018 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 22:02:36,018 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$39739, RMSE=$47163, RÂ²=0.023 [SELECTED]
2025-06-04 22:02:36,018 - MoETrainer - INFO -   2. elastic_light: Score=1.058, MAE=$40230, RMSE=$47222, RÂ²=0.020
2025-06-04 22:02:36,018 - MoETrainer - INFO -   3. rf_shallow: Score=1.059, MAE=$39699, RMSE=$47311, RÂ²=0.016
2025-06-04 22:02:36,018 - MoETrainer - INFO - Bin 4: Small bin (719), using rule-based selection
2025-06-04 22:02:36,899 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 22:02:36,899 - MoETrainer - INFO -   1. elastic_light: Score=1.114, MAE=$198091, RMSE=$277429, RÂ²=0.170 [SELECTED]
2025-06-04 22:02:36,900 - MoETrainer - INFO -   2. ridge_medium: Score=1.120, MAE=$199365, RMSE=$278891, RÂ²=0.161
2025-06-04 22:02:36,900 - MoETrainer - INFO -   3. rf_shallow: Score=1.127, MAE=$198801, RMSE=$281185, RÂ²=0.147
2025-06-04 22:02:36,900 - MoETrainer - INFO - Training selected expert models...
2025-06-04 22:02:36,903 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 715 samples
2025-06-04 22:02:36,906 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 715 samples
2025-06-04 22:02:36,953 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 715 samples
2025-06-04 22:02:36,998 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 3: 712 samples
2025-06-04 22:02:37,007 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 719 samples
2025-06-04 22:02:37,007 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-04 22:02:37,031 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 22:02:37,033 - MoETrainer - INFO - Overall Performance:
2025-06-04 22:02:37,034 - MoETrainer - INFO -   RMSE: $117,870
2025-06-04 22:02:37,035 - MoETrainer - INFO -   MAE: $61,763 (11.2% of mean)
2025-06-04 22:02:37,035 - MoETrainer - INFO -   RÂ²: 0.8227
2025-06-04 22:02:37,035 - MoETrainer - INFO -   MAPE: 9.5%
2025-06-04 22:02:37,036 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-04 22:02:37,036 - MoETrainer - INFO -   Median APE: 7.0%
2025-06-04 22:02:37,036 - MoETrainer - INFO -   Within 5%: 38.8% of predictions
2025-06-04 22:02:37,037 - MoETrainer - INFO -   Within 10%: 68.8% of predictions
2025-06-04 22:02:37,037 - MoETrainer - INFO -   Within 15%: 84.0% of predictions
2025-06-04 22:02:37,037 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 22:02:37,038 - MoETrainer - INFO -   Bin 0: RMSE=$38,437, RÂ²=0.1697, Samples=224
2025-06-04 22:02:37,038 - MoETrainer - INFO -   Bin 1: RMSE=$20,271, RÂ²=-0.0011, Samples=203
2025-06-04 22:02:37,038 - MoETrainer - INFO -   Bin 2: RMSE=$26,016, RÂ²=0.0540, Samples=209
2025-06-04 22:02:37,039 - MoETrainer - INFO -   Bin 3: RMSE=$46,606, RÂ²=0.0586, Samples=224
2025-06-04 22:02:37,040 - MoETrainer - INFO -   Bin 4: RMSE=$243,200, RÂ²=0.2468, Samples=241
2025-06-04 22:02:37,041 - MoETrainer - INFO -   5 bins: RÂ²=0.8227, RMSE=$117,870
2025-06-04 22:02:37,042 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 22:02:37,042 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 22:02:37,043 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 22:02:37,043 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-04 22:02:37,748 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 22:02:37,748 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-04 22:02:37,750 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-04 22:02:37,750 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-04 22:02:37,750 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-04 22:02:38,505 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 22:02:38,505 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-04 22:02:38,505 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-04 22:02:38,505 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-04 22:02:38,505 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-04 22:02:39,268 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 22:02:39,268 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-04 22:02:39,268 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-04 22:02:39,268 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-04 22:02:39,268 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-04 22:02:40,033 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 22:02:40,033 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-04 22:02:40,033 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-04 22:02:40,033 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-04 22:02:40,033 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-04 22:02:40,805 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 22:02:40,806 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-04 22:02:40,806 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-04 22:02:40,807 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-04 22:02:40,807 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-04 22:02:41,603 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 22:02:41,604 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-04 22:02:41,604 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-04 22:02:41,604 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-04 22:02:41,605 - MoETrainer - INFO - Training selected expert models...
2025-06-04 22:02:41,607 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-04 22:02:41,804 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-04 22:02:41,840 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-04 22:02:42,023 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-04 22:02:42,026 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-04 22:02:42,029 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-04 22:02:42,029 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 22:02:42,076 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 22:02:42,076 - MoETrainer - INFO - Overall Performance:
2025-06-04 22:02:42,077 - MoETrainer - INFO -   RMSE: $110,663
2025-06-04 22:02:42,077 - MoETrainer - INFO -   MAE: $56,069 (10.2% of mean)
2025-06-04 22:02:42,077 - MoETrainer - INFO -   RÂ²: 0.8437
2025-06-04 22:02:42,078 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-04 22:02:42,078 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-04 22:02:42,079 - MoETrainer - INFO -   Median APE: 6.0%
2025-06-04 22:02:42,079 - MoETrainer - INFO -   Within 5%: 41.7% of predictions
2025-06-04 22:02:42,079 - MoETrainer - INFO -   Within 10%: 75.7% of predictions
2025-06-04 22:02:42,080 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-04 22:02:42,080 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 22:02:42,081 - MoETrainer - INFO -   Bin 0: RMSE=$35,762, RÂ²=0.0641, Samples=165
2025-06-04 22:02:42,081 - MoETrainer - INFO -   Bin 1: RMSE=$20,318, RÂ²=-0.0196, Samples=193
2025-06-04 22:02:42,082 - MoETrainer - INFO -   Bin 2: RMSE=$20,547, RÂ²=0.0539, Samples=161
2025-06-04 22:02:42,082 - MoETrainer - INFO -   Bin 3: RMSE=$27,860, RÂ²=-0.0529, Samples=189
2025-06-04 22:02:42,084 - MoETrainer - INFO -   Bin 4: RMSE=$44,882, RÂ²=-0.0086, Samples=185
2025-06-04 22:02:42,084 - MoETrainer - INFO -   Bin 5: RMSE=$246,175, RÂ²=0.2126, Samples=208
2025-06-04 22:02:42,085 - MoETrainer - INFO -   6 bins: RÂ²=0.8437, RMSE=$110,663
2025-06-04 22:02:42,085 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-04 22:02:42,085 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-04 22:02:42,087 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-04 22:02:42,088 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-04 22:02:42,088 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-04 22:02:42,089 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-04 22:02:42,809 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-04 22:02:42,809 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-04 22:02:42,809 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-04 22:02:42,809 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-04 22:02:42,809 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-04 22:02:43,614 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-04 22:02:43,614 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-04 22:02:43,614 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-04 22:02:43,616 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-04 22:02:43,616 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-04 22:02:44,413 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-04 22:02:44,413 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-04 22:02:44,414 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-04 22:02:44,414 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-04 22:02:44,415 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-04 22:02:45,209 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-04 22:02:45,210 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-04 22:02:45,210 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-04 22:02:45,210 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-04 22:02:45,211 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-04 22:02:45,980 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-04 22:02:45,980 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-04 22:02:45,981 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-04 22:02:45,981 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-04 22:02:45,982 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-04 22:02:46,802 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-04 22:02:46,802 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-04 22:02:46,802 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-04 22:02:46,802 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-04 22:02:46,802 - MoETrainer - INFO - Training selected expert models...
2025-06-04 22:02:46,812 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-04 22:02:46,997 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-04 22:02:47,034 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-04 22:02:47,216 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-04 22:02:47,216 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-04 22:02:47,216 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-04 22:02:47,216 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-04 22:02:47,266 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-04 22:02:47,266 - MoETrainer - INFO - Overall Performance:
2025-06-04 22:02:47,266 - MoETrainer - INFO -   RMSE: $110,663
2025-06-04 22:02:47,266 - MoETrainer - INFO -   MAE: $56,069 (10.2% of mean)
2025-06-04 22:02:47,266 - MoETrainer - INFO -   RÂ²: 0.8437
2025-06-04 22:02:47,266 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-04 22:02:47,266 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Median APE: 6.0%
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Within 5%: 41.7% of predictions
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Within 10%: 75.7% of predictions
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-04 22:02:47,266 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 0: RMSE=$35,762, RÂ²=0.0641, Samples=165
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 1: RMSE=$20,318, RÂ²=-0.0196, Samples=193
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 2: RMSE=$20,547, RÂ²=0.0539, Samples=161
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 3: RMSE=$27,860, RÂ²=-0.0529, Samples=189
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 4: RMSE=$44,882, RÂ²=-0.0086, Samples=185
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 5: RMSE=$246,175, RÂ²=0.2126, Samples=208
2025-06-04 22:02:47,266 - MoETrainer - INFO - Final Expert Configuration:
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 0: elastic_light
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 1: rf_shallow
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 2: xgb_conservative
2025-06-04 22:02:47,266 - MoETrainer - INFO -   Bin 3: rf_shallow
2025-06-04 22:02:47,275 - MoETrainer - INFO -   Bin 4: ridge_medium
2025-06-04 22:02:47,275 - MoETrainer - INFO -   Bin 5: elastic_light
2025-06-04 22:02:47,275 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-04 22:02:47,275 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-04 22:02:47,276 - MoETrainer - INFO - Final Performance: RÂ² = 0.8437
2025-06-04 22:02:47,276 - MoETrainer - INFO - Final RMSE: $110,663
2025-06-04 22:02:47,276 - MoETrainer - INFO - Final MAE: $56,069
2025-06-05 21:17:14,130 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-05 21:17:14,131 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-05 21:17:14,131 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-05 21:17:15,096 - MoETrainer - INFO - Raw data shape: (151630, 26)
2025-06-05 21:17:15,833 - MoETrainer - INFO - Final features: 23 (from 27 after consolidation)
2025-06-05 21:17:15,844 - MoETrainer - INFO - Loaded dataset: 151630 samples, 23 features
2025-06-05 21:17:15,847 - MoETrainer - INFO - Target statistics: mean=$409, std=$249
2025-06-05 21:17:15,847 - MoETrainer - INFO - Target range: [$0, $4,900]
2025-06-05 21:17:15,848 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-05 21:17:15,896 - MoETrainer - INFO - Removed 453 outliers (0.3%)
2025-06-05 21:17:15,927 - MoETrainer - INFO - Applying smart feature selection from 23 features...
2025-06-05 21:18:10,882 - MoETrainer - INFO - Selected 16 features using hybrid selection
2025-06-05 21:18:11,003 - MoETrainer - INFO - Applied robust scaling
2025-06-05 21:18:11,008 - MoETrainer - INFO - Splitting data...
2025-06-05 21:18:11,098 - MoETrainer - INFO - Data split - Train: 98264, Val: 22677, Test: 30236
2025-06-05 21:18:11,099 - MoETrainer - INFO - Train target: mean=$405, std=$229
2025-06-05 21:18:11,099 - MoETrainer - INFO - Test target: mean=$402, std=$226
2025-06-05 21:18:11,100 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-05 21:18:11,108 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:18:11,108 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:18:11,109 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:18:11,113 - MoETrainer - INFO - Bin 0: Large bin (32691), using CV selection
2025-06-05 21:19:38,337 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-05 21:19:38,338 - MoETrainer - INFO -   1. rf_medium: MSE=6Â±0, RÂ²=0.998 [SELECTED]
2025-06-05 21:19:38,338 - MoETrainer - INFO -   2. xgb_balanced: MSE=14Â±0, RÂ²=0.995
2025-06-05 21:19:38,338 - MoETrainer - INFO -   3. rf_shallow: MSE=202Â±14, RÂ²=0.930
2025-06-05 21:19:38,344 - MoETrainer - INFO - Bin 1: Large bin (32483), using CV selection
2025-06-05 21:21:05,417 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-05 21:21:05,418 - MoETrainer - INFO -   1. rf_medium: MSE=19Â±1, RÂ²=0.991 [SELECTED]
2025-06-05 21:21:05,418 - MoETrainer - INFO -   2. xgb_balanced: MSE=23Â±3, RÂ²=0.989
2025-06-05 21:21:05,419 - MoETrainer - INFO -   3. ridge_light: MSE=249Â±19, RÂ²=0.877
2025-06-05 21:21:05,426 - MoETrainer - INFO - Bin 2: Large bin (33090), using CV selection
2025-06-05 21:22:33,658 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-05 21:22:33,658 - MoETrainer - INFO -   1. rf_medium: MSE=73Â±19, RÂ²=0.998 [SELECTED]
2025-06-05 21:22:33,659 - MoETrainer - INFO -   2. xgb_balanced: MSE=170Â±15, RÂ²=0.996
2025-06-05 21:22:33,659 - MoETrainer - INFO -   3. ridge_light: MSE=2203Â±86, RÂ²=0.954
2025-06-05 21:22:33,660 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:23:06,320 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 32691 samples
2025-06-05 21:23:38,894 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 32483 samples
2025-06-05 21:24:13,084 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 33090 samples
2025-06-05 21:24:13,085 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-05 21:24:13,730 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:24:13,730 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:24:13,731 - MoETrainer - INFO -   RMSE: $5
2025-06-05 21:24:13,731 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-05 21:24:13,731 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-05 21:24:13,731 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-05 21:24:13,733 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-05 21:24:13,733 - MoETrainer - INFO -   Median APE: 0.3%
2025-06-05 21:24:13,733 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-05 21:24:13,733 - MoETrainer - INFO -   Within 10%: 99.7% of predictions
2025-06-05 21:24:13,734 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-05 21:24:13,734 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:24:13,734 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9988, Samples=10098
2025-06-05 21:24:13,735 - MoETrainer - INFO -   Bin 1: RMSE=$4, RÂ²=0.9913, Samples=10079
2025-06-05 21:24:13,735 - MoETrainer - INFO -   Bin 2: RMSE=$7, RÂ²=0.9990, Samples=10059
2025-06-05 21:24:13,735 - MoETrainer - INFO -   3 bins: RÂ²=0.9996, RMSE=$5
2025-06-05 21:24:13,744 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:24:13,744 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:24:13,745 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:24:13,752 - MoETrainer - INFO - Bin 0: Large bin (24533), using CV selection
2025-06-05 21:25:30,808 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-05 21:25:30,808 - MoETrainer - INFO -   1. rf_medium: MSE=6Â±1, RÂ²=0.997 [SELECTED]
2025-06-05 21:25:30,809 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.995
2025-06-05 21:25:30,809 - MoETrainer - INFO -   3. rf_shallow: MSE=150Â±10, RÂ²=0.930
2025-06-05 21:25:30,816 - MoETrainer - INFO - Bin 1: Large bin (24394), using CV selection
2025-06-05 21:26:47,881 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-05 21:26:47,881 - MoETrainer - INFO -   1. xgb_balanced: MSE=12Â±1, RÂ²=0.987 [SELECTED]
2025-06-05 21:26:47,881 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±3, RÂ²=0.978
2025-06-05 21:26:47,881 - MoETrainer - INFO -   3. ridge_light: MSE=172Â±11, RÂ²=0.818
2025-06-05 21:26:47,889 - MoETrainer - INFO - Bin 2: Large bin (24366), using CV selection
2025-06-05 21:27:57,730 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-05 21:27:57,731 - MoETrainer - INFO -   1. xgb_balanced: MSE=21Â±4, RÂ²=0.987 [SELECTED]
2025-06-05 21:27:57,731 - MoETrainer - INFO -   2. rf_medium: MSE=85Â±7, RÂ²=0.949
2025-06-05 21:27:57,731 - MoETrainer - INFO -   3. ridge_light: MSE=238Â±18, RÂ²=0.858
2025-06-05 21:27:57,736 - MoETrainer - INFO - Bin 3: Large bin (24971), using CV selection
2025-06-05 21:29:13,448 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-05 21:29:13,448 - MoETrainer - INFO -   1. rf_medium: MSE=103Â±26, RÂ²=0.998 [SELECTED]
2025-06-05 21:29:13,448 - MoETrainer - INFO -   2. xgb_balanced: MSE=179Â±17, RÂ²=0.996
2025-06-05 21:29:13,448 - MoETrainer - INFO -   3. ridge_light: MSE=2177Â±40, RÂ²=0.955
2025-06-05 21:29:13,450 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:29:40,186 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 24533 samples
2025-06-05 21:29:41,021 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 24394 samples
2025-06-05 21:29:41,811 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 24366 samples
2025-06-05 21:30:07,277 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 24971 samples
2025-06-05 21:30:07,277 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-05 21:30:07,678 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:30:07,679 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:30:07,679 - MoETrainer - INFO -   RMSE: $5
2025-06-05 21:30:07,680 - MoETrainer - INFO -   MAE: $3 (0.6% of mean)
2025-06-05 21:30:07,680 - MoETrainer - INFO -   RÂ²: 0.9995
2025-06-05 21:30:07,680 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-05 21:30:07,681 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-05 21:30:07,681 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-05 21:30:07,682 - MoETrainer - INFO -   Within 5%: 99.4% of predictions
2025-06-05 21:30:07,682 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-05 21:30:07,682 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-05 21:30:07,682 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:30:07,684 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9983, Samples=7643
2025-06-05 21:30:07,684 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9888, Samples=7560
2025-06-05 21:30:07,684 - MoETrainer - INFO -   Bin 2: RMSE=$5, RÂ²=0.9871, Samples=7457
2025-06-05 21:30:07,685 - MoETrainer - INFO -   Bin 3: RMSE=$8, RÂ²=0.9987, Samples=7576
2025-06-05 21:30:07,686 - MoETrainer - INFO -   4 bins: RÂ²=0.9995, RMSE=$5
2025-06-05 21:30:07,695 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:30:07,696 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:30:07,696 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:30:07,711 - MoETrainer - INFO - Bin 0: Large bin (19436), using CV selection
2025-06-05 21:30:59,150 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-05 21:30:59,151 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±2, RÂ²=0.996 [SELECTED]
2025-06-05 21:30:59,151 - MoETrainer - INFO -   2. xgb_balanced: MSE=11Â±3, RÂ²=0.994
2025-06-05 21:30:59,151 - MoETrainer - INFO -   3. xgb_conservative: MSE=157Â±4, RÂ²=0.910
2025-06-05 21:30:59,156 - MoETrainer - INFO - Bin 1: Large bin (19643), using CV selection
2025-06-05 21:31:51,531 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-05 21:31:51,531 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±0, RÂ²=0.982 [SELECTED]
2025-06-05 21:31:51,532 - MoETrainer - INFO -   2. rf_medium: MSE=23Â±2, RÂ²=0.962
2025-06-05 21:31:51,532 - MoETrainer - INFO -   3. ridge_light: MSE=148Â±10, RÂ²=0.752
2025-06-05 21:31:51,537 - MoETrainer - INFO - Bin 2: Large bin (19871), using CV selection
2025-06-05 21:32:46,027 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-05 21:32:46,027 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±0, RÂ²=0.981 [SELECTED]
2025-06-05 21:32:46,028 - MoETrainer - INFO -   2. rf_medium: MSE=55Â±1, RÂ²=0.928
2025-06-05 21:32:46,028 - MoETrainer - INFO -   3. ridge_light: MSE=164Â±4, RÂ²=0.785
2025-06-05 21:32:46,032 - MoETrainer - INFO - Bin 3: Large bin (19631), using CV selection
2025-06-05 21:33:41,479 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-05 21:33:41,480 - MoETrainer - INFO -   1. xgb_balanced: MSE=26Â±2, RÂ²=0.984 [SELECTED]
2025-06-05 21:33:41,480 - MoETrainer - INFO -   2. rf_medium: MSE=118Â±24, RÂ²=0.929
2025-06-05 21:33:41,480 - MoETrainer - INFO -   3. ridge_light: MSE=252Â±10, RÂ²=0.849
2025-06-05 21:33:41,487 - MoETrainer - INFO - Bin 4: Large bin (19683), using CV selection
2025-06-05 21:34:53,522 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-05 21:34:53,523 - MoETrainer - INFO -   1. rf_medium: MSE=110Â±14, RÂ²=0.998 [SELECTED]
2025-06-05 21:34:53,523 - MoETrainer - INFO -   2. xgb_balanced: MSE=189Â±15, RÂ²=0.996
2025-06-05 21:34:53,523 - MoETrainer - INFO -   3. ridge_light: MSE=2151Â±85, RÂ²=0.956
2025-06-05 21:34:53,524 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:35:22,089 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 19436 samples
2025-06-05 21:35:23,070 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 19643 samples
2025-06-05 21:35:24,045 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 19871 samples
2025-06-05 21:35:25,070 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 19631 samples
2025-06-05 21:35:53,241 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 19683 samples
2025-06-05 21:35:53,242 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-05 21:35:53,735 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:35:53,736 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:35:53,737 - MoETrainer - INFO -   RMSE: $5
2025-06-05 21:35:53,737 - MoETrainer - INFO -   MAE: $3 (0.6% of mean)
2025-06-05 21:35:53,738 - MoETrainer - INFO -   RÂ²: 0.9995
2025-06-05 21:35:53,738 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-05 21:35:53,739 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-05 21:35:53,739 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-05 21:35:53,740 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-05 21:35:53,740 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-05 21:35:53,742 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-05 21:35:53,742 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:35:53,743 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=6015
2025-06-05 21:35:53,743 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9867, Samples=6119
2025-06-05 21:35:53,744 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9849, Samples=6123
2025-06-05 21:35:53,744 - MoETrainer - INFO -   Bin 3: RMSE=$5, RÂ²=0.9860, Samples=6087
2025-06-05 21:35:53,745 - MoETrainer - INFO -   Bin 4: RMSE=$9, RÂ²=0.9983, Samples=5892
2025-06-05 21:35:53,752 - MoETrainer - INFO -   5 bins: RÂ²=0.9995, RMSE=$5
2025-06-05 21:35:53,766 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:35:53,769 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:35:53,769 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:35:53,774 - MoETrainer - INFO - Bin 0: Large bin (16200), using CV selection
2025-06-05 21:36:43,596 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-05 21:36:43,596 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±1, RÂ²=0.996 [SELECTED]
2025-06-05 21:36:43,596 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.994
2025-06-05 21:36:43,596 - MoETrainer - INFO -   3. xgb_conservative: MSE=141Â±1, RÂ²=0.909
2025-06-05 21:36:43,604 - MoETrainer - INFO - Bin 1: Large bin (16491), using CV selection
2025-06-05 21:37:30,281 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-05 21:37:30,283 - MoETrainer - INFO -   1. xgb_balanced: MSE=9Â±0, RÂ²=0.978 [SELECTED]
2025-06-05 21:37:30,283 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±1, RÂ²=0.955
2025-06-05 21:37:30,283 - MoETrainer - INFO -   3. ridge_light: MSE=124Â±13, RÂ²=0.712
2025-06-05 21:37:30,287 - MoETrainer - INFO - Bin 2: Large bin (16236), using CV selection
2025-06-05 21:38:16,227 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-05 21:38:16,230 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±1, RÂ²=0.973 [SELECTED]
2025-06-05 21:38:16,230 - MoETrainer - INFO -   2. rf_medium: MSE=45Â±2, RÂ²=0.896
2025-06-05 21:38:16,230 - MoETrainer - INFO -   3. ridge_light: MSE=146Â±17, RÂ²=0.658
2025-06-05 21:38:16,234 - MoETrainer - INFO - Bin 3: Large bin (16247), using CV selection
2025-06-05 21:39:03,135 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-05 21:39:03,137 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±1, RÂ²=0.975 [SELECTED]
2025-06-05 21:39:03,137 - MoETrainer - INFO -   2. rf_medium: MSE=53Â±1, RÂ²=0.911
2025-06-05 21:39:03,137 - MoETrainer - INFO -   3. ridge_light: MSE=165Â±10, RÂ²=0.720
2025-06-05 21:39:03,143 - MoETrainer - INFO - Bin 4: Large bin (16704), using CV selection
2025-06-05 21:39:51,494 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-05 21:39:51,495 - MoETrainer - INFO -   1. xgb_balanced: MSE=28Â±2, RÂ²=0.983 [SELECTED]
2025-06-05 21:39:51,495 - MoETrainer - INFO -   2. rf_medium: MSE=108Â±27, RÂ²=0.935
2025-06-05 21:39:51,495 - MoETrainer - INFO -   3. ridge_light: MSE=267Â±1, RÂ²=0.840
2025-06-05 21:39:51,499 - MoETrainer - INFO - Bin 5: Large bin (16386), using CV selection
2025-06-05 21:40:38,733 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-05 21:40:38,733 - MoETrainer - INFO -   1. rf_medium: MSE=138Â±67, RÂ²=0.997 [SELECTED]
2025-06-05 21:40:38,733 - MoETrainer - INFO -   2. xgb_balanced: MSE=204Â±26, RÂ²=0.996
2025-06-05 21:40:38,733 - MoETrainer - INFO -   3. ridge_light: MSE=2128Â±36, RÂ²=0.957
2025-06-05 21:40:38,735 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:40:55,167 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 16200 samples
2025-06-05 21:40:55,831 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 16491 samples
2025-06-05 21:40:56,462 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 16236 samples
2025-06-05 21:40:57,084 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 16247 samples
2025-06-05 21:40:57,741 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 4: 16704 samples
2025-06-05 21:41:14,912 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 16386 samples
2025-06-05 21:41:14,912 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-05 21:41:15,285 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:41:15,285 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:41:15,286 - MoETrainer - INFO -   RMSE: $5
2025-06-05 21:41:15,286 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-05 21:41:15,286 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-05 21:41:15,288 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-05 21:41:15,288 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-05 21:41:15,288 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-05 21:41:15,289 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-05 21:41:15,289 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-05 21:41:15,289 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-05 21:41:15,289 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:41:15,291 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=5079
2025-06-05 21:41:15,291 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9839, Samples=5019
2025-06-05 21:41:15,291 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9794, Samples=5105
2025-06-05 21:41:15,291 - MoETrainer - INFO -   Bin 3: RMSE=$4, RÂ²=0.9787, Samples=4974
2025-06-05 21:41:15,292 - MoETrainer - INFO -   Bin 4: RMSE=$5, RÂ²=0.9844, Samples=5181
2025-06-05 21:41:15,292 - MoETrainer - INFO -   Bin 5: RMSE=$9, RÂ²=0.9984, Samples=4878
2025-06-05 21:41:15,307 - MoETrainer - INFO -   6 bins: RÂ²=0.9996, RMSE=$5
2025-06-05 21:41:15,308 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-05 21:41:15,308 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-05 21:41:15,319 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:41:15,321 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:41:15,322 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:41:15,327 - MoETrainer - INFO - Bin 0: Large bin (16200), using CV selection
2025-06-05 21:42:00,079 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-05 21:42:00,079 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±1, RÂ²=0.996 [SELECTED]
2025-06-05 21:42:00,081 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.994
2025-06-05 21:42:00,081 - MoETrainer - INFO -   3. xgb_conservative: MSE=141Â±1, RÂ²=0.909
2025-06-05 21:42:00,084 - MoETrainer - INFO - Bin 1: Large bin (16491), using CV selection
2025-06-05 21:42:50,697 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-05 21:42:50,697 - MoETrainer - INFO -   1. xgb_balanced: MSE=9Â±0, RÂ²=0.978 [SELECTED]
2025-06-05 21:42:50,697 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±1, RÂ²=0.955
2025-06-05 21:42:50,698 - MoETrainer - INFO -   3. ridge_light: MSE=124Â±13, RÂ²=0.712
2025-06-05 21:42:50,701 - MoETrainer - INFO - Bin 2: Large bin (16236), using CV selection
2025-06-05 21:43:37,361 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-05 21:43:37,362 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±1, RÂ²=0.973 [SELECTED]
2025-06-05 21:43:37,362 - MoETrainer - INFO -   2. rf_medium: MSE=45Â±2, RÂ²=0.896
2025-06-05 21:43:37,362 - MoETrainer - INFO -   3. ridge_light: MSE=146Â±17, RÂ²=0.658
2025-06-05 21:43:37,367 - MoETrainer - INFO - Bin 3: Large bin (16247), using CV selection
2025-06-05 21:44:23,855 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-05 21:44:23,857 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±1, RÂ²=0.975 [SELECTED]
2025-06-05 21:44:23,857 - MoETrainer - INFO -   2. rf_medium: MSE=53Â±1, RÂ²=0.911
2025-06-05 21:44:23,857 - MoETrainer - INFO -   3. ridge_light: MSE=165Â±10, RÂ²=0.720
2025-06-05 21:44:23,861 - MoETrainer - INFO - Bin 4: Large bin (16704), using CV selection
2025-06-05 21:45:27,185 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-05 21:45:27,186 - MoETrainer - INFO -   1. xgb_balanced: MSE=28Â±2, RÂ²=0.983 [SELECTED]
2025-06-05 21:45:27,186 - MoETrainer - INFO -   2. rf_medium: MSE=108Â±27, RÂ²=0.935
2025-06-05 21:45:27,187 - MoETrainer - INFO -   3. ridge_light: MSE=267Â±1, RÂ²=0.840
2025-06-05 21:45:27,193 - MoETrainer - INFO - Bin 5: Large bin (16386), using CV selection
2025-06-05 21:46:30,515 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-05 21:46:30,516 - MoETrainer - INFO -   1. rf_medium: MSE=138Â±67, RÂ²=0.997 [SELECTED]
2025-06-05 21:46:30,516 - MoETrainer - INFO -   2. xgb_balanced: MSE=204Â±26, RÂ²=0.996
2025-06-05 21:46:30,516 - MoETrainer - INFO -   3. ridge_light: MSE=2128Â±36, RÂ²=0.957
2025-06-05 21:46:30,517 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:46:52,600 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 16200 samples
2025-06-05 21:46:53,482 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 16491 samples
2025-06-05 21:46:54,356 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 16236 samples
2025-06-05 21:46:55,247 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 16247 samples
2025-06-05 21:46:56,177 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 4: 16704 samples
2025-06-05 21:47:19,871 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 16386 samples
2025-06-05 21:47:19,871 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-05 21:47:20,336 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:47:20,337 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:47:20,338 - MoETrainer - INFO -   RMSE: $5
2025-06-05 21:47:20,338 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-05 21:47:20,338 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-05 21:47:20,340 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-05 21:47:20,340 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-05 21:47:20,341 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-05 21:47:20,342 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-05 21:47:20,342 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-05 21:47:20,342 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-05 21:47:20,343 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:47:20,343 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=5079
2025-06-05 21:47:20,344 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9839, Samples=5019
2025-06-05 21:47:20,344 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9794, Samples=5105
2025-06-05 21:47:20,345 - MoETrainer - INFO -   Bin 3: RMSE=$4, RÂ²=0.9787, Samples=4974
2025-06-05 21:47:20,346 - MoETrainer - INFO -   Bin 4: RMSE=$5, RÂ²=0.9844, Samples=5181
2025-06-05 21:47:20,346 - MoETrainer - INFO -   Bin 5: RMSE=$9, RÂ²=0.9984, Samples=4878
2025-06-05 21:47:20,346 - MoETrainer - INFO - Final Expert Configuration:
2025-06-05 21:47:20,348 - MoETrainer - INFO -   Bin 0: rf_medium
2025-06-05 21:47:20,349 - MoETrainer - INFO -   Bin 1: xgb_balanced
2025-06-05 21:47:20,349 - MoETrainer - INFO -   Bin 2: xgb_balanced
2025-06-05 21:47:20,350 - MoETrainer - INFO -   Bin 3: xgb_balanced
2025-06-05 21:47:20,351 - MoETrainer - INFO -   Bin 4: xgb_balanced
2025-06-05 21:47:20,351 - MoETrainer - INFO -   Bin 5: rf_medium
2025-06-05 21:47:20,352 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-05 21:47:20,352 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-05 21:47:20,353 - MoETrainer - INFO - Final Performance: RÂ² = 0.9996
2025-06-05 21:47:20,353 - MoETrainer - INFO - Final RMSE: $5
2025-06-05 21:47:20,353 - MoETrainer - INFO - Final MAE: $2
2025-06-05 21:53:35,619 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-05 21:53:35,620 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-05 21:53:35,620 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-05 21:53:36,575 - MoETrainer - INFO - Raw data shape: (5525, 745)
2025-06-05 21:53:36,580 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-05 21:53:36,589 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-05 21:53:36,636 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-05 21:53:39,711 - MoETrainer - INFO - Consolidated to 13 features
2025-06-05 21:53:39,742 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-05 21:53:39,742 - MoETrainer - INFO - Loaded dataset: 5525 samples, 15 features
2025-06-05 21:53:39,748 - MoETrainer - INFO - Target statistics: mean=$543,777, std=$289,820
2025-06-05 21:53:39,748 - MoETrainer - INFO - Target range: [$149,000, $2,485,000]
2025-06-05 21:53:39,748 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-05 21:53:39,750 - MoETrainer - INFO - Removed 22 outliers (0.4%)
2025-06-05 21:53:39,756 - MoETrainer - INFO - Applied robust scaling
2025-06-05 21:53:39,764 - MoETrainer - INFO - Splitting data...
2025-06-05 21:53:39,769 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-05 21:53:39,771 - MoETrainer - INFO - Train target: mean=$535,714, std=$267,185
2025-06-05 21:53:39,771 - MoETrainer - INFO - Test target: mean=$550,320, std=$279,941
2025-06-05 21:53:39,771 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-05 21:53:39,773 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:53:39,774 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:53:39,774 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:53:39,774 - MoETrainer - INFO - Bin 0: Large bin (1165), using CV selection
2025-06-05 21:53:43,181 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-05 21:53:43,182 - MoETrainer - INFO -   1. xgb_conservative: MSE=2248866944Â±151247400, RÂ²=0.147 [SELECTED]
2025-06-05 21:53:43,183 - MoETrainer - INFO -   2. rf_shallow: MSE=2295483764Â±175383637, RÂ²=0.130
2025-06-05 21:53:43,184 - MoETrainer - INFO -   3. xgb_balanced: MSE=2313097899Â±183084443, RÂ²=0.123
2025-06-05 21:53:43,184 - MoETrainer - INFO - Bin 1: Large bin (1217), using CV selection
2025-06-05 21:53:46,694 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-05 21:53:46,694 - MoETrainer - INFO -   1. xgb_conservative: MSE=2004258603Â±59239375, RÂ²=0.150 [SELECTED]
2025-06-05 21:53:46,694 - MoETrainer - INFO -   2. rf_shallow: MSE=2021611240Â±74284372, RÂ²=0.142
2025-06-05 21:53:46,694 - MoETrainer - INFO -   3. rf_medium: MSE=2036781232Â±75496684, RÂ²=0.136
2025-06-05 21:53:46,694 - MoETrainer - INFO - Bin 2: Large bin (1194), using CV selection
2025-06-05 21:53:50,655 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-05 21:53:50,656 - MoETrainer - INFO -   1. xgb_conservative: MSE=52465810091Â±2914131108, RÂ²=0.314 [SELECTED]
2025-06-05 21:53:50,656 - MoETrainer - INFO -   2. rf_medium: MSE=52517779381Â±3068690025, RÂ²=0.313
2025-06-05 21:53:50,656 - MoETrainer - INFO -   3. xgb_balanced: MSE=53155876864Â±2542668687, RÂ²=0.305
2025-06-05 21:53:50,658 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:53:50,722 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1165 samples
2025-06-05 21:53:50,787 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1217 samples
2025-06-05 21:53:50,858 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1194 samples
2025-06-05 21:53:50,858 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-05 21:53:50,881 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:53:50,881 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:53:50,883 - MoETrainer - INFO -   RMSE: $145,003
2025-06-05 21:53:50,884 - MoETrainer - INFO -   MAE: $82,260 (14.9% of mean)
2025-06-05 21:53:50,884 - MoETrainer - INFO -   RÂ²: 0.7317
2025-06-05 21:53:50,885 - MoETrainer - INFO -   MAPE: 13.3%
2025-06-05 21:53:50,885 - MoETrainer - INFO -   MPE: +2.5% (bias: overprediction)
2025-06-05 21:53:50,886 - MoETrainer - INFO -   Median APE: 9.9%
2025-06-05 21:53:50,886 - MoETrainer - INFO -   Within 5%: 26.3% of predictions
2025-06-05 21:53:50,886 - MoETrainer - INFO -   Within 10%: 50.2% of predictions
2025-06-05 21:53:50,886 - MoETrainer - INFO -   Within 15%: 67.0% of predictions
2025-06-05 21:53:50,886 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:53:50,889 - MoETrainer - INFO -   Bin 0: RMSE=$45,349, RÂ²=0.2364, Samples=358
2025-06-05 21:53:50,889 - MoETrainer - INFO -   Bin 1: RMSE=$44,496, RÂ²=0.1442, Samples=350
2025-06-05 21:53:50,889 - MoETrainer - INFO -   Bin 2: RMSE=$235,092, RÂ²=0.2973, Samples=393
2025-06-05 21:53:50,889 - MoETrainer - INFO -   3 bins: RÂ²=0.7317, RMSE=$145,003
2025-06-05 21:53:50,891 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:53:50,891 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:53:50,891 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:53:50,891 - MoETrainer - INFO - Bin 0: Large bin (887), using CV selection
2025-06-05 21:53:53,619 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-05 21:53:53,619 - MoETrainer - INFO -   1. xgb_conservative: MSE=1699376469Â±112481401, RÂ²=0.135 [SELECTED]
2025-06-05 21:53:53,621 - MoETrainer - INFO -   2. rf_shallow: MSE=1734470679Â±104281772, RÂ²=0.118
2025-06-05 21:53:53,621 - MoETrainer - INFO -   3. rf_medium: MSE=1749125603Â±91301604, RÂ²=0.110
2025-06-05 21:53:53,621 - MoETrainer - INFO - Bin 1: Large bin (899), using CV selection
2025-06-05 21:53:56,300 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-05 21:53:56,300 - MoETrainer - INFO -   1. xgb_conservative: MSE=737793707Â±14275717, RÂ²=0.040 [SELECTED]
2025-06-05 21:53:56,300 - MoETrainer - INFO -   2. ridge_heavy: MSE=737826389Â±15099293, RÂ²=0.040
2025-06-05 21:53:56,300 - MoETrainer - INFO -   3. ridge_light: MSE=738881536Â±15267667, RÂ²=0.039
2025-06-05 21:53:56,300 - MoETrainer - INFO - Bin 2: Large bin (869), using CV selection
2025-06-05 21:53:58,974 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-05 21:53:58,975 - MoETrainer - INFO -   1. rf_shallow: MSE=1834980134Â±50692358, RÂ²=0.068 [SELECTED]
2025-06-05 21:53:58,975 - MoETrainer - INFO -   2. xgb_conservative: MSE=1863295147Â±70599990, RÂ²=0.053
2025-06-05 21:53:58,976 - MoETrainer - INFO -   3. rf_medium: MSE=1895010255Â±42666115, RÂ²=0.037
2025-06-05 21:53:58,977 - MoETrainer - INFO - Bin 3: Large bin (921), using CV selection
2025-06-05 21:54:01,885 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-05 21:54:01,886 - MoETrainer - INFO -   1. ridge_heavy: MSE=58603895467Â±2606958159, RÂ²=0.249 [SELECTED]
2025-06-05 21:54:01,888 - MoETrainer - INFO -   2. ridge_medium: MSE=58691986773Â±2553100480, RÂ²=0.248
2025-06-05 21:54:01,889 - MoETrainer - INFO -   3. ridge_light: MSE=58793007787Â±2644117710, RÂ²=0.247
2025-06-05 21:54:01,889 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:54:01,936 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 887 samples
2025-06-05 21:54:01,975 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 899 samples
2025-06-05 21:54:02,210 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 869 samples
2025-06-05 21:54:02,213 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 921 samples
2025-06-05 21:54:02,213 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-05 21:54:02,245 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:54:02,245 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:54:02,245 - MoETrainer - INFO -   RMSE: $131,978
2025-06-05 21:54:02,246 - MoETrainer - INFO -   MAE: $71,749 (13.0% of mean)
2025-06-05 21:54:02,246 - MoETrainer - INFO -   RÂ²: 0.7777
2025-06-05 21:54:02,246 - MoETrainer - INFO -   MAPE: 11.3%
2025-06-05 21:54:02,249 - MoETrainer - INFO -   MPE: +2.5% (bias: overprediction)
2025-06-05 21:54:02,249 - MoETrainer - INFO -   Median APE: 8.4%
2025-06-05 21:54:02,250 - MoETrainer - INFO -   Within 5%: 26.7% of predictions
2025-06-05 21:54:02,250 - MoETrainer - INFO -   Within 10%: 61.1% of predictions
2025-06-05 21:54:02,251 - MoETrainer - INFO -   Within 15%: 77.6% of predictions
2025-06-05 21:54:02,252 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:54:02,253 - MoETrainer - INFO -   Bin 0: RMSE=$39,994, RÂ²=0.2190, Samples=271
2025-06-05 21:54:02,253 - MoETrainer - INFO -   Bin 1: RMSE=$28,041, RÂ²=0.0240, Samples=248
2025-06-05 21:54:02,254 - MoETrainer - INFO -   Bin 2: RMSE=$44,628, RÂ²=0.0243, Samples=275
2025-06-05 21:54:02,254 - MoETrainer - INFO -   Bin 3: RMSE=$242,148, RÂ²=0.2574, Samples=307
2025-06-05 21:54:02,256 - MoETrainer - INFO -   4 bins: RÂ²=0.7777, RMSE=$131,978
2025-06-05 21:54:02,257 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:54:02,258 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:54:02,258 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:54:02,258 - MoETrainer - INFO - Bin 0: Small bin (715), using rule-based selection
2025-06-05 21:54:03,075 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-05 21:54:03,076 - MoETrainer - INFO -   1. ridge_medium: Score=1.043, MAE=$28340, RMSE=$34390, RÂ²=0.106 [SELECTED]
2025-06-05 21:54:03,076 - MoETrainer - INFO -   2. elastic_light: Score=1.057, MAE=$28865, RMSE=$34815, RÂ²=0.084
2025-06-05 21:54:03,076 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$29041, RMSE=$34831, RÂ²=0.083
2025-06-05 21:54:03,078 - MoETrainer - INFO - Bin 1: Small bin (715), using rule-based selection
2025-06-05 21:54:03,911 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-05 21:54:03,912 - MoETrainer - INFO -   1. elastic_light: Score=1.142, MAE=$17523, RMSE=$20565, RÂ²=-0.038 [SELECTED]
2025-06-05 21:54:03,912 - MoETrainer - INFO -   2. rf_shallow: Score=1.156, MAE=$17197, RMSE=$20626, RÂ²=-0.044
2025-06-05 21:54:03,913 - MoETrainer - INFO -   3. rf_medium: Score=1.170, MAE=$17148, RMSE=$20683, RÂ²=-0.050
2025-06-05 21:54:03,913 - MoETrainer - INFO - Bin 2: Small bin (715), using rule-based selection
2025-06-05 21:54:04,757 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-05 21:54:04,757 - MoETrainer - INFO -   1. xgb_conservative: Score=1.063, MAE=$22364, RMSE=$26541, RÂ²=-0.006 [SELECTED]
2025-06-05 21:54:04,757 - MoETrainer - INFO -   2. rf_shallow: Score=1.154, MAE=$22867, RMSE=$27008, RÂ²=-0.042
2025-06-05 21:54:04,758 - MoETrainer - INFO -   3. rf_medium: Score=1.158, MAE=$22548, RMSE=$27033, RÂ²=-0.044
2025-06-05 21:54:04,758 - MoETrainer - INFO - Bin 3: Small bin (712), using rule-based selection
2025-06-05 21:54:05,700 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-05 21:54:05,701 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$39739, RMSE=$47163, RÂ²=0.023 [SELECTED]
2025-06-05 21:54:05,701 - MoETrainer - INFO -   2. elastic_light: Score=1.058, MAE=$40230, RMSE=$47222, RÂ²=0.020
2025-06-05 21:54:05,701 - MoETrainer - INFO -   3. rf_shallow: Score=1.059, MAE=$39699, RMSE=$47311, RÂ²=0.016
2025-06-05 21:54:05,703 - MoETrainer - INFO - Bin 4: Small bin (719), using rule-based selection
2025-06-05 21:54:06,826 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-05 21:54:06,827 - MoETrainer - INFO -   1. elastic_light: Score=1.114, MAE=$198091, RMSE=$277429, RÂ²=0.170 [SELECTED]
2025-06-05 21:54:06,828 - MoETrainer - INFO -   2. ridge_medium: Score=1.120, MAE=$199365, RMSE=$278891, RÂ²=0.161
2025-06-05 21:54:06,828 - MoETrainer - INFO -   3. rf_shallow: Score=1.127, MAE=$198801, RMSE=$281185, RÂ²=0.147
2025-06-05 21:54:06,829 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:54:06,832 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 715 samples
2025-06-05 21:54:06,836 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 715 samples
2025-06-05 21:54:06,895 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 715 samples
2025-06-05 21:54:06,951 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 3: 712 samples
2025-06-05 21:54:06,960 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 719 samples
2025-06-05 21:54:06,962 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-05 21:54:06,991 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:54:06,992 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:54:06,993 - MoETrainer - INFO -   RMSE: $117,870
2025-06-05 21:54:06,993 - MoETrainer - INFO -   MAE: $61,763 (11.2% of mean)
2025-06-05 21:54:06,994 - MoETrainer - INFO -   RÂ²: 0.8227
2025-06-05 21:54:06,994 - MoETrainer - INFO -   MAPE: 9.5%
2025-06-05 21:54:06,995 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-05 21:54:06,995 - MoETrainer - INFO -   Median APE: 7.0%
2025-06-05 21:54:06,996 - MoETrainer - INFO -   Within 5%: 38.8% of predictions
2025-06-05 21:54:06,996 - MoETrainer - INFO -   Within 10%: 68.8% of predictions
2025-06-05 21:54:06,996 - MoETrainer - INFO -   Within 15%: 84.0% of predictions
2025-06-05 21:54:06,997 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:54:06,998 - MoETrainer - INFO -   Bin 0: RMSE=$38,437, RÂ²=0.1697, Samples=224
2025-06-05 21:54:06,998 - MoETrainer - INFO -   Bin 1: RMSE=$20,271, RÂ²=-0.0011, Samples=203
2025-06-05 21:54:06,999 - MoETrainer - INFO -   Bin 2: RMSE=$26,016, RÂ²=0.0540, Samples=209
2025-06-05 21:54:07,000 - MoETrainer - INFO -   Bin 3: RMSE=$46,606, RÂ²=0.0586, Samples=224
2025-06-05 21:54:07,000 - MoETrainer - INFO -   Bin 4: RMSE=$243,200, RÂ²=0.2468, Samples=241
2025-06-05 21:54:07,001 - MoETrainer - INFO -   5 bins: RÂ²=0.8227, RMSE=$117,870
2025-06-05 21:54:07,003 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:54:07,004 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:54:07,004 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:54:07,005 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-05 21:54:07,763 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-05 21:54:07,763 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-05 21:54:07,764 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-05 21:54:07,764 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-05 21:54:07,765 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-05 21:54:08,549 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-05 21:54:08,549 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-05 21:54:08,550 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-05 21:54:08,550 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-05 21:54:08,550 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-05 21:54:09,303 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-05 21:54:09,303 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-05 21:54:09,304 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-05 21:54:09,304 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-05 21:54:09,305 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-05 21:54:10,074 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-05 21:54:10,110 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-05 21:54:10,110 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-05 21:54:10,110 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-05 21:54:10,110 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-05 21:54:10,879 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-05 21:54:10,879 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-05 21:54:10,879 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-05 21:54:10,879 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-05 21:54:10,881 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-05 21:54:11,687 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-05 21:54:11,687 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-05 21:54:11,687 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-05 21:54:11,687 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-05 21:54:11,690 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:54:11,691 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-05 21:54:11,884 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-05 21:54:11,918 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-05 21:54:12,109 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-05 21:54:12,112 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-05 21:54:12,115 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-05 21:54:12,116 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-05 21:54:12,160 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:54:12,160 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:54:12,161 - MoETrainer - INFO -   RMSE: $110,663
2025-06-05 21:54:12,161 - MoETrainer - INFO -   MAE: $56,069 (10.2% of mean)
2025-06-05 21:54:12,161 - MoETrainer - INFO -   RÂ²: 0.8437
2025-06-05 21:54:12,161 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-05 21:54:12,161 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-05 21:54:12,161 - MoETrainer - INFO -   Median APE: 6.0%
2025-06-05 21:54:12,163 - MoETrainer - INFO -   Within 5%: 41.7% of predictions
2025-06-05 21:54:12,163 - MoETrainer - INFO -   Within 10%: 75.7% of predictions
2025-06-05 21:54:12,163 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-05 21:54:12,163 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:54:12,163 - MoETrainer - INFO -   Bin 0: RMSE=$35,762, RÂ²=0.0641, Samples=165
2025-06-05 21:54:12,164 - MoETrainer - INFO -   Bin 1: RMSE=$20,318, RÂ²=-0.0196, Samples=193
2025-06-05 21:54:12,164 - MoETrainer - INFO -   Bin 2: RMSE=$20,547, RÂ²=0.0539, Samples=161
2025-06-05 21:54:12,165 - MoETrainer - INFO -   Bin 3: RMSE=$27,860, RÂ²=-0.0529, Samples=189
2025-06-05 21:54:12,166 - MoETrainer - INFO -   Bin 4: RMSE=$44,882, RÂ²=-0.0086, Samples=185
2025-06-05 21:54:12,166 - MoETrainer - INFO -   Bin 5: RMSE=$246,175, RÂ²=0.2126, Samples=208
2025-06-05 21:54:12,167 - MoETrainer - INFO -   6 bins: RÂ²=0.8437, RMSE=$110,663
2025-06-05 21:54:12,168 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-05 21:54:12,168 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-05 21:54:12,169 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-05 21:54:12,170 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-05 21:54:12,170 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-05 21:54:12,170 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-05 21:54:12,871 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-05 21:54:12,871 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-05 21:54:12,871 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-05 21:54:12,872 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-05 21:54:12,872 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-05 21:54:13,640 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-05 21:54:13,641 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-05 21:54:13,641 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-05 21:54:13,641 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-05 21:54:13,642 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-05 21:54:14,394 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-05 21:54:14,396 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-05 21:54:14,396 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-05 21:54:14,396 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-05 21:54:14,397 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-05 21:54:15,172 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-05 21:54:15,173 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-05 21:54:15,173 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-05 21:54:15,173 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-05 21:54:15,174 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-05 21:54:16,009 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-05 21:54:16,009 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-05 21:54:16,010 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-05 21:54:16,010 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-05 21:54:16,010 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-05 21:54:16,806 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-05 21:54:16,807 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-05 21:54:16,807 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-05 21:54:16,808 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-05 21:54:16,808 - MoETrainer - INFO - Training selected expert models...
2025-06-05 21:54:16,812 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-05 21:54:17,006 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-05 21:54:17,050 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-05 21:54:17,246 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-05 21:54:17,249 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-05 21:54:17,251 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-05 21:54:17,252 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-05 21:54:17,287 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-05 21:54:17,287 - MoETrainer - INFO - Overall Performance:
2025-06-05 21:54:17,288 - MoETrainer - INFO -   RMSE: $110,663
2025-06-05 21:54:17,288 - MoETrainer - INFO -   MAE: $56,069 (10.2% of mean)
2025-06-05 21:54:17,289 - MoETrainer - INFO -   RÂ²: 0.8437
2025-06-05 21:54:17,289 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-05 21:54:17,290 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-05 21:54:17,290 - MoETrainer - INFO -   Median APE: 6.0%
2025-06-05 21:54:17,291 - MoETrainer - INFO -   Within 5%: 41.7% of predictions
2025-06-05 21:54:17,291 - MoETrainer - INFO -   Within 10%: 75.7% of predictions
2025-06-05 21:54:17,291 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-05 21:54:17,292 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-05 21:54:17,292 - MoETrainer - INFO -   Bin 0: RMSE=$35,762, RÂ²=0.0641, Samples=165
2025-06-05 21:54:17,293 - MoETrainer - INFO -   Bin 1: RMSE=$20,318, RÂ²=-0.0196, Samples=193
2025-06-05 21:54:17,293 - MoETrainer - INFO -   Bin 2: RMSE=$20,547, RÂ²=0.0539, Samples=161
2025-06-05 21:54:17,294 - MoETrainer - INFO -   Bin 3: RMSE=$27,860, RÂ²=-0.0529, Samples=189
2025-06-05 21:54:17,294 - MoETrainer - INFO -   Bin 4: RMSE=$44,882, RÂ²=-0.0086, Samples=185
2025-06-05 21:54:17,294 - MoETrainer - INFO -   Bin 5: RMSE=$246,175, RÂ²=0.2126, Samples=208
2025-06-05 21:54:17,295 - MoETrainer - INFO - Final Expert Configuration:
2025-06-05 21:54:17,295 - MoETrainer - INFO -   Bin 0: elastic_light
2025-06-05 21:54:17,295 - MoETrainer - INFO -   Bin 1: rf_shallow
2025-06-05 21:54:17,296 - MoETrainer - INFO -   Bin 2: xgb_conservative
2025-06-05 21:54:17,296 - MoETrainer - INFO -   Bin 3: rf_shallow
2025-06-05 21:54:17,297 - MoETrainer - INFO -   Bin 4: ridge_medium
2025-06-05 21:54:17,297 - MoETrainer - INFO -   Bin 5: elastic_light
2025-06-05 21:54:17,297 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-05 21:54:17,297 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-05 21:54:17,299 - MoETrainer - INFO - Final Performance: RÂ² = 0.8437
2025-06-05 21:54:17,299 - MoETrainer - INFO - Final RMSE: $110,663
2025-06-05 21:54:17,300 - MoETrainer - INFO - Final MAE: $56,069
2025-06-08 15:16:00,649 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-08 15:16:00,649 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-08 15:16:00,649 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-08 15:16:01,085 - MoETrainer - INFO - Raw data shape: (5525, 745)
2025-06-08 15:16:01,085 - MoETrainer - INFO - REMOVING DATA LEAKAGE COLUMNS: ['Estimated neighbourhood price per m2']
2025-06-08 15:16:01,097 - MoETrainer - INFO - Removed 1 leakage columns
2025-06-08 15:16:01,120 - MoETrainer - INFO - Consolidating 743 features using original approach...
2025-06-08 15:16:03,421 - MoETrainer - INFO - Consolidated to 13 features
2025-06-08 15:16:03,462 - MoETrainer - INFO - Final features: 15 (from 15 after consolidation)
2025-06-08 15:16:03,462 - MoETrainer - INFO - Loaded dataset: 5525 samples, 15 features
2025-06-08 15:16:03,462 - MoETrainer - INFO - Target statistics: mean=$543,777, std=$289,820
2025-06-08 15:16:03,462 - MoETrainer - INFO - Target range: [$149,000, $2,485,000]
2025-06-08 15:16:03,462 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-08 15:16:03,462 - MoETrainer - INFO - Removed 22 outliers (0.4%)
2025-06-08 15:16:03,480 - MoETrainer - INFO - Applied robust scaling
2025-06-08 15:16:03,480 - MoETrainer - INFO - Splitting data...
2025-06-08 15:16:03,490 - MoETrainer - INFO - Data split - Train: 3576, Val: 826, Test: 1101
2025-06-08 15:16:03,490 - MoETrainer - INFO - Train target: mean=$535,714, std=$267,185
2025-06-08 15:16:03,491 - MoETrainer - INFO - Test target: mean=$550,320, std=$279,941
2025-06-08 15:16:03,491 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-08 15:16:03,493 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:16:03,493 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:16:03,494 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:16:03,494 - MoETrainer - INFO - Bin 0: Large bin (1165), using CV selection
2025-06-08 15:16:06,097 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-08 15:16:06,097 - MoETrainer - INFO -   1. xgb_conservative: MSE=2248866944Â±151247400, RÂ²=0.147 [SELECTED]
2025-06-08 15:16:06,097 - MoETrainer - INFO -   2. rf_shallow: MSE=2295483764Â±175383637, RÂ²=0.130
2025-06-08 15:16:06,109 - MoETrainer - INFO -   3. xgb_balanced: MSE=2313097899Â±183084443, RÂ²=0.123
2025-06-08 15:16:06,109 - MoETrainer - INFO - Bin 1: Large bin (1217), using CV selection
2025-06-08 15:16:08,742 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-08 15:16:08,743 - MoETrainer - INFO -   1. xgb_conservative: MSE=2004258603Â±59239375, RÂ²=0.150 [SELECTED]
2025-06-08 15:16:08,743 - MoETrainer - INFO -   2. rf_shallow: MSE=2021611240Â±74284372, RÂ²=0.142
2025-06-08 15:16:08,744 - MoETrainer - INFO -   3. rf_medium: MSE=2036781232Â±75496684, RÂ²=0.136
2025-06-08 15:16:08,744 - MoETrainer - INFO - Bin 2: Large bin (1194), using CV selection
2025-06-08 15:16:11,592 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-08 15:16:11,593 - MoETrainer - INFO -   1. xgb_conservative: MSE=52465810091Â±2914131108, RÂ²=0.314 [SELECTED]
2025-06-08 15:16:11,593 - MoETrainer - INFO -   2. rf_medium: MSE=52517779381Â±3068690025, RÂ²=0.313
2025-06-08 15:16:11,593 - MoETrainer - INFO -   3. xgb_balanced: MSE=53155876864Â±2542668687, RÂ²=0.305
2025-06-08 15:16:11,593 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:16:11,630 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 1165 samples
2025-06-08 15:16:11,681 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 1217 samples
2025-06-08 15:16:11,748 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 1194 samples
2025-06-08 15:16:11,749 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-08 15:16:11,769 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:16:11,770 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:16:11,770 - MoETrainer - INFO -   RMSE: $145,003
2025-06-08 15:16:11,771 - MoETrainer - INFO -   MAE: $82,260 (14.9% of mean)
2025-06-08 15:16:11,771 - MoETrainer - INFO -   RÂ²: 0.7317
2025-06-08 15:16:11,771 - MoETrainer - INFO -   MAPE: 13.3%
2025-06-08 15:16:11,772 - MoETrainer - INFO -   MPE: +2.5% (bias: overprediction)
2025-06-08 15:16:11,772 - MoETrainer - INFO -   Median APE: 9.9%
2025-06-08 15:16:11,772 - MoETrainer - INFO -   Within 5%: 26.3% of predictions
2025-06-08 15:16:11,773 - MoETrainer - INFO -   Within 10%: 50.2% of predictions
2025-06-08 15:16:11,773 - MoETrainer - INFO -   Within 15%: 67.0% of predictions
2025-06-08 15:16:11,773 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:16:11,774 - MoETrainer - INFO -   Bin 0: RMSE=$45,349, RÂ²=0.2364, Samples=358
2025-06-08 15:16:11,774 - MoETrainer - INFO -   Bin 1: RMSE=$44,496, RÂ²=0.1442, Samples=350
2025-06-08 15:16:11,775 - MoETrainer - INFO -   Bin 2: RMSE=$235,092, RÂ²=0.2973, Samples=393
2025-06-08 15:16:11,775 - MoETrainer - INFO -   3 bins: RÂ²=0.7317, RMSE=$145,003
2025-06-08 15:16:11,777 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:16:11,778 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:16:11,778 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:16:11,778 - MoETrainer - INFO - Bin 0: Large bin (887), using CV selection
2025-06-08 15:16:14,142 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-08 15:16:14,143 - MoETrainer - INFO -   1. xgb_conservative: MSE=1699376469Â±112481401, RÂ²=0.135 [SELECTED]
2025-06-08 15:16:14,143 - MoETrainer - INFO -   2. rf_shallow: MSE=1734470679Â±104281772, RÂ²=0.118
2025-06-08 15:16:14,144 - MoETrainer - INFO -   3. rf_medium: MSE=1749125603Â±91301604, RÂ²=0.110
2025-06-08 15:16:14,145 - MoETrainer - INFO - Bin 1: Large bin (899), using CV selection
2025-06-08 15:16:17,551 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-08 15:16:17,551 - MoETrainer - INFO -   1. xgb_conservative: MSE=737793707Â±14275717, RÂ²=0.040 [SELECTED]
2025-06-08 15:16:17,551 - MoETrainer - INFO -   2. ridge_heavy: MSE=737826389Â±15099293, RÂ²=0.040
2025-06-08 15:16:17,552 - MoETrainer - INFO -   3. ridge_light: MSE=738881536Â±15267667, RÂ²=0.039
2025-06-08 15:16:17,552 - MoETrainer - INFO - Bin 2: Large bin (869), using CV selection
2025-06-08 15:16:19,904 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-08 15:16:19,905 - MoETrainer - INFO -   1. rf_shallow: MSE=1834980134Â±50692358, RÂ²=0.068 [SELECTED]
2025-06-08 15:16:19,905 - MoETrainer - INFO -   2. xgb_conservative: MSE=1863295147Â±70599990, RÂ²=0.053
2025-06-08 15:16:19,905 - MoETrainer - INFO -   3. rf_medium: MSE=1895010255Â±42666115, RÂ²=0.037
2025-06-08 15:16:19,906 - MoETrainer - INFO - Bin 3: Large bin (921), using CV selection
2025-06-08 15:16:22,494 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-08 15:16:22,495 - MoETrainer - INFO -   1. ridge_heavy: MSE=58603895467Â±2606958159, RÂ²=0.249 [SELECTED]
2025-06-08 15:16:22,495 - MoETrainer - INFO -   2. ridge_medium: MSE=58691986773Â±2553100480, RÂ²=0.248
2025-06-08 15:16:22,496 - MoETrainer - INFO -   3. ridge_light: MSE=58793007787Â±2644117710, RÂ²=0.247
2025-06-08 15:16:22,496 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:16:22,531 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 887 samples
2025-06-08 15:16:22,580 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 1: 899 samples
2025-06-08 15:16:22,835 - MoETrainer - INFO - Successfully trained rf_shallow for bin 2: 869 samples
2025-06-08 15:16:22,838 - MoETrainer - INFO - Successfully trained ridge_heavy for bin 3: 921 samples
2025-06-08 15:16:22,838 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-08 15:16:22,861 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:16:22,862 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:16:22,862 - MoETrainer - INFO -   RMSE: $131,978
2025-06-08 15:16:22,862 - MoETrainer - INFO -   MAE: $71,749 (13.0% of mean)
2025-06-08 15:16:22,863 - MoETrainer - INFO -   RÂ²: 0.7777
2025-06-08 15:16:22,863 - MoETrainer - INFO -   MAPE: 11.3%
2025-06-08 15:16:22,863 - MoETrainer - INFO -   MPE: +2.5% (bias: overprediction)
2025-06-08 15:16:22,863 - MoETrainer - INFO -   Median APE: 8.4%
2025-06-08 15:16:22,863 - MoETrainer - INFO -   Within 5%: 26.7% of predictions
2025-06-08 15:16:22,865 - MoETrainer - INFO -   Within 10%: 61.1% of predictions
2025-06-08 15:16:22,865 - MoETrainer - INFO -   Within 15%: 77.6% of predictions
2025-06-08 15:16:22,865 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:16:22,865 - MoETrainer - INFO -   Bin 0: RMSE=$39,994, RÂ²=0.2190, Samples=271
2025-06-08 15:16:22,866 - MoETrainer - INFO -   Bin 1: RMSE=$28,041, RÂ²=0.0240, Samples=248
2025-06-08 15:16:22,866 - MoETrainer - INFO -   Bin 2: RMSE=$44,628, RÂ²=0.0243, Samples=275
2025-06-08 15:16:22,866 - MoETrainer - INFO -   Bin 3: RMSE=$242,148, RÂ²=0.2574, Samples=307
2025-06-08 15:16:22,867 - MoETrainer - INFO -   4 bins: RÂ²=0.7777, RMSE=$131,978
2025-06-08 15:16:22,868 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:16:22,868 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:16:22,868 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:16:22,869 - MoETrainer - INFO - Bin 0: Small bin (715), using rule-based selection
2025-06-08 15:16:23,620 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-08 15:16:23,622 - MoETrainer - INFO -   1. ridge_medium: Score=1.043, MAE=$28340, RMSE=$34390, RÂ²=0.106 [SELECTED]
2025-06-08 15:16:23,622 - MoETrainer - INFO -   2. elastic_light: Score=1.057, MAE=$28865, RMSE=$34815, RÂ²=0.084
2025-06-08 15:16:23,622 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$29041, RMSE=$34831, RÂ²=0.083
2025-06-08 15:16:23,622 - MoETrainer - INFO - Bin 1: Small bin (715), using rule-based selection
2025-06-08 15:16:24,352 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-08 15:16:24,352 - MoETrainer - INFO -   1. elastic_light: Score=1.142, MAE=$17523, RMSE=$20565, RÂ²=-0.038 [SELECTED]
2025-06-08 15:16:24,352 - MoETrainer - INFO -   2. rf_shallow: Score=1.156, MAE=$17197, RMSE=$20626, RÂ²=-0.044
2025-06-08 15:16:24,352 - MoETrainer - INFO -   3. rf_medium: Score=1.170, MAE=$17148, RMSE=$20683, RÂ²=-0.050
2025-06-08 15:16:24,358 - MoETrainer - INFO - Bin 2: Small bin (715), using rule-based selection
2025-06-08 15:16:25,074 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-08 15:16:25,074 - MoETrainer - INFO -   1. xgb_conservative: Score=1.063, MAE=$22364, RMSE=$26541, RÂ²=-0.006 [SELECTED]
2025-06-08 15:16:25,074 - MoETrainer - INFO -   2. rf_shallow: Score=1.154, MAE=$22867, RMSE=$27008, RÂ²=-0.042
2025-06-08 15:16:25,074 - MoETrainer - INFO -   3. rf_medium: Score=1.158, MAE=$22548, RMSE=$27033, RÂ²=-0.044
2025-06-08 15:16:25,088 - MoETrainer - INFO - Bin 3: Small bin (712), using rule-based selection
2025-06-08 15:16:25,873 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-08 15:16:25,873 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$39739, RMSE=$47163, RÂ²=0.023 [SELECTED]
2025-06-08 15:16:25,873 - MoETrainer - INFO -   2. elastic_light: Score=1.058, MAE=$40230, RMSE=$47222, RÂ²=0.020
2025-06-08 15:16:25,873 - MoETrainer - INFO -   3. rf_shallow: Score=1.059, MAE=$39699, RMSE=$47311, RÂ²=0.016
2025-06-08 15:16:25,873 - MoETrainer - INFO - Bin 4: Small bin (719), using rule-based selection
2025-06-08 15:16:26,662 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-08 15:16:26,662 - MoETrainer - INFO -   1. elastic_light: Score=1.114, MAE=$198091, RMSE=$277429, RÂ²=0.170 [SELECTED]
2025-06-08 15:16:26,662 - MoETrainer - INFO -   2. ridge_medium: Score=1.120, MAE=$199365, RMSE=$278891, RÂ²=0.161
2025-06-08 15:16:26,662 - MoETrainer - INFO -   3. rf_shallow: Score=1.127, MAE=$198801, RMSE=$281185, RÂ²=0.147
2025-06-08 15:16:26,676 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:16:26,678 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 715 samples
2025-06-08 15:16:26,680 - MoETrainer - INFO - Successfully trained elastic_light for bin 1: 715 samples
2025-06-08 15:16:26,720 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 715 samples
2025-06-08 15:16:26,764 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 3: 712 samples
2025-06-08 15:16:26,778 - MoETrainer - INFO - Successfully trained elastic_light for bin 4: 719 samples
2025-06-08 15:16:26,778 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-08 15:16:26,801 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:16:26,802 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:16:26,802 - MoETrainer - INFO -   RMSE: $117,870
2025-06-08 15:16:26,802 - MoETrainer - INFO -   MAE: $61,763 (11.2% of mean)
2025-06-08 15:16:26,802 - MoETrainer - INFO -   RÂ²: 0.8227
2025-06-08 15:16:26,803 - MoETrainer - INFO -   MAPE: 9.5%
2025-06-08 15:16:26,803 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-08 15:16:26,803 - MoETrainer - INFO -   Median APE: 7.0%
2025-06-08 15:16:26,804 - MoETrainer - INFO -   Within 5%: 38.8% of predictions
2025-06-08 15:16:26,804 - MoETrainer - INFO -   Within 10%: 68.8% of predictions
2025-06-08 15:16:26,804 - MoETrainer - INFO -   Within 15%: 84.0% of predictions
2025-06-08 15:16:26,804 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:16:26,804 - MoETrainer - INFO -   Bin 0: RMSE=$38,437, RÂ²=0.1697, Samples=224
2025-06-08 15:16:26,804 - MoETrainer - INFO -   Bin 1: RMSE=$20,271, RÂ²=-0.0011, Samples=203
2025-06-08 15:16:26,807 - MoETrainer - INFO -   Bin 2: RMSE=$26,016, RÂ²=0.0540, Samples=209
2025-06-08 15:16:26,807 - MoETrainer - INFO -   Bin 3: RMSE=$46,606, RÂ²=0.0586, Samples=224
2025-06-08 15:16:26,807 - MoETrainer - INFO -   Bin 4: RMSE=$243,200, RÂ²=0.2468, Samples=241
2025-06-08 15:16:26,807 - MoETrainer - INFO -   5 bins: RÂ²=0.8227, RMSE=$117,870
2025-06-08 15:16:26,809 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:16:26,810 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:16:26,810 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:16:26,810 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-08 15:16:27,474 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-08 15:16:27,474 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-08 15:16:27,475 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-08 15:16:27,475 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-08 15:16:27,476 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-08 15:16:28,202 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-08 15:16:28,203 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-08 15:16:28,203 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-08 15:16:28,203 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-08 15:16:28,204 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-08 15:16:28,840 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-08 15:16:28,841 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-08 15:16:28,841 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-08 15:16:28,842 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-08 15:16:28,842 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-08 15:16:29,491 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-08 15:16:29,491 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-08 15:16:29,491 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-08 15:16:29,492 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-08 15:16:29,492 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-08 15:16:30,143 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-08 15:16:30,143 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-08 15:16:30,144 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-08 15:16:30,144 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-08 15:16:30,145 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-08 15:16:30,826 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-08 15:16:30,827 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-08 15:16:30,827 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-08 15:16:30,827 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-08 15:16:30,828 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:16:30,830 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-08 15:16:31,015 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-08 15:16:31,047 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-08 15:16:31,218 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-08 15:16:31,220 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-08 15:16:31,223 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-08 15:16:31,223 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-08 15:16:31,253 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:16:31,254 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:16:31,254 - MoETrainer - INFO -   RMSE: $110,663
2025-06-08 15:16:31,254 - MoETrainer - INFO -   MAE: $56,069 (10.2% of mean)
2025-06-08 15:16:31,255 - MoETrainer - INFO -   RÂ²: 0.8437
2025-06-08 15:16:31,255 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-08 15:16:31,255 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-08 15:16:31,256 - MoETrainer - INFO -   Median APE: 6.0%
2025-06-08 15:16:31,256 - MoETrainer - INFO -   Within 5%: 41.7% of predictions
2025-06-08 15:16:31,256 - MoETrainer - INFO -   Within 10%: 75.7% of predictions
2025-06-08 15:16:31,257 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-08 15:16:31,257 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:16:31,257 - MoETrainer - INFO -   Bin 0: RMSE=$35,762, RÂ²=0.0641, Samples=165
2025-06-08 15:16:31,258 - MoETrainer - INFO -   Bin 1: RMSE=$20,318, RÂ²=-0.0196, Samples=193
2025-06-08 15:16:31,258 - MoETrainer - INFO -   Bin 2: RMSE=$20,547, RÂ²=0.0539, Samples=161
2025-06-08 15:16:31,258 - MoETrainer - INFO -   Bin 3: RMSE=$27,860, RÂ²=-0.0529, Samples=189
2025-06-08 15:16:31,259 - MoETrainer - INFO -   Bin 4: RMSE=$44,882, RÂ²=-0.0086, Samples=185
2025-06-08 15:16:31,259 - MoETrainer - INFO -   Bin 5: RMSE=$246,175, RÂ²=0.2126, Samples=208
2025-06-08 15:16:31,259 - MoETrainer - INFO -   6 bins: RÂ²=0.8437, RMSE=$110,663
2025-06-08 15:16:31,260 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-08 15:16:31,260 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-08 15:16:31,261 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:16:31,262 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:16:31,262 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:16:31,263 - MoETrainer - INFO - Bin 0: Small bin (533), using rule-based selection
2025-06-08 15:16:31,880 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-08 15:16:31,880 - MoETrainer - INFO -   1. elastic_light: Score=1.089, MAE=$28245, RMSE=$34862, RÂ²=0.030 [SELECTED]
2025-06-08 15:16:31,880 - MoETrainer - INFO -   2. ridge_medium: Score=1.095, MAE=$28381, RMSE=$35051, RÂ²=0.019
2025-06-08 15:16:31,880 - MoETrainer - INFO -   3. rf_shallow: Score=1.097, MAE=$28461, RMSE=$35117, RÂ²=0.015
2025-06-08 15:16:31,880 - MoETrainer - INFO - Bin 1: Small bin (632), using rule-based selection
2025-06-08 15:16:32,493 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-08 15:16:32,493 - MoETrainer - INFO -   1. rf_shallow: Score=1.029, MAE=$18480, RMSE=$21149, RÂ²=0.046 [SELECTED]
2025-06-08 15:16:32,493 - MoETrainer - INFO -   2. xgb_conservative: Score=1.031, MAE=$18397, RMSE=$21206, RÂ²=0.041
2025-06-08 15:16:32,493 - MoETrainer - INFO -   3. rf_medium: Score=1.036, MAE=$18339, RMSE=$21321, RÂ²=0.031
2025-06-08 15:16:32,493 - MoETrainer - INFO - Bin 2: Small bin (621), using rule-based selection
2025-06-08 15:16:33,131 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-08 15:16:33,131 - MoETrainer - INFO -   1. xgb_conservative: Score=1.056, MAE=$17753, RMSE=$20640, RÂ²=-0.006 [SELECTED]
2025-06-08 15:16:33,131 - MoETrainer - INFO -   2. rf_shallow: Score=1.067, MAE=$17716, RMSE=$20684, RÂ²=-0.010
2025-06-08 15:16:33,131 - MoETrainer - INFO -   3. elastic_light: Score=1.084, MAE=$18053, RMSE=$20749, RÂ²=-0.016
2025-06-08 15:16:33,131 - MoETrainer - INFO - Bin 3: Small bin (596), using rule-based selection
2025-06-08 15:16:33,766 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-08 15:16:33,767 - MoETrainer - INFO -   1. rf_shallow: Score=1.039, MAE=$23304, RMSE=$27559, RÂ²=0.014 [SELECTED]
2025-06-08 15:16:33,767 - MoETrainer - INFO -   2. xgb_conservative: Score=1.052, MAE=$23547, RMSE=$27787, RÂ²=-0.002
2025-06-08 15:16:33,768 - MoETrainer - INFO -   3. rf_medium: Score=1.057, MAE=$23072, RMSE=$27815, RÂ²=-0.004
2025-06-08 15:16:33,768 - MoETrainer - INFO - Bin 4: Small bin (584), using rule-based selection
2025-06-08 15:16:34,431 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-08 15:16:34,433 - MoETrainer - INFO -   1. ridge_medium: Score=1.021, MAE=$37237, RMSE=$43345, RÂ²=0.075 [SELECTED]
2025-06-08 15:16:34,433 - MoETrainer - INFO -   2. rf_shallow: Score=1.022, MAE=$36989, RMSE=$43425, RÂ²=0.072
2025-06-08 15:16:34,433 - MoETrainer - INFO -   3. elastic_light: Score=1.022, MAE=$37256, RMSE=$43417, RÂ²=0.072
2025-06-08 15:16:34,433 - MoETrainer - INFO - Bin 5: Small bin (610), using rule-based selection
2025-06-08 15:16:35,087 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-08 15:16:35,088 - MoETrainer - INFO -   1. elastic_light: Score=1.112, MAE=$199298, RMSE=$256278, RÂ²=0.174 [SELECTED]
2025-06-08 15:16:35,088 - MoETrainer - INFO -   2. ridge_medium: Score=1.134, MAE=$202128, RMSE=$261846, RÂ²=0.138
2025-06-08 15:16:35,088 - MoETrainer - INFO -   3. rf_shallow: Score=1.151, MAE=$201803, RMSE=$266824, RÂ²=0.105
2025-06-08 15:16:35,089 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:16:35,091 - MoETrainer - INFO - Successfully trained elastic_light for bin 0: 533 samples
2025-06-08 15:16:35,274 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 632 samples
2025-06-08 15:16:35,308 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 2: 621 samples
2025-06-08 15:16:35,480 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 596 samples
2025-06-08 15:16:35,482 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 584 samples
2025-06-08 15:16:35,486 - MoETrainer - INFO - Successfully trained elastic_light for bin 5: 610 samples
2025-06-08 15:16:35,486 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-08 15:16:35,521 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:16:35,521 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:16:35,522 - MoETrainer - INFO -   RMSE: $110,663
2025-06-08 15:16:35,522 - MoETrainer - INFO -   MAE: $56,069 (10.2% of mean)
2025-06-08 15:16:35,523 - MoETrainer - INFO -   RÂ²: 0.8437
2025-06-08 15:16:35,523 - MoETrainer - INFO -   MAPE: 8.4%
2025-06-08 15:16:35,523 - MoETrainer - INFO -   MPE: +1.5% (bias: overprediction)
2025-06-08 15:16:35,524 - MoETrainer - INFO -   Median APE: 6.0%
2025-06-08 15:16:35,524 - MoETrainer - INFO -   Within 5%: 41.7% of predictions
2025-06-08 15:16:35,525 - MoETrainer - INFO -   Within 10%: 75.7% of predictions
2025-06-08 15:16:35,525 - MoETrainer - INFO -   Within 15%: 86.6% of predictions
2025-06-08 15:16:35,525 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:16:35,525 - MoETrainer - INFO -   Bin 0: RMSE=$35,762, RÂ²=0.0641, Samples=165
2025-06-08 15:16:35,526 - MoETrainer - INFO -   Bin 1: RMSE=$20,318, RÂ²=-0.0196, Samples=193
2025-06-08 15:16:35,526 - MoETrainer - INFO -   Bin 2: RMSE=$20,547, RÂ²=0.0539, Samples=161
2025-06-08 15:16:35,526 - MoETrainer - INFO -   Bin 3: RMSE=$27,860, RÂ²=-0.0529, Samples=189
2025-06-08 15:16:35,527 - MoETrainer - INFO -   Bin 4: RMSE=$44,882, RÂ²=-0.0086, Samples=185
2025-06-08 15:16:35,527 - MoETrainer - INFO -   Bin 5: RMSE=$246,175, RÂ²=0.2126, Samples=208
2025-06-08 15:16:35,527 - MoETrainer - INFO - Final Expert Configuration:
2025-06-08 15:16:35,529 - MoETrainer - INFO -   Bin 0: elastic_light
2025-06-08 15:16:35,529 - MoETrainer - INFO -   Bin 1: rf_shallow
2025-06-08 15:16:35,529 - MoETrainer - INFO -   Bin 2: xgb_conservative
2025-06-08 15:16:35,530 - MoETrainer - INFO -   Bin 3: rf_shallow
2025-06-08 15:16:35,530 - MoETrainer - INFO -   Bin 4: ridge_medium
2025-06-08 15:16:35,531 - MoETrainer - INFO -   Bin 5: elastic_light
2025-06-08 15:16:35,531 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-08 15:16:35,532 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-08 15:16:35,532 - MoETrainer - INFO - Final Performance: RÂ² = 0.8437
2025-06-08 15:16:35,532 - MoETrainer - INFO - Final RMSE: $110,663
2025-06-08 15:16:35,533 - MoETrainer - INFO - Final MAE: $56,069
2025-06-08 15:22:29,495 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-08 15:22:29,495 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-08 15:22:29,496 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-08 15:22:30,001 - MoETrainer - INFO - Raw data shape: (151630, 26)
2025-06-08 15:22:30,428 - MoETrainer - INFO - Final features: 23 (from 27 after consolidation)
2025-06-08 15:22:30,442 - MoETrainer - INFO - Loaded dataset: 151630 samples, 23 features
2025-06-08 15:22:30,444 - MoETrainer - INFO - Target statistics: mean=$409, std=$249
2025-06-08 15:22:30,446 - MoETrainer - INFO - Target range: [$0, $4,900]
2025-06-08 15:22:30,446 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-08 15:22:30,484 - MoETrainer - INFO - Removed 453 outliers (0.3%)
2025-06-08 15:22:30,500 - MoETrainer - INFO - Applying smart feature selection from 23 features...
2025-06-08 15:23:08,533 - MoETrainer - INFO - Selected 16 features using hybrid selection
2025-06-08 15:23:08,648 - MoETrainer - INFO - Applied robust scaling
2025-06-08 15:23:08,650 - MoETrainer - INFO - Splitting data...
2025-06-08 15:23:08,697 - MoETrainer - INFO - Data split - Train: 98264, Val: 22677, Test: 30236
2025-06-08 15:23:08,698 - MoETrainer - INFO - Train target: mean=$405, std=$229
2025-06-08 15:23:08,699 - MoETrainer - INFO - Test target: mean=$402, std=$226
2025-06-08 15:23:08,700 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-08 15:23:08,708 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:23:08,709 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:23:08,709 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:23:08,713 - MoETrainer - INFO - Bin 0: Large bin (32691), using CV selection
2025-06-08 15:24:17,843 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-08 15:24:17,843 - MoETrainer - INFO -   1. rf_medium: MSE=6Â±0, RÂ²=0.998 [SELECTED]
2025-06-08 15:24:17,843 - MoETrainer - INFO -   2. xgb_balanced: MSE=14Â±0, RÂ²=0.995
2025-06-08 15:24:17,843 - MoETrainer - INFO -   3. rf_shallow: MSE=202Â±14, RÂ²=0.930
2025-06-08 15:24:17,843 - MoETrainer - INFO - Bin 1: Large bin (32483), using CV selection
2025-06-08 15:25:03,815 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-08 15:25:03,815 - MoETrainer - INFO -   1. rf_medium: MSE=19Â±1, RÂ²=0.991 [SELECTED]
2025-06-08 15:25:03,815 - MoETrainer - INFO -   2. xgb_balanced: MSE=23Â±3, RÂ²=0.989
2025-06-08 15:25:03,815 - MoETrainer - INFO -   3. ridge_light: MSE=249Â±19, RÂ²=0.877
2025-06-08 15:25:03,815 - MoETrainer - INFO - Bin 2: Large bin (33090), using CV selection
2025-06-08 15:25:51,798 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-08 15:25:51,799 - MoETrainer - INFO -   1. rf_medium: MSE=73Â±19, RÂ²=0.998 [SELECTED]
2025-06-08 15:25:51,799 - MoETrainer - INFO -   2. xgb_balanced: MSE=170Â±15, RÂ²=0.996
2025-06-08 15:25:51,799 - MoETrainer - INFO -   3. ridge_light: MSE=2203Â±86, RÂ²=0.954
2025-06-08 15:25:51,799 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:26:15,701 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 32691 samples
2025-06-08 15:26:47,765 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 32483 samples
2025-06-08 15:27:22,713 - MoETrainer - INFO - Successfully trained rf_medium for bin 2: 33090 samples
2025-06-08 15:27:22,713 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-08 15:27:23,608 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:27:23,608 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:27:23,621 - MoETrainer - INFO -   RMSE: $5
2025-06-08 15:27:23,622 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-08 15:27:23,622 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-08 15:27:23,622 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-08 15:27:23,622 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-08 15:27:23,622 - MoETrainer - INFO -   Median APE: 0.3%
2025-06-08 15:27:23,622 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-08 15:27:23,622 - MoETrainer - INFO -   Within 10%: 99.7% of predictions
2025-06-08 15:27:23,622 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-08 15:27:23,622 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:27:23,622 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9988, Samples=10098
2025-06-08 15:27:23,627 - MoETrainer - INFO -   Bin 1: RMSE=$4, RÂ²=0.9913, Samples=10079
2025-06-08 15:27:23,627 - MoETrainer - INFO -   Bin 2: RMSE=$7, RÂ²=0.9990, Samples=10059
2025-06-08 15:27:23,627 - MoETrainer - INFO -   3 bins: RÂ²=0.9996, RMSE=$5
2025-06-08 15:27:23,637 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:27:23,639 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:27:23,639 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:27:23,641 - MoETrainer - INFO - Bin 0: Large bin (24533), using CV selection
2025-06-08 15:28:25,209 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-08 15:28:25,209 - MoETrainer - INFO -   1. rf_medium: MSE=6Â±1, RÂ²=0.997 [SELECTED]
2025-06-08 15:28:25,209 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.995
2025-06-08 15:28:25,210 - MoETrainer - INFO -   3. rf_shallow: MSE=150Â±10, RÂ²=0.930
2025-06-08 15:28:25,215 - MoETrainer - INFO - Bin 1: Large bin (24394), using CV selection
2025-06-08 15:29:31,172 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-08 15:29:31,172 - MoETrainer - INFO -   1. xgb_balanced: MSE=12Â±1, RÂ²=0.987 [SELECTED]
2025-06-08 15:29:31,173 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±3, RÂ²=0.978
2025-06-08 15:29:31,173 - MoETrainer - INFO -   3. ridge_light: MSE=172Â±11, RÂ²=0.818
2025-06-08 15:29:31,178 - MoETrainer - INFO - Bin 2: Large bin (24366), using CV selection
2025-06-08 15:30:50,538 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-08 15:30:50,538 - MoETrainer - INFO -   1. xgb_balanced: MSE=21Â±4, RÂ²=0.987 [SELECTED]
2025-06-08 15:30:50,538 - MoETrainer - INFO -   2. rf_medium: MSE=85Â±7, RÂ²=0.949
2025-06-08 15:30:50,539 - MoETrainer - INFO -   3. ridge_light: MSE=238Â±18, RÂ²=0.858
2025-06-08 15:30:50,544 - MoETrainer - INFO - Bin 3: Large bin (24971), using CV selection
2025-06-08 15:31:57,703 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-08 15:31:57,703 - MoETrainer - INFO -   1. rf_medium: MSE=103Â±26, RÂ²=0.998 [SELECTED]
2025-06-08 15:31:57,703 - MoETrainer - INFO -   2. xgb_balanced: MSE=179Â±17, RÂ²=0.996
2025-06-08 15:31:57,703 - MoETrainer - INFO -   3. ridge_light: MSE=2177Â±40, RÂ²=0.955
2025-06-08 15:31:57,703 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:32:16,221 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 24533 samples
2025-06-08 15:32:16,946 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 24394 samples
2025-06-08 15:32:17,588 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 24366 samples
2025-06-08 15:32:37,086 - MoETrainer - INFO - Successfully trained rf_medium for bin 3: 24971 samples
2025-06-08 15:32:37,088 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-08 15:32:37,412 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:32:37,413 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:32:37,413 - MoETrainer - INFO -   RMSE: $5
2025-06-08 15:32:37,414 - MoETrainer - INFO -   MAE: $3 (0.6% of mean)
2025-06-08 15:32:37,414 - MoETrainer - INFO -   RÂ²: 0.9995
2025-06-08 15:32:37,414 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-08 15:32:37,415 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-08 15:32:37,415 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-08 15:32:37,415 - MoETrainer - INFO -   Within 5%: 99.4% of predictions
2025-06-08 15:32:37,415 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-08 15:32:37,416 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-08 15:32:37,416 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:32:37,416 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9983, Samples=7643
2025-06-08 15:32:37,416 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9888, Samples=7560
2025-06-08 15:32:37,416 - MoETrainer - INFO -   Bin 2: RMSE=$5, RÂ²=0.9871, Samples=7457
2025-06-08 15:32:37,416 - MoETrainer - INFO -   Bin 3: RMSE=$8, RÂ²=0.9987, Samples=7576
2025-06-08 15:32:37,417 - MoETrainer - INFO -   4 bins: RÂ²=0.9995, RMSE=$5
2025-06-08 15:32:37,423 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:32:37,423 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:32:37,423 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:32:37,426 - MoETrainer - INFO - Bin 0: Large bin (19436), using CV selection
2025-06-08 15:33:05,963 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-08 15:33:05,964 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±2, RÂ²=0.996 [SELECTED]
2025-06-08 15:33:05,964 - MoETrainer - INFO -   2. xgb_balanced: MSE=11Â±3, RÂ²=0.994
2025-06-08 15:33:05,964 - MoETrainer - INFO -   3. xgb_conservative: MSE=157Â±4, RÂ²=0.910
2025-06-08 15:33:05,967 - MoETrainer - INFO - Bin 1: Large bin (19643), using CV selection
2025-06-08 15:33:34,531 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-08 15:33:34,532 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±0, RÂ²=0.982 [SELECTED]
2025-06-08 15:33:34,532 - MoETrainer - INFO -   2. rf_medium: MSE=23Â±2, RÂ²=0.962
2025-06-08 15:33:34,532 - MoETrainer - INFO -   3. ridge_light: MSE=148Â±10, RÂ²=0.752
2025-06-08 15:33:34,535 - MoETrainer - INFO - Bin 2: Large bin (19871), using CV selection
2025-06-08 15:34:02,821 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-08 15:34:02,821 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±0, RÂ²=0.981 [SELECTED]
2025-06-08 15:34:02,821 - MoETrainer - INFO -   2. rf_medium: MSE=55Â±1, RÂ²=0.928
2025-06-08 15:34:02,821 - MoETrainer - INFO -   3. ridge_light: MSE=164Â±4, RÂ²=0.785
2025-06-08 15:34:02,824 - MoETrainer - INFO - Bin 3: Large bin (19631), using CV selection
2025-06-08 15:34:31,571 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-08 15:34:31,571 - MoETrainer - INFO -   1. xgb_balanced: MSE=26Â±2, RÂ²=0.984 [SELECTED]
2025-06-08 15:34:31,571 - MoETrainer - INFO -   2. rf_medium: MSE=118Â±24, RÂ²=0.929
2025-06-08 15:34:31,572 - MoETrainer - INFO -   3. ridge_light: MSE=252Â±10, RÂ²=0.849
2025-06-08 15:34:31,575 - MoETrainer - INFO - Bin 4: Large bin (19683), using CV selection
2025-06-08 15:35:12,985 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-08 15:35:12,985 - MoETrainer - INFO -   1. rf_medium: MSE=110Â±14, RÂ²=0.998 [SELECTED]
2025-06-08 15:35:12,986 - MoETrainer - INFO -   2. xgb_balanced: MSE=189Â±15, RÂ²=0.996
2025-06-08 15:35:12,986 - MoETrainer - INFO -   3. ridge_light: MSE=2151Â±85, RÂ²=0.956
2025-06-08 15:35:12,987 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:35:28,038 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 19436 samples
2025-06-08 15:35:28,649 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 19643 samples
2025-06-08 15:35:29,501 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 19871 samples
2025-06-08 15:35:30,367 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 19631 samples
2025-06-08 15:35:47,199 - MoETrainer - INFO - Successfully trained rf_medium for bin 4: 19683 samples
2025-06-08 15:35:47,201 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-08 15:35:47,508 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:35:47,509 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:35:47,509 - MoETrainer - INFO -   RMSE: $5
2025-06-08 15:35:47,509 - MoETrainer - INFO -   MAE: $3 (0.6% of mean)
2025-06-08 15:35:47,510 - MoETrainer - INFO -   RÂ²: 0.9995
2025-06-08 15:35:47,510 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-08 15:35:47,510 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-08 15:35:47,512 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-08 15:35:47,512 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-08 15:35:47,512 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-08 15:35:47,512 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-08 15:35:47,513 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:35:47,513 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=6015
2025-06-08 15:35:47,513 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9867, Samples=6119
2025-06-08 15:35:47,513 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9849, Samples=6123
2025-06-08 15:35:47,513 - MoETrainer - INFO -   Bin 3: RMSE=$5, RÂ²=0.9860, Samples=6087
2025-06-08 15:35:47,513 - MoETrainer - INFO -   Bin 4: RMSE=$9, RÂ²=0.9983, Samples=5892
2025-06-08 15:35:47,518 - MoETrainer - INFO -   5 bins: RÂ²=0.9995, RMSE=$5
2025-06-08 15:35:47,527 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:35:47,527 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:35:47,527 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:35:47,531 - MoETrainer - INFO - Bin 0: Large bin (16200), using CV selection
2025-06-08 15:36:44,814 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-08 15:36:44,814 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±1, RÂ²=0.996 [SELECTED]
2025-06-08 15:36:44,814 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.994
2025-06-08 15:36:44,816 - MoETrainer - INFO -   3. xgb_conservative: MSE=141Â±1, RÂ²=0.909
2025-06-08 15:36:44,816 - MoETrainer - INFO - Bin 1: Large bin (16491), using CV selection
2025-06-08 15:37:20,935 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-08 15:37:20,935 - MoETrainer - INFO -   1. xgb_balanced: MSE=9Â±0, RÂ²=0.978 [SELECTED]
2025-06-08 15:37:20,936 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±1, RÂ²=0.955
2025-06-08 15:37:20,936 - MoETrainer - INFO -   3. ridge_light: MSE=124Â±13, RÂ²=0.712
2025-06-08 15:37:20,940 - MoETrainer - INFO - Bin 2: Large bin (16236), using CV selection
2025-06-08 15:37:58,223 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-08 15:37:58,223 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±1, RÂ²=0.973 [SELECTED]
2025-06-08 15:37:58,223 - MoETrainer - INFO -   2. rf_medium: MSE=45Â±2, RÂ²=0.896
2025-06-08 15:37:58,223 - MoETrainer - INFO -   3. ridge_light: MSE=146Â±17, RÂ²=0.658
2025-06-08 15:37:58,229 - MoETrainer - INFO - Bin 3: Large bin (16247), using CV selection
2025-06-08 15:38:57,959 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-08 15:38:57,959 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±1, RÂ²=0.975 [SELECTED]
2025-06-08 15:38:57,972 - MoETrainer - INFO -   2. rf_medium: MSE=53Â±1, RÂ²=0.911
2025-06-08 15:38:57,972 - MoETrainer - INFO -   3. ridge_light: MSE=165Â±10, RÂ²=0.720
2025-06-08 15:38:57,978 - MoETrainer - INFO - Bin 4: Large bin (16704), using CV selection
2025-06-08 15:39:56,142 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-08 15:39:56,142 - MoETrainer - INFO -   1. xgb_balanced: MSE=28Â±2, RÂ²=0.983 [SELECTED]
2025-06-08 15:39:56,142 - MoETrainer - INFO -   2. rf_medium: MSE=108Â±27, RÂ²=0.935
2025-06-08 15:39:56,142 - MoETrainer - INFO -   3. ridge_light: MSE=267Â±1, RÂ²=0.840
2025-06-08 15:39:56,151 - MoETrainer - INFO - Bin 5: Large bin (16386), using CV selection
2025-06-08 15:40:52,365 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-08 15:40:52,367 - MoETrainer - INFO -   1. rf_medium: MSE=138Â±67, RÂ²=0.997 [SELECTED]
2025-06-08 15:40:52,367 - MoETrainer - INFO -   2. xgb_balanced: MSE=204Â±26, RÂ²=0.996
2025-06-08 15:40:52,368 - MoETrainer - INFO -   3. ridge_light: MSE=2128Â±36, RÂ²=0.957
2025-06-08 15:40:52,368 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:41:06,144 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 16200 samples
2025-06-08 15:41:06,537 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 16491 samples
2025-06-08 15:41:06,922 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 16236 samples
2025-06-08 15:41:07,295 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 16247 samples
2025-06-08 15:41:07,694 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 4: 16704 samples
2025-06-08 15:41:18,401 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 16386 samples
2025-06-08 15:41:18,402 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-08 15:41:18,618 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:41:18,618 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:41:18,618 - MoETrainer - INFO -   RMSE: $5
2025-06-08 15:41:18,618 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-08 15:41:18,619 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-08 15:41:18,619 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-08 15:41:18,619 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-08 15:41:18,619 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-08 15:41:18,620 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-08 15:41:18,620 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-08 15:41:18,620 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-08 15:41:18,620 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:41:18,620 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=5079
2025-06-08 15:41:18,620 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9839, Samples=5019
2025-06-08 15:41:18,622 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9794, Samples=5105
2025-06-08 15:41:18,622 - MoETrainer - INFO -   Bin 3: RMSE=$4, RÂ²=0.9787, Samples=4974
2025-06-08 15:41:18,622 - MoETrainer - INFO -   Bin 4: RMSE=$5, RÂ²=0.9844, Samples=5181
2025-06-08 15:41:18,622 - MoETrainer - INFO -   Bin 5: RMSE=$9, RÂ²=0.9984, Samples=4878
2025-06-08 15:41:18,631 - MoETrainer - INFO -   6 bins: RÂ²=0.9996, RMSE=$5
2025-06-08 15:41:18,632 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-08 15:41:18,632 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-08 15:41:18,639 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-08 15:41:18,639 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-08 15:41:18,640 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-08 15:41:18,642 - MoETrainer - INFO - Bin 0: Large bin (16200), using CV selection
2025-06-08 15:41:46,278 - MoETrainer - INFO - Bin 0: CV selection results:
2025-06-08 15:41:46,278 - MoETrainer - INFO -   1. rf_medium: MSE=7Â±1, RÂ²=0.996 [SELECTED]
2025-06-08 15:41:46,278 - MoETrainer - INFO -   2. xgb_balanced: MSE=10Â±2, RÂ²=0.994
2025-06-08 15:41:46,278 - MoETrainer - INFO -   3. xgb_conservative: MSE=141Â±1, RÂ²=0.909
2025-06-08 15:41:46,283 - MoETrainer - INFO - Bin 1: Large bin (16491), using CV selection
2025-06-08 15:42:15,749 - MoETrainer - INFO - Bin 1: CV selection results:
2025-06-08 15:42:15,750 - MoETrainer - INFO -   1. xgb_balanced: MSE=9Â±0, RÂ²=0.978 [SELECTED]
2025-06-08 15:42:15,750 - MoETrainer - INFO -   2. rf_medium: MSE=20Â±1, RÂ²=0.955
2025-06-08 15:42:15,750 - MoETrainer - INFO -   3. ridge_light: MSE=124Â±13, RÂ²=0.712
2025-06-08 15:42:15,753 - MoETrainer - INFO - Bin 2: Large bin (16236), using CV selection
2025-06-08 15:42:45,506 - MoETrainer - INFO - Bin 2: CV selection results:
2025-06-08 15:42:45,506 - MoETrainer - INFO -   1. xgb_balanced: MSE=11Â±1, RÂ²=0.973 [SELECTED]
2025-06-08 15:42:45,506 - MoETrainer - INFO -   2. rf_medium: MSE=45Â±2, RÂ²=0.896
2025-06-08 15:42:45,507 - MoETrainer - INFO -   3. ridge_light: MSE=146Â±17, RÂ²=0.658
2025-06-08 15:42:45,509 - MoETrainer - INFO - Bin 3: Large bin (16247), using CV selection
2025-06-08 15:43:17,041 - MoETrainer - INFO - Bin 3: CV selection results:
2025-06-08 15:43:17,042 - MoETrainer - INFO -   1. xgb_balanced: MSE=15Â±1, RÂ²=0.975 [SELECTED]
2025-06-08 15:43:17,042 - MoETrainer - INFO -   2. rf_medium: MSE=53Â±1, RÂ²=0.911
2025-06-08 15:43:17,042 - MoETrainer - INFO -   3. ridge_light: MSE=165Â±10, RÂ²=0.720
2025-06-08 15:43:17,045 - MoETrainer - INFO - Bin 4: Large bin (16704), using CV selection
2025-06-08 15:43:50,051 - MoETrainer - INFO - Bin 4: CV selection results:
2025-06-08 15:43:50,052 - MoETrainer - INFO -   1. xgb_balanced: MSE=28Â±2, RÂ²=0.983 [SELECTED]
2025-06-08 15:43:50,052 - MoETrainer - INFO -   2. rf_medium: MSE=108Â±27, RÂ²=0.935
2025-06-08 15:43:50,052 - MoETrainer - INFO -   3. ridge_light: MSE=267Â±1, RÂ²=0.840
2025-06-08 15:43:50,056 - MoETrainer - INFO - Bin 5: Large bin (16386), using CV selection
2025-06-08 15:44:21,756 - MoETrainer - INFO - Bin 5: CV selection results:
2025-06-08 15:44:21,756 - MoETrainer - INFO -   1. rf_medium: MSE=138Â±67, RÂ²=0.997 [SELECTED]
2025-06-08 15:44:21,756 - MoETrainer - INFO -   2. xgb_balanced: MSE=204Â±26, RÂ²=0.996
2025-06-08 15:44:21,756 - MoETrainer - INFO -   3. ridge_light: MSE=2128Â±36, RÂ²=0.957
2025-06-08 15:44:21,756 - MoETrainer - INFO - Training selected expert models...
2025-06-08 15:44:32,793 - MoETrainer - INFO - Successfully trained rf_medium for bin 0: 16200 samples
2025-06-08 15:44:33,214 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 1: 16491 samples
2025-06-08 15:44:33,637 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 2: 16236 samples
2025-06-08 15:44:34,045 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 3: 16247 samples
2025-06-08 15:44:34,469 - MoETrainer - INFO - Successfully trained xgb_balanced for bin 4: 16704 samples
2025-06-08 15:44:45,565 - MoETrainer - INFO - Successfully trained rf_medium for bin 5: 16386 samples
2025-06-08 15:44:45,565 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-08 15:44:45,782 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-08 15:44:45,782 - MoETrainer - INFO - Overall Performance:
2025-06-08 15:44:45,782 - MoETrainer - INFO -   RMSE: $5
2025-06-08 15:44:45,782 - MoETrainer - INFO -   MAE: $2 (0.6% of mean)
2025-06-08 15:44:45,782 - MoETrainer - INFO -   RÂ²: 0.9996
2025-06-08 15:44:45,782 - MoETrainer - INFO -   MAPE: 0.7%
2025-06-08 15:44:45,782 - MoETrainer - INFO -   MPE: +0.1% (bias: overprediction)
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Median APE: 0.4%
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Within 5%: 99.3% of predictions
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Within 10%: 99.8% of predictions
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Within 15%: 99.9% of predictions
2025-06-08 15:44:45,782 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 0: RMSE=$2, RÂ²=0.9968, Samples=5079
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 1: RMSE=$3, RÂ²=0.9839, Samples=5019
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 2: RMSE=$3, RÂ²=0.9794, Samples=5105
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 3: RMSE=$4, RÂ²=0.9787, Samples=4974
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 4: RMSE=$5, RÂ²=0.9844, Samples=5181
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 5: RMSE=$9, RÂ²=0.9984, Samples=4878
2025-06-08 15:44:45,782 - MoETrainer - INFO - Final Expert Configuration:
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 0: rf_medium
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 1: xgb_balanced
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 2: xgb_balanced
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 3: xgb_balanced
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 4: xgb_balanced
2025-06-08 15:44:45,782 - MoETrainer - INFO -   Bin 5: rf_medium
2025-06-08 15:44:45,782 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-08 15:44:45,782 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-08 15:44:45,782 - MoETrainer - INFO - Final Performance: RÂ² = 0.9996
2025-06-08 15:44:45,782 - MoETrainer - INFO - Final RMSE: $5
2025-06-08 15:44:45,792 - MoETrainer - INFO - Final MAE: $2
2025-06-09 23:59:19,163 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-09 23:59:19,163 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-09 23:59:19,163 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-09 23:59:19,163 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-09 23:59:19,168 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-09 23:59:19,170 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-09 23:59:19,170 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-09 23:59:19,170 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-09 23:59:19,177 - MoETrainer - INFO - Applied robust scaling
2025-06-09 23:59:19,177 - MoETrainer - INFO - Splitting data...
2025-06-09 23:59:19,181 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-09 23:59:19,183 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-09 23:59:19,183 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-09 23:59:19,184 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-09 23:59:19,184 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-09 23:59:19,185 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-09 23:59:19,185 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-09 23:59:19,185 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-09 23:59:19,825 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-09 23:59:19,825 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-09 23:59:19,825 - MoETrainer - INFO -   2. rf_shallow: Score=0.718, MAE=$23801, RMSE=$30844, RÂ²=0.576
2025-06-09 23:59:19,826 - MoETrainer - INFO -   3. rf_medium: Score=0.720, MAE=$24118, RMSE=$30921, RÂ²=0.574
2025-06-09 23:59:19,826 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-09 23:59:20,409 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-09 23:59:20,409 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-09 23:59:20,410 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-09 23:59:20,410 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-09 23:59:20,410 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-09 23:59:20,976 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-09 23:59:20,976 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-09 23:59:20,977 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-09 23:59:20,977 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-09 23:59:20,978 - MoETrainer - INFO - Training selected expert models...
2025-06-09 23:59:20,980 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-09 23:59:21,314 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-09 23:59:21,317 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-09 23:59:21,317 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-09 23:59:21,426 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-09 23:59:21,426 - MoETrainer - INFO - Overall Performance:
2025-06-09 23:59:21,426 - MoETrainer - INFO -   RMSE: $27,918
2025-06-09 23:59:21,426 - MoETrainer - INFO -   MAE: $22,153 (4.7% of mean)
2025-06-09 23:59:21,426 - MoETrainer - INFO -   RÂ²: 0.9268
2025-06-09 23:59:21,426 - MoETrainer - INFO -   MAPE: 5.3%
2025-06-09 23:59:21,428 - MoETrainer - INFO -   MPE: +0.5% (bias: overprediction)
2025-06-09 23:59:21,428 - MoETrainer - INFO -   Median APE: 3.9%
2025-06-09 23:59:21,428 - MoETrainer - INFO -   Within 5%: 59.8% of predictions
2025-06-09 23:59:21,428 - MoETrainer - INFO -   Within 10%: 89.8% of predictions
2025-06-09 23:59:21,428 - MoETrainer - INFO -   Within 15%: 96.2% of predictions
2025-06-09 23:59:21,428 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-09 23:59:21,428 - MoETrainer - INFO -   Bin 0: RMSE=$32,300, RÂ²=0.6490, Samples=132
2025-06-09 23:59:21,428 - MoETrainer - INFO -   Bin 1: RMSE=$22,868, RÂ²=0.1699, Samples=130
2025-06-09 23:59:21,428 - MoETrainer - INFO -   Bin 2: RMSE=$27,724, RÂ²=0.7245, Samples=138
2025-06-09 23:59:21,431 - MoETrainer - INFO -   3 bins: RÂ²=0.9268, RMSE=$27,918
2025-06-09 23:59:21,431 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-09 23:59:21,431 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-09 23:59:21,431 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-09 23:59:21,434 - MoETrainer - INFO - Bin 0: Small bin (325), using rule-based selection
2025-06-09 23:59:21,584 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-09 23:59:21,584 - MoETrainer - INFO -   1. ridge_medium: Score=0.722, MAE=$22686, RMSE=$29813, RÂ²=0.573 [SELECTED]
2025-06-09 23:59:21,584 - MoETrainer - INFO -   2. xgb_conservative: Score=0.821, MAE=$26010, RMSE=$33876, RÂ²=0.449
2025-06-09 23:59:21,584 - MoETrainer - INFO -   3. rf_shallow: Score=0.823, MAE=$26253, RMSE=$33930, RÂ²=0.447
2025-06-09 23:59:21,596 - MoETrainer - INFO - Bin 1: Small bin (325), using rule-based selection
2025-06-09 23:59:21,760 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-09 23:59:21,760 - MoETrainer - INFO -   1. ridge_medium: Score=0.875, MAE=$14693, RMSE=$16957, RÂ²=0.293 [SELECTED]
2025-06-09 23:59:21,760 - MoETrainer - INFO -   2. rf_shallow: Score=0.886, MAE=$14793, RMSE=$17177, RÂ²=0.274
2025-06-09 23:59:21,760 - MoETrainer - INFO -   3. xgb_conservative: Score=0.912, MAE=$14813, RMSE=$17695, RÂ²=0.230
2025-06-09 23:59:21,760 - MoETrainer - INFO - Bin 2: Small bin (325), using rule-based selection
2025-06-09 23:59:21,958 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-09 23:59:21,958 - MoETrainer - INFO -   1. ridge_medium: Score=0.914, MAE=$15819, RMSE=$18279, RÂ²=0.222 [SELECTED]
2025-06-09 23:59:21,958 - MoETrainer - INFO -   2. rf_shallow: Score=0.945, MAE=$15926, RMSE=$18921, RÂ²=0.167
2025-06-09 23:59:21,958 - MoETrainer - INFO -   3. xgb_conservative: Score=0.952, MAE=$15850, RMSE=$19066, RÂ²=0.154
2025-06-09 23:59:21,958 - MoETrainer - INFO - Bin 3: Small bin (325), using rule-based selection
2025-06-09 23:59:22,203 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-09 23:59:22,205 - MoETrainer - INFO -   1. ridge_medium: Score=0.615, MAE=$22836, RMSE=$29251, RÂ²=0.667 [SELECTED]
2025-06-09 23:59:22,205 - MoETrainer - INFO -   2. xgb_conservative: Score=0.697, MAE=$27000, RMSE=$33043, RÂ²=0.575
2025-06-09 23:59:22,206 - MoETrainer - INFO -   3. rf_shallow: Score=0.704, MAE=$25873, RMSE=$33524, RÂ²=0.563
2025-06-09 23:59:22,206 - MoETrainer - INFO - Training selected expert models...
2025-06-09 23:59:22,209 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 325 samples
2025-06-09 23:59:22,213 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 325 samples
2025-06-09 23:59:22,219 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 325 samples
2025-06-09 23:59:22,221 - MoETrainer - INFO - Successfully trained ridge_medium for bin 3: 325 samples
2025-06-09 23:59:22,221 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-09 23:59:22,253 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-09 23:59:22,253 - MoETrainer - INFO - Overall Performance:
2025-06-09 23:59:22,253 - MoETrainer - INFO -   RMSE: $24,112
2025-06-09 23:59:22,253 - MoETrainer - INFO -   MAE: $18,450 (3.9% of mean)
2025-06-09 23:59:22,253 - MoETrainer - INFO -   RÂ²: 0.9454
2025-06-09 23:59:22,253 - MoETrainer - INFO -   MAPE: 4.5%
2025-06-09 23:59:22,258 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-09 23:59:22,258 - MoETrainer - INFO -   Median APE: 3.3%
2025-06-09 23:59:22,258 - MoETrainer - INFO -   Within 5%: 72.0% of predictions
2025-06-09 23:59:22,258 - MoETrainer - INFO -   Within 10%: 92.5% of predictions
2025-06-09 23:59:22,258 - MoETrainer - INFO -   Within 15%: 96.2% of predictions
2025-06-09 23:59:22,258 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-09 23:59:22,262 - MoETrainer - INFO -   Bin 0: RMSE=$33,148, RÂ²=0.5590, Samples=95
2025-06-09 23:59:22,262 - MoETrainer - INFO -   Bin 1: RMSE=$17,375, RÂ²=0.2550, Samples=97
2025-06-09 23:59:22,262 - MoETrainer - INFO -   Bin 2: RMSE=$16,333, RÂ²=0.2695, Samples=104
2025-06-09 23:59:22,264 - MoETrainer - INFO -   Bin 3: RMSE=$26,154, RÂ²=0.6891, Samples=104
2025-06-09 23:59:22,265 - MoETrainer - INFO -   4 bins: RÂ²=0.9454, RMSE=$24,112
2025-06-09 23:59:22,266 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-09 23:59:22,266 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-09 23:59:22,266 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-09 23:59:22,269 - MoETrainer - INFO - Bin 0: Small bin (260), using rule-based selection
2025-06-09 23:59:22,484 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-09 23:59:22,484 - MoETrainer - INFO -   1. xgb_conservative: Score=0.738, MAE=$19489, RMSE=$24559, RÂ²=0.539 [SELECTED]
2025-06-09 23:59:22,484 - MoETrainer - INFO -   2. ridge_medium: Score=0.741, MAE=$19033, RMSE=$24690, RÂ²=0.534
2025-06-09 23:59:22,486 - MoETrainer - INFO -   3. rf_shallow: Score=0.758, MAE=$19557, RMSE=$25270, RÂ²=0.512
2025-06-09 23:59:22,486 - MoETrainer - INFO - Bin 1: Small bin (260), using rule-based selection
2025-06-09 23:59:22,661 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-09 23:59:22,661 - MoETrainer - INFO -   1. ridge_medium: Score=0.952, MAE=$13640, RMSE=$15963, RÂ²=0.156 [SELECTED]
2025-06-09 23:59:22,661 - MoETrainer - INFO -   2. rf_shallow: Score=0.989, MAE=$13518, RMSE=$16612, RÂ²=0.086
2025-06-09 23:59:22,661 - MoETrainer - INFO -   3. xgb_conservative: Score=0.997, MAE=$14013, RMSE=$16731, RÂ²=0.073
2025-06-09 23:59:22,661 - MoETrainer - INFO - Bin 2: Small bin (260), using rule-based selection
2025-06-09 23:59:22,807 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-09 23:59:22,807 - MoETrainer - INFO -   1. ridge_medium: Score=0.959, MAE=$11353, RMSE=$13509, RÂ²=0.127 [SELECTED]
2025-06-09 23:59:22,807 - MoETrainer - INFO -   2. xgb_conservative: Score=0.999, MAE=$11751, RMSE=$14085, RÂ²=0.051
2025-06-09 23:59:22,807 - MoETrainer - INFO -   3. rf_shallow: Score=1.012, MAE=$11904, RMSE=$14270, RÂ²=0.026
2025-06-09 23:59:22,807 - MoETrainer - INFO - Bin 3: Small bin (260), using rule-based selection
2025-06-09 23:59:22,958 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-09 23:59:22,958 - MoETrainer - INFO -   1. rf_shallow: Score=0.859, MAE=$13079, RMSE=$15177, RÂ²=0.304 [SELECTED]
2025-06-09 23:59:22,958 - MoETrainer - INFO -   2. xgb_conservative: Score=0.879, MAE=$13011, RMSE=$15543, RÂ²=0.270
2025-06-09 23:59:22,958 - MoETrainer - INFO -   3. ridge_medium: Score=0.904, MAE=$13793, RMSE=$15974, RÂ²=0.229
2025-06-09 23:59:22,958 - MoETrainer - INFO - Bin 4: Small bin (260), using rule-based selection
2025-06-09 23:59:23,102 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-09 23:59:23,102 - MoETrainer - INFO -   1. ridge_medium: Score=0.640, MAE=$23184, RMSE=$28966, RÂ²=0.638 [SELECTED]
2025-06-09 23:59:23,102 - MoETrainer - INFO -   2. xgb_conservative: Score=0.716, MAE=$27054, RMSE=$32309, RÂ²=0.549
2025-06-09 23:59:23,102 - MoETrainer - INFO -   3. rf_shallow: Score=0.736, MAE=$27307, RMSE=$33250, RÂ²=0.523
2025-06-09 23:59:23,102 - MoETrainer - INFO - Training selected expert models...
2025-06-09 23:59:23,138 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 260 samples
2025-06-09 23:59:23,139 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 260 samples
2025-06-09 23:59:23,143 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 260 samples
2025-06-09 23:59:23,259 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 260 samples
2025-06-09 23:59:23,261 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 260 samples
2025-06-09 23:59:23,262 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-09 23:59:23,289 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-09 23:59:23,290 - MoETrainer - INFO - Overall Performance:
2025-06-09 23:59:23,290 - MoETrainer - INFO -   RMSE: $21,997
2025-06-09 23:59:23,290 - MoETrainer - INFO -   MAE: $16,611 (3.6% of mean)
2025-06-09 23:59:23,291 - MoETrainer - INFO -   RÂ²: 0.9546
2025-06-09 23:59:23,291 - MoETrainer - INFO -   MAPE: 4.1%
2025-06-09 23:59:23,291 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-09 23:59:23,292 - MoETrainer - INFO -   Median APE: 2.8%
2025-06-09 23:59:23,292 - MoETrainer - INFO -   Within 5%: 77.0% of predictions
2025-06-09 23:59:23,293 - MoETrainer - INFO -   Within 10%: 95.0% of predictions
2025-06-09 23:59:23,293 - MoETrainer - INFO -   Within 15%: 97.0% of predictions
2025-06-09 23:59:23,293 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-09 23:59:23,294 - MoETrainer - INFO -   Bin 0: RMSE=$33,812, RÂ²=0.4603, Samples=75
2025-06-09 23:59:23,294 - MoETrainer - INFO -   Bin 1: RMSE=$15,070, RÂ²=0.1720, Samples=82
2025-06-09 23:59:23,294 - MoETrainer - INFO -   Bin 2: RMSE=$14,555, RÂ²=0.0691, Samples=77
2025-06-09 23:59:23,295 - MoETrainer - INFO -   Bin 3: RMSE=$15,881, RÂ²=0.2028, Samples=79
2025-06-09 23:59:23,295 - MoETrainer - INFO -   Bin 4: RMSE=$24,668, RÂ²=0.6859, Samples=87
2025-06-09 23:59:23,295 - MoETrainer - INFO -   5 bins: RÂ²=0.9546, RMSE=$21,997
2025-06-09 23:59:23,296 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-09 23:59:23,297 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-09 23:59:23,297 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-09 23:59:23,298 - MoETrainer - INFO - Bin 0: Small bin (217), using rule-based selection
2025-06-09 23:59:23,457 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-09 23:59:23,458 - MoETrainer - INFO -   1. ridge_medium: Score=0.810, MAE=$23026, RMSE=$30602, RÂ²=0.457 [SELECTED]
2025-06-09 23:59:23,458 - MoETrainer - INFO -   2. rf_shallow: Score=0.819, MAE=$23340, RMSE=$30952, RÂ²=0.445
2025-06-09 23:59:23,459 - MoETrainer - INFO -   3. xgb_conservative: Score=0.837, MAE=$23245, RMSE=$31690, RÂ²=0.418
2025-06-09 23:59:23,459 - MoETrainer - INFO - Bin 1: Small bin (216), using rule-based selection
2025-06-09 23:59:23,604 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-09 23:59:23,605 - MoETrainer - INFO -   1. rf_shallow: Score=0.938, MAE=$12983, RMSE=$15086, RÂ²=0.182 [SELECTED]
2025-06-09 23:59:23,605 - MoETrainer - INFO -   2. xgb_conservative: Score=0.944, MAE=$13119, RMSE=$15187, RÂ²=0.171
2025-06-09 23:59:23,606 - MoETrainer - INFO -   3. ridge_medium: Score=0.983, MAE=$13848, RMSE=$15815, RÂ²=0.101
2025-06-09 23:59:23,606 - MoETrainer - INFO - Bin 2: Small bin (217), using rule-based selection
2025-06-09 23:59:23,747 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-09 23:59:23,747 - MoETrainer - INFO -   1. ridge_medium: Score=1.019, MAE=$11724, RMSE=$13256, RÂ²=0.014 [SELECTED]
2025-06-09 23:59:23,748 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$11751, RMSE=$13300, RÂ²=0.008
2025-06-09 23:59:23,748 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$11783, RMSE=$13435, RÂ²=-0.013
2025-06-09 23:59:23,749 - MoETrainer - INFO - Bin 3: Small bin (216), using rule-based selection
2025-06-09 23:59:23,898 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-09 23:59:23,899 - MoETrainer - INFO -   1. rf_shallow: Score=0.956, MAE=$11194, RMSE=$12770, RÂ²=0.129 [SELECTED]
2025-06-09 23:59:23,899 - MoETrainer - INFO -   2. xgb_conservative: Score=0.960, MAE=$11133, RMSE=$12828, RÂ²=0.121
2025-06-09 23:59:23,901 - MoETrainer - INFO -   3. ridge_medium: Score=0.963, MAE=$11329, RMSE=$12856, RÂ²=0.117
2025-06-09 23:59:23,901 - MoETrainer - INFO - Bin 4: Small bin (217), using rule-based selection
2025-06-09 23:59:24,054 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-09 23:59:24,055 - MoETrainer - INFO -   1. xgb_conservative: Score=0.896, MAE=$12613, RMSE=$15047, RÂ²=0.239 [SELECTED]
2025-06-09 23:59:24,055 - MoETrainer - INFO -   2. ridge_medium: Score=0.918, MAE=$13043, RMSE=$15410, RÂ²=0.202
2025-06-09 23:59:24,056 - MoETrainer - INFO -   3. rf_shallow: Score=0.936, MAE=$12718, RMSE=$15737, RÂ²=0.167
2025-06-09 23:59:24,056 - MoETrainer - INFO - Bin 5: Small bin (217), using rule-based selection
2025-06-09 23:59:24,210 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-09 23:59:24,211 - MoETrainer - INFO -   1. ridge_medium: Score=0.695, MAE=$25362, RMSE=$31017, RÂ²=0.572 [SELECTED]
2025-06-09 23:59:24,212 - MoETrainer - INFO -   2. rf_shallow: Score=0.696, MAE=$25262, RMSE=$31034, RÂ²=0.571
2025-06-09 23:59:24,212 - MoETrainer - INFO -   3. xgb_conservative: Score=0.724, MAE=$26505, RMSE=$32292, RÂ²=0.536
2025-06-09 23:59:24,212 - MoETrainer - INFO - Training selected expert models...
2025-06-09 23:59:24,214 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 217 samples
2025-06-09 23:59:24,333 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 216 samples
2025-06-09 23:59:24,336 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 217 samples
2025-06-09 23:59:24,454 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 216 samples
2025-06-09 23:59:24,479 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 217 samples
2025-06-09 23:59:24,481 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 217 samples
2025-06-09 23:59:24,482 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-09 23:59:24,522 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-09 23:59:24,523 - MoETrainer - INFO - Overall Performance:
2025-06-09 23:59:24,523 - MoETrainer - INFO -   RMSE: $20,808
2025-06-09 23:59:24,523 - MoETrainer - INFO -   MAE: $15,765 (3.4% of mean)
2025-06-09 23:59:24,524 - MoETrainer - INFO -   RÂ²: 0.9594
2025-06-09 23:59:24,524 - MoETrainer - INFO -   MAPE: 3.9%
2025-06-09 23:59:24,524 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-09 23:59:24,525 - MoETrainer - INFO -   Median APE: 2.7%
2025-06-09 23:59:24,525 - MoETrainer - INFO -   Within 5%: 78.5% of predictions
2025-06-09 23:59:24,525 - MoETrainer - INFO -   Within 10%: 94.8% of predictions
2025-06-09 23:59:24,526 - MoETrainer - INFO -   Within 15%: 97.5% of predictions
2025-06-09 23:59:24,526 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-09 23:59:24,526 - MoETrainer - INFO -   Bin 0: RMSE=$33,641, RÂ²=0.3913, Samples=61
2025-06-09 23:59:24,526 - MoETrainer - INFO -   Bin 1: RMSE=$16,714, RÂ²=0.0131, Samples=71
2025-06-09 23:59:24,527 - MoETrainer - INFO -   Bin 2: RMSE=$13,295, RÂ²=-0.0186, Samples=60
2025-06-09 23:59:24,527 - MoETrainer - INFO -   Bin 3: RMSE=$12,002, RÂ²=-0.0378, Samples=70
2025-06-09 23:59:24,528 - MoETrainer - INFO -   Bin 4: RMSE=$17,058, RÂ²=0.1041, Samples=68
2025-06-09 23:59:24,528 - MoETrainer - INFO -   Bin 5: RMSE=$25,029, RÂ²=0.6323, Samples=70
2025-06-09 23:59:24,529 - MoETrainer - INFO -   6 bins: RÂ²=0.9594, RMSE=$20,808
2025-06-09 23:59:24,529 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-09 23:59:24,530 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-09 23:59:24,531 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-09 23:59:24,532 - MoETrainer - INFO - Created expert pool with 9 models
2025-06-09 23:59:24,532 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-09 23:59:24,532 - MoETrainer - INFO - Bin 0: Small bin (217), using rule-based selection
2025-06-09 23:59:24,691 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-09 23:59:24,691 - MoETrainer - INFO -   1. ridge_medium: Score=0.810, MAE=$23026, RMSE=$30602, RÂ²=0.457 [SELECTED]
2025-06-09 23:59:24,692 - MoETrainer - INFO -   2. rf_shallow: Score=0.819, MAE=$23340, RMSE=$30952, RÂ²=0.445
2025-06-09 23:59:24,692 - MoETrainer - INFO -   3. xgb_conservative: Score=0.837, MAE=$23245, RMSE=$31690, RÂ²=0.418
2025-06-09 23:59:24,692 - MoETrainer - INFO - Bin 1: Small bin (216), using rule-based selection
2025-06-09 23:59:24,839 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-09 23:59:24,840 - MoETrainer - INFO -   1. rf_shallow: Score=0.938, MAE=$12983, RMSE=$15086, RÂ²=0.182 [SELECTED]
2025-06-09 23:59:24,840 - MoETrainer - INFO -   2. xgb_conservative: Score=0.944, MAE=$13119, RMSE=$15187, RÂ²=0.171
2025-06-09 23:59:24,840 - MoETrainer - INFO -   3. ridge_medium: Score=0.983, MAE=$13848, RMSE=$15815, RÂ²=0.101
2025-06-09 23:59:24,841 - MoETrainer - INFO - Bin 2: Small bin (217), using rule-based selection
2025-06-09 23:59:24,999 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-09 23:59:25,000 - MoETrainer - INFO -   1. ridge_medium: Score=1.019, MAE=$11724, RMSE=$13256, RÂ²=0.014 [SELECTED]
2025-06-09 23:59:25,000 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$11751, RMSE=$13300, RÂ²=0.008
2025-06-09 23:59:25,000 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$11783, RMSE=$13435, RÂ²=-0.013
2025-06-09 23:59:25,001 - MoETrainer - INFO - Bin 3: Small bin (216), using rule-based selection
2025-06-09 23:59:25,138 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-09 23:59:25,139 - MoETrainer - INFO -   1. rf_shallow: Score=0.956, MAE=$11194, RMSE=$12770, RÂ²=0.129 [SELECTED]
2025-06-09 23:59:25,139 - MoETrainer - INFO -   2. xgb_conservative: Score=0.960, MAE=$11133, RMSE=$12828, RÂ²=0.121
2025-06-09 23:59:25,140 - MoETrainer - INFO -   3. ridge_medium: Score=0.963, MAE=$11329, RMSE=$12856, RÂ²=0.117
2025-06-09 23:59:25,140 - MoETrainer - INFO - Bin 4: Small bin (217), using rule-based selection
2025-06-09 23:59:25,285 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-09 23:59:25,286 - MoETrainer - INFO -   1. xgb_conservative: Score=0.896, MAE=$12613, RMSE=$15047, RÂ²=0.239 [SELECTED]
2025-06-09 23:59:25,286 - MoETrainer - INFO -   2. ridge_medium: Score=0.918, MAE=$13043, RMSE=$15410, RÂ²=0.202
2025-06-09 23:59:25,287 - MoETrainer - INFO -   3. rf_shallow: Score=0.936, MAE=$12718, RMSE=$15737, RÂ²=0.167
2025-06-09 23:59:25,287 - MoETrainer - INFO - Bin 5: Small bin (217), using rule-based selection
2025-06-09 23:59:25,445 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-09 23:59:25,445 - MoETrainer - INFO -   1. ridge_medium: Score=0.695, MAE=$25362, RMSE=$31017, RÂ²=0.572 [SELECTED]
2025-06-09 23:59:25,446 - MoETrainer - INFO -   2. rf_shallow: Score=0.696, MAE=$25262, RMSE=$31034, RÂ²=0.571
2025-06-09 23:59:25,446 - MoETrainer - INFO -   3. xgb_conservative: Score=0.724, MAE=$26505, RMSE=$32292, RÂ²=0.536
2025-06-09 23:59:25,446 - MoETrainer - INFO - Training selected expert models...
2025-06-09 23:59:25,449 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 217 samples
2025-06-09 23:59:25,570 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 216 samples
2025-06-09 23:59:25,571 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 217 samples
2025-06-09 23:59:25,687 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 216 samples
2025-06-09 23:59:25,713 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 217 samples
2025-06-09 23:59:25,715 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 217 samples
2025-06-09 23:59:25,715 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-09 23:59:25,753 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-09 23:59:25,754 - MoETrainer - INFO - Overall Performance:
2025-06-09 23:59:25,754 - MoETrainer - INFO -   RMSE: $20,808
2025-06-09 23:59:25,754 - MoETrainer - INFO -   MAE: $15,765 (3.4% of mean)
2025-06-09 23:59:25,755 - MoETrainer - INFO -   RÂ²: 0.9594
2025-06-09 23:59:25,755 - MoETrainer - INFO -   MAPE: 3.9%
2025-06-09 23:59:25,755 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-09 23:59:25,757 - MoETrainer - INFO -   Median APE: 2.7%
2025-06-09 23:59:25,757 - MoETrainer - INFO -   Within 5%: 78.5% of predictions
2025-06-09 23:59:25,758 - MoETrainer - INFO -   Within 10%: 94.8% of predictions
2025-06-09 23:59:25,758 - MoETrainer - INFO -   Within 15%: 97.5% of predictions
2025-06-09 23:59:25,759 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-09 23:59:25,759 - MoETrainer - INFO -   Bin 0: RMSE=$33,641, RÂ²=0.3913, Samples=61
2025-06-09 23:59:25,759 - MoETrainer - INFO -   Bin 1: RMSE=$16,714, RÂ²=0.0131, Samples=71
2025-06-09 23:59:25,761 - MoETrainer - INFO -   Bin 2: RMSE=$13,295, RÂ²=-0.0186, Samples=60
2025-06-09 23:59:25,761 - MoETrainer - INFO -   Bin 3: RMSE=$12,002, RÂ²=-0.0378, Samples=70
2025-06-09 23:59:25,762 - MoETrainer - INFO -   Bin 4: RMSE=$17,058, RÂ²=0.1041, Samples=68
2025-06-09 23:59:25,762 - MoETrainer - INFO -   Bin 5: RMSE=$25,029, RÂ²=0.6323, Samples=70
2025-06-09 23:59:25,763 - MoETrainer - INFO - Final Expert Configuration:
2025-06-09 23:59:25,763 - MoETrainer - INFO -   Bin 0: ridge_medium
2025-06-09 23:59:25,764 - MoETrainer - INFO -   Bin 1: rf_shallow
2025-06-09 23:59:25,765 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-09 23:59:25,766 - MoETrainer - INFO -   Bin 3: rf_shallow
2025-06-09 23:59:25,767 - MoETrainer - INFO -   Bin 4: xgb_conservative
2025-06-09 23:59:25,767 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-06-09 23:59:25,768 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-09 23:59:25,768 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-09 23:59:25,769 - MoETrainer - INFO - Final Performance: RÂ² = 0.9594
2025-06-09 23:59:25,770 - MoETrainer - INFO - Final RMSE: $20,808
2025-06-09 23:59:25,770 - MoETrainer - INFO - Final MAE: $15,765
2025-06-10 19:12:27,782 - MoETrainer - INFO - Loading data...
2025-06-10 19:12:27,783 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:12:27,784 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:12:27,790 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:12:27,792 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:12:27,796 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:12:27,796 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:12:27,807 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:12:27,807 - MoETrainer - INFO - Splitting data...
2025-06-10 19:12:27,813 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:12:27,813 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:12:27,814 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:12:27,815 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:12:27,816 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:12:27,816 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:12:27,817 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:12:27,817 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-10 19:12:29,002 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:12:29,003 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-10 19:12:29,003 - MoETrainer - INFO -   2. lgb_conservative: Score=0.716, MAE=$23708, RMSE=$30793, RÂ²=0.577
2025-06-10 19:12:29,004 - MoETrainer - INFO -   3. lgb_balanced: Score=0.717, MAE=$24528, RMSE=$30703, RÂ²=0.580
2025-06-10 19:12:29,004 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-10 19:12:29,501 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:12:29,501 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-10 19:12:29,502 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-10 19:12:29,502 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-10 19:12:29,503 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-10 19:12:29,993 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:12:29,993 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-10 19:12:29,994 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-10 19:12:29,994 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-10 19:12:29,995 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:12:29,998 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-10 19:12:30,286 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-10 19:12:30,289 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-10 19:12:30,289 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:12:30,310 - MoETrainer - INFO - Training perfect routing neural gate...
2025-06-10 19:12:30,311 - MoETrainer - INFO - Goal: Learn features â bin assignment (mimic hard routing)
2025-06-10 19:12:30,317 - MoETrainer - INFO - Routing target analysis:
2025-06-10 19:12:30,318 - MoETrainer - INFO -   Bin boundaries: ['$419,653', '$506,842']
2025-06-10 19:12:30,318 - MoETrainer - INFO -   Train bin distribution: [np.int64(433), np.int64(433), np.int64(434)]
2025-06-10 19:12:30,319 - MoETrainer - INFO -   Val bin distribution: [np.int64(97), np.int64(93), np.int64(110)]
2025-06-10 19:12:35,367 - MoETrainer - INFO - Epoch   0: Loss=1.0984, Bin Acc=0.310, RÂ²=0.2947, Temp=2.00
2025-06-10 19:12:35,368 - MoETrainer - INFO -          Predicted bin counts: [np.int64(0), np.int64(300), np.int64(0)]
2025-06-10 19:12:35,985 - MoETrainer - INFO - Epoch  25: Loss=0.9885, Bin Acc=0.687, RÂ²=0.7980, Temp=1.75
2025-06-10 19:12:36,497 - MoETrainer - INFO - Epoch  50: Loss=0.7418, Bin Acc=0.757, RÂ²=0.8685, Temp=1.50
2025-06-10 19:12:36,498 - MoETrainer - INFO -          Predicted bin counts: [np.int64(143), np.int64(37), np.int64(120)]
2025-06-10 19:12:37,035 - MoETrainer - INFO - Epoch  75: Loss=0.5891, Bin Acc=0.763, RÂ²=0.8708, Temp=1.25
2025-06-10 19:12:37,516 - MoETrainer - INFO - Epoch 100: Loss=0.5006, Bin Acc=0.800, RÂ²=0.8779, Temp=1.00
2025-06-10 19:12:37,516 - MoETrainer - INFO -          Predicted bin counts: [np.int64(121), np.int64(58), np.int64(121)]
2025-06-10 19:12:38,089 - MoETrainer - INFO - Epoch 125: Loss=0.4582, Bin Acc=0.827, RÂ²=0.8852, Temp=0.75
2025-06-10 19:12:38,573 - MoETrainer - INFO - Early stopping at epoch 149
2025-06-10 19:12:38,574 - MoETrainer - INFO - Loaded best model: Bin Acc=0.827, RÂ²=0.8852
2025-06-10 19:20:49,289 - MoETrainer - INFO - === FIXED NEURAL GATE COMPARISON STARTING ===
2025-06-10 19:20:49,289 - MoETrainer - INFO - Loading data with Hybrid DataManager...
2025-06-10 19:20:49,290 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:20:49,290 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:20:49,292 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:20:49,293 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:20:49,293 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:20:49,294 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:20:49,299 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:20:49,299 - MoETrainer - INFO - Splitting data...
2025-06-10 19:20:49,301 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:20:49,302 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:20:49,302 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:20:49,304 - MoETrainer - INFO - 
=== TESTING FEATURE-BASED BINNING ===
2025-06-10 19:20:49,305 - MoETrainer - INFO - Testing feature-based expert assignment...
2025-06-10 19:20:49,306 - MoETrainer - INFO - Created 1 feature-based binning rules
2025-06-10 19:20:49,307 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:20:49,307 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:20:49,308 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:20:49,308 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:20:49,308 - MoETrainer - INFO - Bin 0: Small bin (429), using rule-based selection
2025-06-10 19:20:50,099 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:20:50,100 - MoETrainer - INFO -   1. ridge_medium: Score=0.533, MAE=$24510, RMSE=$30814, RÂ²=0.783 [SELECTED]
2025-06-10 19:20:50,100 - MoETrainer - INFO -   2. rf_medium: Score=0.608, MAE=$28363, RMSE=$35084, RÂ²=0.718
2025-06-10 19:20:50,100 - MoETrainer - INFO -   3. rf_shallow: Score=0.615, MAE=$28814, RMSE=$35419, RÂ²=0.713
2025-06-10 19:20:50,101 - MoETrainer - INFO - Bin 1: Small bin (442), using rule-based selection
2025-06-10 19:20:50,644 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:20:50,645 - MoETrainer - INFO -   1. ridge_medium: Score=0.672, MAE=$29105, RMSE=$35449, RÂ²=0.628 [SELECTED]
2025-06-10 19:20:50,648 - MoETrainer - INFO -   2. rf_medium: Score=0.706, MAE=$30337, RMSE=$37309, RÂ²=0.588
2025-06-10 19:20:50,654 - MoETrainer - INFO -   3. xgb_conservative: Score=0.717, MAE=$30706, RMSE=$37860, RÂ²=0.576
2025-06-10 19:20:50,655 - MoETrainer - INFO - Bin 2: Small bin (429), using rule-based selection
2025-06-10 19:20:51,239 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:20:51,239 - MoETrainer - INFO -   1. ridge_medium: Score=0.520, MAE=$24890, RMSE=$32318, RÂ²=0.774 [SELECTED]
2025-06-10 19:20:51,239 - MoETrainer - INFO -   2. lgb_balanced: Score=0.545, MAE=$26666, RMSE=$33793, RÂ²=0.752
2025-06-10 19:20:51,240 - MoETrainer - INFO -   3. xgb_balanced: Score=0.587, MAE=$29222, RMSE=$36337, RÂ²=0.714
2025-06-10 19:20:51,240 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:20:51,242 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 429 samples
2025-06-10 19:20:51,244 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 442 samples
2025-06-10 19:20:51,246 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 429 samples
2025-06-10 19:20:51,248 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:20:51,259 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:20:51,259 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:20:51,260 - MoETrainer - INFO -   RMSE: $33,022
2025-06-10 19:20:51,260 - MoETrainer - INFO -   MAE: $26,595 (5.7% of mean)
2025-06-10 19:20:51,260 - MoETrainer - INFO -   RÂ²: 0.8977
2025-06-10 19:20:51,260 - MoETrainer - INFO -   MAPE: 6.2%
2025-06-10 19:20:51,261 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:20:51,261 - MoETrainer - INFO -   Median APE: 5.0%
2025-06-10 19:20:51,261 - MoETrainer - INFO -   Within 5%: 51.0% of predictions
2025-06-10 19:20:51,262 - MoETrainer - INFO -   Within 10%: 83.8% of predictions
2025-06-10 19:20:51,262 - MoETrainer - INFO -   Within 15%: 93.8% of predictions
2025-06-10 19:20:51,262 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:20:51,263 - MoETrainer - INFO -   Bin 0: RMSE=$33,244, RÂ²=0.7603, Samples=147
2025-06-10 19:20:51,263 - MoETrainer - INFO -   Bin 1: RMSE=$36,294, RÂ²=0.5007, Samples=119
2025-06-10 19:20:51,263 - MoETrainer - INFO -   Bin 2: RMSE=$29,544, RÂ²=0.8037, Samples=134
2025-06-10 19:20:51,264 - MoETrainer - INFO - 
=== TESTING FIXED NEURAL GATE ===
2025-06-10 19:20:51,265 - MoETrainer - INFO - Testing fixed neural gate...
2025-06-10 19:20:51,937 - MoETrainer - INFO - Using device: cpu
2025-06-10 19:20:51,938 - MoETrainer - INFO - Training FIXED neural gating network...
2025-06-10 19:20:54,764 - MoETrainer - INFO - Epoch   0: Train RMSE=    5465, Val RMSE=    7688
2025-06-10 19:20:54,765 - MoETrainer - INFO -          Avg expert weights: [0.250, 0.250, 0.250, 0.250]
2025-06-10 19:20:54,768 - MoETrainer - INFO - Epoch   1: Train RMSE=    5465, Val RMSE=    7688
2025-06-10 19:20:54,772 - MoETrainer - INFO - Epoch   2: Train RMSE=    5465, Val RMSE=    7688
2025-06-10 19:20:54,777 - MoETrainer - INFO - Epoch   3: Train RMSE=    5465, Val RMSE=    7688
2025-06-10 19:20:54,780 - MoETrainer - INFO - Epoch   4: Train RMSE=    5465, Val RMSE=    7689
2025-06-10 19:20:54,786 - MoETrainer - INFO - Epoch   5: Train RMSE=    5465, Val RMSE=    7689
2025-06-10 19:20:54,789 - MoETrainer - INFO - Epoch   6: Train RMSE=    5465, Val RMSE=    7689
2025-06-10 19:20:54,792 - MoETrainer - INFO - Epoch   7: Train RMSE=    5464, Val RMSE=    7689
2025-06-10 19:20:54,796 - MoETrainer - INFO - Epoch   8: Train RMSE=    5464, Val RMSE=    7689
2025-06-10 19:20:54,800 - MoETrainer - INFO - Epoch   9: Train RMSE=    5464, Val RMSE=    7689
2025-06-10 19:20:54,820 - MoETrainer - INFO - Early stopping at epoch 15
2025-06-10 19:20:54,820 - MoETrainer - INFO - Loaded best model with validation RMSE: 7688
2025-06-10 19:20:54,825 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:20:54,825 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:20:54,825 - MoETrainer - INFO -   RMSE: $32,952
2025-06-10 19:20:54,826 - MoETrainer - INFO -   MAE: $26,698 (5.7% of mean)
2025-06-10 19:20:54,826 - MoETrainer - INFO -   RÂ²: 0.8981
2025-06-10 19:20:54,826 - MoETrainer - INFO -   MAPE: 6.3%
2025-06-10 19:20:54,826 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:20:54,826 - MoETrainer - INFO -   Median APE: 4.8%
2025-06-10 19:20:54,827 - MoETrainer - INFO -   Within 5%: 51.0% of predictions
2025-06-10 19:20:54,827 - MoETrainer - INFO -   Within 10%: 82.2% of predictions
2025-06-10 19:20:54,827 - MoETrainer - INFO -   Within 15%: 95.0% of predictions
2025-06-10 19:20:54,827 - MoETrainer - INFO - Gate weight statistics:
2025-06-10 19:20:54,827 - MoETrainer - INFO -   lgb_conservative: 0.250 average weight
2025-06-10 19:20:54,828 - MoETrainer - INFO -   xgb_balanced: 0.250 average weight
2025-06-10 19:20:54,828 - MoETrainer - INFO -   rf_medium: 0.250 average weight
2025-06-10 19:20:54,828 - MoETrainer - INFO -   ridge_ensemble: 0.250 average weight
2025-06-10 19:20:54,829 - MoETrainer - INFO - 
=== TESTING SIMPLE BASELINE ===
2025-06-10 19:20:54,829 - MoETrainer - INFO - Testing simple baseline...
2025-06-10 19:20:55,590 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:20:55,613 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:20:55,653 - MoETrainer - INFO -   RMSE: $35,308
2025-06-10 19:20:55,691 - MoETrainer - INFO -   MAE: $27,999 (6.0% of mean)
2025-06-10 19:20:55,707 - MoETrainer - INFO -   RÂ²: 0.8830
2025-06-10 19:20:55,738 - MoETrainer - INFO -   MAPE: 6.6%
2025-06-10 19:20:55,749 - MoETrainer - INFO -   MPE: +0.6% (bias: overprediction)
2025-06-10 19:20:55,780 - MoETrainer - INFO -   Median APE: 5.2%
2025-06-10 19:20:55,780 - MoETrainer - INFO -   Within 5%: 48.2% of predictions
2025-06-10 19:20:55,780 - MoETrainer - INFO -   Within 10%: 80.0% of predictions
2025-06-10 19:20:55,781 - MoETrainer - INFO -   Within 15%: 93.5% of predictions
2025-06-10 19:21:48,828 - MoETrainer - INFO - Loading data...
2025-06-10 19:21:48,828 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:21:48,829 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:21:48,831 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:21:48,831 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:21:48,831 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:21:48,832 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:21:48,836 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:21:48,836 - MoETrainer - INFO - Splitting data...
2025-06-10 19:21:48,838 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:21:48,839 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:21:48,839 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:21:48,841 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:21:48,841 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:21:48,842 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:21:48,842 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:21:48,843 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-10 19:21:49,583 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:21:49,584 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-10 19:21:49,584 - MoETrainer - INFO -   2. lgb_conservative: Score=0.716, MAE=$23708, RMSE=$30793, RÂ²=0.577
2025-06-10 19:21:49,585 - MoETrainer - INFO -   3. lgb_balanced: Score=0.717, MAE=$24528, RMSE=$30703, RÂ²=0.580
2025-06-10 19:21:49,585 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-10 19:21:50,060 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:21:50,060 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-10 19:21:50,060 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-10 19:21:50,061 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-10 19:21:50,061 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-10 19:21:50,544 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:21:50,544 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-10 19:21:50,545 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-10 19:21:50,545 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-10 19:21:50,545 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:21:50,547 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-10 19:21:50,804 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-10 19:21:50,806 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-10 19:21:50,806 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:21:50,820 - MoETrainer - INFO - Training perfect routing neural gate...
2025-06-10 19:21:50,821 - MoETrainer - INFO - Goal: Learn features â bin assignment (mimic hard routing)
2025-06-10 19:21:50,822 - MoETrainer - INFO - Routing target analysis:
2025-06-10 19:21:50,823 - MoETrainer - INFO -   Bin boundaries: ['$419,653', '$506,842']
2025-06-10 19:21:50,824 - MoETrainer - INFO -   Train bin distribution: [np.int64(433), np.int64(433), np.int64(434)]
2025-06-10 19:21:50,824 - MoETrainer - INFO -   Val bin distribution: [np.int64(97), np.int64(93), np.int64(110)]
2025-06-10 19:21:53,457 - MoETrainer - INFO - Epoch   0: Loss=1.0980, Bin Acc=0.367, RÂ²=0.7316, Temp=2.00
2025-06-10 19:21:53,457 - MoETrainer - INFO -          Predicted bin counts: [np.int64(0), np.int64(0), np.int64(300)]
2025-06-10 19:21:53,917 - MoETrainer - INFO - Early stopping at epoch 25
2025-06-10 19:21:53,918 - MoETrainer - INFO - Loaded best model: Bin Acc=0.367, RÂ²=0.7316
2025-06-10 19:22:13,512 - MoETrainer - INFO - Loading data...
2025-06-10 19:22:13,513 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:22:13,513 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:22:13,514 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:22:13,515 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:22:13,516 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:22:13,516 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:22:13,520 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:22:13,520 - MoETrainer - INFO - Splitting data...
2025-06-10 19:22:13,523 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:22:13,523 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:22:13,524 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:22:13,525 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:22:13,526 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:22:13,527 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:22:13,528 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:22:13,529 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-10 19:22:14,294 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:22:14,295 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-10 19:22:14,295 - MoETrainer - INFO -   2. lgb_conservative: Score=0.716, MAE=$23708, RMSE=$30793, RÂ²=0.577
2025-06-10 19:22:14,295 - MoETrainer - INFO -   3. lgb_balanced: Score=0.717, MAE=$24528, RMSE=$30703, RÂ²=0.580
2025-06-10 19:22:14,296 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-10 19:22:14,784 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:22:14,785 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-10 19:22:14,785 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-10 19:22:14,785 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-10 19:22:14,786 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-10 19:22:15,286 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:22:15,287 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-10 19:22:15,287 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-10 19:22:15,287 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-10 19:22:15,288 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:22:15,289 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-10 19:22:15,567 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-10 19:22:15,569 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-10 19:22:15,569 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:22:15,581 - MoETrainer - INFO - Training perfect routing neural gate...
2025-06-10 19:22:15,582 - MoETrainer - INFO - Goal: Learn features â bin assignment (mimic hard routing)
2025-06-10 19:22:15,584 - MoETrainer - INFO - Routing target analysis:
2025-06-10 19:22:15,586 - MoETrainer - INFO -   Bin boundaries: ['$419,653', '$506,842']
2025-06-10 19:22:15,586 - MoETrainer - INFO -   Train bin distribution: [np.int64(433), np.int64(433), np.int64(434)]
2025-06-10 19:22:15,587 - MoETrainer - INFO -   Val bin distribution: [np.int64(97), np.int64(93), np.int64(110)]
2025-06-10 19:22:18,360 - MoETrainer - INFO - Epoch   0: Loss=1.0994, Bin Acc=0.310, RÂ²=0.2947, Temp=2.00
2025-06-10 19:22:18,360 - MoETrainer - INFO -          Predicted bin counts: [np.int64(0), np.int64(300), np.int64(0)]
2025-06-10 19:22:18,921 - MoETrainer - INFO - Epoch  25: Loss=0.9850, Bin Acc=0.553, RÂ²=0.5876, Temp=1.75
2025-06-10 19:22:19,431 - MoETrainer - INFO - Epoch  50: Loss=0.7383, Bin Acc=0.747, RÂ²=0.8648, Temp=1.50
2025-06-10 19:22:19,432 - MoETrainer - INFO -          Predicted bin counts: [np.int64(139), np.int64(25), np.int64(136)]
2025-06-10 19:22:19,615 - MoETrainer - INFO - Early stopping at epoch 59
2025-06-10 19:22:19,616 - MoETrainer - INFO - Loaded best model: Bin Acc=0.833, RÂ²=0.8847
2025-06-10 19:22:33,529 - MoETrainer - INFO - Loading data...
2025-06-10 19:22:33,529 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:22:33,530 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:22:33,532 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:22:33,533 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:22:33,533 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:22:33,533 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:22:33,537 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:22:33,538 - MoETrainer - INFO - Splitting data...
2025-06-10 19:22:33,540 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:22:33,541 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:22:33,541 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:22:33,543 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:22:33,543 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:22:33,543 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:22:33,544 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:22:33,544 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-10 19:22:34,315 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:22:34,315 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-10 19:22:34,316 - MoETrainer - INFO -   2. lgb_conservative: Score=0.716, MAE=$23708, RMSE=$30793, RÂ²=0.577
2025-06-10 19:22:34,316 - MoETrainer - INFO -   3. lgb_balanced: Score=0.717, MAE=$24528, RMSE=$30703, RÂ²=0.580
2025-06-10 19:22:34,317 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-10 19:22:34,816 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:22:34,816 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-10 19:22:34,817 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-10 19:22:34,817 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-10 19:22:34,817 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-10 19:22:35,319 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:22:35,319 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-10 19:22:35,320 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-10 19:22:35,320 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-10 19:22:35,320 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:22:35,322 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-10 19:22:35,592 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-10 19:22:35,594 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-10 19:22:35,594 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:22:35,606 - MoETrainer - INFO - Training perfect routing neural gate...
2025-06-10 19:22:35,607 - MoETrainer - INFO - Goal: Learn features â bin assignment (mimic hard routing)
2025-06-10 19:22:35,609 - MoETrainer - INFO - Routing target analysis:
2025-06-10 19:22:35,610 - MoETrainer - INFO -   Bin boundaries: ['$419,653', '$506,842']
2025-06-10 19:22:35,610 - MoETrainer - INFO -   Train bin distribution: [np.int64(433), np.int64(433), np.int64(434)]
2025-06-10 19:22:35,611 - MoETrainer - INFO -   Val bin distribution: [np.int64(97), np.int64(93), np.int64(110)]
2025-06-10 19:22:38,364 - MoETrainer - INFO - Epoch   0: Loss=1.0982, Bin Acc=0.367, RÂ²=0.7316, Temp=2.00
2025-06-10 19:22:38,364 - MoETrainer - INFO -          Predicted bin counts: [np.int64(0), np.int64(0), np.int64(300)]
2025-06-10 19:22:38,759 - MoETrainer - INFO - Early stopping at epoch 25
2025-06-10 19:22:38,760 - MoETrainer - INFO - Loaded best model: Bin Acc=0.367, RÂ²=0.7316
2025-06-10 19:22:48,625 - MoETrainer - INFO - Loading data...
2025-06-10 19:22:48,625 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:22:48,626 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:22:48,627 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:22:48,628 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:22:48,629 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:22:48,629 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:22:48,633 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:22:48,633 - MoETrainer - INFO - Splitting data...
2025-06-10 19:22:48,635 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:22:48,636 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:22:48,637 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:22:48,638 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:22:48,639 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:22:48,639 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:22:48,640 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:22:48,641 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-10 19:22:49,415 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:22:49,415 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-10 19:22:49,416 - MoETrainer - INFO -   2. lgb_conservative: Score=0.716, MAE=$23708, RMSE=$30793, RÂ²=0.577
2025-06-10 19:22:49,416 - MoETrainer - INFO -   3. lgb_balanced: Score=0.717, MAE=$24528, RMSE=$30703, RÂ²=0.580
2025-06-10 19:22:49,417 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-10 19:22:49,911 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:22:49,912 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-10 19:22:49,912 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-10 19:22:49,913 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-10 19:22:49,913 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-10 19:22:50,399 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:22:50,399 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-10 19:22:50,400 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-10 19:22:50,400 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-10 19:22:50,401 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:22:50,403 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-10 19:22:50,666 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-10 19:22:50,668 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-10 19:22:50,668 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:22:50,684 - MoETrainer - INFO - Training perfect routing neural gate...
2025-06-10 19:22:50,685 - MoETrainer - INFO - Goal: Learn features â bin assignment (mimic hard routing)
2025-06-10 19:22:50,686 - MoETrainer - INFO - Routing target analysis:
2025-06-10 19:22:50,686 - MoETrainer - INFO -   Bin boundaries: ['$419,653', '$506,842']
2025-06-10 19:22:50,687 - MoETrainer - INFO -   Train bin distribution: [np.int64(433), np.int64(433), np.int64(434)]
2025-06-10 19:22:50,687 - MoETrainer - INFO -   Val bin distribution: [np.int64(97), np.int64(93), np.int64(110)]
2025-06-10 19:22:53,471 - MoETrainer - INFO - Epoch   0: Loss=1.0990, Bin Acc=0.367, RÂ²=0.7316, Temp=2.00
2025-06-10 19:22:53,472 - MoETrainer - INFO -          Predicted bin counts: [np.int64(0), np.int64(0), np.int64(300)]
2025-06-10 19:22:53,962 - MoETrainer - INFO - Epoch  25: Loss=0.9859, Bin Acc=0.637, RÂ²=0.7686, Temp=1.75
2025-06-10 19:22:54,518 - MoETrainer - INFO - Epoch  50: Loss=0.7354, Bin Acc=0.753, RÂ²=0.8690, Temp=1.50
2025-06-10 19:22:54,519 - MoETrainer - INFO -          Predicted bin counts: [np.int64(144), np.int64(32), np.int64(124)]
2025-06-10 19:22:55,013 - MoETrainer - INFO - Epoch  75: Loss=0.5798, Bin Acc=0.757, RÂ²=0.8652, Temp=1.25
2025-06-10 19:22:55,036 - MoETrainer - INFO - Early stopping at epoch 76
2025-06-10 19:22:55,037 - MoETrainer - INFO - Loaded best model: Bin Acc=0.757, RÂ²=0.8697
2025-06-10 19:25:01,615 - MoETrainer - INFO - Loading data...
2025-06-10 19:25:01,616 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:25:01,616 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:25:01,618 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:25:01,618 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:25:01,619 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:25:01,619 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:25:01,623 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:25:01,624 - MoETrainer - INFO - Splitting data...
2025-06-10 19:25:01,626 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:25:01,626 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:25:01,627 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:25:01,628 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:25:01,629 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:25:01,629 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:25:01,630 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:25:01,630 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-10 19:25:02,345 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:25:02,345 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-10 19:25:02,345 - MoETrainer - INFO -   2. lgb_conservative: Score=0.716, MAE=$23708, RMSE=$30793, RÂ²=0.577
2025-06-10 19:25:02,346 - MoETrainer - INFO -   3. lgb_balanced: Score=0.717, MAE=$24528, RMSE=$30703, RÂ²=0.580
2025-06-10 19:25:02,346 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-10 19:25:02,780 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:25:02,780 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-10 19:25:02,781 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-10 19:25:02,781 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-10 19:25:02,782 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-10 19:25:03,215 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:25:03,216 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-10 19:25:03,216 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-10 19:25:03,216 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-10 19:25:03,217 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:25:03,218 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-10 19:25:03,465 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-10 19:25:03,467 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-10 19:25:03,467 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:25:03,480 - MoETrainer - INFO - Training perfect routing neural gate...
2025-06-10 19:25:03,481 - MoETrainer - INFO - Goal: Learn features â bin assignment (mimic hard routing)
2025-06-10 19:25:03,483 - MoETrainer - INFO - Routing target analysis:
2025-06-10 19:25:03,483 - MoETrainer - INFO -   Bin boundaries: ['$419,653', '$506,842']
2025-06-10 19:25:03,484 - MoETrainer - INFO -   Train bin distribution: [np.int64(433), np.int64(433), np.int64(434)]
2025-06-10 19:25:03,484 - MoETrainer - INFO -   Val bin distribution: [np.int64(97), np.int64(93), np.int64(110)]
2025-06-10 19:25:06,203 - MoETrainer - INFO - Epoch   0: Loss=1.0985, Bin Acc=0.323, RÂ²=0.6194, Temp=2.00
2025-06-10 19:25:06,204 - MoETrainer - INFO -          Predicted bin counts: [np.int64(300), np.int64(0), np.int64(0)]
2025-06-10 19:25:06,523 - MoETrainer - INFO - Epoch  25: Loss=1.0048, Bin Acc=0.413, RÂ²=0.5038, Temp=1.75
2025-06-10 19:25:06,568 - MoETrainer - INFO - Early stopping at epoch 27
2025-06-10 19:25:06,569 - MoETrainer - INFO - Loaded best model: Bin Acc=0.530, RÂ²=0.8120
2025-06-10 19:27:21,357 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-10 19:27:21,358 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-10 19:27:21,358 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:27:21,359 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:27:21,360 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:27:21,361 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:27:21,361 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:27:21,362 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:27:21,365 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:27:21,366 - MoETrainer - INFO - Splitting data...
2025-06-10 19:27:21,369 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:27:21,370 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:27:21,370 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:27:21,371 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-10 19:27:21,373 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:27:21,374 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:27:21,375 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:27:21,375 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:27:21,376 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-10 19:27:22,076 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:27:22,076 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-10 19:27:22,077 - MoETrainer - INFO -   2. lgb_conservative: Score=0.716, MAE=$23708, RMSE=$30793, RÂ²=0.577
2025-06-10 19:27:22,077 - MoETrainer - INFO -   3. lgb_balanced: Score=0.717, MAE=$24528, RMSE=$30703, RÂ²=0.580
2025-06-10 19:27:22,078 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-10 19:27:22,509 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:27:22,510 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-10 19:27:22,510 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-10 19:27:22,511 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-10 19:27:22,511 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-10 19:27:22,950 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:27:22,950 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-10 19:27:22,950 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-10 19:27:22,951 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-10 19:27:22,951 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:27:22,953 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-10 19:27:23,227 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-10 19:27:23,230 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-10 19:27:23,230 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:27:23,251 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:27:23,251 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:27:23,251 - MoETrainer - INFO -   RMSE: $27,918
2025-06-10 19:27:23,252 - MoETrainer - INFO -   MAE: $22,153 (4.7% of mean)
2025-06-10 19:27:23,252 - MoETrainer - INFO -   RÂ²: 0.9268
2025-06-10 19:27:23,252 - MoETrainer - INFO -   MAPE: 5.3%
2025-06-10 19:27:23,253 - MoETrainer - INFO -   MPE: +0.5% (bias: overprediction)
2025-06-10 19:27:23,253 - MoETrainer - INFO -   Median APE: 3.9%
2025-06-10 19:27:23,254 - MoETrainer - INFO -   Within 5%: 59.8% of predictions
2025-06-10 19:27:23,254 - MoETrainer - INFO -   Within 10%: 89.8% of predictions
2025-06-10 19:27:23,254 - MoETrainer - INFO -   Within 15%: 96.2% of predictions
2025-06-10 19:27:23,255 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:27:23,255 - MoETrainer - INFO -   Bin 0: RMSE=$32,300, RÂ²=0.6490, Samples=132
2025-06-10 19:27:23,256 - MoETrainer - INFO -   Bin 1: RMSE=$22,868, RÂ²=0.1699, Samples=130
2025-06-10 19:27:23,258 - MoETrainer - INFO -   Bin 2: RMSE=$27,724, RÂ²=0.7245, Samples=138
2025-06-10 19:27:23,258 - MoETrainer - INFO -   3 bins: RÂ²=0.9268, RMSE=$27,918
2025-06-10 19:27:23,259 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:27:23,260 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:27:23,260 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:27:23,261 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:27:23,261 - MoETrainer - INFO - Bin 0: Small bin (325), using rule-based selection
2025-06-10 19:27:23,399 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:27:23,399 - MoETrainer - INFO -   1. ridge_medium: Score=0.722, MAE=$22686, RMSE=$29813, RÂ²=0.573 [SELECTED]
2025-06-10 19:27:23,400 - MoETrainer - INFO -   2. xgb_conservative: Score=0.821, MAE=$26010, RMSE=$33876, RÂ²=0.449
2025-06-10 19:27:23,400 - MoETrainer - INFO -   3. rf_shallow: Score=0.823, MAE=$26253, RMSE=$33930, RÂ²=0.447
2025-06-10 19:27:23,401 - MoETrainer - INFO - Bin 1: Small bin (325), using rule-based selection
2025-06-10 19:27:23,536 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:27:23,536 - MoETrainer - INFO -   1. ridge_medium: Score=0.875, MAE=$14693, RMSE=$16957, RÂ²=0.293 [SELECTED]
2025-06-10 19:27:23,537 - MoETrainer - INFO -   2. rf_shallow: Score=0.886, MAE=$14793, RMSE=$17177, RÂ²=0.274
2025-06-10 19:27:23,537 - MoETrainer - INFO -   3. lgb_conservative: Score=0.898, MAE=$14726, RMSE=$17410, RÂ²=0.254
2025-06-10 19:27:23,538 - MoETrainer - INFO - Bin 2: Small bin (325), using rule-based selection
2025-06-10 19:27:23,689 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:27:23,690 - MoETrainer - INFO -   1. ridge_medium: Score=0.914, MAE=$15819, RMSE=$18279, RÂ²=0.222 [SELECTED]
2025-06-10 19:27:23,691 - MoETrainer - INFO -   2. rf_shallow: Score=0.945, MAE=$15926, RMSE=$18921, RÂ²=0.167
2025-06-10 19:27:23,691 - MoETrainer - INFO -   3. xgb_conservative: Score=0.952, MAE=$15850, RMSE=$19066, RÂ²=0.154
2025-06-10 19:27:23,692 - MoETrainer - INFO - Bin 3: Small bin (325), using rule-based selection
2025-06-10 19:27:23,834 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-10 19:27:23,835 - MoETrainer - INFO -   1. ridge_medium: Score=0.615, MAE=$22836, RMSE=$29251, RÂ²=0.667 [SELECTED]
2025-06-10 19:27:23,835 - MoETrainer - INFO -   2. xgb_conservative: Score=0.697, MAE=$27000, RMSE=$33043, RÂ²=0.575
2025-06-10 19:27:23,835 - MoETrainer - INFO -   3. rf_shallow: Score=0.704, MAE=$25873, RMSE=$33524, RÂ²=0.563
2025-06-10 19:27:23,836 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:27:23,837 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 325 samples
2025-06-10 19:27:23,839 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 325 samples
2025-06-10 19:27:23,840 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 325 samples
2025-06-10 19:27:23,843 - MoETrainer - INFO - Successfully trained ridge_medium for bin 3: 325 samples
2025-06-10 19:27:23,844 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-10 19:27:23,854 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:27:23,854 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:27:23,855 - MoETrainer - INFO -   RMSE: $24,112
2025-06-10 19:27:23,855 - MoETrainer - INFO -   MAE: $18,450 (3.9% of mean)
2025-06-10 19:27:23,855 - MoETrainer - INFO -   RÂ²: 0.9454
2025-06-10 19:27:23,856 - MoETrainer - INFO -   MAPE: 4.5%
2025-06-10 19:27:23,856 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:27:23,857 - MoETrainer - INFO -   Median APE: 3.3%
2025-06-10 19:27:23,858 - MoETrainer - INFO -   Within 5%: 72.0% of predictions
2025-06-10 19:27:23,858 - MoETrainer - INFO -   Within 10%: 92.5% of predictions
2025-06-10 19:27:23,859 - MoETrainer - INFO -   Within 15%: 96.2% of predictions
2025-06-10 19:27:23,860 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:27:23,860 - MoETrainer - INFO -   Bin 0: RMSE=$33,148, RÂ²=0.5590, Samples=95
2025-06-10 19:27:23,861 - MoETrainer - INFO -   Bin 1: RMSE=$17,375, RÂ²=0.2550, Samples=97
2025-06-10 19:27:23,861 - MoETrainer - INFO -   Bin 2: RMSE=$16,333, RÂ²=0.2695, Samples=104
2025-06-10 19:27:23,861 - MoETrainer - INFO -   Bin 3: RMSE=$26,154, RÂ²=0.6891, Samples=104
2025-06-10 19:27:23,862 - MoETrainer - INFO -   4 bins: RÂ²=0.9454, RMSE=$24,112
2025-06-10 19:27:23,863 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:27:23,863 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:27:23,863 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:27:23,864 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:27:23,864 - MoETrainer - INFO - Bin 0: Small bin (260), using rule-based selection
2025-06-10 19:27:23,994 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:27:23,994 - MoETrainer - INFO -   1. xgb_conservative: Score=0.738, MAE=$19489, RMSE=$24559, RÂ²=0.539 [SELECTED]
2025-06-10 19:27:23,995 - MoETrainer - INFO -   2. ridge_medium: Score=0.741, MAE=$19033, RMSE=$24690, RÂ²=0.534
2025-06-10 19:27:23,995 - MoETrainer - INFO -   3. rf_shallow: Score=0.758, MAE=$19557, RMSE=$25270, RÂ²=0.512
2025-06-10 19:27:23,995 - MoETrainer - INFO - Bin 1: Small bin (260), using rule-based selection
2025-06-10 19:27:24,138 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:27:24,138 - MoETrainer - INFO -   1. ridge_medium: Score=0.952, MAE=$13640, RMSE=$15963, RÂ²=0.156 [SELECTED]
2025-06-10 19:27:24,138 - MoETrainer - INFO -   2. lgb_conservative: Score=0.985, MAE=$13536, RMSE=$16537, RÂ²=0.095
2025-06-10 19:27:24,139 - MoETrainer - INFO -   3. rf_shallow: Score=0.989, MAE=$13518, RMSE=$16612, RÂ²=0.086
2025-06-10 19:27:24,140 - MoETrainer - INFO - Bin 2: Small bin (260), using rule-based selection
2025-06-10 19:27:24,311 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:27:24,311 - MoETrainer - INFO -   1. ridge_medium: Score=0.959, MAE=$11353, RMSE=$13509, RÂ²=0.127 [SELECTED]
2025-06-10 19:27:24,312 - MoETrainer - INFO -   2. lgb_conservative: Score=0.995, MAE=$11905, RMSE=$14024, RÂ²=0.060
2025-06-10 19:27:24,313 - MoETrainer - INFO -   3. xgb_conservative: Score=0.999, MAE=$11751, RMSE=$14085, RÂ²=0.051
2025-06-10 19:27:24,313 - MoETrainer - INFO - Bin 3: Small bin (260), using rule-based selection
2025-06-10 19:27:24,567 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-10 19:27:24,567 - MoETrainer - INFO -   1. rf_shallow: Score=0.859, MAE=$13079, RMSE=$15177, RÂ²=0.304 [SELECTED]
2025-06-10 19:27:24,567 - MoETrainer - INFO -   2. lgb_conservative: Score=0.870, MAE=$13192, RMSE=$15363, RÂ²=0.287
2025-06-10 19:27:24,568 - MoETrainer - INFO -   3. xgb_conservative: Score=0.879, MAE=$13011, RMSE=$15543, RÂ²=0.270
2025-06-10 19:27:24,568 - MoETrainer - INFO - Bin 4: Small bin (260), using rule-based selection
2025-06-10 19:27:24,703 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-10 19:27:24,703 - MoETrainer - INFO -   1. ridge_medium: Score=0.640, MAE=$23184, RMSE=$28966, RÂ²=0.638 [SELECTED]
2025-06-10 19:27:24,704 - MoETrainer - INFO -   2. xgb_conservative: Score=0.716, MAE=$27054, RMSE=$32309, RÂ²=0.549
2025-06-10 19:27:24,704 - MoETrainer - INFO -   3. rf_shallow: Score=0.736, MAE=$27307, RMSE=$33250, RÂ²=0.523
2025-06-10 19:27:24,704 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:27:24,728 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 260 samples
2025-06-10 19:27:24,732 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 260 samples
2025-06-10 19:27:24,734 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 260 samples
2025-06-10 19:27:24,824 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 260 samples
2025-06-10 19:27:24,826 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 260 samples
2025-06-10 19:27:24,826 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-10 19:27:24,845 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:27:24,845 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:27:24,846 - MoETrainer - INFO -   RMSE: $21,997
2025-06-10 19:27:24,846 - MoETrainer - INFO -   MAE: $16,611 (3.6% of mean)
2025-06-10 19:27:24,846 - MoETrainer - INFO -   RÂ²: 0.9546
2025-06-10 19:27:24,846 - MoETrainer - INFO -   MAPE: 4.1%
2025-06-10 19:27:24,847 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:27:24,847 - MoETrainer - INFO -   Median APE: 2.8%
2025-06-10 19:27:24,847 - MoETrainer - INFO -   Within 5%: 77.0% of predictions
2025-06-10 19:27:24,848 - MoETrainer - INFO -   Within 10%: 95.0% of predictions
2025-06-10 19:27:24,848 - MoETrainer - INFO -   Within 15%: 97.0% of predictions
2025-06-10 19:27:24,849 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:27:24,849 - MoETrainer - INFO -   Bin 0: RMSE=$33,812, RÂ²=0.4603, Samples=75
2025-06-10 19:27:24,850 - MoETrainer - INFO -   Bin 1: RMSE=$15,070, RÂ²=0.1720, Samples=82
2025-06-10 19:27:24,850 - MoETrainer - INFO -   Bin 2: RMSE=$14,555, RÂ²=0.0691, Samples=77
2025-06-10 19:27:24,850 - MoETrainer - INFO -   Bin 3: RMSE=$15,881, RÂ²=0.2028, Samples=79
2025-06-10 19:27:24,851 - MoETrainer - INFO -   Bin 4: RMSE=$24,668, RÂ²=0.6859, Samples=87
2025-06-10 19:27:24,851 - MoETrainer - INFO -   5 bins: RÂ²=0.9546, RMSE=$21,997
2025-06-10 19:27:24,852 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:27:24,853 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:27:24,853 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:27:24,853 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:27:24,854 - MoETrainer - INFO - Bin 0: Small bin (217), using rule-based selection
2025-06-10 19:27:24,996 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:27:24,996 - MoETrainer - INFO -   1. ridge_medium: Score=0.810, MAE=$23026, RMSE=$30602, RÂ²=0.457 [SELECTED]
2025-06-10 19:27:24,996 - MoETrainer - INFO -   2. lgb_conservative: Score=0.818, MAE=$23260, RMSE=$30936, RÂ²=0.445
2025-06-10 19:27:24,997 - MoETrainer - INFO -   3. rf_shallow: Score=0.819, MAE=$23340, RMSE=$30952, RÂ²=0.445
2025-06-10 19:27:24,997 - MoETrainer - INFO - Bin 1: Small bin (216), using rule-based selection
2025-06-10 19:27:25,116 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:27:25,117 - MoETrainer - INFO -   1. rf_shallow: Score=0.938, MAE=$12983, RMSE=$15086, RÂ²=0.182 [SELECTED]
2025-06-10 19:27:25,117 - MoETrainer - INFO -   2. xgb_conservative: Score=0.944, MAE=$13119, RMSE=$15187, RÂ²=0.171
2025-06-10 19:27:25,118 - MoETrainer - INFO -   3. lgb_conservative: Score=0.967, MAE=$13676, RMSE=$15553, RÂ²=0.131
2025-06-10 19:27:25,118 - MoETrainer - INFO - Bin 2: Small bin (217), using rule-based selection
2025-06-10 19:27:25,238 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:27:25,239 - MoETrainer - INFO -   1. ridge_medium: Score=1.019, MAE=$11724, RMSE=$13256, RÂ²=0.014 [SELECTED]
2025-06-10 19:27:25,240 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$11751, RMSE=$13300, RÂ²=0.008
2025-06-10 19:27:25,240 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$11783, RMSE=$13435, RÂ²=-0.013
2025-06-10 19:27:25,240 - MoETrainer - INFO - Bin 3: Small bin (216), using rule-based selection
2025-06-10 19:27:25,372 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-10 19:27:25,372 - MoETrainer - INFO -   1. lgb_conservative: Score=0.941, MAE=$10900, RMSE=$12570, RÂ²=0.156 [SELECTED]
2025-06-10 19:27:25,373 - MoETrainer - INFO -   2. rf_shallow: Score=0.956, MAE=$11194, RMSE=$12770, RÂ²=0.129
2025-06-10 19:27:25,373 - MoETrainer - INFO -   3. xgb_conservative: Score=0.960, MAE=$11133, RMSE=$12828, RÂ²=0.121
2025-06-10 19:27:25,373 - MoETrainer - INFO - Bin 4: Small bin (217), using rule-based selection
2025-06-10 19:27:25,484 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-10 19:27:25,485 - MoETrainer - INFO -   1. xgb_conservative: Score=0.896, MAE=$12613, RMSE=$15047, RÂ²=0.239 [SELECTED]
2025-06-10 19:27:25,485 - MoETrainer - INFO -   2. ridge_medium: Score=0.918, MAE=$13043, RMSE=$15410, RÂ²=0.202
2025-06-10 19:27:25,485 - MoETrainer - INFO -   3. rf_shallow: Score=0.936, MAE=$12718, RMSE=$15737, RÂ²=0.167
2025-06-10 19:27:25,486 - MoETrainer - INFO - Bin 5: Small bin (217), using rule-based selection
2025-06-10 19:27:25,595 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-10 19:27:25,595 - MoETrainer - INFO -   1. ridge_medium: Score=0.695, MAE=$25362, RMSE=$31017, RÂ²=0.572 [SELECTED]
2025-06-10 19:27:25,595 - MoETrainer - INFO -   2. rf_shallow: Score=0.696, MAE=$25262, RMSE=$31034, RÂ²=0.571
2025-06-10 19:27:25,596 - MoETrainer - INFO -   3. lgb_conservative: Score=0.718, MAE=$25063, RMSE=$32107, RÂ²=0.541
2025-06-10 19:27:25,596 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:27:25,598 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 217 samples
2025-06-10 19:27:25,681 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 216 samples
2025-06-10 19:27:25,683 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 217 samples
2025-06-10 19:27:25,692 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 3: 216 samples
2025-06-10 19:27:25,713 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 217 samples
2025-06-10 19:27:25,715 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 217 samples
2025-06-10 19:27:25,715 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-10 19:27:25,736 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:27:25,736 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:27:25,736 - MoETrainer - INFO -   RMSE: $20,818
2025-06-10 19:27:25,737 - MoETrainer - INFO -   MAE: $15,792 (3.4% of mean)
2025-06-10 19:27:25,737 - MoETrainer - INFO -   RÂ²: 0.9593
2025-06-10 19:27:25,737 - MoETrainer - INFO -   MAPE: 3.9%
2025-06-10 19:27:25,738 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:27:25,738 - MoETrainer - INFO -   Median APE: 2.7%
2025-06-10 19:27:25,738 - MoETrainer - INFO -   Within 5%: 78.5% of predictions
2025-06-10 19:27:25,738 - MoETrainer - INFO -   Within 10%: 94.8% of predictions
2025-06-10 19:27:25,738 - MoETrainer - INFO -   Within 15%: 97.5% of predictions
2025-06-10 19:27:25,739 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:27:25,739 - MoETrainer - INFO -   Bin 0: RMSE=$33,641, RÂ²=0.3913, Samples=61
2025-06-10 19:27:25,739 - MoETrainer - INFO -   Bin 1: RMSE=$16,714, RÂ²=0.0131, Samples=71
2025-06-10 19:27:25,739 - MoETrainer - INFO -   Bin 2: RMSE=$13,295, RÂ²=-0.0186, Samples=60
2025-06-10 19:27:25,739 - MoETrainer - INFO -   Bin 3: RMSE=$12,095, RÂ²=-0.0541, Samples=70
2025-06-10 19:27:25,740 - MoETrainer - INFO -   Bin 4: RMSE=$17,058, RÂ²=0.1041, Samples=68
2025-06-10 19:27:25,740 - MoETrainer - INFO -   Bin 5: RMSE=$25,029, RÂ²=0.6323, Samples=70
2025-06-10 19:27:25,740 - MoETrainer - INFO -   6 bins: RÂ²=0.9593, RMSE=$20,818
2025-06-10 19:27:25,740 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-10 19:27:25,741 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-10 19:27:25,741 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:27:25,743 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:27:25,743 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:27:25,744 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:27:25,744 - MoETrainer - INFO - Bin 0: Small bin (217), using rule-based selection
2025-06-10 19:27:25,871 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:27:25,871 - MoETrainer - INFO -   1. ridge_medium: Score=0.810, MAE=$23026, RMSE=$30602, RÂ²=0.457 [SELECTED]
2025-06-10 19:27:25,872 - MoETrainer - INFO -   2. lgb_conservative: Score=0.818, MAE=$23260, RMSE=$30936, RÂ²=0.445
2025-06-10 19:27:25,872 - MoETrainer - INFO -   3. rf_shallow: Score=0.819, MAE=$23340, RMSE=$30952, RÂ²=0.445
2025-06-10 19:27:25,873 - MoETrainer - INFO - Bin 1: Small bin (216), using rule-based selection
2025-06-10 19:27:25,986 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:27:25,986 - MoETrainer - INFO -   1. rf_shallow: Score=0.938, MAE=$12983, RMSE=$15086, RÂ²=0.182 [SELECTED]
2025-06-10 19:27:25,987 - MoETrainer - INFO -   2. xgb_conservative: Score=0.944, MAE=$13119, RMSE=$15187, RÂ²=0.171
2025-06-10 19:27:25,987 - MoETrainer - INFO -   3. lgb_conservative: Score=0.967, MAE=$13676, RMSE=$15553, RÂ²=0.131
2025-06-10 19:27:25,988 - MoETrainer - INFO - Bin 2: Small bin (217), using rule-based selection
2025-06-10 19:27:26,106 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:27:26,106 - MoETrainer - INFO -   1. ridge_medium: Score=1.019, MAE=$11724, RMSE=$13256, RÂ²=0.014 [SELECTED]
2025-06-10 19:27:26,107 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$11751, RMSE=$13300, RÂ²=0.008
2025-06-10 19:27:26,107 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$11783, RMSE=$13435, RÂ²=-0.013
2025-06-10 19:27:26,108 - MoETrainer - INFO - Bin 3: Small bin (216), using rule-based selection
2025-06-10 19:27:26,240 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-10 19:27:26,240 - MoETrainer - INFO -   1. lgb_conservative: Score=0.941, MAE=$10900, RMSE=$12570, RÂ²=0.156 [SELECTED]
2025-06-10 19:27:26,241 - MoETrainer - INFO -   2. rf_shallow: Score=0.956, MAE=$11194, RMSE=$12770, RÂ²=0.129
2025-06-10 19:27:26,241 - MoETrainer - INFO -   3. xgb_conservative: Score=0.960, MAE=$11133, RMSE=$12828, RÂ²=0.121
2025-06-10 19:27:26,242 - MoETrainer - INFO - Bin 4: Small bin (217), using rule-based selection
2025-06-10 19:27:26,351 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-10 19:27:26,352 - MoETrainer - INFO -   1. xgb_conservative: Score=0.896, MAE=$12613, RMSE=$15047, RÂ²=0.239 [SELECTED]
2025-06-10 19:27:26,352 - MoETrainer - INFO -   2. ridge_medium: Score=0.918, MAE=$13043, RMSE=$15410, RÂ²=0.202
2025-06-10 19:27:26,353 - MoETrainer - INFO -   3. rf_shallow: Score=0.936, MAE=$12718, RMSE=$15737, RÂ²=0.167
2025-06-10 19:27:26,353 - MoETrainer - INFO - Bin 5: Small bin (217), using rule-based selection
2025-06-10 19:27:26,471 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-10 19:27:26,472 - MoETrainer - INFO -   1. ridge_medium: Score=0.695, MAE=$25362, RMSE=$31017, RÂ²=0.572 [SELECTED]
2025-06-10 19:27:26,472 - MoETrainer - INFO -   2. rf_shallow: Score=0.696, MAE=$25262, RMSE=$31034, RÂ²=0.571
2025-06-10 19:27:26,473 - MoETrainer - INFO -   3. lgb_conservative: Score=0.718, MAE=$25063, RMSE=$32107, RÂ²=0.541
2025-06-10 19:27:26,473 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:27:26,476 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 217 samples
2025-06-10 19:27:26,561 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 216 samples
2025-06-10 19:27:26,563 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 217 samples
2025-06-10 19:27:26,580 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 3: 216 samples
2025-06-10 19:27:26,601 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 217 samples
2025-06-10 19:27:26,602 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 217 samples
2025-06-10 19:27:26,603 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-10 19:27:26,623 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:27:26,623 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:27:26,624 - MoETrainer - INFO -   RMSE: $20,818
2025-06-10 19:27:26,624 - MoETrainer - INFO -   MAE: $15,792 (3.4% of mean)
2025-06-10 19:27:26,624 - MoETrainer - INFO -   RÂ²: 0.9593
2025-06-10 19:27:26,624 - MoETrainer - INFO -   MAPE: 3.9%
2025-06-10 19:27:26,624 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:27:26,625 - MoETrainer - INFO -   Median APE: 2.7%
2025-06-10 19:27:26,625 - MoETrainer - INFO -   Within 5%: 78.5% of predictions
2025-06-10 19:27:26,625 - MoETrainer - INFO -   Within 10%: 94.8% of predictions
2025-06-10 19:27:26,625 - MoETrainer - INFO -   Within 15%: 97.5% of predictions
2025-06-10 19:27:26,625 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:27:26,626 - MoETrainer - INFO -   Bin 0: RMSE=$33,641, RÂ²=0.3913, Samples=61
2025-06-10 19:27:26,627 - MoETrainer - INFO -   Bin 1: RMSE=$16,714, RÂ²=0.0131, Samples=71
2025-06-10 19:27:26,627 - MoETrainer - INFO -   Bin 2: RMSE=$13,295, RÂ²=-0.0186, Samples=60
2025-06-10 19:27:26,627 - MoETrainer - INFO -   Bin 3: RMSE=$12,095, RÂ²=-0.0541, Samples=70
2025-06-10 19:27:26,628 - MoETrainer - INFO -   Bin 4: RMSE=$17,058, RÂ²=0.1041, Samples=68
2025-06-10 19:27:26,628 - MoETrainer - INFO -   Bin 5: RMSE=$25,029, RÂ²=0.6323, Samples=70
2025-06-10 19:27:26,628 - MoETrainer - INFO - Final Expert Configuration:
2025-06-10 19:27:26,629 - MoETrainer - INFO -   Bin 0: ridge_medium
2025-06-10 19:27:26,629 - MoETrainer - INFO -   Bin 1: rf_shallow
2025-06-10 19:27:26,629 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-10 19:27:26,629 - MoETrainer - INFO -   Bin 3: lgb_conservative
2025-06-10 19:27:26,630 - MoETrainer - INFO -   Bin 4: xgb_conservative
2025-06-10 19:27:26,630 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-06-10 19:27:26,630 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-10 19:27:26,631 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-10 19:27:26,632 - MoETrainer - INFO - Final Performance: RÂ² = 0.9593
2025-06-10 19:27:26,632 - MoETrainer - INFO - Final RMSE: $20,818
2025-06-10 19:27:26,632 - MoETrainer - INFO - Final MAE: $15,792
2025-06-10 19:28:34,645 - MoETrainer - INFO - === TRAINING BASELINE MODEL ===
2025-06-10 19:28:34,645 - MoETrainer - INFO - Configuration: Hybrid DataManager + Enhanced Expert Factory
2025-06-10 19:28:34,646 - MoETrainer - INFO - Loading data with hybrid processing...
2025-06-10 19:28:34,646 - MoETrainer - WARNING - No data file found. Generating sample data.
2025-06-10 19:28:34,648 - MoETrainer - INFO - Loaded dataset: 2000 samples, 7 features
2025-06-10 19:28:34,648 - MoETrainer - INFO - Target statistics: mean=$466,218, std=$102,122
2025-06-10 19:28:34,649 - MoETrainer - INFO - Target range: [$135,933, $809,379]
2025-06-10 19:28:34,649 - MoETrainer - INFO - Preprocessing data with hybrid approach...
2025-06-10 19:28:34,653 - MoETrainer - INFO - Applied robust scaling
2025-06-10 19:28:34,654 - MoETrainer - INFO - Splitting data...
2025-06-10 19:28:34,656 - MoETrainer - INFO - Data split - Train: 1300, Val: 300, Test: 400
2025-06-10 19:28:34,657 - MoETrainer - INFO - Train target: mean=$465,711, std=$101,303
2025-06-10 19:28:34,657 - MoETrainer - INFO - Test target: mean=$467,709, std=$103,219
2025-06-10 19:28:34,658 - MoETrainer - INFO - Finding optimal bin configuration...
2025-06-10 19:28:34,658 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:28:34,659 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:28:34,660 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:28:34,661 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:28:34,662 - MoETrainer - INFO - Bin 0: Small bin (433), using rule-based selection
2025-06-10 19:28:35,414 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:28:35,414 - MoETrainer - INFO -   1. ridge_medium: Score=0.693, MAE=$23726, RMSE=$29680, RÂ²=0.607 [SELECTED]
2025-06-10 19:28:35,414 - MoETrainer - INFO -   2. lgb_conservative: Score=0.716, MAE=$23708, RMSE=$30793, RÂ²=0.577
2025-06-10 19:28:35,415 - MoETrainer - INFO -   3. lgb_balanced: Score=0.717, MAE=$24528, RMSE=$30703, RÂ²=0.580
2025-06-10 19:28:35,416 - MoETrainer - INFO - Bin 1: Small bin (433), using rule-based selection
2025-06-10 19:28:35,895 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:28:35,895 - MoETrainer - INFO -   1. rf_medium: Score=0.801, MAE=$16363, RMSE=$19372, RÂ²=0.413 [SELECTED]
2025-06-10 19:28:35,896 - MoETrainer - INFO -   2. xgb_balanced: Score=0.801, MAE=$15689, RMSE=$19414, RÂ²=0.411
2025-06-10 19:28:35,896 - MoETrainer - INFO -   3. rf_shallow: Score=0.804, MAE=$16532, RMSE=$19432, RÂ²=0.410
2025-06-10 19:28:35,897 - MoETrainer - INFO - Bin 2: Small bin (434), using rule-based selection
2025-06-10 19:28:36,332 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:28:36,333 - MoETrainer - INFO -   1. ridge_medium: Score=0.542, MAE=$22792, RMSE=$28912, RÂ²=0.748 [SELECTED]
2025-06-10 19:28:36,333 - MoETrainer - INFO -   2. rf_medium: Score=0.616, MAE=$25644, RMSE=$32926, RÂ²=0.673
2025-06-10 19:28:36,334 - MoETrainer - INFO -   3. xgb_conservative: Score=0.620, MAE=$26294, RMSE=$33040, RÂ²=0.671
2025-06-10 19:28:36,334 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:28:36,336 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 433 samples
2025-06-10 19:28:36,580 - MoETrainer - INFO - Successfully trained rf_medium for bin 1: 433 samples
2025-06-10 19:28:36,582 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 434 samples
2025-06-10 19:28:36,582 - MoETrainer - INFO - Training completed: 3 experts trained
2025-06-10 19:28:36,601 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:28:36,602 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:28:36,603 - MoETrainer - INFO -   RMSE: $27,918
2025-06-10 19:28:36,604 - MoETrainer - INFO -   MAE: $22,153 (4.7% of mean)
2025-06-10 19:28:36,604 - MoETrainer - INFO -   RÂ²: 0.9268
2025-06-10 19:28:36,605 - MoETrainer - INFO -   MAPE: 5.3%
2025-06-10 19:28:36,605 - MoETrainer - INFO -   MPE: +0.5% (bias: overprediction)
2025-06-10 19:28:36,605 - MoETrainer - INFO -   Median APE: 3.9%
2025-06-10 19:28:36,606 - MoETrainer - INFO -   Within 5%: 59.8% of predictions
2025-06-10 19:28:36,606 - MoETrainer - INFO -   Within 10%: 89.8% of predictions
2025-06-10 19:28:36,607 - MoETrainer - INFO -   Within 15%: 96.2% of predictions
2025-06-10 19:28:36,607 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:28:36,607 - MoETrainer - INFO -   Bin 0: RMSE=$32,300, RÂ²=0.6490, Samples=132
2025-06-10 19:28:36,608 - MoETrainer - INFO -   Bin 1: RMSE=$22,868, RÂ²=0.1699, Samples=130
2025-06-10 19:28:36,608 - MoETrainer - INFO -   Bin 2: RMSE=$27,724, RÂ²=0.7245, Samples=138
2025-06-10 19:28:36,608 - MoETrainer - INFO -   3 bins: RÂ²=0.9268, RMSE=$27,918
2025-06-10 19:28:36,609 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:28:36,610 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:28:36,610 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:28:36,611 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:28:36,611 - MoETrainer - INFO - Bin 0: Small bin (325), using rule-based selection
2025-06-10 19:28:36,737 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:28:36,738 - MoETrainer - INFO -   1. ridge_medium: Score=0.722, MAE=$22686, RMSE=$29813, RÂ²=0.573 [SELECTED]
2025-06-10 19:28:36,738 - MoETrainer - INFO -   2. xgb_conservative: Score=0.821, MAE=$26010, RMSE=$33876, RÂ²=0.449
2025-06-10 19:28:36,738 - MoETrainer - INFO -   3. rf_shallow: Score=0.823, MAE=$26253, RMSE=$33930, RÂ²=0.447
2025-06-10 19:28:36,739 - MoETrainer - INFO - Bin 1: Small bin (325), using rule-based selection
2025-06-10 19:28:36,863 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:28:36,863 - MoETrainer - INFO -   1. ridge_medium: Score=0.875, MAE=$14693, RMSE=$16957, RÂ²=0.293 [SELECTED]
2025-06-10 19:28:36,864 - MoETrainer - INFO -   2. rf_shallow: Score=0.886, MAE=$14793, RMSE=$17177, RÂ²=0.274
2025-06-10 19:28:36,864 - MoETrainer - INFO -   3. lgb_conservative: Score=0.898, MAE=$14726, RMSE=$17410, RÂ²=0.254
2025-06-10 19:28:36,865 - MoETrainer - INFO - Bin 2: Small bin (325), using rule-based selection
2025-06-10 19:28:36,992 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:28:36,993 - MoETrainer - INFO -   1. ridge_medium: Score=0.914, MAE=$15819, RMSE=$18279, RÂ²=0.222 [SELECTED]
2025-06-10 19:28:36,993 - MoETrainer - INFO -   2. rf_shallow: Score=0.945, MAE=$15926, RMSE=$18921, RÂ²=0.167
2025-06-10 19:28:36,994 - MoETrainer - INFO -   3. xgb_conservative: Score=0.952, MAE=$15850, RMSE=$19066, RÂ²=0.154
2025-06-10 19:28:36,994 - MoETrainer - INFO - Bin 3: Small bin (325), using rule-based selection
2025-06-10 19:28:37,117 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-10 19:28:37,118 - MoETrainer - INFO -   1. ridge_medium: Score=0.615, MAE=$22836, RMSE=$29251, RÂ²=0.667 [SELECTED]
2025-06-10 19:28:37,118 - MoETrainer - INFO -   2. xgb_conservative: Score=0.697, MAE=$27000, RMSE=$33043, RÂ²=0.575
2025-06-10 19:28:37,119 - MoETrainer - INFO -   3. rf_shallow: Score=0.704, MAE=$25873, RMSE=$33524, RÂ²=0.563
2025-06-10 19:28:37,119 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:28:37,121 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 325 samples
2025-06-10 19:28:37,122 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 325 samples
2025-06-10 19:28:37,124 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 325 samples
2025-06-10 19:28:37,126 - MoETrainer - INFO - Successfully trained ridge_medium for bin 3: 325 samples
2025-06-10 19:28:37,126 - MoETrainer - INFO - Training completed: 4 experts trained
2025-06-10 19:28:37,139 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:28:37,139 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:28:37,140 - MoETrainer - INFO -   RMSE: $24,112
2025-06-10 19:28:37,140 - MoETrainer - INFO -   MAE: $18,450 (3.9% of mean)
2025-06-10 19:28:37,140 - MoETrainer - INFO -   RÂ²: 0.9454
2025-06-10 19:28:37,141 - MoETrainer - INFO -   MAPE: 4.5%
2025-06-10 19:28:37,141 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:28:37,141 - MoETrainer - INFO -   Median APE: 3.3%
2025-06-10 19:28:37,142 - MoETrainer - INFO -   Within 5%: 72.0% of predictions
2025-06-10 19:28:37,142 - MoETrainer - INFO -   Within 10%: 92.5% of predictions
2025-06-10 19:28:37,142 - MoETrainer - INFO -   Within 15%: 96.2% of predictions
2025-06-10 19:28:37,143 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:28:37,143 - MoETrainer - INFO -   Bin 0: RMSE=$33,148, RÂ²=0.5590, Samples=95
2025-06-10 19:28:37,143 - MoETrainer - INFO -   Bin 1: RMSE=$17,375, RÂ²=0.2550, Samples=97
2025-06-10 19:28:37,144 - MoETrainer - INFO -   Bin 2: RMSE=$16,333, RÂ²=0.2695, Samples=104
2025-06-10 19:28:37,144 - MoETrainer - INFO -   Bin 3: RMSE=$26,154, RÂ²=0.6891, Samples=104
2025-06-10 19:28:37,145 - MoETrainer - INFO -   4 bins: RÂ²=0.9454, RMSE=$24,112
2025-06-10 19:28:37,146 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:28:37,146 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:28:37,147 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:28:37,147 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:28:37,147 - MoETrainer - INFO - Bin 0: Small bin (260), using rule-based selection
2025-06-10 19:28:37,269 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:28:37,270 - MoETrainer - INFO -   1. xgb_conservative: Score=0.738, MAE=$19489, RMSE=$24559, RÂ²=0.539 [SELECTED]
2025-06-10 19:28:37,270 - MoETrainer - INFO -   2. ridge_medium: Score=0.741, MAE=$19033, RMSE=$24690, RÂ²=0.534
2025-06-10 19:28:37,270 - MoETrainer - INFO -   3. rf_shallow: Score=0.758, MAE=$19557, RMSE=$25270, RÂ²=0.512
2025-06-10 19:28:37,271 - MoETrainer - INFO - Bin 1: Small bin (260), using rule-based selection
2025-06-10 19:28:37,389 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:28:37,389 - MoETrainer - INFO -   1. ridge_medium: Score=0.952, MAE=$13640, RMSE=$15963, RÂ²=0.156 [SELECTED]
2025-06-10 19:28:37,390 - MoETrainer - INFO -   2. lgb_conservative: Score=0.985, MAE=$13536, RMSE=$16537, RÂ²=0.095
2025-06-10 19:28:37,390 - MoETrainer - INFO -   3. rf_shallow: Score=0.989, MAE=$13518, RMSE=$16612, RÂ²=0.086
2025-06-10 19:28:37,391 - MoETrainer - INFO - Bin 2: Small bin (260), using rule-based selection
2025-06-10 19:28:37,507 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:28:37,508 - MoETrainer - INFO -   1. ridge_medium: Score=0.959, MAE=$11353, RMSE=$13509, RÂ²=0.127 [SELECTED]
2025-06-10 19:28:37,508 - MoETrainer - INFO -   2. lgb_conservative: Score=0.995, MAE=$11905, RMSE=$14024, RÂ²=0.060
2025-06-10 19:28:37,509 - MoETrainer - INFO -   3. xgb_conservative: Score=0.999, MAE=$11751, RMSE=$14085, RÂ²=0.051
2025-06-10 19:28:37,509 - MoETrainer - INFO - Bin 3: Small bin (260), using rule-based selection
2025-06-10 19:28:37,628 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-10 19:28:37,628 - MoETrainer - INFO -   1. rf_shallow: Score=0.859, MAE=$13079, RMSE=$15177, RÂ²=0.304 [SELECTED]
2025-06-10 19:28:37,629 - MoETrainer - INFO -   2. lgb_conservative: Score=0.870, MAE=$13192, RMSE=$15363, RÂ²=0.287
2025-06-10 19:28:37,629 - MoETrainer - INFO -   3. xgb_conservative: Score=0.879, MAE=$13011, RMSE=$15543, RÂ²=0.270
2025-06-10 19:28:37,630 - MoETrainer - INFO - Bin 4: Small bin (260), using rule-based selection
2025-06-10 19:28:37,745 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-10 19:28:37,745 - MoETrainer - INFO -   1. ridge_medium: Score=0.640, MAE=$23184, RMSE=$28966, RÂ²=0.638 [SELECTED]
2025-06-10 19:28:37,746 - MoETrainer - INFO -   2. xgb_conservative: Score=0.716, MAE=$27054, RMSE=$32309, RÂ²=0.549
2025-06-10 19:28:37,746 - MoETrainer - INFO -   3. rf_shallow: Score=0.736, MAE=$27307, RMSE=$33250, RÂ²=0.523
2025-06-10 19:28:37,747 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:28:37,768 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 0: 260 samples
2025-06-10 19:28:37,770 - MoETrainer - INFO - Successfully trained ridge_medium for bin 1: 260 samples
2025-06-10 19:28:37,773 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 260 samples
2025-06-10 19:28:37,861 - MoETrainer - INFO - Successfully trained rf_shallow for bin 3: 260 samples
2025-06-10 19:28:37,863 - MoETrainer - INFO - Successfully trained ridge_medium for bin 4: 260 samples
2025-06-10 19:28:37,863 - MoETrainer - INFO - Training completed: 5 experts trained
2025-06-10 19:28:37,883 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:28:37,883 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:28:37,883 - MoETrainer - INFO -   RMSE: $21,997
2025-06-10 19:28:37,884 - MoETrainer - INFO -   MAE: $16,611 (3.6% of mean)
2025-06-10 19:28:37,884 - MoETrainer - INFO -   RÂ²: 0.9546
2025-06-10 19:28:37,885 - MoETrainer - INFO -   MAPE: 4.1%
2025-06-10 19:28:37,885 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:28:37,886 - MoETrainer - INFO -   Median APE: 2.8%
2025-06-10 19:28:37,886 - MoETrainer - INFO -   Within 5%: 77.0% of predictions
2025-06-10 19:28:37,887 - MoETrainer - INFO -   Within 10%: 95.0% of predictions
2025-06-10 19:28:37,887 - MoETrainer - INFO -   Within 15%: 97.0% of predictions
2025-06-10 19:28:37,888 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:28:37,889 - MoETrainer - INFO -   Bin 0: RMSE=$33,812, RÂ²=0.4603, Samples=75
2025-06-10 19:28:37,890 - MoETrainer - INFO -   Bin 1: RMSE=$15,070, RÂ²=0.1720, Samples=82
2025-06-10 19:28:37,890 - MoETrainer - INFO -   Bin 2: RMSE=$14,555, RÂ²=0.0691, Samples=77
2025-06-10 19:28:37,891 - MoETrainer - INFO -   Bin 3: RMSE=$15,881, RÂ²=0.2028, Samples=79
2025-06-10 19:28:37,891 - MoETrainer - INFO -   Bin 4: RMSE=$24,668, RÂ²=0.6859, Samples=87
2025-06-10 19:28:37,892 - MoETrainer - INFO -   5 bins: RÂ²=0.9546, RMSE=$21,997
2025-06-10 19:28:37,893 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:28:37,893 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:28:37,894 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:28:37,894 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:28:37,894 - MoETrainer - INFO - Bin 0: Small bin (217), using rule-based selection
2025-06-10 19:28:38,008 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:28:38,008 - MoETrainer - INFO -   1. ridge_medium: Score=0.810, MAE=$23026, RMSE=$30602, RÂ²=0.457 [SELECTED]
2025-06-10 19:28:38,009 - MoETrainer - INFO -   2. lgb_conservative: Score=0.818, MAE=$23260, RMSE=$30936, RÂ²=0.445
2025-06-10 19:28:38,009 - MoETrainer - INFO -   3. rf_shallow: Score=0.819, MAE=$23340, RMSE=$30952, RÂ²=0.445
2025-06-10 19:28:38,010 - MoETrainer - INFO - Bin 1: Small bin (216), using rule-based selection
2025-06-10 19:28:38,127 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:28:38,127 - MoETrainer - INFO -   1. rf_shallow: Score=0.938, MAE=$12983, RMSE=$15086, RÂ²=0.182 [SELECTED]
2025-06-10 19:28:38,128 - MoETrainer - INFO -   2. xgb_conservative: Score=0.944, MAE=$13119, RMSE=$15187, RÂ²=0.171
2025-06-10 19:28:38,128 - MoETrainer - INFO -   3. lgb_conservative: Score=0.967, MAE=$13676, RMSE=$15553, RÂ²=0.131
2025-06-10 19:28:38,128 - MoETrainer - INFO - Bin 2: Small bin (217), using rule-based selection
2025-06-10 19:28:38,240 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:28:38,241 - MoETrainer - INFO -   1. ridge_medium: Score=1.019, MAE=$11724, RMSE=$13256, RÂ²=0.014 [SELECTED]
2025-06-10 19:28:38,241 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$11751, RMSE=$13300, RÂ²=0.008
2025-06-10 19:28:38,241 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$11783, RMSE=$13435, RÂ²=-0.013
2025-06-10 19:28:38,242 - MoETrainer - INFO - Bin 3: Small bin (216), using rule-based selection
2025-06-10 19:28:38,354 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-10 19:28:38,355 - MoETrainer - INFO -   1. lgb_conservative: Score=0.941, MAE=$10900, RMSE=$12570, RÂ²=0.156 [SELECTED]
2025-06-10 19:28:38,355 - MoETrainer - INFO -   2. rf_shallow: Score=0.956, MAE=$11194, RMSE=$12770, RÂ²=0.129
2025-06-10 19:28:38,355 - MoETrainer - INFO -   3. xgb_conservative: Score=0.960, MAE=$11133, RMSE=$12828, RÂ²=0.121
2025-06-10 19:28:38,356 - MoETrainer - INFO - Bin 4: Small bin (217), using rule-based selection
2025-06-10 19:28:38,472 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-10 19:28:38,473 - MoETrainer - INFO -   1. xgb_conservative: Score=0.896, MAE=$12613, RMSE=$15047, RÂ²=0.239 [SELECTED]
2025-06-10 19:28:38,473 - MoETrainer - INFO -   2. ridge_medium: Score=0.918, MAE=$13043, RMSE=$15410, RÂ²=0.202
2025-06-10 19:28:38,473 - MoETrainer - INFO -   3. rf_shallow: Score=0.936, MAE=$12718, RMSE=$15737, RÂ²=0.167
2025-06-10 19:28:38,474 - MoETrainer - INFO - Bin 5: Small bin (217), using rule-based selection
2025-06-10 19:28:38,587 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-10 19:28:38,587 - MoETrainer - INFO -   1. ridge_medium: Score=0.695, MAE=$25362, RMSE=$31017, RÂ²=0.572 [SELECTED]
2025-06-10 19:28:38,587 - MoETrainer - INFO -   2. rf_shallow: Score=0.696, MAE=$25262, RMSE=$31034, RÂ²=0.571
2025-06-10 19:28:38,588 - MoETrainer - INFO -   3. lgb_conservative: Score=0.718, MAE=$25063, RMSE=$32107, RÂ²=0.541
2025-06-10 19:28:38,589 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:28:38,590 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 217 samples
2025-06-10 19:28:38,669 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 216 samples
2025-06-10 19:28:38,671 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 217 samples
2025-06-10 19:28:38,681 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 3: 216 samples
2025-06-10 19:28:38,702 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 217 samples
2025-06-10 19:28:38,705 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 217 samples
2025-06-10 19:28:38,706 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-10 19:28:38,727 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:28:38,727 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:28:38,727 - MoETrainer - INFO -   RMSE: $20,818
2025-06-10 19:28:38,728 - MoETrainer - INFO -   MAE: $15,792 (3.4% of mean)
2025-06-10 19:28:38,728 - MoETrainer - INFO -   RÂ²: 0.9593
2025-06-10 19:28:38,728 - MoETrainer - INFO -   MAPE: 3.9%
2025-06-10 19:28:38,729 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:28:38,729 - MoETrainer - INFO -   Median APE: 2.7%
2025-06-10 19:28:38,729 - MoETrainer - INFO -   Within 5%: 78.5% of predictions
2025-06-10 19:28:38,729 - MoETrainer - INFO -   Within 10%: 94.8% of predictions
2025-06-10 19:28:38,729 - MoETrainer - INFO -   Within 15%: 97.5% of predictions
2025-06-10 19:28:38,730 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:28:38,730 - MoETrainer - INFO -   Bin 0: RMSE=$33,641, RÂ²=0.3913, Samples=61
2025-06-10 19:28:38,730 - MoETrainer - INFO -   Bin 1: RMSE=$16,714, RÂ²=0.0131, Samples=71
2025-06-10 19:28:38,730 - MoETrainer - INFO -   Bin 2: RMSE=$13,295, RÂ²=-0.0186, Samples=60
2025-06-10 19:28:38,730 - MoETrainer - INFO -   Bin 3: RMSE=$12,095, RÂ²=-0.0541, Samples=70
2025-06-10 19:28:38,731 - MoETrainer - INFO -   Bin 4: RMSE=$17,058, RÂ²=0.1041, Samples=68
2025-06-10 19:28:38,731 - MoETrainer - INFO -   Bin 5: RMSE=$25,029, RÂ²=0.6323, Samples=70
2025-06-10 19:28:38,731 - MoETrainer - INFO -   6 bins: RÂ²=0.9593, RMSE=$20,818
2025-06-10 19:28:38,732 - MoETrainer - INFO - Optimal configuration: 6 bins
2025-06-10 19:28:38,732 - MoETrainer - INFO - Training final model with 6 bins...
2025-06-10 19:28:38,733 - MoETrainer - INFO - Selecting optimal experts with size-aware strategy...
2025-06-10 19:28:38,733 - MoETrainer - INFO - Created expert pool with 12 models
2025-06-10 19:28:38,733 - MoETrainer - INFO - LightGBM models available for high-quality selection
2025-06-10 19:28:38,733 - MoETrainer - INFO - XGBoost models available for high-quality selection
2025-06-10 19:28:38,734 - MoETrainer - INFO - Bin 0: Small bin (217), using rule-based selection
2025-06-10 19:28:38,848 - MoETrainer - INFO - Bin 0: Rule-based selection results:
2025-06-10 19:28:38,849 - MoETrainer - INFO -   1. ridge_medium: Score=0.810, MAE=$23026, RMSE=$30602, RÂ²=0.457 [SELECTED]
2025-06-10 19:28:38,849 - MoETrainer - INFO -   2. lgb_conservative: Score=0.818, MAE=$23260, RMSE=$30936, RÂ²=0.445
2025-06-10 19:28:38,849 - MoETrainer - INFO -   3. rf_shallow: Score=0.819, MAE=$23340, RMSE=$30952, RÂ²=0.445
2025-06-10 19:28:38,850 - MoETrainer - INFO - Bin 1: Small bin (216), using rule-based selection
2025-06-10 19:28:38,962 - MoETrainer - INFO - Bin 1: Rule-based selection results:
2025-06-10 19:28:38,962 - MoETrainer - INFO -   1. rf_shallow: Score=0.938, MAE=$12983, RMSE=$15086, RÂ²=0.182 [SELECTED]
2025-06-10 19:28:38,963 - MoETrainer - INFO -   2. xgb_conservative: Score=0.944, MAE=$13119, RMSE=$15187, RÂ²=0.171
2025-06-10 19:28:38,963 - MoETrainer - INFO -   3. lgb_conservative: Score=0.967, MAE=$13676, RMSE=$15553, RÂ²=0.131
2025-06-10 19:28:38,964 - MoETrainer - INFO - Bin 2: Small bin (217), using rule-based selection
2025-06-10 19:28:39,076 - MoETrainer - INFO - Bin 2: Rule-based selection results:
2025-06-10 19:28:39,076 - MoETrainer - INFO -   1. ridge_medium: Score=1.019, MAE=$11724, RMSE=$13256, RÂ²=0.014 [SELECTED]
2025-06-10 19:28:39,077 - MoETrainer - INFO -   2. rf_shallow: Score=1.023, MAE=$11751, RMSE=$13300, RÂ²=0.008
2025-06-10 19:28:39,077 - MoETrainer - INFO -   3. xgb_conservative: Score=1.058, MAE=$11783, RMSE=$13435, RÂ²=-0.013
2025-06-10 19:28:39,077 - MoETrainer - INFO - Bin 3: Small bin (216), using rule-based selection
2025-06-10 19:28:39,191 - MoETrainer - INFO - Bin 3: Rule-based selection results:
2025-06-10 19:28:39,191 - MoETrainer - INFO -   1. lgb_conservative: Score=0.941, MAE=$10900, RMSE=$12570, RÂ²=0.156 [SELECTED]
2025-06-10 19:28:39,192 - MoETrainer - INFO -   2. rf_shallow: Score=0.956, MAE=$11194, RMSE=$12770, RÂ²=0.129
2025-06-10 19:28:39,192 - MoETrainer - INFO -   3. xgb_conservative: Score=0.960, MAE=$11133, RMSE=$12828, RÂ²=0.121
2025-06-10 19:28:39,193 - MoETrainer - INFO - Bin 4: Small bin (217), using rule-based selection
2025-06-10 19:28:39,304 - MoETrainer - INFO - Bin 4: Rule-based selection results:
2025-06-10 19:28:39,304 - MoETrainer - INFO -   1. xgb_conservative: Score=0.896, MAE=$12613, RMSE=$15047, RÂ²=0.239 [SELECTED]
2025-06-10 19:28:39,305 - MoETrainer - INFO -   2. ridge_medium: Score=0.918, MAE=$13043, RMSE=$15410, RÂ²=0.202
2025-06-10 19:28:39,305 - MoETrainer - INFO -   3. rf_shallow: Score=0.936, MAE=$12718, RMSE=$15737, RÂ²=0.167
2025-06-10 19:28:39,306 - MoETrainer - INFO - Bin 5: Small bin (217), using rule-based selection
2025-06-10 19:28:39,421 - MoETrainer - INFO - Bin 5: Rule-based selection results:
2025-06-10 19:28:39,421 - MoETrainer - INFO -   1. ridge_medium: Score=0.695, MAE=$25362, RMSE=$31017, RÂ²=0.572 [SELECTED]
2025-06-10 19:28:39,422 - MoETrainer - INFO -   2. rf_shallow: Score=0.696, MAE=$25262, RMSE=$31034, RÂ²=0.571
2025-06-10 19:28:39,422 - MoETrainer - INFO -   3. lgb_conservative: Score=0.718, MAE=$25063, RMSE=$32107, RÂ²=0.541
2025-06-10 19:28:39,422 - MoETrainer - INFO - Training selected expert models...
2025-06-10 19:28:39,424 - MoETrainer - INFO - Successfully trained ridge_medium for bin 0: 217 samples
2025-06-10 19:28:39,506 - MoETrainer - INFO - Successfully trained rf_shallow for bin 1: 216 samples
2025-06-10 19:28:39,507 - MoETrainer - INFO - Successfully trained ridge_medium for bin 2: 217 samples
2025-06-10 19:28:39,518 - MoETrainer - INFO - Successfully trained lgb_conservative for bin 3: 216 samples
2025-06-10 19:28:39,541 - MoETrainer - INFO - Successfully trained xgb_conservative for bin 4: 217 samples
2025-06-10 19:28:39,542 - MoETrainer - INFO - Successfully trained ridge_medium for bin 5: 217 samples
2025-06-10 19:28:39,543 - MoETrainer - INFO - Training completed: 6 experts trained
2025-06-10 19:28:39,565 - MoETrainer - INFO - === Model Evaluation Results ===
2025-06-10 19:28:39,565 - MoETrainer - INFO - Overall Performance:
2025-06-10 19:28:39,566 - MoETrainer - INFO -   RMSE: $20,818
2025-06-10 19:28:39,566 - MoETrainer - INFO -   MAE: $15,792 (3.4% of mean)
2025-06-10 19:28:39,566 - MoETrainer - INFO -   RÂ²: 0.9593
2025-06-10 19:28:39,566 - MoETrainer - INFO -   MAPE: 3.9%
2025-06-10 19:28:39,566 - MoETrainer - INFO -   MPE: +0.8% (bias: overprediction)
2025-06-10 19:28:39,567 - MoETrainer - INFO -   Median APE: 2.7%
2025-06-10 19:28:39,567 - MoETrainer - INFO -   Within 5%: 78.5% of predictions
2025-06-10 19:28:39,567 - MoETrainer - INFO -   Within 10%: 94.8% of predictions
2025-06-10 19:28:39,567 - MoETrainer - INFO -   Within 15%: 97.5% of predictions
2025-06-10 19:28:39,567 - MoETrainer - INFO - 
Per-bin Performance:
2025-06-10 19:28:39,568 - MoETrainer - INFO -   Bin 0: RMSE=$33,641, RÂ²=0.3913, Samples=61
2025-06-10 19:28:39,568 - MoETrainer - INFO -   Bin 1: RMSE=$16,714, RÂ²=0.0131, Samples=71
2025-06-10 19:28:39,568 - MoETrainer - INFO -   Bin 2: RMSE=$13,295, RÂ²=-0.0186, Samples=60
2025-06-10 19:28:39,568 - MoETrainer - INFO -   Bin 3: RMSE=$12,095, RÂ²=-0.0541, Samples=70
2025-06-10 19:28:39,569 - MoETrainer - INFO -   Bin 4: RMSE=$17,058, RÂ²=0.1041, Samples=68
2025-06-10 19:28:39,569 - MoETrainer - INFO -   Bin 5: RMSE=$25,029, RÂ²=0.6323, Samples=70
2025-06-10 19:28:39,569 - MoETrainer - INFO - Final Expert Configuration:
2025-06-10 19:28:39,569 - MoETrainer - INFO -   Bin 0: ridge_medium
2025-06-10 19:28:39,570 - MoETrainer - INFO -   Bin 1: rf_shallow
2025-06-10 19:28:39,571 - MoETrainer - INFO -   Bin 2: ridge_medium
2025-06-10 19:28:39,571 - MoETrainer - INFO -   Bin 3: lgb_conservative
2025-06-10 19:28:39,572 - MoETrainer - INFO -   Bin 4: xgb_conservative
2025-06-10 19:28:39,572 - MoETrainer - INFO -   Bin 5: ridge_medium
2025-06-10 19:28:39,573 - MoETrainer - INFO - === COMPREHENSIVE BASELINE EVALUATION ===
2025-06-10 19:28:39,574 - MoETrainer - INFO - === BASELINE MODEL TRAINING COMPLETE ===
2025-06-10 19:28:39,574 - MoETrainer - INFO - Final Performance: RÂ² = 0.9593
2025-06-10 19:28:39,574 - MoETrainer - INFO - Final RMSE: $20,818
2025-06-10 19:28:39,575 - MoETrainer - INFO - Final MAE: $15,792
